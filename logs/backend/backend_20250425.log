2025-04-25 00:30:20,922 - core.database.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 00:30:20,922 - core.database.connection - INFO - Using MySQL database URL: mysql+pymysql://rai_user:rai_password@mysql:3306/rai_chat
2025-04-25 00:30:20,922 - core.database.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 00:30:20,950 - core.database.connection - INFO - Database connection successful!
2025-04-25 00:30:20,950 - core.database.connection - INFO - Creating database tables if they don't exist...
2025-04-25 00:30:20,954 - core.database.connection - INFO - Database tables created or already exist.
2025-04-25 00:30:20,962 - core.database.connection - INFO - Default user already exists.
2025-04-25 00:30:20,978 - app - INFO - Auth blueprint registered successfully
2025-04-25 00:30:20,994 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 00:30:20,994 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 00:30:20,994 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 00:30:20,994 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 00:30:20,994 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 00:30:20,994 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 00:30:20,994 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 00:30:20,994 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 00:30:21,002 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 00:30:21,002 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 00:30:21,002 - components.action_handler - INFO - Web search functionality is available
2025-04-25 00:30:21,003 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 00:30:21,003 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 00:30:21,004 - app - INFO - Chat blueprint registered successfully
2025-04-25 00:30:21,004 - root - INFO - MySQL connection: rai_user@mysql:3306/rai_chat
2025-04-25 00:30:21,006 - app - INFO - Session blueprint registered successfully
2025-04-25 00:30:21,006 - app - INFO - Memory blueprint registered successfully
2025-04-25 00:30:21,008 - app - INFO - System Messages blueprint registered successfully
2025-04-25 00:30:21,009 - app - INFO - Test Search blueprint registered successfully
2025-04-25 00:30:21,010 - app - INFO - Basic endpoints registered successfully
2025-04-25 00:30:21,014 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 00:38:39,010 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 00:38:39,012 - managers.session - INFO - Creating new UserSessionManager instance
2025-04-25 00:38:39,013 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 00:38:39,013 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 00:38:39,013 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 066b6ed9-2e8a-4598-957a-9dfc7d98e6eb
2025-04-25 00:38:39,014 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 00:38:39,015 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 00:38:39,015 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 00:38:39,015 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 00:38:39,020 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 00:38:39,020 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 00:38:39,032 - utils.imports - INFO - Added /app/ to Python path
2025-04-25 00:38:39,040 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 00:38:39,040 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 00:38:39,040 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 00:38:39,040 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 00:38:39,041 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 00:38:39,041 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 00:38:39,041 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 00:38:39,041 - api.endpoints.chat - ERROR - Error processing chat request: 'ConversationManager' object has no attribute 'load_session'
2025-04-25 00:40:02,452 - core.database.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 00:40:02,452 - core.database.connection - INFO - Using MySQL database URL: mysql+pymysql://rai_user:rai_password@mysql:3306/rai_chat
2025-04-25 00:40:02,452 - core.database.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 00:40:02,467 - core.database.connection - INFO - Database connection successful!
2025-04-25 00:40:02,467 - core.database.connection - INFO - Creating database tables if they don't exist...
2025-04-25 00:40:02,470 - core.database.connection - INFO - Database tables created or already exist.
2025-04-25 00:40:02,475 - core.database.connection - INFO - Default user already exists.
2025-04-25 00:40:02,493 - app - INFO - Auth blueprint registered successfully
2025-04-25 00:40:02,508 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 00:40:02,508 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 00:40:02,508 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 00:40:02,508 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 00:40:02,508 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 00:40:02,508 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 00:40:02,508 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 00:40:02,508 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 00:40:02,516 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 00:40:02,516 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 00:40:02,516 - components.action_handler - INFO - Web search functionality is available
2025-04-25 00:40:02,517 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 00:40:02,517 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 00:40:02,517 - app - INFO - Chat blueprint registered successfully
2025-04-25 00:40:02,518 - root - INFO - MySQL connection: rai_user@mysql:3306/rai_chat
2025-04-25 00:40:02,520 - app - INFO - Session blueprint registered successfully
2025-04-25 00:40:02,521 - app - INFO - Memory blueprint registered successfully
2025-04-25 00:40:02,523 - app - INFO - System Messages blueprint registered successfully
2025-04-25 00:40:02,523 - app - INFO - Test Search blueprint registered successfully
2025-04-25 00:40:02,524 - app - INFO - Basic endpoints registered successfully
2025-04-25 00:40:02,528 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 00:45:11,248 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 00:45:11,248 - managers.session - INFO - Creating new UserSessionManager instance
2025-04-25 00:45:11,249 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 00:45:11,249 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 00:45:11,250 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: c80b7b73-f128-4580-8438-4ade70b1055d
2025-04-25 00:45:11,251 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 00:45:11,251 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 00:45:11,251 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 00:45:11,252 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 00:45:11,256 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 00:45:11,257 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 00:45:11,261 - utils.imports - INFO - Added /app/ to Python path
2025-04-25 00:45:11,263 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 00:45:11,263 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 00:45:11,264 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 00:45:11,264 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 00:45:11,264 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 00:45:11,264 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 00:45:11,264 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 00:45:11,264 - ConvMgr_User5 - INFO - Loading session c80b7b73-f128-4580-8438-4ade70b1055d
2025-04-25 00:45:11,265 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 00:45:11,265 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 00:45:11,265 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 00:45:11,272 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 00:45:11,281 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_aabb56e6-23f7-4402-a65f-35ae9344eb07', 'timestamp': '2025-04-25T00:45:11.272993', 'session_id': 'c80b7b73-f128-4580-8438-4ade70b1055d', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T00:45:11.266137"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 00:45:11,283 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 00:45:11,283 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 00:45:11,283 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is Jordan.
2025-04-25 00:45:11,286 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 00:45:11,287 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 00:45:11,287 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 00:45:11,287 - components.prompt_builder - INFO - Constructing prompt for session c80b7b73-f128-4580-8438-4ade70b1055d, user 5, depth 0
2025-04-25 00:45:11,287 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 00:45:11,287 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Hi, my name is Jordan. Tell me about yourself.'
2025-04-25 00:45:11,288 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 00:45:11,288 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 00:45:11,288 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 00:45:11,288 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 00:45:11,289 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 00:45:11,289 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 00:45:14,030 - CtxMemMgr_User5 - INFO - Loading session c80b7b73-f128-4580-8438-4ade70b1055d for processing assistant message
2025-04-25 00:45:14,030 - CtxMemMgr_User5 - INFO - Loading session context for c80b7b73-f128-4580-8438-4ade70b1055d from /app/data/sessions/5/c80b7b73-f128-4580-8438-4ade70b1055d/context.json
2025-04-25 00:45:14,031 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/c80b7b73-f128-4580-8438-4ade70b1055d/context.json not found. Initializing empty context for new session c80b7b73-f128-4580-8438-4ade70b1055d.
2025-04-25 00:45:14,032 - CtxMemMgr_User5 - INFO - Stored turn 1b1da476-c1ad-40a0-920b-9b69c091550a for active session c80b7b73-f128-4580-8438-4ade70b1055d
2025-04-25 00:45:14,032 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session c80b7b73-f128-4580-8438-4ade70b1055d: '...'
2025-04-25 00:45:14,033 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: Jordan
2025-04-25 00:45:14,034 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is Jordan.
2025-04-25 00:45:14,041 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 00:45:14,042 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 00:45:14,043 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 00:45:14,043 - CtxMemMgr_User5 - INFO - Session c80b7b73-f128-4580-8438-4ade70b1055d: Active history token count ~11 / 30000
2025-04-25 00:45:14,043 - CtxMemMgr_User5 - INFO - Saving active session context for c80b7b73-f128-4580-8438-4ade70b1055d to /app/data/sessions/5/c80b7b73-f128-4580-8438-4ade70b1055d/context.json
2025-04-25 00:45:14,046 - CtxMemMgr_User5 - INFO - Successfully saved context for session c80b7b73-f128-4580-8438-4ade70b1055d
2025-04-25 00:45:14,046 - ActionHandler_User5 - INFO - Processing LLM response for session c80b7b73-f128-4580-8438-4ade70b1055d, user 5
2025-04-25 00:45:14,047 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: c80b7b73-f128-4580-8438-4ade70b1055d).
2025-04-25 00:45:14,048 - CtxMemMgr_User5 - INFO - Stored turn c2690251-32cf-4419-a998-bb8274be88e2 for active session c80b7b73-f128-4580-8438-4ade70b1055d
2025-04-25 00:45:14,048 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session c80b7b73-f128-4580-8438-4ade70b1055d: '...'
2025-04-25 00:45:14,048 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: Jordan
2025-04-25 00:45:14,048 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 00:45:14,049 - CtxMemMgr_User5 - INFO - Session c80b7b73-f128-4580-8438-4ade70b1055d: Active history token count ~22 / 30000
2025-04-25 00:45:14,049 - CtxMemMgr_User5 - INFO - Saving active session context for c80b7b73-f128-4580-8438-4ade70b1055d to /app/data/sessions/5/c80b7b73-f128-4580-8438-4ade70b1055d/context.json
2025-04-25 00:45:14,052 - CtxMemMgr_User5 - INFO - Successfully saved context for session c80b7b73-f128-4580-8438-4ade70b1055d
2025-04-25 00:45:14,052 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 00:45:14,053 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T00:45:00Z",
    "speaker": "User...
2025-04-25 01:16:37,522 - core.database.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 01:16:37,522 - core.database.connection - INFO - Using MySQL database URL: mysql+pymysql://rai_user:rai_password@mysql:3306/rai_chat
2025-04-25 01:16:37,522 - core.database.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 01:16:37,538 - core.database.connection - INFO - Database connection successful!
2025-04-25 01:16:37,539 - core.database.connection - INFO - Creating database tables if they don't exist...
2025-04-25 01:16:37,541 - core.database.connection - INFO - Database tables created or already exist.
2025-04-25 01:16:37,546 - core.database.connection - INFO - Default user already exists.
2025-04-25 01:16:37,562 - app - INFO - Auth blueprint registered successfully
2025-04-25 01:16:37,573 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 01:16:37,573 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 01:16:37,573 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 01:16:37,573 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 01:16:37,573 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 01:16:37,573 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 01:16:37,573 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 01:16:37,574 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 01:16:37,582 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 01:16:37,582 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 01:16:37,582 - components.action_handler - INFO - Web search functionality is available
2025-04-25 01:16:37,582 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 01:16:37,582 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 01:16:37,583 - app - INFO - Chat blueprint registered successfully
2025-04-25 01:16:37,584 - root - INFO - MySQL connection: rai_user@mysql:3306/rai_chat
2025-04-25 01:16:37,585 - app - INFO - Session blueprint registered successfully
2025-04-25 01:16:37,586 - app - INFO - Memory blueprint registered successfully
2025-04-25 01:16:37,588 - app - INFO - System Messages blueprint registered successfully
2025-04-25 01:16:37,588 - app - INFO - Test Search blueprint registered successfully
2025-04-25 01:16:37,589 - app - INFO - Basic endpoints registered successfully
2025-04-25 01:16:37,593 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 01:20:27,065 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:27,066 - managers.session - INFO - Creating new UserSessionManager instance
2025-04-25 01:20:27,067 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 01:20:27,067 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 01:20:27,068 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:27,069 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:20:27,070 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:20:27,070 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:20:27,071 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:20:27,076 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:27,077 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:20:27,082 - utils.imports - INFO - Added /app/ to Python path
2025-04-25 01:20:27,087 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:20:27,087 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:20:27,088 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:20:27,088 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:20:27,088 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:20:27,088 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:20:27,088 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:20:27,089 - ConvMgr_User5 - INFO - Loading session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:27,089 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:20:27,089 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:20:27,089 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:20:27,097 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:27,107 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_9cb8d39a-567d-4cee-a21e-624787242244', 'timestamp': '2025-04-25T01:20:27.098426', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:27.090428"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:27,111 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:27,111 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:27,114 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:27,114 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:20:27,115 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite color. It's cerulean blue.'
2025-04-25 01:20:27,115 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:27,115 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:27,115 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:27,115 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:20:27,116 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:27,116 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:29,708 - CtxMemMgr_User5 - INFO - Loading session bcac0241-a487-429d-a434-9e4e2e4d06d4 for processing assistant message
2025-04-25 01:20:29,709 - CtxMemMgr_User5 - INFO - Loading session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 from /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:29,709 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json not found. Initializing empty context for new session bcac0241-a487-429d-a434-9e4e2e4d06d4.
2025-04-25 01:20:29,710 - CtxMemMgr_User5 - INFO - Stored turn 798eac03-f204-467a-bbfd-ee86dc3f5d15 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:29,710 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:29,715 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:29,715 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~15 / 30000
2025-04-25 01:20:29,716 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:29,719 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:29,719 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:29,721 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:29,721 - CtxMemMgr_User5 - INFO - Stored turn 887244f5-38f7-4449-b34a-66a028344199 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:29,721 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:29,722 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:29,722 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~30 / 30000
2025-04-25 01:20:29,722 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:29,725 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:29,725 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:29,726 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:30,733 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:30,737 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:30,742 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_87b87217-6f93-4cff-94d2-2e35fecd4842', 'timestamp': '2025-04-25T01:20:30.738176', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:30.734090"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:30,745 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:30,746 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:30,747 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:30,747 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my hometown. It's Springfield, Illinois.'
2025-04-25 01:20:30,747 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:30,747 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:30,748 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:30,749 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:30,749 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:33,055 - CtxMemMgr_User5 - INFO - Stored turn 5d297b2a-236d-4984-be57-64e23eb112ea for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:33,056 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:33,056 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:33,056 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~45 / 30000
2025-04-25 01:20:33,056 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:33,058 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:33,058 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:33,058 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:33,058 - CtxMemMgr_User5 - INFO - Stored turn 06c2e101-b43a-4c19-9a04-a4c5fbc36e35 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:33,059 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:33,059 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:33,059 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~60 / 30000
2025-04-25 01:20:33,059 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:33,060 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:33,061 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:33,061 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:34,072 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:34,079 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:34,087 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_12d746e0-8ba5-40a0-aa41-1311cbec81f6', 'timestamp': '2025-04-25T01:20:34.079890', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:34.073275"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:34,093 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:34,094 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:34,095 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:34,096 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my birthday. It's March 15.'
2025-04-25 01:20:34,096 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:34,097 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:34,097 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:34,100 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:34,100 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:36,129 - CtxMemMgr_User5 - INFO - Stored turn ee48bf2f-b443-456d-9580-8358195fa005 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:36,129 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:36,129 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:36,130 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~72 / 30000
2025-04-25 01:20:36,130 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:36,133 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:36,134 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:36,134 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:36,134 - CtxMemMgr_User5 - INFO - Stored turn 8e9297b8-edc5-405e-9242-c46be532a5d0 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:36,134 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:36,135 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:36,135 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~84 / 30000
2025-04-25 01:20:36,135 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:36,137 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:36,137 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:36,138 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:37,144 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:37,152 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:37,159 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8b9c9413-13bf-441c-b01c-8a5677b0569b', 'timestamp': '2025-04-25T01:20:37.153454', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:37.146092"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:37,163 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:37,163 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:37,167 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:37,168 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my pet. It's a golden retriever named Max.'
2025-04-25 01:20:37,168 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:37,169 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:37,169 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:37,171 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:37,172 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:39,366 - CtxMemMgr_User5 - INFO - Stored turn 71dd344b-1bf0-48b1-98cd-64a736bf5299 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:39,367 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:39,367 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:39,368 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~100 / 30000
2025-04-25 01:20:39,368 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:39,378 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:39,378 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:39,379 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:39,379 - CtxMemMgr_User5 - INFO - Stored turn 22f18478-4a44-4620-9d2c-371296ea6545 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:39,379 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:39,380 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:39,380 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~116 / 30000
2025-04-25 01:20:39,380 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:39,383 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:39,383 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:39,384 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:40,420 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:40,427 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:40,443 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_97b82254-11e2-40f5-9a89-d3537e6b93bb', 'timestamp': '2025-04-25T01:20:40.428215', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:40.421113"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:40,454 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:40,454 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:40,455 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:40,456 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my hobby. It's collecting vintage postcards.'
2025-04-25 01:20:40,456 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:40,456 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:40,457 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:40,459 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:40,459 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:42,861 - CtxMemMgr_User5 - INFO - Stored turn fc8fed3b-e012-4169-a756-e8e098bb7ece for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:42,861 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:42,862 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:42,862 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~132 / 30000
2025-04-25 01:20:42,862 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:42,865 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:42,865 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:42,865 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:42,866 - CtxMemMgr_User5 - INFO - Stored turn fb42214d-6c6a-484d-8d73-26f0484ed39b for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:42,866 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:42,866 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:42,867 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~148 / 30000
2025-04-25 01:20:42,867 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:42,869 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:42,869 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:42,871 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:43,880 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:43,887 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:43,892 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8b532f13-8e63-4bd0-be2c-34be90f8e698', 'timestamp': '2025-04-25T01:20:43.887984', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:43.881881"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:43,896 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:43,897 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:43,898 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:43,898 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my dream job. It's wildlife photographer in national parks.'
2025-04-25 01:20:43,898 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:43,899 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:43,899 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:43,901 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:43,901 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:46,822 - CtxMemMgr_User5 - INFO - Stored turn 24ae8a1d-6b27-414c-8f82-22491d5e32dc for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:46,822 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:46,823 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:46,823 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~168 / 30000
2025-04-25 01:20:46,823 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:46,827 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:46,827 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:46,828 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:46,828 - CtxMemMgr_User5 - INFO - Stored turn 9c1e6549-0f73-459b-8dc7-e352ad11ce05 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:46,828 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:46,828 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:46,829 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~188 / 30000
2025-04-25 01:20:46,829 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:46,831 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:46,832 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:46,832 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:47,842 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:47,849 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:47,855 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7833007e-4116-4910-8de2-27e2c79063c3', 'timestamp': '2025-04-25T01:20:47.849860', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:47.843944"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:47,861 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:47,861 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:47,863 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:47,863 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite book. It's The Count of Monte Cristo.'
2025-04-25 01:20:47,864 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:47,864 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:47,864 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:47,867 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:47,867 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:50,523 - CtxMemMgr_User5 - INFO - Stored turn 08ff7b94-16cc-4d42-8e94-f2ffd4bbe6b4 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:50,523 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:50,524 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:50,524 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~205 / 30000
2025-04-25 01:20:50,524 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:50,531 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:50,531 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:50,532 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:50,532 - CtxMemMgr_User5 - INFO - Stored turn 04f6f6cb-7c63-46ef-a4b9-a658c3146e98 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:50,532 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:50,533 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:50,533 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~222 / 30000
2025-04-25 01:20:50,533 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:50,537 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:50,537 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:50,538 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:51,552 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:51,563 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:51,570 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0e81d53c-6a1f-476c-80f3-86992b17e9f9', 'timestamp': '2025-04-25T01:20:51.564166', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:51.553831"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:51,576 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:51,577 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:51,578 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:51,579 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite movie. It's The Shawshank Redemption.'
2025-04-25 01:20:51,579 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:51,579 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:51,580 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:51,582 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:51,583 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:54,229 - CtxMemMgr_User5 - INFO - Stored turn d8273239-b427-4d0c-b82c-a9843aea8c37 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:54,230 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:54,230 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:54,231 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~239 / 30000
2025-04-25 01:20:54,232 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:54,236 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:54,236 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:54,237 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:54,237 - CtxMemMgr_User5 - INFO - Stored turn 523b687b-f7bf-4b35-b38b-6e3240e9d28c for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:54,238 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:54,238 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:54,238 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~256 / 30000
2025-04-25 01:20:54,239 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:54,242 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:54,243 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:54,244 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:55,253 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:55,260 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:55,266 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0f5fedba-57b7-4a4e-9408-bd297299f6cb', 'timestamp': '2025-04-25T01:20:55.260989', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:55.254406"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:55,270 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:55,271 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:55,272 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:55,273 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite food. It's spicy Thai curry.'
2025-04-25 01:20:55,273 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:55,273 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:55,273 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:55,276 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:55,277 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:20:57,596 - CtxMemMgr_User5 - INFO - Stored turn 4a6f564f-4ac1-4fa6-b1c6-e2fa15233597 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:57,596 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:57,597 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:57,597 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~271 / 30000
2025-04-25 01:20:57,597 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:57,604 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:57,604 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:20:57,604 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:20:57,605 - CtxMemMgr_User5 - INFO - Stored turn 830f5d25-6adf-4bac-aa5c-403ae4c4f888 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:57,605 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:20:57,605 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:20:57,605 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~286 / 30000
2025-04-25 01:20:57,606 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:20:57,608 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:20:57,609 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:20:57,609 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:20:58,618 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:58,623 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:20:58,627 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_507eeafb-203b-44fc-a288-72c88cc7be0f', 'timestamp': '2025-04-25T01:20:58.624140', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:20:58.619062"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:20:58,631 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:58,631 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:20:58,632 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:20:58,632 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my college major. It's environmental science.'
2025-04-25 01:20:58,632 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:20:58,633 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:20:58,633 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:20:58,634 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:20:58,635 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:00,947 - CtxMemMgr_User5 - INFO - Stored turn 2626ab93-3d25-4baa-9937-8af2444904c1 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:00,948 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:00,950 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:00,952 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~302 / 30000
2025-04-25 01:21:00,953 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:00,956 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:00,957 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:00,957 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:00,957 - CtxMemMgr_User5 - INFO - Stored turn 673a737c-d39b-4b09-88af-5054953c67cf for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:00,958 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:00,958 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:00,958 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~318 / 30000
2025-04-25 01:21:00,958 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:00,960 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:00,960 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:00,960 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:21:01,968 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:01,974 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:01,980 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_101b1966-e71d-477f-b9a4-cbee9cb01394', 'timestamp': '2025-04-25T01:21:01.974776', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:01.969434"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:01,984 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:01,984 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:01,986 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:01,986 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How's the weather today?'
2025-04-25 01:21:01,986 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:01,986 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:01,986 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:01,988 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:01,988 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:03,873 - CtxMemMgr_User5 - INFO - Stored turn 3eec54c8-b36a-4dcc-96d8-f7b024be83b9 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:03,873 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:03,874 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:03,875 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~324 / 30000
2025-04-25 01:21:03,875 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:03,883 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:03,884 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:03,884 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 01:21:03,885 - ActionHandler_User5 - INFO - Extracted query: 'current weather'
2025-04-25 01:21:03,885 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'current weather' (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4)
2025-04-25 01:21:03,886 - CtxMemMgr_User5 - INFO - Stored turn a2ccd436-1035-4e59-8097-a335a9085ce5 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:03,886 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:03,886 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:03,887 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~330 / 30000
2025-04-25 01:21:03,887 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:03,895 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:03,895 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745544063-bcac0241) ***
2025-04-25 01:21:03,896 - ActionHandler_User5 - INFO - Storing search status for session bcac0241-a487-429d-a434-9e4e2e4d06d4: active
2025-04-25 01:21:03,902 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:03,905 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7b290714-cddf-47fd-85db-3c898341becc', 'timestamp': '2025-04-25T01:21:03.902527', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: current weather", "search_id": "search-1745544063-bcac0241", "timestamp": "2025-04-25T01:21:03.896211"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:03,907 - ActionHandler_User5 - INFO - Stored system message ID sys_7b290714-cddf-47fd-85db-3c898341becc for search ID search-1745544063-bcac0241
2025-04-25 01:21:03,907 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:03,907 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'current weather'
2025-04-25 01:21:03,907 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 01:21:03,907 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 01:21:03,907 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 01:21:03,907 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'current weather'
2025-04-25 01:21:03,908 - components.action_handler - INFO - Performing Tavily search for query: 'current weather'
2025-04-25 01:21:03,908 - components.action_handler - INFO - Calling Tavily search API with query: 'current weather'
2025-04-25 01:21:07,392 - components.action_handler - INFO - Tavily search response: {'query': 'current weather', 'follow_up_questions': None, 'answer': 'Today, April 25, 2025, the temperature is 29.5C (85.2F) with partly cloudy skies. Winds are light at 2.2 mph (3.6 kph) from the S...
2025-04-25 01:21:07,393 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: current weather

Summary: Today, April 25, 2025, the temperature is 29.5C (85.2F) with partly cloudy skies. Winds are light at 2.2 mph (3.6 kph) from the SSW. Humidity is 69%.

1...
2025-04-25 01:21:07,393 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 01:21:07,394 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 01:21:07,394 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 1842
2025-04-25 01:21:07,394 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: current weather

Summary: Today, April 25, 2025, the temperature is 29.5C (85.2...
2025-04-25 01:21:07,395 - ActionHandler_User5 - INFO - Updating system message sys_7b290714-cddf-47fd-85db-3c898341becc for search ID search-1745544063-bcac0241
2025-04-25 01:21:07,399 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:07,404 - api.endpoints.system_messages - INFO - Updated system message sys_7b290714-cddf-47fd-85db-3c898341becc in database
2025-04-25 01:21:07,406 - ActionHandler_User5 - INFO - Successfully updated system message sys_7b290714-cddf-47fd-85db-3c898341becc
2025-04-25 01:21:07,412 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:07,419 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_25356652-7ccb-4e7c-9967-9ffc23bf21ae', 'timestamp': '2025-04-25T01:21:07.412709', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: current weather\\n\\nSummary: Today, April 25, 2025, the temperature is 29.5\\u00b0C (85.2\\u0 ... (1773 characters truncated) ...  2025 April 24, 2025 April 25, 2025 April 26, 2025 April 27, 2025 April 28, 2025 April 29, 2025...\\n\\n", "timestamp": "2025-04-25T01:21:07.406783"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:08,437 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:08,453 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:08,463 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1ee65a9a-d224-445c-a5e4-2284b5a7928a', 'timestamp': '2025-04-25T01:21:08.453907', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:08.439561"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:08,469 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:08,469 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:08,470 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:08,470 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me an interesting fact about space.'
2025-04-25 01:21:08,470 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:08,470 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:08,470 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:08,471 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:08,471 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:10,878 - CtxMemMgr_User5 - INFO - Stored turn f2e0b742-2333-4b81-b2b0-88527edd72e6 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:10,879 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:10,879 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:10,880 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~340 / 30000
2025-04-25 01:21:10,881 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:10,885 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:10,885 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:10,885 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:10,886 - CtxMemMgr_User5 - INFO - Stored turn f161b7a5-c56e-4be4-8f68-eb407c8afbc3 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:10,886 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:10,886 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:10,886 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~350 / 30000
2025-04-25 01:21:10,887 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:10,890 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:10,890 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:10,890 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:11,901 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:11,905 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:11,913 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f2ff1eb5-08dc-4c0d-9db8-f06c3be7cc05', 'timestamp': '2025-04-25T01:21:11.906259', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:11.901729"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:11,917 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:11,918 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:11,919 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:11,920 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's your favorite season?'
2025-04-25 01:21:11,920 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:11,921 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:11,921 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:11,923 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:11,924 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:14,454 - CtxMemMgr_User5 - INFO - Stored turn f39ef50a-a359-40f7-a225-5f8a30f6f8e5 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:14,454 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:14,455 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:14,455 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~357 / 30000
2025-04-25 01:21:14,455 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:14,460 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:14,461 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:14,461 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:14,461 - CtxMemMgr_User5 - INFO - Stored turn b393df71-062d-4ded-b627-8e48f752e19d for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:14,462 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:14,462 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:14,462 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~364 / 30000
2025-04-25 01:21:14,462 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:14,467 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:14,468 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:14,468 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:15,485 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:15,487 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:15,490 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ba9520ab-1304-42f2-b88b-0a2f6988f679', 'timestamp': '2025-04-25T01:21:15.488208', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:15.485551"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:15,491 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:15,491 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:15,492 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:15,492 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'If you could travel anywhere, where would you go?'
2025-04-25 01:21:15,492 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:15,492 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:15,492 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:15,493 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:15,493 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:17,847 - CtxMemMgr_User5 - INFO - Stored turn 2e8c048e-e863-46ff-b767-e89db0f65fda for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:17,847 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:17,848 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:17,849 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~376 / 30000
2025-04-25 01:21:17,849 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:17,861 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:17,862 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:17,862 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:17,862 - CtxMemMgr_User5 - INFO - Stored turn 86d98c49-3a16-4243-aeaf-2b6e19ad2ce7 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:17,863 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:17,863 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:17,863 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~388 / 30000
2025-04-25 01:21:17,864 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:17,871 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:17,872 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:17,872 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:18,880 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:18,888 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:18,896 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_720f890c-c198-473d-86e4-6a7921a86fbe', 'timestamp': '2025-04-25T01:21:18.888979', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:18.881603"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:18,902 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:18,902 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:18,904 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:18,904 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about advances in renewable energy.'
2025-04-25 01:21:18,905 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:18,905 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:18,905 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:18,908 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:18,908 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:22,645 - CtxMemMgr_User5 - INFO - Stored turn d8c10113-65fa-4085-9c5f-43129e333c90 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:22,645 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:22,645 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:22,646 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~398 / 30000
2025-04-25 01:21:22,646 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:22,652 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:22,652 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:22,652 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 01:21:22,653 - ActionHandler_User5 - INFO - Extracted query: 'advancements in renewable energy technologies 2025'
2025-04-25 01:21:22,653 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'advancements in renewable energy technologies 2025' (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4)
2025-04-25 01:21:22,653 - CtxMemMgr_User5 - INFO - Stored turn 099fd24b-eac8-481e-b3e7-cf6a6f390930 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:22,653 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:22,654 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:22,654 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~408 / 30000
2025-04-25 01:21:22,654 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:22,658 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:22,658 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745544082-bcac0241) ***
2025-04-25 01:21:22,658 - ActionHandler_User5 - INFO - Storing search status for session bcac0241-a487-429d-a434-9e4e2e4d06d4: active
2025-04-25 01:21:22,663 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:22,668 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d3b89c72-e6ef-40d5-9664-99895b91c4a1', 'timestamp': '2025-04-25T01:21:22.664214', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: advancements in renewable energy technologies 2025", "search_id": "search-1745544082-bcac0241", "timestamp": "2025-04-25T01:21:22.658927"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:22,670 - ActionHandler_User5 - INFO - Stored system message ID sys_d3b89c72-e6ef-40d5-9664-99895b91c4a1 for search ID search-1745544082-bcac0241
2025-04-25 01:21:22,670 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:22,670 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'advancements in renewable energy technologies 2025'
2025-04-25 01:21:22,671 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 01:21:22,671 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 01:21:22,671 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 01:21:22,671 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'advancements in renewable energy technologies 2025'
2025-04-25 01:21:22,671 - components.action_handler - INFO - Performing Tavily search for query: 'advancements in renewable energy technologies 2025'
2025-04-25 01:21:22,672 - components.action_handler - INFO - Calling Tavily search API with query: 'advancements in renewable energy technologies 2025'
2025-04-25 01:21:25,458 - components.action_handler - INFO - Tavily search response: {'query': 'advancements in renewable energy technologies 2025', 'follow_up_questions': None, 'answer': 'In 2025, renewable energy technologies focus on cheaper solar and wind, advanced storage, and gr...
2025-04-25 01:21:25,459 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: advancements in renewable energy technologies 2025

Summary: In 2025, renewable energy technologies focus on cheaper solar and wind, advanced storage, and green hydrogen. AI and Io...
2025-04-25 01:21:25,460 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 01:21:25,461 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 01:21:25,461 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 2026
2025-04-25 01:21:25,462 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: advancements in renewable energy technologies 2025

Summary: In 2025, renewable ...
2025-04-25 01:21:25,462 - ActionHandler_User5 - INFO - Updating system message sys_d3b89c72-e6ef-40d5-9664-99895b91c4a1 for search ID search-1745544082-bcac0241
2025-04-25 01:21:25,467 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:25,471 - api.endpoints.system_messages - INFO - Updated system message sys_d3b89c72-e6ef-40d5-9664-99895b91c4a1 in database
2025-04-25 01:21:25,473 - ActionHandler_User5 - INFO - Successfully updated system message sys_d3b89c72-e6ef-40d5-9664-99895b91c4a1
2025-04-25 01:21:25,478 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:25,482 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_96ed95e2-02c4-4b5d-8a9c-3f422c6a785c', 'timestamp': '2025-04-25T01:21:25.478710', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: advancements in renewable energy technologies 2025\\n\\nSummary: In 2025, renewable energy tec ... (1886 characters truncated) ...  In the long term, technologies for decarbonizing buses and long-haul trucks, decarbonizing car...\\n\\n", "timestamp": "2025-04-25T01:21:25.473807"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:26,497 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:26,512 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:26,530 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1a2f628d-7cde-4ad9-969e-d13534c07732', 'timestamp': '2025-04-25T01:21:26.515059', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:26.499405"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:26,535 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:26,535 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:26,536 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:21:26,536 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:26,536 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:26,537 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:26,537 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:26,537 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite color?'
2025-04-25 01:21:26,537 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:26,537 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:26,537 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:26,538 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:26,538 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:28,618 - CtxMemMgr_User5 - INFO - Stored turn 792aae6e-773a-4e02-b88e-9a42b88dc798 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:28,618 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:28,619 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:28,619 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~414 / 30000
2025-04-25 01:21:28,620 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:28,626 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:28,626 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:28,627 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:28,627 - CtxMemMgr_User5 - INFO - Stored turn 7de5bad8-6432-490c-a9a7-4bd73d4e363a for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:28,628 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:28,628 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:28,631 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~420 / 30000
2025-04-25 01:21:28,631 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:28,637 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:28,637 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:28,638 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:29,649 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:29,658 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:29,666 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_aa89eafa-d8b4-4c0b-a36a-51667fe92213', 'timestamp': '2025-04-25T01:21:29.659800', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:29.651761"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:29,672 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:29,673 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:29,675 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the hometown.
2025-04-25 01:21:29,675 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:29,679 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:29,680 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:29,681 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:29,681 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my hometown?'
2025-04-25 01:21:29,681 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:29,682 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:29,682 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:29,683 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:29,684 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:32,068 - CtxMemMgr_User5 - INFO - Stored turn 708349ae-d3e5-499c-88ac-306e848c9d59 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:32,069 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:32,069 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:32,070 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~425 / 30000
2025-04-25 01:21:32,070 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:32,077 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:32,077 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:32,077 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:32,078 - CtxMemMgr_User5 - INFO - Stored turn 3e328238-86df-4d2a-b88a-42b755f3f61d for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:32,078 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:32,078 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:32,079 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~430 / 30000
2025-04-25 01:21:32,079 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:32,085 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:32,085 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:32,086 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:33,093 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:33,100 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:33,105 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fc3ea3c5-339c-4d3e-a99e-10e1f23fd4b7', 'timestamp': '2025-04-25T01:21:33.101121', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:33.094789"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:33,109 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:33,109 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:33,110 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the birthday.
2025-04-25 01:21:33,111 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:33,112 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:33,113 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:33,114 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:33,114 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my birthday?'
2025-04-25 01:21:33,114 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:33,115 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:33,115 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:33,117 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:33,117 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:35,133 - CtxMemMgr_User5 - INFO - Stored turn d9b0036d-2875-47f0-bdc2-8fe1172d448d for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:35,134 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:35,134 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:35,135 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~435 / 30000
2025-04-25 01:21:35,135 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:35,145 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:35,146 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:35,146 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:35,146 - CtxMemMgr_User5 - INFO - Stored turn 8581ffba-fe39-4ec2-a66a-57c1ba40af31 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:35,146 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:35,146 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:35,146 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~440 / 30000
2025-04-25 01:21:35,146 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:35,148 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:35,149 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:35,149 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:21:36,160 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:36,172 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:36,180 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5e3afdf9-ad4b-45cd-9420-9f55f2ec0975', 'timestamp': '2025-04-25T01:21:36.173674', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:36.163014"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:36,185 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:36,186 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:36,187 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the pet.
2025-04-25 01:21:36,188 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:36,190 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:36,190 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:36,191 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:36,191 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my pet?'
2025-04-25 01:21:36,191 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:36,191 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:36,191 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:36,192 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:36,192 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:38,161 - CtxMemMgr_User5 - INFO - Stored turn 50fd58be-30a1-4b02-afd5-47838eaad70f for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:38,161 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:38,162 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:38,162 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~443 / 30000
2025-04-25 01:21:38,162 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:38,168 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:38,168 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:38,169 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:38,169 - CtxMemMgr_User5 - INFO - Stored turn 38c3ca86-9c5f-46a8-a76c-59353090f04e for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:38,169 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:38,170 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:38,170 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~446 / 30000
2025-04-25 01:21:38,170 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:38,175 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:38,175 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:38,176 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:39,186 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:39,194 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:39,199 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5c78d51b-b04a-4710-bf87-3210088bf837', 'timestamp': '2025-04-25T01:21:39.194779', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:39.187740"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:39,204 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:39,204 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:39,205 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the hobby.
2025-04-25 01:21:39,205 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:39,207 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:39,209 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:39,210 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:39,210 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my hobby?'
2025-04-25 01:21:39,212 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:39,212 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:39,213 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:39,215 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:39,215 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:41,250 - CtxMemMgr_User5 - INFO - Stored turn 2a3935ff-d25b-4ec0-8b5f-0e216469c30f for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:41,250 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:41,251 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:41,251 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~450 / 30000
2025-04-25 01:21:41,251 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:41,258 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:41,259 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:41,259 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 01:21:41,259 - ActionHandler_User5 - INFO - Extracted query: 'common hobbies and interests'
2025-04-25 01:21:41,259 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'common hobbies and interests' (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4)
2025-04-25 01:21:41,260 - CtxMemMgr_User5 - INFO - Stored turn 5fb38e5c-fea7-4b23-a563-e47c3d4bdfbc for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:41,260 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:41,260 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:41,261 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~454 / 30000
2025-04-25 01:21:41,261 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:41,267 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:41,268 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745544101-bcac0241) ***
2025-04-25 01:21:41,268 - ActionHandler_User5 - INFO - Storing search status for session bcac0241-a487-429d-a434-9e4e2e4d06d4: active
2025-04-25 01:21:41,273 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:41,279 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fe1b2b57-c3c0-4841-97a8-9428e8ab9625', 'timestamp': '2025-04-25T01:21:41.273890', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: common hobbies and interests", "search_id": "search-1745544101-bcac0241", "timestamp": "2025-04-25T01:21:41.268556"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:41,280 - ActionHandler_User5 - INFO - Stored system message ID sys_fe1b2b57-c3c0-4841-97a8-9428e8ab9625 for search ID search-1745544101-bcac0241
2025-04-25 01:21:41,280 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:41,281 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'common hobbies and interests'
2025-04-25 01:21:41,281 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 01:21:41,281 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 01:21:41,282 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 01:21:41,282 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'common hobbies and interests'
2025-04-25 01:21:41,282 - components.action_handler - INFO - Performing Tavily search for query: 'common hobbies and interests'
2025-04-25 01:21:41,282 - components.action_handler - INFO - Calling Tavily search API with query: 'common hobbies and interests'
2025-04-25 01:21:43,946 - components.action_handler - INFO - Tavily search response: {'query': 'common hobbies and interests', 'follow_up_questions': None, 'answer': 'Common hobbies include reading, cooking, and playing video games. Many people also enjoy gardening, crafting, and volu...
2025-04-25 01:21:43,946 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: common hobbies and interests

Summary: Common hobbies include reading, cooking, and playing video games. Many people also enjoy gardening, crafting, and volunteering. Hobbies help ...
2025-04-25 01:21:43,947 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 01:21:43,947 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 01:21:43,947 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 1938
2025-04-25 01:21:43,947 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: common hobbies and interests

Summary: Common hobbies include reading, cooking, ...
2025-04-25 01:21:43,948 - ActionHandler_User5 - INFO - Updating system message sys_fe1b2b57-c3c0-4841-97a8-9428e8ab9625 for search ID search-1745544101-bcac0241
2025-04-25 01:21:43,951 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:43,954 - api.endpoints.system_messages - INFO - Updated system message sys_fe1b2b57-c3c0-4841-97a8-9428e8ab9625 in database
2025-04-25 01:21:43,955 - ActionHandler_User5 - INFO - Successfully updated system message sys_fe1b2b57-c3c0-4841-97a8-9428e8ab9625
2025-04-25 01:21:43,959 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:43,965 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fa3455f2-f27c-43c4-a75a-19e776969333', 'timestamp': '2025-04-25T01:21:43.960442', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: common hobbies and interests\\n\\nSummary: Common hobbies include reading, cooking, and playin ... (1791 characters truncated) ... bbies to Do Alone What is a Hobby? For the purposes of this list, I am focusing on 8 different ...\\n\\n", "timestamp": "2025-04-25T01:21:43.955888"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:44,976 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:44,978 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:44,981 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7850263e-e319-4608-b310-491eb8d7f402', 'timestamp': '2025-04-25T01:21:44.978986', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:44.976594"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:44,983 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:44,983 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:44,983 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the dream.
2025-04-25 01:21:44,983 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:44,984 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:44,984 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:44,984 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:44,984 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my dream job?'
2025-04-25 01:21:44,984 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:44,984 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:44,984 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:44,985 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:44,985 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:47,123 - CtxMemMgr_User5 - INFO - Stored turn 9c8938bf-8cdf-4a1f-944e-c43b7d07447b for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:47,123 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:47,124 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:47,124 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~459 / 30000
2025-04-25 01:21:47,125 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:47,131 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:47,132 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:47,133 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:47,134 - CtxMemMgr_User5 - INFO - Stored turn e5a58ebf-b971-4aab-904d-f5047e32f02a for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:47,135 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:47,136 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:47,137 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~464 / 30000
2025-04-25 01:21:47,137 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:47,145 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:47,145 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:47,145 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:22:00Z",
    "speaker": "User...
2025-04-25 01:21:48,150 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:48,158 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:48,166 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_32bb4fe9-b033-44c3-83df-dc5792e126ba', 'timestamp': '2025-04-25T01:21:48.160263', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:48.152152"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:48,171 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:48,172 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:48,174 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:21:48,174 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:48,177 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:48,178 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:48,179 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:48,179 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite book?'
2025-04-25 01:21:48,179 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:48,180 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:48,180 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:48,182 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:48,182 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:50,570 - CtxMemMgr_User5 - INFO - Stored turn f5c8c32d-6978-4945-8ad2-b2ab11d2b86f for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:50,571 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:50,572 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:50,573 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~470 / 30000
2025-04-25 01:21:50,573 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:50,585 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:50,585 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:50,586 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:50,587 - CtxMemMgr_User5 - INFO - Stored turn 88904e38-7eab-4022-96dc-564e691bc2c7 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:50,587 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:50,587 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:50,588 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~476 / 30000
2025-04-25 01:21:50,588 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:50,595 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:50,595 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:50,596 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:21:51,600 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:51,605 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:51,609 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_53f9d82c-99d0-4e99-a9cc-7c480532c03c', 'timestamp': '2025-04-25T01:21:51.605682', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:51.601607"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:51,612 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:51,612 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:51,613 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:21:51,613 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:51,615 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:51,616 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:51,616 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:51,617 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite movie?'
2025-04-25 01:21:51,617 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:51,617 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:51,618 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:51,620 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:51,620 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:53,797 - CtxMemMgr_User5 - INFO - Stored turn b71139ee-6566-41cd-9310-b25273843d1a for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:53,799 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:53,799 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:53,799 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~482 / 30000
2025-04-25 01:21:53,799 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:53,802 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:53,802 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:53,802 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:53,803 - CtxMemMgr_User5 - INFO - Stored turn a25a3057-e446-4ee4-b442-524cb7ebadcc for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:53,803 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:53,803 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:53,803 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~488 / 30000
2025-04-25 01:21:53,803 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:53,813 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:53,814 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:53,816 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:54,830 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:54,836 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:54,840 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a3b0c3e4-3e2b-4432-b298-9d0b8296f904', 'timestamp': '2025-04-25T01:21:54.836383', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:54.831185"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:54,844 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:54,844 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:54,845 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:21:54,846 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:54,847 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:54,849 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:54,850 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:54,850 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite food?'
2025-04-25 01:21:54,850 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:54,850 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:54,850 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:54,852 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:54,853 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:21:57,001 - CtxMemMgr_User5 - INFO - Stored turn 7b4e66f8-66af-438b-99d9-0f5404641f1b for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:57,002 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:57,002 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:57,002 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~494 / 30000
2025-04-25 01:21:57,003 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:57,008 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:57,008 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:21:57,009 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:21:57,010 - CtxMemMgr_User5 - INFO - Stored turn 6566cb91-9bcc-4f05-a5a7-e211b8ff1a68 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:57,010 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:21:57,010 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:21:57,010 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~500 / 30000
2025-04-25 01:21:57,010 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:21:57,016 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:21:57,017 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:21:57,017 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:21:58,021 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:58,026 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:21:58,030 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_aedd5395-957b-43ed-a599-afacce94a8b3', 'timestamp': '2025-04-25T01:21:58.026889', 'session_id': 'bcac0241-a487-429d-a434-9e4e2e4d06d4', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:21:58.022580"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:21:58,035 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:58,035 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:21:58,036 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the college.
2025-04-25 01:21:58,036 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:21:58,038 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:21:58,039 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:21:58,039 - components.prompt_builder - INFO - Constructing prompt for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5, depth 0
2025-04-25 01:21:58,040 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my college major?'
2025-04-25 01:21:58,040 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:21:58,040 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:21:58,040 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:21:58,042 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:21:58,042 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:22:00,379 - CtxMemMgr_User5 - INFO - Stored turn 38fda6bc-1d29-4907-ac83-90d4fb036a6c for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:22:00,380 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:22:00,381 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:22:00,381 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~506 / 30000
2025-04-25 01:22:00,382 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:22:00,393 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:22:00,393 - ActionHandler_User5 - INFO - Processing LLM response for session bcac0241-a487-429d-a434-9e4e2e4d06d4, user 5
2025-04-25 01:22:00,394 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: bcac0241-a487-429d-a434-9e4e2e4d06d4).
2025-04-25 01:22:00,395 - CtxMemMgr_User5 - INFO - Stored turn 9cb8109d-673b-4a23-a22d-240441ca0ed3 for active session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:22:00,395 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session bcac0241-a487-429d-a434-9e4e2e4d06d4: '...'
2025-04-25 01:22:00,396 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:22:00,396 - CtxMemMgr_User5 - INFO - Session bcac0241-a487-429d-a434-9e4e2e4d06d4: Active history token count ~512 / 30000
2025-04-25 01:22:00,396 - CtxMemMgr_User5 - INFO - Saving active session context for bcac0241-a487-429d-a434-9e4e2e4d06d4 to /app/data/sessions/5/bcac0241-a487-429d-a434-9e4e2e4d06d4/context.json
2025-04-25 01:22:00,403 - CtxMemMgr_User5 - INFO - Successfully saved context for session bcac0241-a487-429d-a434-9e4e2e4d06d4
2025-04-25 01:22:00,404 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:22:00,404 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:23:00Z",
    "speaker": "User...
2025-04-25 01:22:55,972 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:22:55,973 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:22:55,974 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:22:55,974 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:22:55,975 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:22:55,978 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:22:55,979 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:22:55,979 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:22:55,979 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:22:55,979 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:22:55,980 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:22:55,980 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:22:55,980 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:22:55,980 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:22:55,981 - ConvMgr_User5 - INFO - Loading session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:22:55,981 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:22:55,981 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:22:55,981 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:22:55,988 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:22:55,994 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_aae0e6ce-e74e-4f4f-a5ab-9d2625b48df0', 'timestamp': '2025-04-25T01:22:55.989281', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:22:55.982464"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:22:55,997 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:22:55,997 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:22:55,998 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:22:55,998 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:22:55,998 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite color. It's cerulean blue.'
2025-04-25 01:22:55,998 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:22:55,998 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:22:55,999 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:22:55,999 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:22:56,000 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:22:56,000 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:22:58,053 - CtxMemMgr_User5 - INFO - Loading session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 for processing assistant message
2025-04-25 01:22:58,054 - CtxMemMgr_User5 - INFO - Loading session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 from /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:22:58,055 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json not found. Initializing empty context for new session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9.
2025-04-25 01:22:58,055 - CtxMemMgr_User5 - INFO - Stored turn b9048abe-1e2d-44da-9c92-8cc8c153d263 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:22:58,055 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:22:58,055 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:22:58,056 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~15 / 30000
2025-04-25 01:22:58,056 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:22:58,058 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:22:58,058 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:22:58,059 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:22:58,059 - CtxMemMgr_User5 - INFO - Stored turn 3df89c16-c4b8-4a47-a031-e621176d964b for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:22:58,059 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:22:58,059 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:22:58,059 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~30 / 30000
2025-04-25 01:22:58,059 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:22:58,061 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:22:58,061 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:22:58,061 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:22:59,067 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:22:59,074 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:22:59,081 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_031cbf47-b229-459c-945b-e44272ac6daf', 'timestamp': '2025-04-25T01:22:59.075377', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:22:59.068920"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:22:59,084 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:22:59,084 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:22:59,085 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:22:59,086 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my hometown. It's Springfield, Illinois.'
2025-04-25 01:22:59,086 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:22:59,086 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:22:59,086 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:22:59,088 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:22:59,088 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:01,261 - CtxMemMgr_User5 - INFO - Stored turn 30d2c600-ed6b-4b90-b641-b6b6d89628f3 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:01,262 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:01,262 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:01,263 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~45 / 30000
2025-04-25 01:23:01,263 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:01,265 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:01,266 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:01,266 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:01,266 - CtxMemMgr_User5 - INFO - Stored turn a10683d7-8f89-4d1a-93fb-d342b41412e7 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:01,271 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:01,272 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:01,273 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~60 / 30000
2025-04-25 01:23:01,273 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:01,300 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:01,300 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:01,301 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:02,310 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:02,318 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:02,325 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_3ed48315-d450-482a-81e6-92f6d971a668', 'timestamp': '2025-04-25T01:23:02.322026', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:02.311406"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:02,328 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:02,329 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:02,330 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:02,330 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my birthday. It's March 15.'
2025-04-25 01:23:02,330 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:02,331 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:02,331 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:02,332 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:02,333 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:04,311 - CtxMemMgr_User5 - INFO - Stored turn 89a9eda4-3c2c-4a47-8a41-5a0b03d8776c for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:04,312 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:04,312 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:04,312 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~72 / 30000
2025-04-25 01:23:04,313 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:04,314 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:04,315 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:04,315 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:04,315 - CtxMemMgr_User5 - INFO - Stored turn 72f71071-1105-4036-bb9a-15c5766d062c for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:04,315 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:04,315 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:04,315 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~84 / 30000
2025-04-25 01:23:04,316 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:04,317 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:04,318 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:04,319 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:05,326 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:05,334 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:05,342 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_906c7eaa-a757-462f-aea3-97d7be25b7fc', 'timestamp': '2025-04-25T01:23:05.335591', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:05.327705"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:05,348 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:05,348 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:05,349 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:05,350 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my pet. It's a golden retriever named Max.'
2025-04-25 01:23:05,350 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:05,350 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:05,351 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:05,353 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:05,353 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:07,574 - CtxMemMgr_User5 - INFO - Stored turn edb5d936-27e3-4d5e-b4e9-e4700b74b0fa for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:07,576 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:07,578 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:07,579 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~100 / 30000
2025-04-25 01:23:07,579 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:07,583 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:07,584 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:07,584 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:07,584 - CtxMemMgr_User5 - INFO - Stored turn 03003167-f6f8-482a-a3a2-2412db4003b2 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:07,584 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:07,585 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:07,585 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~116 / 30000
2025-04-25 01:23:07,586 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:07,588 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:07,588 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:07,589 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:23:08,607 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:08,614 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:08,618 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1244b94f-ae99-4ce5-9749-dc9cad15d7eb', 'timestamp': '2025-04-25T01:23:08.614444', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:08.608542"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:08,623 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:08,624 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:08,625 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:08,625 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my hobby. It's collecting vintage postcards.'
2025-04-25 01:23:08,626 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:08,626 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:08,626 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:08,630 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:08,630 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:11,108 - CtxMemMgr_User5 - INFO - Stored turn 3d07e160-5f64-4c52-bdde-7751473daf12 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:11,108 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:11,109 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:11,109 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~132 / 30000
2025-04-25 01:23:11,109 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:11,112 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:11,113 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:11,113 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:11,114 - CtxMemMgr_User5 - INFO - Stored turn 67b32018-141f-4491-9428-ec0a40298d50 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:11,114 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:11,114 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:11,114 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~148 / 30000
2025-04-25 01:23:11,115 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:11,117 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:11,117 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:11,119 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:12,143 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:12,145 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:12,149 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e28bad2a-d7c8-4175-a32a-a5b00ebc7af3', 'timestamp': '2025-04-25T01:23:12.145677', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:12.143576"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:12,150 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:12,150 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:12,151 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:12,151 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my dream job. It's wildlife photographer in national parks.'
2025-04-25 01:23:12,151 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:12,151 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:12,151 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:12,151 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:12,152 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:14,979 - CtxMemMgr_User5 - INFO - Stored turn 332ec6db-d229-468c-9467-78607744d20b for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:14,980 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:14,980 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:14,981 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~168 / 30000
2025-04-25 01:23:14,981 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:14,986 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:14,986 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:14,987 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:14,987 - CtxMemMgr_User5 - INFO - Stored turn 7fb628b8-33d5-4a9d-b01c-c5eb5835a01b for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:14,988 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:14,988 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:14,989 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~188 / 30000
2025-04-25 01:23:14,989 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:14,995 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:14,996 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:14,997 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:16,033 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:16,035 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:16,038 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5d6ee387-75e7-48ad-b9be-5e2946473c51', 'timestamp': '2025-04-25T01:23:16.036016', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:16.033783"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:16,040 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:16,040 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:16,040 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:16,040 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite book. It's The Count of Monte Cristo.'
2025-04-25 01:23:16,040 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:16,040 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:16,041 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:16,041 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:16,041 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:18,406 - CtxMemMgr_User5 - INFO - Stored turn e1cb1661-cf71-4242-804d-398137c88fb3 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:18,406 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:18,406 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:18,407 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~205 / 30000
2025-04-25 01:23:18,407 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:18,410 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:18,410 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:18,411 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:18,411 - CtxMemMgr_User5 - INFO - Stored turn ace1374e-0269-4b6f-95f0-9cda262b5dc9 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:18,412 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:18,412 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:18,413 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~222 / 30000
2025-04-25 01:23:18,414 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:18,417 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:18,417 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:18,417 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:19,428 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:19,432 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:19,435 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_77ede8fc-9155-43a7-b047-cd60075d6153', 'timestamp': '2025-04-25T01:23:19.432627', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:19.428872"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:19,439 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:19,439 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:19,440 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:19,441 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite movie. It's The Shawshank Redemption.'
2025-04-25 01:23:19,441 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:19,441 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:19,441 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:19,443 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:19,443 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:22,134 - CtxMemMgr_User5 - INFO - Stored turn ef74fc42-141e-4529-b273-1959f9edc7d9 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:22,134 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:22,135 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:22,135 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~239 / 30000
2025-04-25 01:23:22,136 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:22,141 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:22,141 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:22,142 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:22,142 - CtxMemMgr_User5 - INFO - Stored turn e19cd25a-ad80-45fb-97cb-c0f538e1e1de for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:22,143 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:22,143 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:22,143 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~256 / 30000
2025-04-25 01:23:22,143 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:22,147 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:22,148 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:22,149 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:23,157 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:23,166 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:23,176 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ab47a6a0-a0a9-4588-a98f-46d5daae5592', 'timestamp': '2025-04-25T01:23:23.166986', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:23.158228"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:23,185 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:23,187 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:23,192 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:23,192 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite food. It's spicy Thai curry.'
2025-04-25 01:23:23,192 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:23,192 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:23,193 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:23,194 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:23,194 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:25,326 - CtxMemMgr_User5 - INFO - Stored turn 85b096e8-a98e-4a95-9e89-26b6bbc9cf95 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:25,327 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:25,328 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:25,328 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~271 / 30000
2025-04-25 01:23:25,329 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:25,336 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:25,336 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:25,337 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:25,337 - CtxMemMgr_User5 - INFO - Stored turn 73eecb5a-eafc-4f87-b384-bf039d0153ae for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:25,337 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:25,337 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:25,338 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~286 / 30000
2025-04-25 01:23:25,338 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:25,341 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:25,341 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:25,342 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:23:26,351 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:26,358 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:26,364 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_dbfd6734-1bb4-43f4-b56d-1e412c4e4dde', 'timestamp': '2025-04-25T01:23:26.358796', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:26.352192"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:26,370 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:26,370 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:26,371 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:26,372 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my college major. It's environmental science.'
2025-04-25 01:23:26,373 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:26,373 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:26,375 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:26,379 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:26,379 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:28,800 - CtxMemMgr_User5 - INFO - Stored turn c0c60857-c2f2-40f0-a654-ab8542325d4a for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:28,800 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:28,801 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:28,802 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~302 / 30000
2025-04-25 01:23:28,802 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:28,806 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:28,806 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:28,806 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:28,807 - CtxMemMgr_User5 - INFO - Stored turn 0a71f2ee-27e8-499e-a520-a2b80901224c for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:28,807 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:28,807 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:28,808 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~318 / 30000
2025-04-25 01:23:28,809 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:28,813 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:28,813 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:28,814 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:29,828 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:29,837 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:29,845 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_98854564-61de-47bd-8d1a-1eb1c326a3bd', 'timestamp': '2025-04-25T01:23:29.838278', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:29.830156"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:29,852 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:29,853 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:29,854 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:29,855 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How's the weather today?'
2025-04-25 01:23:29,855 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:29,856 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:29,856 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:29,858 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:29,858 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:31,702 - CtxMemMgr_User5 - INFO - Stored turn 86cebae1-29b4-4315-b703-af4db043d07d for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:31,702 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:31,702 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:31,703 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~324 / 30000
2025-04-25 01:23:31,704 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:31,708 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:31,710 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:31,710 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 01:23:31,711 - ActionHandler_User5 - INFO - Extracted query: 'current weather'
2025-04-25 01:23:31,711 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'current weather' (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9)
2025-04-25 01:23:31,711 - CtxMemMgr_User5 - INFO - Stored turn fcd48c19-aa88-4ed3-a7d5-aec4b064ecde for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:31,711 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:31,712 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:31,712 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~330 / 30000
2025-04-25 01:23:31,712 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:31,715 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:31,715 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745544211-a04ef0d9) ***
2025-04-25 01:23:31,716 - ActionHandler_User5 - INFO - Storing search status for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: active
2025-04-25 01:23:31,722 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:31,728 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ae46d805-2ee7-4fc7-8eeb-76a4a7c2231f', 'timestamp': '2025-04-25T01:23:31.723339', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: current weather", "search_id": "search-1745544211-a04ef0d9", "timestamp": "2025-04-25T01:23:31.715978"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:31,730 - ActionHandler_User5 - INFO - Stored system message ID sys_ae46d805-2ee7-4fc7-8eeb-76a4a7c2231f for search ID search-1745544211-a04ef0d9
2025-04-25 01:23:31,731 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:31,731 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'current weather'
2025-04-25 01:23:31,731 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 01:23:31,731 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 01:23:31,731 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 01:23:31,731 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'current weather'
2025-04-25 01:23:31,731 - components.action_handler - INFO - Performing Tavily search for query: 'current weather'
2025-04-25 01:23:31,731 - components.action_handler - INFO - Calling Tavily search API with query: 'current weather'
2025-04-25 01:23:34,907 - components.action_handler - INFO - Tavily search response: {'query': 'current weather', 'follow_up_questions': None, 'answer': "Today's weather is partly cloudy with a temperature of 85F (29.5C) and a light breeze. The humidity is 69%, and the UV index is 7...
2025-04-25 01:23:34,910 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: current weather

Summary: Today's weather is partly cloudy with a temperature of 85F (29.5C) and a light breeze. The humidity is 69%, and the UV index is 7. The forecast is for c...
2025-04-25 01:23:34,913 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 01:23:34,913 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 01:23:34,914 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 1847
2025-04-25 01:23:34,914 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: current weather

Summary: Today's weather is partly cloudy with a temperature of...
2025-04-25 01:23:34,914 - ActionHandler_User5 - INFO - Updating system message sys_ae46d805-2ee7-4fc7-8eeb-76a4a7c2231f for search ID search-1745544211-a04ef0d9
2025-04-25 01:23:34,918 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:34,925 - api.endpoints.system_messages - INFO - Updated system message sys_ae46d805-2ee7-4fc7-8eeb-76a4a7c2231f in database
2025-04-25 01:23:34,929 - ActionHandler_User5 - INFO - Successfully updated system message sys_ae46d805-2ee7-4fc7-8eeb-76a4a7c2231f
2025-04-25 01:23:34,936 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:34,939 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cde634ba-4138-4d37-8688-016d55942949', 'timestamp': '2025-04-25T01:23:34.936555', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: current weather\\n\\nSummary: Today\'s weather is partly cloudy with a temperature of 85\\u00b ... (1786 characters truncated) ... April. United States England Australia Canada \\u00b0F \\u00b0C. Columbus . Weather in April 20...\\n\\n", "timestamp": "2025-04-25T01:23:34.929880"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:35,951 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:35,959 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:35,966 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0e7dc2fb-b0c3-4518-ac13-3977a0ebbf6b', 'timestamp': '2025-04-25T01:23:35.960604', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:35.952672"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:35,972 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:35,972 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:35,973 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:35,974 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me an interesting fact about space.'
2025-04-25 01:23:35,974 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:35,974 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:35,974 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:35,977 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:35,978 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:38,381 - CtxMemMgr_User5 - INFO - Stored turn e4c79676-d3d7-4974-8c0f-cabde9ce973a for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:38,381 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:38,381 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:38,382 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~340 / 30000
2025-04-25 01:23:38,382 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:38,388 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:38,389 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:38,389 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:38,390 - CtxMemMgr_User5 - INFO - Stored turn 272bf5c0-e7c0-4ffd-88fd-355ea6026d5a for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:38,390 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:38,390 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:38,391 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~350 / 30000
2025-04-25 01:23:38,391 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:38,398 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:38,399 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:38,400 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:23:39,407 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:39,415 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:39,422 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5c4b06c8-f43c-4378-aa27-ac5d6b4bbfb5', 'timestamp': '2025-04-25T01:23:39.417206', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:39.408491"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:39,428 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:39,429 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:39,431 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:39,432 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's your favorite season?'
2025-04-25 01:23:39,432 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:39,433 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:39,433 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:39,436 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:39,436 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:42,013 - CtxMemMgr_User5 - INFO - Stored turn f184abbc-d747-4a88-8cf1-99b40c914319 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:42,015 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:42,015 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:42,016 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~357 / 30000
2025-04-25 01:23:42,016 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:42,020 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:42,020 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:42,021 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:42,021 - CtxMemMgr_User5 - INFO - Stored turn a8deace4-9606-4e2a-a39c-dff9d2611dfb for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:42,021 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:42,021 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:42,021 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~364 / 30000
2025-04-25 01:23:42,022 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:42,023 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:42,023 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:42,024 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:23:43,043 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:43,052 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:43,055 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cb1098b7-5257-4d77-9a82-135b9ed179ac', 'timestamp': '2025-04-25T01:23:43.053186', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:43.045422"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:43,057 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:43,057 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:43,057 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:43,057 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'If you could travel anywhere, where would you go?'
2025-04-25 01:23:43,058 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:43,058 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:43,058 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:43,059 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:43,059 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:45,495 - CtxMemMgr_User5 - INFO - Stored turn 50d4e835-7d8f-4a8f-99cd-a3f2571aa24b for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:45,496 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:45,497 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:45,497 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~376 / 30000
2025-04-25 01:23:45,498 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:45,513 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:45,514 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:45,514 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:45,515 - CtxMemMgr_User5 - INFO - Stored turn 16886f58-7c6e-4109-b85f-e7774fc0fae2 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:45,516 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:45,517 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:45,518 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~388 / 30000
2025-04-25 01:23:45,518 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:45,531 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:45,533 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:45,533 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:23:46,553 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:46,565 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:46,574 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_731322af-2c0f-463b-b44f-0425f7e793af', 'timestamp': '2025-04-25T01:23:46.566598', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:46.556231"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:46,576 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:46,576 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:46,576 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:46,577 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about advances in renewable energy.'
2025-04-25 01:23:46,577 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:46,577 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:46,577 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:46,577 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:46,578 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:50,408 - CtxMemMgr_User5 - INFO - Stored turn f9822828-4a0f-4068-ab02-2f99bd397f91 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:50,408 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:50,410 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:50,411 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~398 / 30000
2025-04-25 01:23:50,412 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:50,424 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:50,424 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:50,426 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:50,427 - CtxMemMgr_User5 - INFO - Stored turn 16f20c77-7e5a-4906-bc97-151d3de22edc for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:50,428 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:50,428 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:50,429 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~408 / 30000
2025-04-25 01:23:50,430 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:50,437 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:50,438 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:50,438 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:24:00Z",
    "speaker": "User...
2025-04-25 01:23:51,452 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:51,458 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:51,463 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0f2d9cac-be21-4a68-9ef8-6e5ecfa45e50', 'timestamp': '2025-04-25T01:23:51.458592', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:51.453737"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:51,468 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:51,468 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:51,469 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:23:51,470 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:23:51,471 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:23:51,472 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:23:51,473 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:51,473 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite color?'
2025-04-25 01:23:51,474 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:51,474 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:51,474 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:51,476 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:51,476 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:53,501 - CtxMemMgr_User5 - INFO - Stored turn 5f1caf38-ca53-483f-a671-aaa36ffece97 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:53,501 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:53,502 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:53,502 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~414 / 30000
2025-04-25 01:23:53,502 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:53,507 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:53,508 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:53,508 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:53,508 - CtxMemMgr_User5 - INFO - Stored turn 65ee657a-e0cc-4b0f-9c58-6de5c5733025 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:53,508 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:53,509 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:53,509 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~420 / 30000
2025-04-25 01:23:53,509 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:53,513 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:53,513 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:53,514 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:23:53,517 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:53,524 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:53,531 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1f161cff-8062-44d3-81ef-b93a9fa95191', 'timestamp': '2025-04-25T01:23:53.524740', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:53.518465"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:53,535 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:53,535 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:53,535 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:53,535 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:23:53,536 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:53,536 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:53,536 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:53,537 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:53,537 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:23:56,056 - CtxMemMgr_User5 - INFO - Stored turn 76098bd5-22bb-4646-9ae1-1a91798beacc for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:56,056 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:56,057 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:56,058 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~436 / 30000
2025-04-25 01:23:56,058 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:56,064 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:56,064 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:23:56,065 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:23:56,065 - CtxMemMgr_User5 - INFO - Stored turn 8d8f7d82-cf11-4a68-9f33-a97be6d559f4 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:56,065 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:23:56,065 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:23:56,066 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~452 / 30000
2025-04-25 01:23:56,066 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:23:56,070 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:23:56,071 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:23:56,071 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:23:58,084 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:58,093 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:23:58,100 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7eac5567-5a6f-4640-918b-9e49373205de', 'timestamp': '2025-04-25T01:23:58.094463', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:23:58.085891"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:23:58,106 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:58,106 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:23:58,108 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the hometown.
2025-04-25 01:23:58,109 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:23:58,111 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:23:58,112 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:23:58,113 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:23:58,113 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my hometown?'
2025-04-25 01:23:58,114 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:23:58,114 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:23:58,114 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:23:58,116 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:23:58,116 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:00,160 - CtxMemMgr_User5 - INFO - Stored turn 1a42b9b9-c0b9-4d99-a084-e9ae6ab9afff for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:00,160 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:00,161 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:00,161 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~457 / 30000
2025-04-25 01:24:00,162 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:00,171 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:00,172 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:00,173 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:00,173 - CtxMemMgr_User5 - INFO - Stored turn e5fb68bc-0677-435c-9f90-981ebaf92a21 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:00,173 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:00,174 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:00,175 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~462 / 30000
2025-04-25 01:24:00,175 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:00,184 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:00,185 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:00,185 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:00,190 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:00,192 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:00,195 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ccffe539-7864-4ff2-a0f7-aee82e312dc6', 'timestamp': '2025-04-25T01:24:00.192862', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:00.190825"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:00,196 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:00,196 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:00,197 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:00,197 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:00,197 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:00,197 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:00,197 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:00,198 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:00,198 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:02,767 - CtxMemMgr_User5 - INFO - Stored turn 34eba359-feee-4a05-bf07-2a59cfc14797 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:02,768 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:02,768 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:02,768 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~478 / 30000
2025-04-25 01:24:02,769 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:02,775 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:02,775 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:02,775 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:02,776 - CtxMemMgr_User5 - INFO - Stored turn 0acb2fa6-89ce-41f5-a6f5-83a237effc2e for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:02,776 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:02,776 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:02,776 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~494 / 30000
2025-04-25 01:24:02,777 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:02,780 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:02,780 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:02,781 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:03,787 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:03,793 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:03,798 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_15eed87c-a45c-4cdd-a571-dd0fa2a707e6', 'timestamp': '2025-04-25T01:24:03.793784', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:03.788616"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:03,802 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:03,802 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:03,803 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:03,803 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:03,804 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:03,805 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:03,805 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:03,807 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:03,807 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:05,865 - CtxMemMgr_User5 - INFO - Stored turn 3b94e93b-b50e-4d01-ac91-a61f4af17fdd for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:05,865 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:05,865 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:05,866 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~510 / 30000
2025-04-25 01:24:05,866 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:05,871 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:05,871 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:05,871 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:05,872 - CtxMemMgr_User5 - INFO - Stored turn 21c411b7-9842-458c-8d99-bfc6c4a6c214 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:05,872 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:05,872 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:05,872 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~526 / 30000
2025-04-25 01:24:05,872 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:05,875 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:05,876 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:05,876 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:07,894 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:07,902 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:07,909 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c3c25f70-1111-4840-9a9d-e7507f775a90', 'timestamp': '2025-04-25T01:24:07.903344', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:07.895900"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:07,914 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:07,914 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:07,916 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the birthday.
2025-04-25 01:24:07,916 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:24:07,919 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:24:07,920 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:24:07,921 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:07,922 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my birthday?'
2025-04-25 01:24:07,922 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:07,923 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:07,923 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:07,926 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:07,926 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:09,894 - CtxMemMgr_User5 - INFO - Stored turn 1811c1a4-1a16-4297-a5ad-139f2fca99e8 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:09,895 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:09,895 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:09,895 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~531 / 30000
2025-04-25 01:24:09,896 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:09,901 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:09,901 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:09,902 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:09,902 - CtxMemMgr_User5 - INFO - Stored turn 28955cbf-2f12-45e5-93e2-d337ecb4ac83 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:09,902 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:09,902 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:09,902 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~536 / 30000
2025-04-25 01:24:09,903 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:09,908 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:09,909 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:09,909 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:09,913 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:09,917 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:09,923 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a83c6c69-8a6c-4341-bd6a-4826c6ab29f9', 'timestamp': '2025-04-25T01:24:09.918121', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:09.914081"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:09,926 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:09,926 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:09,927 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:09,928 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:09,928 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:09,928 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:09,928 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:09,929 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:09,929 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:12,158 - CtxMemMgr_User5 - INFO - Stored turn 476c002e-27e4-46f2-b1de-45ab4c8433c1 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:12,158 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:12,158 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:12,159 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~552 / 30000
2025-04-25 01:24:12,159 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:12,164 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:12,165 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:12,165 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:12,165 - CtxMemMgr_User5 - INFO - Stored turn cd9a3be1-6f8f-47d7-ad90-aab73d5aef2a for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:12,166 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:12,166 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:12,166 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~568 / 30000
2025-04-25 01:24:12,167 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:12,170 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:12,170 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:12,171 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:13,176 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:13,182 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:13,187 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e983a53d-6d02-48cb-97da-88a56231c246', 'timestamp': '2025-04-25T01:24:13.183146', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:13.177584"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:13,192 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:13,193 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:13,196 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:13,196 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:13,197 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:13,197 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:13,197 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:13,201 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:13,202 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:15,350 - CtxMemMgr_User5 - INFO - Stored turn f225ceac-2bfa-4c45-af08-fab98e64a82c for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:15,351 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:15,352 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:15,353 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~584 / 30000
2025-04-25 01:24:15,353 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:15,367 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:15,368 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:15,368 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:15,368 - CtxMemMgr_User5 - INFO - Stored turn 9ce6f37b-5a81-4615-88cf-fcdefdd6e7d6 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:15,369 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:15,369 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:15,369 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~600 / 30000
2025-04-25 01:24:15,370 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:15,376 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:15,376 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:15,377 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:17,394 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:17,402 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:17,413 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8d1b7a5b-c211-4f76-9e09-7b2b6794fe8a', 'timestamp': '2025-04-25T01:24:17.403514', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:17.395920"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:17,418 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:17,419 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:17,420 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the pet.
2025-04-25 01:24:17,421 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:24:17,424 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:24:17,425 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:24:17,425 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:17,425 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my pet?'
2025-04-25 01:24:17,425 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:17,425 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:17,426 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:17,427 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:17,427 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:19,592 - CtxMemMgr_User5 - INFO - Stored turn f1573a13-3db8-4b5a-8f96-b7746eeec1b8 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:19,592 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:19,593 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:19,594 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~603 / 30000
2025-04-25 01:24:19,595 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:19,610 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:19,610 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:19,611 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:19,611 - CtxMemMgr_User5 - INFO - Stored turn faff39c8-9ac6-404d-aa05-29bbeb7371e0 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:19,611 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:19,612 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:19,612 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~606 / 30000
2025-04-25 01:24:19,613 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:19,619 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:19,620 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:19,620 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:19,623 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:19,626 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:19,629 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_866d5396-991a-48a5-b127-e26e8d55820b', 'timestamp': '2025-04-25T01:24:19.626997', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:19.623811"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:19,631 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:19,631 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:19,631 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:19,631 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:19,631 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:19,631 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:19,632 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:19,632 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:19,632 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:22,560 - CtxMemMgr_User5 - INFO - Stored turn efc016bd-d4e4-498b-b183-6c178d231c5e for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:22,560 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:22,560 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:22,560 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~622 / 30000
2025-04-25 01:24:22,560 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:22,563 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:22,564 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:22,564 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:22,564 - CtxMemMgr_User5 - INFO - Stored turn 3e9a3de6-234f-49e4-b16d-ca77296bc037 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:22,564 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:22,564 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:22,565 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~638 / 30000
2025-04-25 01:24:22,565 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:22,567 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:22,567 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:22,567 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:23,577 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:23,584 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:23,594 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7ca7d0eb-eed7-408c-a35c-341ea255372f', 'timestamp': '2025-04-25T01:24:23.584774', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:23.578167"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:23,600 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:23,600 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:23,602 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:23,602 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:23,602 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:23,603 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:23,603 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:23,605 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:23,605 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:25,518 - CtxMemMgr_User5 - INFO - Stored turn 7ddd68fa-7f21-4c95-bdf7-7157f18aa0a0 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:25,518 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:25,519 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:25,519 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~654 / 30000
2025-04-25 01:24:25,519 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:25,521 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:25,521 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:25,521 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:25,522 - CtxMemMgr_User5 - INFO - Stored turn d28916d7-8a5c-4154-9df0-fc2e82bb3337 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:25,522 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:25,522 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:25,522 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~670 / 30000
2025-04-25 01:24:25,522 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:25,549 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:25,549 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:25,549 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:27,578 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:27,586 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:27,592 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d9ccb055-07fc-4266-be83-5ee35b368009', 'timestamp': '2025-04-25T01:24:27.586664', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:27.580528"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:27,594 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:27,594 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:27,595 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the hobby.
2025-04-25 01:24:27,595 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:24:27,596 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:24:27,596 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:24:27,596 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:27,596 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my hobby?'
2025-04-25 01:24:27,596 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:27,596 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:27,596 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:27,597 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:27,597 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:29,725 - CtxMemMgr_User5 - INFO - Stored turn 14e2cfb9-fd9d-4d2c-87d8-045e29c47587 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:29,725 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:29,725 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:29,726 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~674 / 30000
2025-04-25 01:24:29,726 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:29,728 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:29,728 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:29,729 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:29,729 - CtxMemMgr_User5 - INFO - Stored turn 004ab723-7a98-4dac-971d-84c733564ab0 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:29,729 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:29,729 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:29,729 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~678 / 30000
2025-04-25 01:24:29,729 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:29,731 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:29,731 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:29,732 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:29,734 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:29,736 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:29,738 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1b1062a3-5735-4ed9-9337-6bfe9acb9a66', 'timestamp': '2025-04-25T01:24:29.736901', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:29.735187"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:29,739 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:29,740 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:29,740 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:29,740 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:29,740 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:29,740 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:29,740 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:29,741 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:29,741 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:32,486 - CtxMemMgr_User5 - INFO - Stored turn 19067f9a-7136-47a5-8af2-911864f10741 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:32,486 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:32,486 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:32,487 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~694 / 30000
2025-04-25 01:24:32,487 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:32,496 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:32,496 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:32,496 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:32,496 - CtxMemMgr_User5 - INFO - Stored turn 860bab1b-44f1-454f-8f57-03c441a8a24b for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:32,497 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:32,497 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:32,497 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~710 / 30000
2025-04-25 01:24:32,498 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:32,505 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:32,505 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:32,505 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:33,514 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:33,522 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:33,527 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1f3b9aae-b00f-49b7-8e7b-2dda3fbe32a2', 'timestamp': '2025-04-25T01:24:33.523153', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:33.515472"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:33,531 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:33,531 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:33,532 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:33,533 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:33,533 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:33,533 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:33,533 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:33,535 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:33,536 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:36,087 - CtxMemMgr_User5 - INFO - Stored turn 0028d1e4-10b7-49bd-8dd9-27df70e7d0b5 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:36,088 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:36,088 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:36,088 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~726 / 30000
2025-04-25 01:24:36,089 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:36,098 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:36,098 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:36,098 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:36,099 - CtxMemMgr_User5 - INFO - Stored turn e4437db8-157f-49aa-b19a-3c42a47b87ad for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:36,099 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:36,099 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:36,099 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~742 / 30000
2025-04-25 01:24:36,100 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:36,104 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:36,105 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:36,105 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:38,126 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:38,135 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:38,145 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b60046b6-bd43-44a9-bcef-94fd4bdfd529', 'timestamp': '2025-04-25T01:24:38.136791', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:38.127884"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:38,153 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:38,154 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:38,155 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the dream.
2025-04-25 01:24:38,156 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:24:38,157 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:24:38,158 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:24:38,158 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:38,158 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my dream job?'
2025-04-25 01:24:38,158 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:38,158 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:38,158 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:38,159 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:38,159 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:40,584 - CtxMemMgr_User5 - INFO - Stored turn 0deafced-dd4f-446a-939a-d90b65fb5078 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:40,585 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:40,586 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:40,588 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~747 / 30000
2025-04-25 01:24:40,588 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:40,610 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:40,610 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:40,611 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:40,611 - CtxMemMgr_User5 - INFO - Stored turn b2b095dc-306b-4235-9d68-2b2357f39476 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:40,611 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:40,611 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:40,611 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~752 / 30000
2025-04-25 01:24:40,611 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:40,614 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:40,614 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:40,614 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:40,619 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:40,622 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:40,624 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fea1b00b-a4d7-4a7d-9bf2-ad84c78b09fd', 'timestamp': '2025-04-25T01:24:40.622264', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:40.619819"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:40,626 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:40,626 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:40,627 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:40,627 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:40,627 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:40,627 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:40,627 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:40,627 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:40,627 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:42,737 - CtxMemMgr_User5 - INFO - Stored turn c86a17c5-2c85-4178-8d68-a151498009e6 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:42,738 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:42,738 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:42,739 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~768 / 30000
2025-04-25 01:24:42,740 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:42,757 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:42,759 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:42,760 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:42,760 - CtxMemMgr_User5 - INFO - Stored turn 18c4faec-98fc-484b-bdb8-21e282aadf25 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:42,760 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:42,761 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:42,761 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~784 / 30000
2025-04-25 01:24:42,761 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:42,767 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:42,767 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:42,768 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:43,785 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:43,789 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:43,792 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_dde9a0f8-f3f0-4432-aac5-2982ab9ce40f', 'timestamp': '2025-04-25T01:24:43.790243', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:43.787131"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:43,794 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:43,794 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:43,794 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:43,794 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:43,794 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:43,795 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:43,795 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:43,795 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:43,795 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:45,907 - CtxMemMgr_User5 - INFO - Stored turn ccfb1c6a-e824-43dc-b9a6-7ffbd16ef1cb for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:45,908 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:45,909 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:45,909 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~800 / 30000
2025-04-25 01:24:45,910 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:45,926 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:45,927 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:45,928 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:45,928 - CtxMemMgr_User5 - INFO - Stored turn 8787eabc-9dfa-474e-9dcf-a20ebd64ca71 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:45,929 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:45,929 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:45,930 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~816 / 30000
2025-04-25 01:24:45,930 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:45,935 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:45,935 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:45,935 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:47,952 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:47,962 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:47,972 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_91dc9b06-f5e6-4f57-af96-2f693eabfac1', 'timestamp': '2025-04-25T01:24:47.963406', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:47.954379"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:47,979 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:47,980 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:47,981 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:24:47,982 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:24:47,984 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:24:47,984 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:24:47,984 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:47,985 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite book?'
2025-04-25 01:24:47,985 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:47,985 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:47,985 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:47,986 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:47,986 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:49,869 - CtxMemMgr_User5 - INFO - Stored turn ba220b7e-d164-4d07-8aca-e5bcbdad98ac for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:49,870 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:49,870 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:49,871 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~822 / 30000
2025-04-25 01:24:49,871 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:49,889 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:49,889 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:49,890 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:49,890 - CtxMemMgr_User5 - INFO - Stored turn 98e072aa-aa0a-4c47-8580-e05ebe358ab2 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:49,891 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:49,891 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:49,891 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~828 / 30000
2025-04-25 01:24:49,892 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:49,901 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:49,901 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:49,901 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:49,906 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:49,910 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:49,914 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c5ea7986-64a2-42d0-960d-f34b948abc37', 'timestamp': '2025-04-25T01:24:49.910732', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:49.907252"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:49,917 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:49,917 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:49,917 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:49,917 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:49,918 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:49,918 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:49,918 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:49,919 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:49,919 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:52,085 - CtxMemMgr_User5 - INFO - Stored turn 0d4426c1-8a5e-4919-8e3e-f4206736b670 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:52,085 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:52,086 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:52,086 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~844 / 30000
2025-04-25 01:24:52,087 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:52,098 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:52,099 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:52,099 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:52,099 - CtxMemMgr_User5 - INFO - Stored turn eac6b6c8-2e1a-4e91-910a-9257e41b1854 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:52,099 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:52,100 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:52,100 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~860 / 30000
2025-04-25 01:24:52,100 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:52,108 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:52,108 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:52,108 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:24:53,113 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:53,124 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:53,131 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a59a7e25-e93d-40f3-b70a-6f3eccf7040c', 'timestamp': '2025-04-25T01:24:53.125479', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:53.114202"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:53,133 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:53,134 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:53,134 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:53,134 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:53,134 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:53,134 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:53,135 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:53,136 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:53,136 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:55,207 - CtxMemMgr_User5 - INFO - Stored turn b5b9fcc6-cf6f-4a49-9580-c733f69267d6 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:55,209 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:55,209 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:55,211 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~876 / 30000
2025-04-25 01:24:55,211 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:55,238 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:55,238 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:55,239 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:55,240 - CtxMemMgr_User5 - INFO - Stored turn 65ad0f38-1d64-4bc3-b56b-67982bb06156 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:55,240 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:55,241 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:55,241 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~892 / 30000
2025-04-25 01:24:55,242 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:55,253 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:55,253 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:55,253 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:57,269 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:57,277 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:57,286 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_727e5356-e2c0-4074-b645-f83fbf52cbb3', 'timestamp': '2025-04-25T01:24:57.278293', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:57.271080"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:57,289 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:57,289 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:57,289 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:24:57,289 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:24:57,290 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:24:57,290 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:24:57,291 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:57,291 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite movie?'
2025-04-25 01:24:57,291 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:57,291 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:57,291 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:57,291 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:57,291 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:24:59,589 - CtxMemMgr_User5 - INFO - Stored turn d8eaf9c0-a624-4c31-959e-add96e2929df for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:59,589 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:59,590 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:59,591 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~898 / 30000
2025-04-25 01:24:59,592 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:59,610 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:59,610 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:24:59,610 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:24:59,611 - CtxMemMgr_User5 - INFO - Stored turn 0bcb1e3b-7f60-4b6d-9f28-150d3d766c35 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:59,611 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:24:59,611 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:24:59,612 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~904 / 30000
2025-04-25 01:24:59,612 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:24:59,616 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:24:59,616 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:24:59,616 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:24:59,620 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:59,623 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:24:59,626 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1308fe55-7eaa-4261-8c82-3d52fc3f15b2', 'timestamp': '2025-04-25T01:24:59.623811', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:24:59.621190"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:24:59,628 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:59,628 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:24:59,628 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:24:59,628 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:24:59,628 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:24:59,628 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:24:59,628 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:24:59,629 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:24:59,629 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:02,154 - CtxMemMgr_User5 - INFO - Stored turn 7d5442a1-6296-4086-a3f5-b54d038946c4 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:02,155 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:02,158 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:02,160 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~920 / 30000
2025-04-25 01:25:02,160 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:02,184 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:02,185 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:02,185 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:02,185 - CtxMemMgr_User5 - INFO - Stored turn 12969528-5d3d-4c99-bf81-6608dc9179d1 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:02,185 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:02,185 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:02,186 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~936 / 30000
2025-04-25 01:25:02,186 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:02,189 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:02,190 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:02,190 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:25:00Z",
    "speaker": "User...
2025-04-25 01:25:03,213 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:03,229 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:03,237 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7d04ec00-356b-4255-96ce-a4018e79bde0', 'timestamp': '2025-04-25T01:25:03.230266', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:25:03.215578"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:25:03,239 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:03,239 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:25:03,239 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:25:03,240 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:25:03,240 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:25:03,240 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:25:03,240 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:25:03,240 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:03,240 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:05,569 - CtxMemMgr_User5 - INFO - Stored turn 24a5c1cf-f8c3-46c2-b252-a0b80c7c3835 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:05,569 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:05,570 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:05,570 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~952 / 30000
2025-04-25 01:25:05,571 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:05,585 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:05,585 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:05,586 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:05,586 - CtxMemMgr_User5 - INFO - Stored turn 5bc516bb-567b-4e93-bdee-32d30be38509 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:05,587 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:05,587 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:05,588 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~968 / 30000
2025-04-25 01:25:05,588 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:05,597 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:05,597 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:05,597 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:25:07,614 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:07,624 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:07,630 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4467fdca-ae0e-4a0b-b9cb-839b4305de62', 'timestamp': '2025-04-25T01:25:07.625385', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:25:07.617204"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:25:07,633 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:07,633 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:25:07,634 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:25:07,635 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:25:07,636 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:25:07,637 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:25:07,637 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:25:07,638 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite food?'
2025-04-25 01:25:07,638 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:25:07,638 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:25:07,638 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:25:07,640 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:07,640 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:09,708 - CtxMemMgr_User5 - INFO - Stored turn 11a6076b-de3f-4ed7-946a-374c89c58178 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:09,709 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:09,709 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:09,710 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~974 / 30000
2025-04-25 01:25:09,710 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:09,729 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:09,729 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:09,730 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:09,730 - CtxMemMgr_User5 - INFO - Stored turn dc10e238-7578-49c9-8115-f3f7fc68b5eb for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:09,731 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:09,731 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:09,732 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~980 / 30000
2025-04-25 01:25:09,733 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:09,739 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:09,739 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:09,740 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:25:09,745 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:09,747 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:09,751 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_77dd647b-a13f-4909-915d-d0ae57c8ba9d', 'timestamp': '2025-04-25T01:25:09.748053', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:25:09.745309"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:25:09,753 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:09,753 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:25:09,754 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:25:09,754 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:25:09,754 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:25:09,754 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:25:09,754 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:25:09,755 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:09,755 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:11,996 - CtxMemMgr_User5 - INFO - Stored turn 11ea7aea-8b65-4dac-a356-8a2261324332 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:11,997 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:11,998 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:11,998 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~996 / 30000
2025-04-25 01:25:11,999 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:12,030 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:12,030 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:12,030 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:12,031 - CtxMemMgr_User5 - INFO - Stored turn 21827f1b-d588-467a-9115-82aa615d267b for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:12,031 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:12,031 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:12,031 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1012 / 30000
2025-04-25 01:25:12,031 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:12,034 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:12,034 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:12,034 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:25:13,055 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:13,070 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:13,078 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a1d14c98-d407-4b22-a8d8-977957045086', 'timestamp': '2025-04-25T01:25:13.073267', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:25:13.058000"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:25:13,081 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:13,081 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:25:13,082 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:25:13,082 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:25:13,082 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:25:13,082 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:25:13,082 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:25:13,083 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:13,083 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:15,070 - CtxMemMgr_User5 - INFO - Stored turn d8bc30f4-d41c-4dbf-90cd-471089a4dd34 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:15,071 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:15,071 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:15,071 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1028 / 30000
2025-04-25 01:25:15,072 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:15,087 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:15,088 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:15,088 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:15,089 - CtxMemMgr_User5 - INFO - Stored turn afabed72-e6d8-4b6f-9a1f-b23a318c1567 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:15,089 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:15,090 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:15,090 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1044 / 30000
2025-04-25 01:25:15,090 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:15,099 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:15,099 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:15,099 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:25:17,113 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:17,122 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:17,129 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f3ea72a7-0e18-45b7-ad5c-239f5521a620', 'timestamp': '2025-04-25T01:25:17.122650', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:25:17.115169"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:25:17,134 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:17,134 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:25:17,135 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the college.
2025-04-25 01:25:17,136 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:25:17,139 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:25:17,140 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:25:17,140 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:25:17,141 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my college major?'
2025-04-25 01:25:17,141 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:25:17,141 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:25:17,142 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:25:17,144 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:17,144 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:19,343 - CtxMemMgr_User5 - INFO - Stored turn 10f4badb-7f26-42b9-91de-c18386675adc for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:19,343 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:19,344 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:19,344 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1050 / 30000
2025-04-25 01:25:19,344 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:19,358 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:19,358 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:19,359 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:19,359 - CtxMemMgr_User5 - INFO - Stored turn 2991e924-6aa8-4b55-8060-5280ed75bde3 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:19,360 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:19,360 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:19,360 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1056 / 30000
2025-04-25 01:25:19,361 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:19,372 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:19,373 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:19,373 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:25:19,377 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:19,381 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:19,384 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ce485f7e-a5d6-4aaa-9c41-21ec9ed2c009', 'timestamp': '2025-04-25T01:25:19.381544', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:25:19.378089"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:25:19,387 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:19,387 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:25:19,387 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:25:19,387 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:25:19,387 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:25:19,388 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:25:19,388 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:25:19,388 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:19,388 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:22,053 - CtxMemMgr_User5 - INFO - Stored turn 0c13b80d-ea4e-4f97-b6f3-29a702674459 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:22,053 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:22,054 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:22,054 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1072 / 30000
2025-04-25 01:25:22,054 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:22,060 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:22,060 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:22,060 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:22,061 - CtxMemMgr_User5 - INFO - Stored turn 05696c09-c2bf-49bc-aad4-029505172a44 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:22,061 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:22,061 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:22,061 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1088 / 30000
2025-04-25 01:25:22,061 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:22,064 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:22,064 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:22,065 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:25:23,075 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:23,081 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:25:23,084 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a5202260-540b-41a3-8e24-c648dd09abfc', 'timestamp': '2025-04-25T01:25:23.082120', 'session_id': 'a04ef0d9-f90f-4246-91ae-0ad33a0c39f9', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:25:23.077688"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:25:23,086 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:23,086 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:25:23,087 - components.prompt_builder - INFO - Constructing prompt for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5, depth 0
2025-04-25 01:25:23,087 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Please provide more details about that. (simulating tier 2 upgrade)'
2025-04-25 01:25:23,087 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:25:23,087 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:25:23,087 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:25:23,087 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:25:23,088 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:25:25,365 - CtxMemMgr_User5 - INFO - Stored turn a36721da-49d7-4f32-a650-7e4a2cdbcd34 for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:25,365 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:25,365 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:25,366 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1104 / 30000
2025-04-25 01:25:25,366 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:25,381 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:25,382 - ActionHandler_User5 - INFO - Processing LLM response for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9, user 5
2025-04-25 01:25:25,382 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: a04ef0d9-f90f-4246-91ae-0ad33a0c39f9).
2025-04-25 01:25:25,383 - CtxMemMgr_User5 - INFO - Stored turn 1f9ae9f3-1194-4052-84c2-bcccd434c2df for active session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:25,383 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: '...'
2025-04-25 01:25:25,383 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:25:25,383 - CtxMemMgr_User5 - INFO - Session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9: Active history token count ~1120 / 30000
2025-04-25 01:25:25,384 - CtxMemMgr_User5 - INFO - Saving active session context for a04ef0d9-f90f-4246-91ae-0ad33a0c39f9 to /app/data/sessions/5/a04ef0d9-f90f-4246-91ae-0ad33a0c39f9/context.json
2025-04-25 01:25:25,395 - CtxMemMgr_User5 - INFO - Successfully saved context for session a04ef0d9-f90f-4246-91ae-0ad33a0c39f9
2025-04-25 01:25:25,395 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:25:25,395 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:26:00Z",
    "speaker": "User...
2025-04-25 01:35:00,449 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:00,450 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:00,451 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:35:00,451 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:35:00,452 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:35:00,455 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:00,456 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:35:00,456 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:35:00,456 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:35:00,457 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:35:00,457 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:35:00,457 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:35:00,457 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:35:00,457 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:35:00,458 - ConvMgr_User5 - INFO - Loading session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:00,458 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:35:00,458 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:35:00,459 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:35:00,464 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:00,469 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b3076b98-fe08-4c7e-886f-169cce5243dc', 'timestamp': '2025-04-25T01:35:00.464526', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:00.459519"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:00,472 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:00,472 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:00,473 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:00,474 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:35:00,474 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite color. It's cerulean blue.'
2025-04-25 01:35:00,474 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:00,475 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:00,475 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:00,476 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:35:00,478 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:00,478 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:02,805 - CtxMemMgr_User5 - INFO - Loading session 76ad8966-94da-4663-ae8e-881247c86c81 for processing assistant message
2025-04-25 01:35:02,806 - CtxMemMgr_User5 - INFO - Loading session context for 76ad8966-94da-4663-ae8e-881247c86c81 from /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:02,809 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json not found. Initializing empty context for new session 76ad8966-94da-4663-ae8e-881247c86c81.
2025-04-25 01:35:02,810 - CtxMemMgr_User5 - INFO - Stored turn 730347be-f3ab-4f02-afd0-f78e5d052283 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:02,811 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:02,812 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:02,813 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~15 / 30000
2025-04-25 01:35:02,814 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:02,827 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:02,827 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:02,828 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:02,828 - CtxMemMgr_User5 - INFO - Stored turn 7ab4ed8f-33f9-407d-8a0d-495cd50385bc for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:02,829 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:02,829 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:02,829 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~30 / 30000
2025-04-25 01:35:02,829 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:02,830 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:02,830 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:02,830 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:38:00Z",
    "speaker": "User...
2025-04-25 01:35:03,841 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:03,850 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:03,861 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_992a1be0-8d13-4dc4-bad2-73a3709178ae', 'timestamp': '2025-04-25T01:35:03.851077', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:03.843007"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:03,866 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:03,867 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:03,870 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:03,871 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my birthday. It's March 15.'
2025-04-25 01:35:03,872 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:03,872 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:03,873 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:03,877 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:03,877 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:06,034 - CtxMemMgr_User5 - INFO - Stored turn 13f093ec-9b01-431a-a027-e33dfb73ba19 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:06,034 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:06,035 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:06,038 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~42 / 30000
2025-04-25 01:35:06,039 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:06,042 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:06,042 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:06,043 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:06,043 - CtxMemMgr_User5 - INFO - Stored turn 0f55fe85-0e62-452d-b371-41f65e1b9fc6 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:06,044 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:06,044 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:06,044 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~54 / 30000
2025-04-25 01:35:06,045 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:06,048 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:06,049 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:06,049 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:07,065 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:07,078 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:07,088 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_649118e4-cdd9-444d-b5e2-2fbebcd45581', 'timestamp': '2025-04-25T01:35:07.078944', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:07.067113"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:07,094 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:07,095 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:07,097 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:07,097 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my pet. It's a golden retriever named Max.'
2025-04-25 01:35:07,098 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:07,098 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:07,098 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:07,100 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:07,100 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:09,374 - CtxMemMgr_User5 - INFO - Stored turn 60e5100d-c22f-423e-943a-e7fa1b83593f for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:09,375 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:09,375 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:09,375 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~70 / 30000
2025-04-25 01:35:09,376 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:09,378 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:09,378 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:09,381 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:09,381 - CtxMemMgr_User5 - INFO - Stored turn c257c02f-7bc5-42b8-8274-715d675c09e0 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:09,382 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:09,382 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:09,383 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~86 / 30000
2025-04-25 01:35:09,383 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:09,386 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:09,386 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:09,387 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:10,394 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:10,399 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:10,404 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_92a1539c-f6d9-4a8f-8fe2-9ea9d07cb002', 'timestamp': '2025-04-25T01:35:10.400142', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:10.395702"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:10,407 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:10,408 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:10,408 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:10,409 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my hobby. It's collecting vintage postcards.'
2025-04-25 01:35:10,409 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:10,409 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:10,409 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:10,411 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:10,411 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:12,782 - CtxMemMgr_User5 - INFO - Stored turn 1c3e0ffa-3dcc-4841-b68b-20564a3c6a43 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:12,782 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:12,783 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:12,783 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~102 / 30000
2025-04-25 01:35:12,784 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:12,788 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:12,788 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:12,789 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:12,789 - CtxMemMgr_User5 - INFO - Stored turn b5cd3729-7f50-4e50-9e0c-078a3cf2abb1 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:12,789 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:12,789 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:12,790 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~118 / 30000
2025-04-25 01:35:12,790 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:12,793 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:12,794 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:12,794 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:13,807 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:13,817 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:13,826 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7c37d54f-1492-4fc3-8d8b-317dd79ff7ca', 'timestamp': '2025-04-25T01:35:13.818044', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:13.809214"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:13,832 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:13,832 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:13,834 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:13,835 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my hometown. It's Springfield, Illinois.'
2025-04-25 01:35:13,835 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:13,836 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:13,836 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:13,839 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:13,839 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:16,234 - CtxMemMgr_User5 - INFO - Stored turn b2284e46-c808-4d9d-99f8-fce7743100d6 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:16,236 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:16,237 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:16,238 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~133 / 30000
2025-04-25 01:35:16,238 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:16,241 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:16,242 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:16,242 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:16,243 - CtxMemMgr_User5 - INFO - Stored turn 56ffa997-2622-44db-ae2a-821bf43c76f5 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:16,243 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:16,243 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:16,244 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~148 / 30000
2025-04-25 01:35:16,244 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:16,247 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:16,248 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:16,248 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:37:00Z",
    "speaker": "User...
2025-04-25 01:35:17,265 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:17,275 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:17,284 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_bb7b6cc4-6158-4ed2-9c80-194fae60034a', 'timestamp': '2025-04-25T01:35:17.276431', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:17.267218"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:17,291 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:17,292 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:17,293 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:17,293 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my dream job. It's wildlife photographer in national parks.'
2025-04-25 01:35:17,293 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:17,293 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:17,293 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:17,295 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:17,295 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:19,999 - CtxMemMgr_User5 - INFO - Stored turn 166c394f-af94-46ed-a50c-20d6ed4adebe for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:20,000 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:20,001 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:20,001 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~168 / 30000
2025-04-25 01:35:20,002 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:20,010 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:20,010 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:20,011 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:20,011 - CtxMemMgr_User5 - INFO - Stored turn 71a519b9-16ed-4a3a-b6d2-5722f459d3fd for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:20,012 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:20,012 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:20,012 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~188 / 30000
2025-04-25 01:35:20,013 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:20,016 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:20,017 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:20,018 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:21,033 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:21,042 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:21,049 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2f4f2806-ee3c-4236-9e65-120d05c80703', 'timestamp': '2025-04-25T01:35:21.043057', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:21.034691"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:21,058 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:21,058 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:21,060 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:21,061 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite book. It's The Count of Monte Cristo.'
2025-04-25 01:35:21,061 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:21,061 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:21,061 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:21,064 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:21,064 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:23,438 - CtxMemMgr_User5 - INFO - Stored turn 25fc7691-a034-4908-9f94-287247f98582 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:23,438 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:23,438 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:23,438 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~205 / 30000
2025-04-25 01:35:23,438 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:23,440 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:23,440 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:23,440 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:23,440 - CtxMemMgr_User5 - INFO - Stored turn f8b459fc-fc89-4ddc-b189-7968e67e467a for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:23,440 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:23,440 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:23,440 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~222 / 30000
2025-04-25 01:35:23,440 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:23,441 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:23,441 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:23,441 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:24,450 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:24,459 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:24,464 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0fb8c6c2-4c5f-44a7-b269-eb89c56af69c', 'timestamp': '2025-04-25T01:35:24.460068', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:24.452069"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:24,466 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:24,466 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:24,466 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:24,467 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite movie. It's The Shawshank Redemption.'
2025-04-25 01:35:24,467 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:24,467 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:24,467 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:24,467 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:24,467 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:26,715 - CtxMemMgr_User5 - INFO - Stored turn 59bc1187-dd25-4774-95b3-57a02761580d for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:26,715 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:26,716 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:26,716 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~239 / 30000
2025-04-25 01:35:26,717 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:26,720 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:26,720 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:26,721 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:26,721 - CtxMemMgr_User5 - INFO - Stored turn 9f551fad-e134-4bc4-a189-609770de3108 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:26,722 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:26,723 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:26,723 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~256 / 30000
2025-04-25 01:35:26,723 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:26,727 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:26,727 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:26,727 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:27,739 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:27,750 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:27,759 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_316eae0e-8a2d-4e9f-8b62-8e2d72268616', 'timestamp': '2025-04-25T01:35:27.751437', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:27.742600"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:27,765 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:27,765 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:27,768 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:27,768 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my favorite food. It's spicy Thai curry.'
2025-04-25 01:35:27,769 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:27,769 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:27,770 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:27,772 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:27,772 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:30,504 - CtxMemMgr_User5 - INFO - Stored turn c3e45c3e-8941-45c1-ace3-9e8ecf8763b2 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:30,504 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:30,505 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:30,506 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~271 / 30000
2025-04-25 01:35:30,506 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:30,508 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:30,509 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:30,510 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:30,510 - CtxMemMgr_User5 - INFO - Stored turn 5a2ab951-3332-40fd-a40d-bb675f91f3d4 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:30,510 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:30,511 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:30,511 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~286 / 30000
2025-04-25 01:35:30,511 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:30,514 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:30,514 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:30,514 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:31,526 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:31,533 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:31,541 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_74a486f2-37e9-4b32-822d-297d8c319f05', 'timestamp': '2025-04-25T01:35:31.534509', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:31.527669"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:31,547 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:31,547 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:31,549 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:31,550 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Let me tell you about my college major. It's environmental science.'
2025-04-25 01:35:31,550 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:31,551 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:31,551 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:31,553 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:31,554 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:34,092 - CtxMemMgr_User5 - INFO - Stored turn dc8e988b-b414-48ed-88e7-3cdbc38ef8ff for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:34,093 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:34,094 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:34,094 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~302 / 30000
2025-04-25 01:35:34,095 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:34,101 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:34,102 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:34,102 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:34,103 - CtxMemMgr_User5 - INFO - Stored turn ad7fe0b9-f18f-47f6-9554-b54e85799329 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:34,103 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:34,104 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:34,104 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~318 / 30000
2025-04-25 01:35:34,104 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:34,109 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:34,110 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:34,110 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:35,123 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:35,133 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:35,142 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0e3c7095-eb8b-49a5-ab49-a3a8c73027c3', 'timestamp': '2025-04-25T01:35:35.134640', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:35.124721"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:35,148 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:35,149 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:35,151 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:35,151 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the weather today.'
2025-04-25 01:35:35,151 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:35,152 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:35,152 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:35,153 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:35,153 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:37,218 - CtxMemMgr_User5 - INFO - Stored turn a35c518e-2040-47c6-b9a6-2756157b717b for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:37,219 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:37,220 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:37,221 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~326 / 30000
2025-04-25 01:35:37,223 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:37,229 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:37,230 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:37,230 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 01:35:37,231 - ActionHandler_User5 - INFO - Extracted query: 'weather'
2025-04-25 01:35:37,231 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'weather' (Session: 76ad8966-94da-4663-ae8e-881247c86c81)
2025-04-25 01:35:37,231 - CtxMemMgr_User5 - INFO - Stored turn eafcba4d-216a-4366-977a-d6a7b252f6b9 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:37,232 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:37,233 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:37,233 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~334 / 30000
2025-04-25 01:35:37,234 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:37,240 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:37,241 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745544937-76ad8966) ***
2025-04-25 01:35:37,241 - ActionHandler_User5 - INFO - Storing search status for session 76ad8966-94da-4663-ae8e-881247c86c81: active
2025-04-25 01:35:37,250 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:37,254 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0812d42b-0598-4195-99e7-2fa0b31c9608', 'timestamp': '2025-04-25T01:35:37.251127', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: weather", "search_id": "search-1745544937-76ad8966", "timestamp": "2025-04-25T01:35:37.241597"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:37,256 - ActionHandler_User5 - INFO - Stored system message ID sys_0812d42b-0598-4195-99e7-2fa0b31c9608 for search ID search-1745544937-76ad8966
2025-04-25 01:35:37,256 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:37,256 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'weather'
2025-04-25 01:35:37,256 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 01:35:37,256 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 01:35:37,256 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 01:35:37,257 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'weather'
2025-04-25 01:35:37,257 - components.action_handler - INFO - Performing Tavily search for query: 'weather'
2025-04-25 01:35:37,257 - components.action_handler - INFO - Calling Tavily search API with query: 'weather'
2025-04-25 01:35:40,441 - components.action_handler - INFO - Tavily search response: {'query': 'weather', 'follow_up_questions': None, 'answer': 'On April 25, 2025, the United States will have a temperature of 59F/39F, 62% humidity, and 9 mph wind. Ohio will be cold with temperature...
2025-04-25 01:35:40,441 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: weather

Summary: On April 25, 2025, the United States will have a temperature of 59F/39F, 62% humidity, and 9 mph wind. Ohio will be cold with temperatures between 39F and 53F...
2025-04-25 01:35:40,442 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 01:35:40,442 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 01:35:40,442 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 1888
2025-04-25 01:35:40,442 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: weather

Summary: On April 25, 2025, the United States will have a temperature o...
2025-04-25 01:35:40,443 - ActionHandler_User5 - INFO - Updating system message sys_0812d42b-0598-4195-99e7-2fa0b31c9608 for search ID search-1745544937-76ad8966
2025-04-25 01:35:40,446 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:40,451 - api.endpoints.system_messages - INFO - Updated system message sys_0812d42b-0598-4195-99e7-2fa0b31c9608 in database
2025-04-25 01:35:40,452 - ActionHandler_User5 - INFO - Successfully updated system message sys_0812d42b-0598-4195-99e7-2fa0b31c9608
2025-04-25 01:35:40,460 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:40,468 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6c7b88c5-61e5-4d89-8bde-bd80e760679a', 'timestamp': '2025-04-25T01:35:40.461114', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: weather\\n\\nSummary: On April 25, 2025, the United States will have a temperature of 59\\u00b ... (1855 characters truncated) ... hio in April The weather in Ohio in April is very cold with temperatures between 39\\u00b0F and...\\n\\n", "timestamp": "2025-04-25T01:35:40.453668"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:41,480 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:41,495 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:41,501 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7f0e29fc-dcbe-41c4-b306-e2a45815c499', 'timestamp': '2025-04-25T01:35:41.496279', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:41.484062"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:41,507 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:41,507 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:41,508 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:41,509 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about your favorite season.'
2025-04-25 01:35:41,509 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:41,509 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:41,510 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:41,513 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:41,513 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:44,124 - CtxMemMgr_User5 - INFO - Stored turn 1467af20-34aa-4305-a001-d2dd582003bf for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:44,125 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:44,125 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:44,126 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~342 / 30000
2025-04-25 01:35:44,126 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:44,135 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:44,135 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:44,137 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:44,140 - CtxMemMgr_User5 - INFO - Stored turn 901ab452-93f4-4c79-acd2-cd13231f68e4 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:44,140 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:44,141 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:44,141 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~350 / 30000
2025-04-25 01:35:44,141 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:44,150 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:44,150 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:44,152 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:38:00Z",
    "speaker": "User...
2025-04-25 01:35:45,168 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:45,179 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:45,191 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6153eb50-5638-45bf-a46d-6dafcb5a5c8b', 'timestamp': '2025-04-25T01:35:45.181506', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:45.170310"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:45,198 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:45,198 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:45,199 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:45,199 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about interesting space facts.'
2025-04-25 01:35:45,199 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:45,199 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:45,199 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:45,201 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:45,201 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:48,328 - CtxMemMgr_User5 - INFO - Stored turn 6f067414-bf5e-4c9d-b66e-94cf8f4fadf9 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:48,329 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:48,329 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:48,330 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~359 / 30000
2025-04-25 01:35:48,331 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:48,335 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:48,336 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:48,337 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:35:48,338 - CtxMemMgr_User5 - INFO - Stored turn 78093718-2a98-4416-8f65-7959e07d630d for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:48,341 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:48,342 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:48,342 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~368 / 30000
2025-04-25 01:35:48,345 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:48,360 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:48,360 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:35:48,361 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:36:00Z",
    "speaker": "User...
2025-04-25 01:35:49,369 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:49,376 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:49,384 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e49985ba-e5e9-444b-85b9-551e3202665f', 'timestamp': '2025-04-25T01:35:49.377516', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:49.371524"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:49,391 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:49,391 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:49,392 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:49,393 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about advances in renewable energy.'
2025-04-25 01:35:49,393 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:49,393 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:49,394 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:49,396 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:49,396 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:35:53,288 - CtxMemMgr_User5 - INFO - Stored turn b4271ddd-12f8-4681-aabf-885cd40b9a6a for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:53,289 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:53,292 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:53,293 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~378 / 30000
2025-04-25 01:35:53,294 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:53,301 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:53,301 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:35:53,301 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 01:35:53,302 - ActionHandler_User5 - INFO - Extracted query: 'recent advancements in renewable energy technologies'
2025-04-25 01:35:53,302 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'recent advancements in renewable energy technologies' (Session: 76ad8966-94da-4663-ae8e-881247c86c81)
2025-04-25 01:35:53,302 - CtxMemMgr_User5 - INFO - Stored turn 52748d39-e187-44a5-8163-c395b246be0d for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:53,302 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:35:53,302 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:35:53,302 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~388 / 30000
2025-04-25 01:35:53,302 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:35:53,304 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:53,304 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745544953-76ad8966) ***
2025-04-25 01:35:53,304 - ActionHandler_User5 - INFO - Storing search status for session 76ad8966-94da-4663-ae8e-881247c86c81: active
2025-04-25 01:35:53,307 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:53,309 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_20e1cd5e-524d-44f0-b758-c8dab759b2d8', 'timestamp': '2025-04-25T01:35:53.307565', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: recent advancements in renewable energy technologies", "search_id": "search-1745544953-76ad8966", "timestamp": "2025-04-25T01:35:53.304750"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:53,310 - ActionHandler_User5 - INFO - Stored system message ID sys_20e1cd5e-524d-44f0-b758-c8dab759b2d8 for search ID search-1745544953-76ad8966
2025-04-25 01:35:53,310 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:35:53,310 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'recent advancements in renewable energy technologies'
2025-04-25 01:35:53,310 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 01:35:53,310 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 01:35:53,310 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 01:35:53,310 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'recent advancements in renewable energy technologies'
2025-04-25 01:35:53,311 - components.action_handler - INFO - Performing Tavily search for query: 'recent advancements in renewable energy technologies'
2025-04-25 01:35:53,311 - components.action_handler - INFO - Calling Tavily search API with query: 'recent advancements in renewable energy technologies'
2025-04-25 01:35:56,206 - components.action_handler - INFO - Tavily search response: {'query': 'recent advancements in renewable energy technologies', 'follow_up_questions': None, 'answer': 'Recent advancements include next-generation solar panels, perovskite cells, airborne wind ener...
2025-04-25 01:35:56,207 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: recent advancements in renewable energy technologies

Summary: Recent advancements include next-generation solar panels, perovskite cells, airborne wind energy, and integration tec...
2025-04-25 01:35:56,207 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 01:35:56,207 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 01:35:56,207 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 2167
2025-04-25 01:35:56,207 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: recent advancements in renewable energy technologies

Summary: Recent advancemen...
2025-04-25 01:35:56,207 - ActionHandler_User5 - INFO - Updating system message sys_20e1cd5e-524d-44f0-b758-c8dab759b2d8 for search ID search-1745544953-76ad8966
2025-04-25 01:35:56,210 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:56,212 - api.endpoints.system_messages - INFO - Updated system message sys_20e1cd5e-524d-44f0-b758-c8dab759b2d8 in database
2025-04-25 01:35:56,214 - ActionHandler_User5 - INFO - Successfully updated system message sys_20e1cd5e-524d-44f0-b758-c8dab759b2d8
2025-04-25 01:35:56,218 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:56,226 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8a8619a3-42d6-4bc2-a2a6-59bc390ce628', 'timestamp': '2025-04-25T01:35:56.218961', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: recent advancements in renewable energy technologies\\n\\nSummary: Recent advancements include ... (2000 characters truncated) ... nding at an unprecedented rate. According to the U.S. Energy Information Agency (EIA), renewabl...\\n\\n", "timestamp": "2025-04-25T01:35:56.215034"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:57,237 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:57,244 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:35:57,250 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ec01a462-fffe-4ef2-878d-2a17b889b0f7', 'timestamp': '2025-04-25T01:35:57.244542', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:35:57.238515"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:35:57,255 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:57,255 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:35:57,256 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:35:57,257 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about a good book you've read recently.'
2025-04-25 01:35:57,257 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:35:57,257 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:35:57,257 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:35:57,259 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:35:57,260 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:00,212 - CtxMemMgr_User5 - INFO - Stored turn 08a113e2-29d6-41d5-8ebe-ce72d0cd7b26 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:00,215 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:00,215 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:00,216 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~399 / 30000
2025-04-25 01:36:00,217 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:00,229 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:00,230 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:00,231 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:00,232 - CtxMemMgr_User5 - INFO - Stored turn f5146e44-cedc-44b4-a810-957368564100 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:00,232 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:00,232 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:00,233 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~410 / 30000
2025-04-25 01:36:00,234 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:00,238 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:00,239 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:00,239 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:38:00Z",
    "speaker": "User...
2025-04-25 01:36:01,257 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:01,265 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:01,271 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_eb08f499-d7f5-4f6d-bd02-560fe01323e2', 'timestamp': '2025-04-25T01:36:01.266617', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:01.258976"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:01,273 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:01,273 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:01,274 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:01,274 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about fun weekend activities.'
2025-04-25 01:36:01,274 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:01,274 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:01,274 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:01,275 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:01,275 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:04,735 - CtxMemMgr_User5 - INFO - Stored turn ed6cf278-7a93-423d-b820-96fabeb5b487 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:04,735 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:04,736 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:04,736 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~419 / 30000
2025-04-25 01:36:04,737 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:04,743 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:04,743 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:04,743 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:04,744 - CtxMemMgr_User5 - INFO - Stored turn df2262b6-2728-47a4-b363-dcb01ffdf369 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:04,744 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:04,744 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:04,745 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~428 / 30000
2025-04-25 01:36:04,745 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:04,750 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:04,750 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:04,751 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:37:00Z",
    "speaker": "User...
2025-04-25 01:36:05,760 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:05,775 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:05,791 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_991f7ac4-f69d-4e08-a21d-023a55601698', 'timestamp': '2025-04-25T01:36:05.776029', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:05.761656"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:05,802 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:05,808 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:05,810 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:05,811 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about where you would travel if you could go anywhere.'
2025-04-25 01:36:05,812 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:05,812 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:05,813 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:05,814 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:05,815 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:08,879 - CtxMemMgr_User5 - INFO - Stored turn 80c385af-50f7-4f1b-a88a-2ce22fd3b216 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:08,879 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:08,880 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:08,880 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~443 / 30000
2025-04-25 01:36:08,881 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:08,889 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:08,889 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:08,889 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:08,890 - CtxMemMgr_User5 - INFO - Stored turn 6d94becd-cc68-4e11-917f-76d2696e09e2 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:08,890 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:08,890 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:08,890 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~458 / 30000
2025-04-25 01:36:08,891 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:08,899 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:08,899 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:08,900 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:38:00Z",
    "speaker": "User...
2025-04-25 01:36:09,916 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:09,925 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:09,936 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_11b02bb6-457c-4230-b863-b839a9495705', 'timestamp': '2025-04-25T01:36:09.926161', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:09.917805"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:09,944 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:09,945 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:09,946 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the hometown.
2025-04-25 01:36:09,946 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:09,947 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:09,947 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:09,948 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:09,948 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my hometown?'
2025-04-25 01:36:09,948 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:09,948 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:09,948 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:09,949 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:09,949 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:11,968 - CtxMemMgr_User5 - INFO - Stored turn 799ba67a-a5fb-4e1b-b78c-7a30af9a75a9 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:11,969 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:11,969 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:11,970 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~463 / 30000
2025-04-25 01:36:11,970 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:11,977 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:11,978 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:11,978 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:11,978 - CtxMemMgr_User5 - INFO - Stored turn 3355c6ef-1139-4ae7-aa1f-0c7d4771236e for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:11,979 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:11,980 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:11,981 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~468 / 30000
2025-04-25 01:36:11,982 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:11,988 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:11,988 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:11,989 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:37:00Z",
    "speaker": "User...
2025-04-25 01:36:12,001 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:12,008 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:12,011 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0146eeb4-ba43-4770-82dd-39f91030c6bb', 'timestamp': '2025-04-25T01:36:12.009081', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:12.003580"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:12,014 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:12,014 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:12,014 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is sorry.
2025-04-25 01:36:12,015 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the inconvenience.
2025-04-25 01:36:12,015 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:36:12,016 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:12,016 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:36:12,016 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:12,016 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:37:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking for their hometown.",
      "tier2": "The user wants to know what their hometown is, which requires accessing previously stored information about them."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:37:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I'm sorry, I don't have that information yet.  Could you tell me?",
      "tier2": "To answer your question accurately, I need to know your hometown. I don't have access to that information in my current memory. Please share your hometown with me so I can remember it for future reference.",
      "tier3": "I apologize for the inconvenience, but I need you to provide your hometown.  [SEARCH_EPISODIC:hometown]"
    }
  }
}
```

EPISODIC SEARCH RESULTS for 'hometown': hometown: Springfield, Illinois'
2025-04-25 01:36:12,017 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:12,017 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:12,017 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:12,018 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:12,018 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:13,818 - CtxMemMgr_User5 - INFO - Stored turn df20c893-dbf7-4c47-9547-cc61e92e71d5 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:13,818 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:13,819 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: sorry
2025-04-25 01:36:13,819 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is sorry.
2025-04-25 01:36:13,823 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:13,826 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:13,827 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:13,828 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~705 / 30000
2025-04-25 01:36:13,828 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:13,843 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:13,843 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:13,843 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:13,843 - CtxMemMgr_User5 - INFO - Stored turn d59ba151-1908-4079-a833-53f994a6a5d6 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:13,843 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:13,844 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: sorry
2025-04-25 01:36:13,844 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:13,844 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~942 / 30000
2025-04-25 01:36:13,844 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:13,847 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:13,847 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:13,847 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:37:00Z",
    "speaker": "User...
2025-04-25 01:36:14,858 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:14,863 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:14,868 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_85b61dc1-75ed-445c-aa55-dab93f49939f', 'timestamp': '2025-04-25T01:36:14.863996', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:14.859105"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:14,874 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:14,874 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:14,875 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:36:14,875 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:14,876 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:14,877 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:14,878 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:14,878 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite book?'
2025-04-25 01:36:14,878 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:14,878 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:14,878 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:14,880 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:14,880 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:17,301 - CtxMemMgr_User5 - INFO - Stored turn e97ba5b5-b084-45f8-9eac-6ffe6459ce7c for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:17,302 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:17,302 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:17,302 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~948 / 30000
2025-04-25 01:36:17,303 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:17,310 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:17,311 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:17,311 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:17,311 - CtxMemMgr_User5 - INFO - Stored turn ec096735-6836-4231-8743-805b481480fc for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:17,312 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:17,312 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:17,313 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~954 / 30000
2025-04-25 01:36:17,313 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:17,318 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:17,319 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:17,320 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:40:00Z",
    "speaker": "User...
2025-04-25 01:36:17,328 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:17,333 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:17,336 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1c767fe1-096c-48ee-9076-efe35f53eebe', 'timestamp': '2025-04-25T01:36:17.334060', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:17.329862"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:17,337 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:17,338 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:17,338 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is sorry.
2025-04-25 01:36:17,338 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:17,339 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the oversight.
2025-04-25 01:36:17,339 - ConvMgr_User5 - INFO - Added 3 new facts to contextual memory
2025-04-25 01:36:17,339 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:17,340 - ConvMgr_User5 - INFO - Saved 3 new facts to database
2025-04-25 01:36:17,340 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:17,340 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:40:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking about their favorite book.",
      "tier2": "The user wants to know what their favorite book is. This requires accessing previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:40:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I'm sorry, I don't have that information yet. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:favorite book]",
      "tier2": "To accurately answer your question about your favorite book, I need access to your past messages where you might have mentioned it. I haven't found any such information in my current memory.  Could you please provide the title of your favorite book?",
      "tier3": "I apologize for the oversight.  I'm still under development and learning to access and retain information effectively.  To help me improve, please tell me what your favorite book is.  [REQUEST_TIER:3:1] [SEARCH_EPISODIC:favorite book]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'favorite book': favorite book: The Count of Monte Cristo
EPISODIC SEARCH RESULTS for 'favorite book': favorite book: The Count of Monte Cristo'
2025-04-25 01:36:17,340 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:17,341 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:17,341 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:17,341 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:17,341 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:19,450 - CtxMemMgr_User5 - INFO - Stored turn 0760f0de-63a0-4f79-8f33-1c786dc2034f for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:19,451 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:19,451 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: sorry
2025-04-25 01:36:19,452 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is sorry.
2025-04-25 01:36:19,457 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:19,459 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:19,459 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:19,460 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~1291 / 30000
2025-04-25 01:36:19,460 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:19,474 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:19,475 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:19,476 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:19,477 - CtxMemMgr_User5 - INFO - Stored turn 5b87630e-863a-4307-8d1e-78c40f57597f for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:19,478 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:19,478 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: sorry
2025-04-25 01:36:19,479 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:19,479 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~1628 / 30000
2025-04-25 01:36:19,479 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:19,482 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:19,482 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:19,482 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:40:00Z",
    "speaker": "User...
2025-04-25 01:36:20,490 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:20,496 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:20,501 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_621bcc0a-63d0-48c1-906a-263913bfd77a', 'timestamp': '2025-04-25T01:36:20.497138', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:20.491864"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:20,505 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:20,506 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:20,507 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:36:20,507 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:20,509 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:20,509 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:20,510 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:20,510 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite food?'
2025-04-25 01:36:20,510 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:20,511 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:20,511 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:20,513 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:20,513 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:22,833 - CtxMemMgr_User5 - INFO - Stored turn 31c87ce0-7b30-436c-8ce8-51a21acc8ab0 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:22,834 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:22,835 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:22,836 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~1634 / 30000
2025-04-25 01:36:22,836 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:22,851 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:22,851 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:22,852 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:22,852 - CtxMemMgr_User5 - INFO - Stored turn d107eecb-864d-42fc-b9e8-64c7e0b63f1c for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:22,853 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:22,853 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:22,853 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~1640 / 30000
2025-04-25 01:36:22,854 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:22,859 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:22,860 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:22,860 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:42:00Z",
    "speaker": "User...
2025-04-25 01:36:22,864 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:22,867 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:22,870 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_9981549d-b8bb-4d40-b5a7-0b9aa7404741', 'timestamp': '2025-04-25T01:36:22.867667', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:22.864844"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:22,873 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:22,873 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:22,873 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:22,874 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the oversight.
2025-04-25 01:36:22,874 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:36:22,875 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:22,876 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:36:22,876 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:22,876 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:42:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking about their favorite food.",
      "tier2": "The user wants to know what their favorite food is, requiring access to previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:42:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I don't have that information yet. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:favorite food]",
      "tier2": "To answer your question about your favorite food, I need to access your past messages or any information I've stored about your preferences. I haven't found that information in my current memory. Could you please tell me what your favorite food is?",
      "tier3": "I apologize for the oversight. I'm still under development and learning to effectively access and retain information. To help me improve, please share your favorite food with me. [REQUEST_TIER:3:1] [SEARCH_EPISODIC:favorite food]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'favorite food': favorite food: spicy Thai curry
EPISODIC SEARCH RESULTS for 'favorite food': favorite food: spicy Thai curry'
2025-04-25 01:36:22,876 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:22,876 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:22,877 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:22,877 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:22,877 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:24,861 - CtxMemMgr_User5 - INFO - Stored turn c6cd1375-9e4b-42ba-ab56-c6cbc81abfad for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:24,862 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:24,862 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:24,862 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:36:24,865 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:24,866 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:24,866 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:24,866 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~1967 / 30000
2025-04-25 01:36:24,867 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:24,875 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:24,875 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:24,875 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:24,876 - CtxMemMgr_User5 - INFO - Stored turn 9ce94843-8964-4ee6-81ab-eae3d7f80e91 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:24,876 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:24,876 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:24,877 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:24,877 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~2294 / 30000
2025-04-25 01:36:24,877 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:24,883 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:24,883 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:24,884 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:42:00Z",
    "speaker": "User...
2025-04-25 01:36:25,889 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:25,893 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:25,897 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1008829a-1d2b-4acb-a1f8-115eae140874', 'timestamp': '2025-04-25T01:36:25.893899', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:25.889654"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:25,901 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:25,901 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:25,902 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:36:25,903 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:25,904 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:25,905 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:25,905 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:25,905 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite color?'
2025-04-25 01:36:25,906 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:25,906 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:25,906 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:25,908 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:25,908 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:28,257 - CtxMemMgr_User5 - INFO - Stored turn 3675fb20-b275-46c1-807f-ad17d3649e47 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:28,258 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:28,258 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:28,259 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~2300 / 30000
2025-04-25 01:36:28,259 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:28,269 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:28,269 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:28,269 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:28,270 - CtxMemMgr_User5 - INFO - Stored turn d9d31478-3082-4747-a614-afb2b1dfd32e for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:28,270 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:28,270 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:28,271 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~2306 / 30000
2025-04-25 01:36:28,271 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:28,278 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:28,278 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:28,279 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:43:00Z",
    "speaker": "User...
2025-04-25 01:36:28,282 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:28,303 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:28,307 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a5d7e86a-ae79-4b91-8882-331943a0ccb3', 'timestamp': '2025-04-25T01:36:28.303925', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:28.283414"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:28,309 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:28,309 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:28,310 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:28,310 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the oversight.
2025-04-25 01:36:28,311 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:36:28,311 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:28,312 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:36:28,312 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:28,312 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:43:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking what their favorite color is.",
      "tier2": "The user's request is to retrieve their favorite color from memory.  This requires accessing previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:43:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I don't have that information yet. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:favorite color]",
      "tier2": "To answer your question accurately, I need to access previously stored information about your preferences. I haven't found any information about your favorite color in my current memory. Could you please tell me what your favorite color is?",
      "tier3": "I apologize for the oversight. I'm still under development and learning to effectively access and retain information. To help me improve, please share your favorite color with me.  [REQUEST_TIER:3:1] [SEARCH_EPISODIC:favorite color]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'favorite color': favorite color: cerulean blue
EPISODIC SEARCH RESULTS for 'favorite color': favorite color: cerulean blue'
2025-04-25 01:36:28,312 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:28,312 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:28,312 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:28,313 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:28,313 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:30,411 - CtxMemMgr_User5 - INFO - Stored turn 687e617a-ca19-4696-b741-d8881ff91451 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:30,412 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:30,413 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:30,414 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:36:30,421 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:30,423 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:30,424 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:30,424 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~2638 / 30000
2025-04-25 01:36:30,425 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:30,439 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:30,439 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:30,440 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:30,440 - CtxMemMgr_User5 - INFO - Stored turn efb2ad6c-5f24-4922-93c7-636d38f68783 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:30,440 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:30,440 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:30,440 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:30,440 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~2970 / 30000
2025-04-25 01:36:30,440 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:30,443 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:30,443 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:30,443 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:43:00Z",
    "speaker": "User...
2025-04-25 01:36:31,455 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:31,463 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:31,475 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4f3056bd-ce19-4c85-bca1-89e0bbe1c4b4', 'timestamp': '2025-04-25T01:36:31.464435', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:31.456812"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:31,481 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:31,481 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:31,484 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the hobby.
2025-04-25 01:36:31,484 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:31,485 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:31,486 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:31,486 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:31,486 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my hobby?'
2025-04-25 01:36:31,486 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:31,486 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:31,486 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:31,487 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:31,487 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:33,798 - CtxMemMgr_User5 - INFO - Stored turn 327f8de6-b95a-4122-8432-b79c772b210f for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:33,799 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:33,799 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:33,800 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~2974 / 30000
2025-04-25 01:36:33,800 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:33,808 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:33,808 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:33,809 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:33,809 - CtxMemMgr_User5 - INFO - Stored turn 0ec2c305-5dce-4b3d-8206-7dbde61b831b for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:33,809 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:33,810 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:33,810 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~2978 / 30000
2025-04-25 01:36:33,810 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:33,816 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:33,816 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:33,817 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:36:33,821 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:33,827 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:33,830 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_633aaba2-ad08-4676-bc72-b68cb2f32c21', 'timestamp': '2025-04-25T01:36:33.828217', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:33.822740"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:33,832 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:33,832 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:33,832 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:33,833 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the oversight.
2025-04-25 01:36:33,833 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:36:33,833 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:33,834 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:36:33,834 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:33,834 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking about their hobby.",
      "tier2": "The user wants to know what their hobby is, requiring access to previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:44:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I don't have that information yet. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:hobby]",
      "tier2": "To answer your question about your hobby, I need to access previously stored information. I haven't found any information about your hobby in my current memory.  Could you please tell me what your hobby is?",
      "tier3": "I apologize for the oversight.  I'm still under development and learning to effectively access and retain information. To help me improve, please share your hobby with me. [REQUEST_TIER:3:1] [SEARCH_EPISODIC:hobby]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'hobby': hobby: collecting vintage postcards
EPISODIC SEARCH RESULTS for 'hobby': hobby: collecting vintage postcards'
2025-04-25 01:36:33,834 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:33,834 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:33,834 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:33,835 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:33,835 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:35,826 - CtxMemMgr_User5 - INFO - Stored turn 4454304e-ee1f-43c8-a128-77cd23eeb779 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:35,827 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:35,828 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:35,828 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:36:35,833 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:35,835 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:35,836 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:35,837 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~3283 / 30000
2025-04-25 01:36:35,837 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:35,845 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:35,845 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:35,846 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:35,846 - CtxMemMgr_User5 - INFO - Stored turn 2f2e5e5b-23a4-4531-97fd-db7721e21978 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:35,846 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:35,847 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:35,848 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:35,848 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~3588 / 30000
2025-04-25 01:36:35,848 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:35,851 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:35,851 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:35,852 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:36:36,865 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:36,873 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:36,882 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1d28e8e1-1d4c-4225-ae80-437982623b71', 'timestamp': '2025-04-25T01:36:36.874765', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:36.866501"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:36,891 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:36,891 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:36,893 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the college.
2025-04-25 01:36:36,894 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:36,895 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:36,896 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:36,896 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:36,896 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my college major?'
2025-04-25 01:36:36,896 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:36,896 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:36,896 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:36,897 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:36,897 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:39,325 - CtxMemMgr_User5 - INFO - Stored turn 16855f87-3899-4def-a3b1-231b613ff4cc for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:39,325 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:39,326 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:39,326 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~3594 / 30000
2025-04-25 01:36:39,327 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:39,340 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:39,341 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:39,342 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:39,342 - CtxMemMgr_User5 - INFO - Stored turn dc87e9c8-c14f-4f04-a578-c6867a0a89a7 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:39,343 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:39,343 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:39,343 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~3600 / 30000
2025-04-25 01:36:39,344 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:39,349 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:39,349 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:39,349 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:45:00Z",
    "speaker": "User...
2025-04-25 01:36:39,352 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:39,354 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:39,355 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_940d2587-0cda-4d25-b588-b43205dca0e5', 'timestamp': '2025-04-25T01:36:39.354373', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:39.352719"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:39,357 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:39,357 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:39,358 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:39,358 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologies for the oversight.
2025-04-25 01:36:39,358 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:36:39,359 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:39,359 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:36:39,359 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:39,359 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:45:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking about their college major.",
      "tier2": "The user's question requires retrieving their college major from stored memory.  This necessitates accessing previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:45:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I don't yet have that information. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:college major]",
      "tier2": "To accurately answer, I need to access your past messages or stored information about your college major. I haven't found this information in my current memory. Could you please share your college major with me?",
      "tier3": "My apologies for the oversight. I'm still under development, learning to effectively access and retain information.  To help me improve, please tell me your college major. [REQUEST_TIER:3:1] [SEARCH_EPISODIC:college major]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'college major': college major: environmental science
EPISODIC SEARCH RESULTS for 'college major': college major: environmental science'
2025-04-25 01:36:39,359 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:39,359 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:39,359 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:39,360 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:39,360 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:41,444 - CtxMemMgr_User5 - INFO - Stored turn 93636388-08e1-4482-9f0a-c4dd2979832f for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:41,444 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:41,445 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:41,445 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:36:41,449 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:41,451 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:41,451 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:41,452 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~3928 / 30000
2025-04-25 01:36:41,452 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:41,465 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:41,465 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:41,466 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:41,466 - CtxMemMgr_User5 - INFO - Stored turn 3672d5ba-fd75-4263-9c4c-c4c439de36dc for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:41,466 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:41,467 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:41,467 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:41,468 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~4256 / 30000
2025-04-25 01:36:41,468 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:41,474 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:41,474 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:41,474 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:45:00Z",
    "speaker": "User...
2025-04-25 01:36:42,483 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:42,496 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:42,507 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_71dfe4fb-fc6e-4dd1-ada1-77866894e50e', 'timestamp': '2025-04-25T01:36:42.497325', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:42.487277"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:42,515 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:42,515 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:42,516 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the dream.
2025-04-25 01:36:42,516 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:42,518 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:42,518 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:42,518 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:42,519 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my dream job?'
2025-04-25 01:36:42,519 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:42,519 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:42,519 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:42,520 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:42,520 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:45,020 - CtxMemMgr_User5 - INFO - Stored turn bd629fd3-b5f8-416b-9d14-2d762faad07a for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:45,020 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:45,021 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:45,021 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~4261 / 30000
2025-04-25 01:36:45,021 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:45,029 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:45,029 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:45,029 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:45,029 - CtxMemMgr_User5 - INFO - Stored turn a0a2bc36-88b5-4a52-94af-1262593c6001 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:45,030 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:45,030 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:45,030 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~4266 / 30000
2025-04-25 01:36:45,030 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:45,038 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:45,038 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:45,039 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:36:45,043 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:45,049 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:45,053 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2d1c3a2d-7041-4108-b20f-10abce6df8b6', 'timestamp': '2025-04-25T01:36:45.049442', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:45.044049"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:45,056 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:45,056 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:45,057 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:45,057 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the oversight.
2025-04-25 01:36:45,058 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:36:45,059 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:45,060 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:36:45,060 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:45,060 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is inquiring about their dream job.",
      "tier2": "The user's question seeks to retrieve their previously stated dream job from memory. This requires accessing previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:46:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I don't have that information yet. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:dream job]",
      "tier2": "To answer your question about your dream job, I need to access previously stored information. I haven't found any information about your dream job in my current memory. Could you please tell me what your dream job is?",
      "tier3": "I apologize for the oversight. I'm still under development and learning to effectively access and retain information. To help me improve, please share your dream job with me. [REQUEST_TIER:3:1] [SEARCH_EPISODIC:dream job]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'dream job': dream job: wildlife photographer in national parks
EPISODIC SEARCH RESULTS for 'dream job': dream job: wildlife photographer in national parks'
2025-04-25 01:36:45,060 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:45,061 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:45,061 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:45,062 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:45,062 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:47,478 - CtxMemMgr_User5 - INFO - Stored turn f003115d-0caa-48b6-b006-755dedcb03d3 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:47,479 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:47,479 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:47,480 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:36:47,484 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:47,485 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:47,486 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:47,486 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~4599 / 30000
2025-04-25 01:36:47,487 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:47,508 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:47,508 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:47,508 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:47,508 - CtxMemMgr_User5 - INFO - Stored turn 712bbb6d-fbc3-48f4-8b4b-1acdeb4df940 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:47,508 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:47,509 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:47,509 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:47,509 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~4932 / 30000
2025-04-25 01:36:47,509 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:47,513 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:47,513 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:47,514 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:36:48,522 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:48,530 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:48,536 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_00e922c3-8a84-4c0f-910f-32d8b640a619', 'timestamp': '2025-04-25T01:36:48.531849', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:48.523382"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:48,541 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:48,542 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:48,543 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the birthday.
2025-04-25 01:36:48,543 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:48,544 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:48,545 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:48,546 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:48,546 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my birthday?'
2025-04-25 01:36:48,546 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:48,546 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:48,546 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:48,548 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:48,548 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:50,973 - CtxMemMgr_User5 - INFO - Stored turn bff66cb0-3e5d-4739-bea3-860553e24b52 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:50,974 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:50,975 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:50,975 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~4937 / 30000
2025-04-25 01:36:50,976 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:50,995 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:50,995 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:50,996 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:50,997 - CtxMemMgr_User5 - INFO - Stored turn 6ad0bb45-547e-42ca-bb71-762d7220c906 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:50,997 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:50,997 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:50,998 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~4942 / 30000
2025-04-25 01:36:50,998 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:51,007 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:51,007 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:51,007 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:36:51,012 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:51,014 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:51,017 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6e5e42e0-3fde-42fc-b9a9-80f45bb20a91', 'timestamp': '2025-04-25T01:36:51.015016', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:51.012846"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:51,019 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:51,019 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:51,020 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:51,020 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:51,021 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:51,021 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:51,021 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:51,021 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking for their birthday.",
      "tier2": "The user's question requires retrieving their birthday from previously stored memory. This necessitates accessing previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:47:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I need to access your previous messages to find your birthday. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:birthday]",
      "tier2": "To answer your question, I need to access previously stored information about your birthday.  I don't currently have that information in my memory. Could you please provide your birthday so I can add it to my records?",
      "tier3": "I apologize for not having access to that information yet. I'm still learning to effectively manage and retrieve stored data. Please share your birthday so I can learn and improve. [REQUEST_TIER:3:1] [SEARCH_EPISODIC:birthday]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'birthday': birthday: March 15
EPISODIC SEARCH RESULTS for 'birthday': birthday: March 15'
2025-04-25 01:36:51,021 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:51,021 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:51,021 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:51,022 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:51,022 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:53,082 - CtxMemMgr_User5 - INFO - Stored turn 15fdf078-5309-4c25-949a-b616deb478b6 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:53,083 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:53,085 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:53,085 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:36:53,091 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:53,093 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:53,094 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:53,095 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~5266 / 30000
2025-04-25 01:36:53,095 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:53,103 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:53,103 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:53,103 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:53,103 - CtxMemMgr_User5 - INFO - Stored turn e2aeabea-4823-47b3-8984-2320c468eeae for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:53,103 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:53,103 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:53,104 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:53,104 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~5590 / 30000
2025-04-25 01:36:53,104 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:53,106 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:53,106 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:53,106 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:36:54,117 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:54,126 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:54,132 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4e6d8fe0-ecec-4eb0-a04e-5c64c4f69b06', 'timestamp': '2025-04-25T01:36:54.126719', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:54.118384"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:54,136 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:54,136 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:54,137 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 01:36:54,137 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:54,139 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:54,140 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:54,140 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:54,141 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my favorite movie?'
2025-04-25 01:36:54,141 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:54,141 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:54,141 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:54,144 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:54,144 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:56,412 - CtxMemMgr_User5 - INFO - Stored turn 597a08aa-2394-4bc2-8ef6-69d8b5ece15f for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:56,413 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:56,413 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:56,413 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~5596 / 30000
2025-04-25 01:36:56,414 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:56,430 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:56,430 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:56,430 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:56,431 - CtxMemMgr_User5 - INFO - Stored turn 8aeb58ea-5fa6-42ad-98fd-6b0f03e0c28f for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:56,431 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:56,431 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:56,432 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~5602 / 30000
2025-04-25 01:36:56,432 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:56,460 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:56,461 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:56,462 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:36:56,474 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:56,477 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:56,480 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ce006425-b080-4868-902a-2a1304cd5ceb', 'timestamp': '2025-04-25T01:36:56.477709', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:56.475176"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:56,482 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:56,482 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:56,482 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:36:56,482 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the oversight.
2025-04-25 01:36:56,483 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:36:56,483 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:56,484 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:36:56,484 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:56,484 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking what their favorite movie is.",
      "tier2": "The user wants to know their favorite movie, requiring a memory search of previously stored information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:48:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I need to check my memory. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:favorite movie]",
      "tier2": "To answer your question accurately, I need to access my stored memory of our past conversations. I don't currently have that information readily available.  Could you please remind me what your favorite movie is?",
      "tier3": "I apologize for the oversight; I am still under development and learning to effectively retrieve information. To help me improve, please tell me your favorite movie. [REQUEST_TIER:3:1] [SEARCH_EPISODIC:favorite movie]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'favorite movie': favorite movie: The Shawshank Redemption
EPISODIC SEARCH RESULTS for 'favorite movie': favorite movie: The Shawshank Redemption'
2025-04-25 01:36:56,484 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:56,484 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:56,484 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:56,485 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:56,485 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:36:58,582 - CtxMemMgr_User5 - INFO - Stored turn 9813c9b8-16d2-4c7b-b160-f8701e7e460c for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:58,583 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:58,584 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:58,586 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:36:58,591 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:58,593 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:36:58,594 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:58,594 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~5920 / 30000
2025-04-25 01:36:58,595 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:58,608 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:58,608 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:36:58,608 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:36:58,609 - CtxMemMgr_User5 - INFO - Stored turn de5dd3b0-36b5-44aa-a4b9-4769df045d10 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:58,609 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:36:58,609 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:36:58,609 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:36:58,609 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~6238 / 30000
2025-04-25 01:36:58,609 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:36:58,612 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:36:58,612 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:36:58,612 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:36:59,623 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:59,635 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:36:59,642 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7b6b8acb-ae43-485c-b94e-0d22ab388901', 'timestamp': '2025-04-25T01:36:59.636582', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:36:59.624540"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:36:59,648 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:59,648 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:36:59,650 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses What for the pet.
2025-04-25 01:36:59,650 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:36:59,653 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:36:59,655 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:36:59,655 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:36:59,656 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What is my pet?'
2025-04-25 01:36:59,656 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:36:59,656 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:36:59,657 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:36:59,659 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:36:59,659 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:37:02,247 - CtxMemMgr_User5 - INFO - Stored turn 7c0b9601-f08c-4e4f-b3ed-0a28ec94f776 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:02,248 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:37:02,248 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:37:02,253 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~6241 / 30000
2025-04-25 01:37:02,254 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:37:02,275 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:02,275 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:37:02,275 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:37:02,275 - CtxMemMgr_User5 - INFO - Stored turn 6229e83f-cf80-47ae-8a10-740537fab44d for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:02,276 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:37:02,276 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:37:02,276 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~6244 / 30000
2025-04-25 01:37:02,276 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:37:02,281 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:02,282 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:37:02,282 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:49:00Z",
    "speaker": "User...
2025-04-25 01:37:02,285 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:37:02,289 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:37:02,292 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ece44f9a-ed0a-406f-9c9d-e48a328d0d8a', 'timestamp': '2025-04-25T01:37:02.289616', 'session_id': '76ad8966-94da-4663-ae8e-881247c86c81', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:37:02.286274"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:37:02,294 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:37:02,295 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:37:02,295 - ConvMgr_User5 - INFO - Pattern match extracted: User's name is still.
2025-04-25 01:37:02,296 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses apologize for the oversight.
2025-04-25 01:37:02,296 - ConvMgr_User5 - INFO - Added 2 new facts to contextual memory
2025-04-25 01:37:02,297 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:37:02,298 - ConvMgr_User5 - INFO - Saved 2 new facts to database
2025-04-25 01:37:02,298 - components.prompt_builder - INFO - Constructing prompt for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5, depth 0
2025-04-25 01:37:02,298 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: '```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:49:00Z",
    "speaker": "User",
    "prompt_tiers": {
      "tier1": "The user is asking about their pet.",
      "tier2": "The user's question requires retrieving information about their pet from previously stored memory.  This necessitates accessing previously stored user information."
    }
  },
  "llm_response": {
    "timestamp": "2025-04-25T01:49:05Z",
    "speaker": "LLM",
    "response_tiers": {
      "tier1": "I need to check my memory for that. [REQUEST_TIER:2:1] [SEARCH_EPISODIC:pet]",
      "tier2": "To answer your question accurately, I need to access my stored memory of our past conversations. I don't currently have that information readily available. Could you please tell me what kind of pet you have?",
      "tier3": "I apologize for the oversight; I am still under development and learning to effectively retrieve information. To help me improve, please tell me what kind of pet you have, and its name if you'd like. [REQUEST_TIER:3:1] [SEARCH_EPISODIC:pet]"
    }
  }
}
```

TIER UPGRADE RESULT: Message ID 1 not found.
TIER UPGRADE RESULT: Message ID 1 not found.
EPISODIC SEARCH RESULTS for 'pet': pet: a golden retriever named Max
EPISODIC SEARCH RESULTS for 'pet': pet: a golden retriever named Max'
2025-04-25 01:37:02,298 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:37:02,298 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:37:02,299 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:37:02,300 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:37:02,300 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:37:04,368 - CtxMemMgr_User5 - INFO - Stored turn 61f70a8d-f09f-47d8-bf59-279343036a7a for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:04,369 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:37:04,369 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:37:04,369 - CtxMemMgr_User5 - INFO - Added name fact to user memory: User's name is still.
2025-04-25 01:37:04,370 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:37:04,371 - CtxMemMgr_User5 - INFO - Successfully saved 1 new facts to database.
2025-04-25 01:37:04,371 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:37:04,371 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~6569 / 30000
2025-04-25 01:37:04,371 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:37:04,378 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:04,378 - ActionHandler_User5 - INFO - Processing LLM response for session 76ad8966-94da-4663-ae8e-881247c86c81, user 5
2025-04-25 01:37:04,378 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 76ad8966-94da-4663-ae8e-881247c86c81).
2025-04-25 01:37:04,378 - CtxMemMgr_User5 - INFO - Stored turn a27cdfea-e2ed-46c3-acb7-6b6d627c4a34 for active session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:04,378 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 76ad8966-94da-4663-ae8e-881247c86c81: '...'
2025-04-25 01:37:04,378 - CtxMemMgr_User5 - INFO - Rule-based extraction found name: still
2025-04-25 01:37:04,378 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:37:04,379 - CtxMemMgr_User5 - INFO - Session 76ad8966-94da-4663-ae8e-881247c86c81: Active history token count ~6894 / 30000
2025-04-25 01:37:04,379 - CtxMemMgr_User5 - INFO - Saving active session context for 76ad8966-94da-4663-ae8e-881247c86c81 to /app/data/sessions/5/76ad8966-94da-4663-ae8e-881247c86c81/context.json
2025-04-25 01:37:04,382 - CtxMemMgr_User5 - INFO - Successfully saved context for session 76ad8966-94da-4663-ae8e-881247c86c81
2025-04-25 01:37:04,382 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:37:04,382 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:49:00Z",
    "speaker": "User...
2025-04-25 01:42:07,694 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:07,695 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:07,696 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:42:07,696 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:42:07,696 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:42:07,699 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:07,700 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:42:07,701 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:42:07,701 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:42:07,701 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:42:07,701 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:42:07,701 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:42:07,702 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:42:07,702 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:42:07,702 - ConvMgr_User5 - INFO - Loading session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:07,703 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:42:07,703 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:42:07,705 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:42:07,711 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:07,718 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_375bc052-2a5d-4dd2-a5ac-ae1d7d8445a9', 'timestamp': '2025-04-25T01:42:07.712120', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:07.706325"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:07,721 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:07,721 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:07,722 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 01:42:07,722 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:42:07,724 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:42:07,724 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:42:07,725 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:07,725 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:42:07,725 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 01:42:07,725 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:07,726 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:07,726 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:07,726 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:42:07,727 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:07,728 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:09,866 - CtxMemMgr_User5 - INFO - Loading session 388e0830-f4d8-482b-967b-9357424eb759 for processing assistant message
2025-04-25 01:42:09,867 - CtxMemMgr_User5 - INFO - Loading session context for 388e0830-f4d8-482b-967b-9357424eb759 from /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:09,868 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json not found. Initializing empty context for new session 388e0830-f4d8-482b-967b-9357424eb759.
2025-04-25 01:42:09,869 - CtxMemMgr_User5 - INFO - Stored turn 6aef1138-7b12-42c0-b150-b9d69f61347e for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:09,869 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:09,870 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:09,870 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~15 / 30000
2025-04-25 01:42:09,870 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:09,873 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:09,874 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:09,874 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:09,875 - CtxMemMgr_User5 - INFO - Stored turn bf464f0f-eba5-4063-b287-63677df1d9fb for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:09,875 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:09,875 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:09,876 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~30 / 30000
2025-04-25 01:42:09,876 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:09,879 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:09,879 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:09,880 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:10,897 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:10,906 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:10,916 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a4956e06-0178-4135-80a1-f3f514a2ae97', 'timestamp': '2025-04-25T01:42:10.907531', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:10.899578"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:10,923 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:10,925 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:10,926 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:10,926 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 01:42:10,926 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:10,927 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:10,927 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:10,928 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:10,929 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:13,004 - CtxMemMgr_User5 - INFO - Stored turn c124da22-12fc-49bd-8920-1746bd4df00e for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:13,004 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:13,005 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:13,005 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~49 / 30000
2025-04-25 01:42:13,006 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:13,009 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:13,009 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:13,010 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:13,010 - CtxMemMgr_User5 - INFO - Stored turn 936054f2-15d2-4bf8-86c9-ae6eab2d87ec for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:13,010 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:13,010 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:13,011 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~68 / 30000
2025-04-25 01:42:13,011 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:13,013 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:13,013 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:13,014 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:14,022 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:14,030 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:14,038 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_80c2452f-bcbb-4acc-8580-179b26b89dc7', 'timestamp': '2025-04-25T01:42:14.032027', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:14.023513"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:14,043 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:14,044 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:14,045 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:14,045 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 01:42:14,046 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:14,046 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:14,046 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:14,048 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:14,049 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:16,515 - CtxMemMgr_User5 - INFO - Stored turn 0443709b-da1f-41f4-b125-c48da2ba1678 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:16,516 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:16,520 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:16,520 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~87 / 30000
2025-04-25 01:42:16,521 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:16,525 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:16,525 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:16,526 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:16,527 - CtxMemMgr_User5 - INFO - Stored turn c34c4297-53fb-47e5-9858-c76db45ac981 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:16,527 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:16,528 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:16,528 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~106 / 30000
2025-04-25 01:42:16,529 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:16,533 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:16,535 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:16,536 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:17,545 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:17,553 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:17,557 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fbf0abed-afb0-4c9b-9b4d-d3405ea249e2', 'timestamp': '2025-04-25T01:42:17.554178', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:17.546129"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:17,562 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:17,562 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:17,564 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 01:42:17,564 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:42:17,566 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:42:17,567 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:42:17,567 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:17,568 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 01:42:17,568 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:17,568 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:17,568 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:17,570 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:17,570 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:20,078 - CtxMemMgr_User5 - INFO - Stored turn 4bc995ef-eebc-46e9-bf79-94560c961c1c for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:20,118 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:20,119 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:20,119 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~122 / 30000
2025-04-25 01:42:20,119 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:20,122 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:20,123 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:20,123 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:20,124 - CtxMemMgr_User5 - INFO - Stored turn 4c0e7029-994e-4393-ac01-4816682f9b8c for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:20,124 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:20,125 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:20,125 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~138 / 30000
2025-04-25 01:42:20,125 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:20,136 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:20,137 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:20,137 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:21,154 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:21,163 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:21,170 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_50a0fa52-c3b7-42f9-bcda-9ce0b0735648', 'timestamp': '2025-04-25T01:42:21.163717', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:21.156542"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:21,176 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:21,177 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:21,179 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:21,179 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 01:42:21,180 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:21,180 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:21,181 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:21,184 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:21,184 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:23,479 - CtxMemMgr_User5 - INFO - Stored turn c2bfbd7f-0f1f-4454-8582-a222268c1faa for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:23,480 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:23,480 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:23,481 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~158 / 30000
2025-04-25 01:42:23,481 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:23,485 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:23,486 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:23,486 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:23,486 - CtxMemMgr_User5 - INFO - Stored turn fcdbdb14-c420-4dd3-b27f-0980332f011a for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:23,486 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:23,486 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:23,486 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~178 / 30000
2025-04-25 01:42:23,486 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:23,487 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:23,487 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:23,487 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:24,499 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:24,506 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:24,514 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1148b2c5-dab1-47fa-910c-d3bcebb29194', 'timestamp': '2025-04-25T01:42:24.507131', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:24.500361"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:24,520 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:24,520 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:24,522 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:24,522 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 01:42:24,523 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:24,523 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:24,524 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:24,525 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:24,525 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:26,838 - CtxMemMgr_User5 - INFO - Stored turn 71d25d00-0f2f-40cb-b64d-595f61f8a669 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:26,839 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:26,839 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:26,839 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~197 / 30000
2025-04-25 01:42:26,840 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:26,844 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:26,844 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:26,845 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:26,845 - CtxMemMgr_User5 - INFO - Stored turn e3cabcfd-58c0-4112-bf75-3a91f2e9b959 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:26,846 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:26,846 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:26,847 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~216 / 30000
2025-04-25 01:42:26,847 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:26,850 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:26,850 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:26,851 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:27,856 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:27,866 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:27,877 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a24bcc46-2c81-482e-908d-00ec5a33314f', 'timestamp': '2025-04-25T01:42:27.867513', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:27.857964"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:27,883 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:27,884 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:27,887 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:27,888 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 01:42:27,888 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:27,888 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:27,888 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:27,889 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:27,889 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:30,036 - CtxMemMgr_User5 - INFO - Stored turn 758c7974-cad5-4752-8119-fddab1b7a136 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:30,036 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:30,036 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:30,036 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~235 / 30000
2025-04-25 01:42:30,037 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:30,039 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:30,039 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:30,040 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:30,040 - CtxMemMgr_User5 - INFO - Stored turn d2cde2b8-035c-434a-80d9-ff2c55984838 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:30,040 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:30,040 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:30,041 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~254 / 30000
2025-04-25 01:42:30,041 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:30,043 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:30,044 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:30,044 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:43:00Z",
    "speaker": "User...
2025-04-25 01:42:31,059 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:31,071 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:31,077 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6b4b73d5-3330-470c-bfb6-fbec1df8c40a', 'timestamp': '2025-04-25T01:42:31.071839', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:31.064248"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:31,082 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:31,083 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:31,084 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:31,084 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 01:42:31,085 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:31,085 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:31,085 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:31,088 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:31,088 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:33,343 - CtxMemMgr_User5 - INFO - Stored turn 69029b46-5afa-4fda-9ba7-2c807eac4bf5 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:33,344 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:33,344 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:33,345 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~271 / 30000
2025-04-25 01:42:33,345 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:33,349 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:33,349 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:33,349 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:33,349 - CtxMemMgr_User5 - INFO - Stored turn 44b25039-e4d8-4188-a261-4cf4aa9a7f95 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:33,350 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:33,350 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:33,350 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~288 / 30000
2025-04-25 01:42:33,350 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:33,353 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:33,353 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:33,353 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:43:00Z",
    "speaker": "User...
2025-04-25 01:42:34,363 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:34,372 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:34,380 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_be3e1695-79b8-4e35-8158-6a7d0ae14a81', 'timestamp': '2025-04-25T01:42:34.372852', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:34.364695"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:34,383 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:34,383 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:34,383 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:34,383 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 01:42:34,384 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:34,384 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:34,384 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:34,385 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:34,385 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:36,426 - CtxMemMgr_User5 - INFO - Stored turn a097a2de-dbf2-4195-8e1a-5950c7b9ced4 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:36,427 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:36,427 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:36,428 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~302 / 30000
2025-04-25 01:42:36,428 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:36,434 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:36,434 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:36,434 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:36,435 - CtxMemMgr_User5 - INFO - Stored turn 35a1f478-8049-4d47-a787-2adaa683f091 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:36,435 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:36,435 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:36,435 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~316 / 30000
2025-04-25 01:42:36,435 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:36,438 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:36,438 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:36,439 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:37,450 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:37,459 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:37,466 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_37c2cd37-6259-45f4-a10e-34d5a5e42f69', 'timestamp': '2025-04-25T01:42:37.459764', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:37.451293"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:37,470 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:37,470 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:37,471 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:37,471 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 01:42:37,471 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:37,472 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:37,472 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:37,473 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:37,474 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:39,660 - CtxMemMgr_User5 - INFO - Stored turn cd474654-3e4a-4912-b70a-e9d07885ed49 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:39,661 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:39,662 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:39,662 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~336 / 30000
2025-04-25 01:42:39,663 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:39,668 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:39,668 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:39,669 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:39,669 - CtxMemMgr_User5 - INFO - Stored turn fe47fcb5-1342-459c-9256-d304d59615ae for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:39,669 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:39,670 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:39,670 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~356 / 30000
2025-04-25 01:42:39,670 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:39,674 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:39,674 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:39,676 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:42:40,687 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:40,697 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:40,702 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2f955d81-6964-433e-9cab-1fe5472351c2', 'timestamp': '2025-04-25T01:42:40.697564', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:40.688753"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:40,705 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:40,705 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:40,706 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:40,706 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 01:42:40,707 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:40,707 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:40,707 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:40,710 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:40,710 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:44,572 - CtxMemMgr_User5 - INFO - Stored turn 01a9979b-f644-4b28-9660-1216a1153c4c for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:44,573 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:44,573 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:44,574 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~365 / 30000
2025-04-25 01:42:44,574 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:44,580 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:44,580 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:44,581 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:44,581 - CtxMemMgr_User5 - INFO - Stored turn 4e08871d-6759-410d-8c48-d90967f27235 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:44,581 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:44,581 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:44,582 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~374 / 30000
2025-04-25 01:42:44,582 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:44,586 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:44,586 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:44,586 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:45:00Z",
    "speaker": "User...
2025-04-25 01:42:45,593 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:45,600 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:45,605 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a1fccac4-93b0-4803-aa55-5a8e02966893', 'timestamp': '2025-04-25T01:42:45.601304', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:45.594860"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:45,610 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:45,611 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:45,611 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:45,612 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 01:42:45,612 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:45,612 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:45,612 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:45,614 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:45,615 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:49,425 - CtxMemMgr_User5 - INFO - Stored turn b5b53b9e-7367-486a-8cd0-9bf2ab32dc0b for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:49,426 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:49,426 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:49,427 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~388 / 30000
2025-04-25 01:42:49,427 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:49,432 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:49,432 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:49,433 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:49,433 - CtxMemMgr_User5 - INFO - Stored turn 14e53ea8-2cb5-488b-8408-4b7994cdf6b1 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:49,433 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:49,433 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:49,434 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~402 / 30000
2025-04-25 01:42:49,434 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:49,436 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:49,437 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:49,437 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:42:50,447 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:50,454 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:50,460 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fb2f176a-acfa-4556-bfe3-d9e6d055cddc', 'timestamp': '2025-04-25T01:42:50.455655', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:50.448712"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:50,466 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:50,467 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:50,468 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:50,468 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 01:42:50,468 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:50,468 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:50,469 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:50,470 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:50,470 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:54,137 - CtxMemMgr_User5 - INFO - Stored turn b9d1a4ec-9267-4d6d-9176-05d48423350a for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:54,137 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:54,138 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:54,138 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~409 / 30000
2025-04-25 01:42:54,138 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:54,141 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:54,141 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:54,142 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:54,142 - CtxMemMgr_User5 - INFO - Stored turn 4ef3642f-5dc3-4a8a-ada2-ab396379e8ce for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:54,142 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:54,143 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:54,143 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~416 / 30000
2025-04-25 01:42:54,143 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:54,145 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:54,146 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:54,146 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:45:00Z",
    "speaker": "User...
2025-04-25 01:42:55,154 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:55,159 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:55,163 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ee772a1c-71e4-40cb-95aa-8506105f5ced', 'timestamp': '2025-04-25T01:42:55.159499', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:55.154957"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:55,167 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:55,168 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:55,169 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:55,169 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's your opinion on modern art?'
2025-04-25 01:42:55,169 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:55,169 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:55,169 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:55,171 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:55,171 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:42:58,065 - CtxMemMgr_User5 - INFO - Stored turn 5a7f09a0-6eb5-4482-a6b9-d09d0a715e87 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:58,065 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:58,065 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:58,066 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~424 / 30000
2025-04-25 01:42:58,066 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:58,072 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:58,072 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:42:58,073 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:42:58,073 - CtxMemMgr_User5 - INFO - Stored turn 6663cc54-533f-4441-a14f-99024b3567c4 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:58,073 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:42:58,073 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:42:58,074 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~432 / 30000
2025-04-25 01:42:58,074 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:42:58,078 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:42:58,078 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:42:58,079 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:42:59,087 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:59,093 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:42:59,098 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ce079b8b-f50b-461a-9667-5d47be57aab6', 'timestamp': '2025-04-25T01:42:59.093971', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:42:59.087951"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:42:59,102 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:59,102 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:42:59,104 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:42:59,104 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the cultural significance of tea ceremonies.'
2025-04-25 01:42:59,104 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:42:59,104 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:42:59,105 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:42:59,107 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:42:59,107 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:02,696 - CtxMemMgr_User5 - INFO - Stored turn 2fd19432-7552-4fcf-a6ba-3890e0f028f2 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:02,697 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:02,697 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:02,697 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~446 / 30000
2025-04-25 01:43:02,698 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:02,703 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:02,703 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:02,704 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:02,704 - CtxMemMgr_User5 - INFO - Stored turn b8cf7cb8-7983-450f-be10-e45d6327de0d for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:02,705 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:02,705 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:02,705 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~460 / 30000
2025-04-25 01:43:02,705 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:02,709 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:02,709 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:02,710 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:45:00Z",
    "speaker": "User...
2025-04-25 01:43:03,717 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:03,723 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:03,728 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c65b777d-3c4e-4144-aea4-12f40f4db600', 'timestamp': '2025-04-25T01:43:03.723730', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:03.718689"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:03,733 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:03,733 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:03,734 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:03,735 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do airplanes generate lift?'
2025-04-25 01:43:03,735 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:03,736 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:03,736 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:03,738 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:03,739 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:07,015 - CtxMemMgr_User5 - INFO - Stored turn 5483d20b-3c70-451c-8a4e-1c4abdf30c32 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:07,016 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:07,016 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:07,017 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~467 / 30000
2025-04-25 01:43:07,017 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:07,024 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:07,024 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:07,025 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:07,025 - CtxMemMgr_User5 - INFO - Stored turn 317d3d8f-ebe7-463f-aff0-9c5d7fbb77f4 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:07,026 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:07,026 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:07,026 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~474 / 30000
2025-04-25 01:43:07,026 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:07,032 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:07,033 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:07,033 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:43:08,044 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:08,054 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:08,062 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6ff22fc3-1ff5-45c8-8e4b-e6814e9261e6', 'timestamp': '2025-04-25T01:43:08.054915', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:08.046512"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:08,067 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:08,067 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:08,069 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:08,069 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a symphony different from other musical compositions?'
2025-04-25 01:43:08,069 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:08,070 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:08,070 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:08,072 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:08,072 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:12,183 - CtxMemMgr_User5 - INFO - Stored turn 10fb5b5c-5e1d-460c-8405-078227e2b033 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:12,183 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:12,184 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:12,184 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~490 / 30000
2025-04-25 01:43:12,185 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:12,193 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:12,193 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:12,194 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:12,194 - CtxMemMgr_User5 - INFO - Stored turn d6486c11-37b2-465a-b1e5-8e452082dab3 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:12,194 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:12,194 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:12,195 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~506 / 30000
2025-04-25 01:43:12,195 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:12,201 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:12,201 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:12,201 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:43:13,210 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:13,216 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:13,221 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_3d20c043-3eab-4a57-8e0f-f28539eabf96', 'timestamp': '2025-04-25T01:43:13.216956', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:13.211253"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:13,226 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:13,226 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:13,227 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:13,227 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the basics of photography.'
2025-04-25 01:43:13,228 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:13,228 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:13,228 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:13,229 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:13,230 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:18,045 - CtxMemMgr_User5 - INFO - Stored turn ebebe87c-fce6-4631-a4dc-4d468e0e1e87 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:18,045 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:18,046 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:18,046 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~514 / 30000
2025-04-25 01:43:18,046 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:18,053 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:18,054 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:18,054 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:18,054 - CtxMemMgr_User5 - INFO - Stored turn 261ac7b1-a101-4438-8975-99bdefb69aa8 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:18,055 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:18,055 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:18,055 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~522 / 30000
2025-04-25 01:43:18,056 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:18,062 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:18,062 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:18,062 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:43:19,072 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:19,081 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:19,086 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_75eafba2-da21-4b21-9c5e-40fdf502cc6b', 'timestamp': '2025-04-25T01:43:19.081950', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:19.075556"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:19,089 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:19,090 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:19,091 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:19,091 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about traditional cuisines from South America.'
2025-04-25 01:43:19,091 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:19,092 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:19,092 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:19,093 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:19,093 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:23,655 - CtxMemMgr_User5 - INFO - Stored turn df8c9e3c-de09-4674-93fd-b71ce0a44029 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:23,656 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:23,656 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:23,657 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~535 / 30000
2025-04-25 01:43:23,658 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:23,668 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:23,668 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:23,669 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:23,669 - CtxMemMgr_User5 - INFO - Stored turn 178cfd86-fa4b-4147-9415-b1980c436a9d for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:23,669 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:23,670 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:23,670 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~548 / 30000
2025-04-25 01:43:23,670 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:23,676 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:23,676 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:23,676 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:43:24,685 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:24,696 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:24,703 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2178459c-e47a-4e8c-87c0-c292e5bd65fe', 'timestamp': '2025-04-25T01:43:24.697059', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:24.689201"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:24,709 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:24,709 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:24,710 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:24,711 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does cloud computing work?'
2025-04-25 01:43:24,711 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:24,711 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:24,711 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:24,713 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:24,713 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:27,770 - CtxMemMgr_User5 - INFO - Stored turn d07851ab-9ff4-4a4e-a328-0d4b2f0a7d75 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:27,771 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:27,772 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:27,773 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~555 / 30000
2025-04-25 01:43:27,773 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:27,782 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:27,782 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:27,783 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:27,783 - CtxMemMgr_User5 - INFO - Stored turn 11bc06f7-efd8-49bb-bd2a-ea20690b0828 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:27,783 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:27,784 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:27,784 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~562 / 30000
2025-04-25 01:43:27,784 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:27,794 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:27,794 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:27,794 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:43:28,802 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:28,809 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:28,815 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b30635c0-1a83-414a-90e7-aa495703b15e', 'timestamp': '2025-04-25T01:43:28.809854', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:28.803387"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:28,819 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:28,820 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:28,822 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:28,822 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my favorite animal again?'
2025-04-25 01:43:28,823 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:28,823 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:28,824 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:28,825 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:28,826 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:30,850 - CtxMemMgr_User5 - INFO - Stored turn b82a3833-b352-45b7-92ff-917db560d816 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:30,850 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:30,851 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:30,851 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~570 / 30000
2025-04-25 01:43:30,852 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:30,861 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:30,861 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:30,862 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:30,862 - CtxMemMgr_User5 - INFO - Stored turn 67966403-5685-4865-81fc-6d58efcc359a for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:30,862 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:30,862 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:30,863 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~578 / 30000
2025-04-25 01:43:30,863 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:30,868 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:30,868 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:30,869 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:43:31,880 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:31,887 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:31,892 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ddec637c-26fb-462b-a37b-48e93e44115c', 'timestamp': '2025-04-25T01:43:31.888337', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:31.881253"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:31,899 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:31,900 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:31,901 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:31,902 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 01:43:31,903 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:31,903 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:31,903 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:31,905 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:31,905 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:34,129 - CtxMemMgr_User5 - INFO - Stored turn d5bac5ca-d6d6-4fca-bfae-9d88715f15b2 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:34,130 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:34,130 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:34,131 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~589 / 30000
2025-04-25 01:43:34,131 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:34,141 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:34,141 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:34,141 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:34,142 - CtxMemMgr_User5 - INFO - Stored turn 6d9c14c9-0315-4e83-9a32-df5a6eb67f6d for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:34,143 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:34,144 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:34,144 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~600 / 30000
2025-04-25 01:43:34,144 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:34,151 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:34,152 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:34,152 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:43:35,161 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:35,164 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:35,166 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a12dddc5-178a-4fad-ad05-7aeb4209c163', 'timestamp': '2025-04-25T01:43:35.164526', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:35.162077"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:35,167 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:35,167 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:35,168 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:35,168 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 01:43:35,168 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:35,168 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:35,168 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:35,169 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:35,169 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:37,175 - CtxMemMgr_User5 - INFO - Stored turn 0b5cc544-3434-42fe-a130-b6051a2ea599 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:37,175 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:37,176 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:37,177 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~611 / 30000
2025-04-25 01:43:37,177 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:37,189 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:37,189 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:37,190 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:37,190 - CtxMemMgr_User5 - INFO - Stored turn 1d35d8df-2586-458e-9912-b42c56a6d774 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:37,190 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:37,191 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:37,191 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~622 / 30000
2025-04-25 01:43:37,192 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:37,198 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:37,198 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:37,199 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:43:38,204 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:38,209 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:38,213 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_881c111e-0596-4a56-9f73-863c5fcff672', 'timestamp': '2025-04-25T01:43:38.210079', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:38.205397"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:38,218 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:38,218 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:38,220 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:38,220 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 01:43:38,220 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:38,221 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:38,221 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:38,223 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:38,223 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:40,250 - CtxMemMgr_User5 - INFO - Stored turn 07dbe1f5-d21a-442d-8695-069b65fe9c1c for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:40,251 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:40,251 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:40,251 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~629 / 30000
2025-04-25 01:43:40,252 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:40,259 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:40,259 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:40,260 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:40,260 - CtxMemMgr_User5 - INFO - Stored turn 4305c6f7-61cd-4d8d-8227-60f79e05493c for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:40,260 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:40,261 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:40,261 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~636 / 30000
2025-04-25 01:43:40,261 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:40,270 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:40,271 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:40,271 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:43:41,330 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:41,339 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:41,343 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_35267b63-04f7-4c33-9af4-5f5bfbc8b62a', 'timestamp': '2025-04-25T01:43:41.339819', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:41.332352"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:41,346 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:41,347 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:41,347 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:41,348 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 01:43:41,348 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:41,348 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:41,348 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:41,350 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:41,350 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:43,709 - CtxMemMgr_User5 - INFO - Stored turn 46b12f97-f0d1-47c4-9d7b-b2f56f356b6e for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:43,710 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:43,710 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:43,711 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~641 / 30000
2025-04-25 01:43:43,711 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:43,721 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:43,721 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:43,721 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:43,722 - CtxMemMgr_User5 - INFO - Stored turn 6683e770-965a-4d08-8217-0c8de02180c8 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:43,722 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:43,722 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:43,723 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~646 / 30000
2025-04-25 01:43:43,723 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:43,730 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:43,730 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:43,731 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:43:44,741 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:44,749 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:44,755 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_df1abf3c-b10c-4eda-8f12-261b275d4e73', 'timestamp': '2025-04-25T01:43:44.750734', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:44.742806"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:44,759 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:44,759 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:44,760 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:44,760 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 01:43:44,761 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:44,761 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:44,761 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:44,762 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:44,763 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:46,938 - CtxMemMgr_User5 - INFO - Stored turn b68f86dc-1ca2-479e-bf81-6d15d5f04c87 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:46,939 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:46,939 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:46,940 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~654 / 30000
2025-04-25 01:43:46,940 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:46,951 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:46,952 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:46,953 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:46,953 - CtxMemMgr_User5 - INFO - Stored turn 9f307dad-265f-4444-9496-1270593e6aad for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:46,953 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:46,953 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:46,954 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~662 / 30000
2025-04-25 01:43:46,955 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:46,965 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:46,965 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:46,965 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:43:47,980 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:47,991 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:48,012 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7a00aee9-57dd-47de-af74-0fc0e340e0e9', 'timestamp': '2025-04-25T01:43:47.995735', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:47.981438"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:48,016 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:48,016 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:48,017 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:48,017 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 01:43:48,017 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:48,017 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:48,017 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:48,018 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:48,018 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:50,557 - CtxMemMgr_User5 - INFO - Stored turn 9c518c2f-7fdd-4b48-af99-fbbf14a073ca for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:50,558 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:50,558 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:50,558 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~670 / 30000
2025-04-25 01:43:50,558 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:50,567 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:50,568 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:50,569 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:50,569 - CtxMemMgr_User5 - INFO - Stored turn c2710fd8-61b6-4ac4-b0b9-a2a4e776948c for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:50,571 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:50,571 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:50,572 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~678 / 30000
2025-04-25 01:43:50,572 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:50,578 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:50,578 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:50,579 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:46:00Z",
    "speaker": "User...
2025-04-25 01:43:51,592 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:51,600 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:51,608 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1af36074-6668-492e-9770-3174d612c272', 'timestamp': '2025-04-25T01:43:51.601048', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:51.594178"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:51,612 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:51,612 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:51,613 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:51,613 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 01:43:51,613 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:51,613 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:51,614 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:51,615 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:51,615 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:53,541 - CtxMemMgr_User5 - INFO - Stored turn 1c139642-cebf-4b1d-9b20-b2a757170203 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:53,542 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:53,542 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:53,542 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~686 / 30000
2025-04-25 01:43:53,543 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:53,547 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:53,547 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:53,547 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:53,547 - CtxMemMgr_User5 - INFO - Stored turn 3e3a1705-20f7-4066-9d29-df043f16f722 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:53,547 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:53,548 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:53,548 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~694 / 30000
2025-04-25 01:43:53,548 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:53,551 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:53,551 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:53,551 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:43:54,559 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:54,564 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:54,567 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_87404b76-cbcc-4182-82df-6ad39b615155', 'timestamp': '2025-04-25T01:43:54.564454', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:54.560063"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:54,570 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:54,571 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:54,571 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:54,572 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 01:43:54,572 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:54,572 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:54,572 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:54,573 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:54,573 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:43:56,713 - CtxMemMgr_User5 - INFO - Stored turn 992811f4-1dd3-4d2f-91cc-f676be01bb62 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:56,714 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:56,716 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:56,717 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~702 / 30000
2025-04-25 01:43:56,717 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:56,731 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:56,731 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:43:56,731 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:43:56,732 - CtxMemMgr_User5 - INFO - Stored turn 9d0ab132-77dd-4907-9b14-68e2673feb18 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:56,732 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:43:56,733 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:43:56,733 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~710 / 30000
2025-04-25 01:43:56,733 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:43:56,743 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:43:56,743 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:43:56,744 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:43:57,753 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:57,760 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:43:57,765 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cb17236e-ac9f-4f58-a747-567aaf8a8d0a', 'timestamp': '2025-04-25T01:43:57.760787', 'session_id': '388e0830-f4d8-482b-967b-9357424eb759', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:43:57.755238"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:43:57,768 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:57,768 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:43:57,769 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 01:43:57,769 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:43:57,771 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:43:57,772 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:43:57,772 - components.prompt_builder - INFO - Constructing prompt for session 388e0830-f4d8-482b-967b-9357424eb759, user 5, depth 0
2025-04-25 01:43:57,772 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 01:43:57,773 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:43:57,773 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:43:57,773 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:43:57,775 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:43:57,775 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:44:00,027 - CtxMemMgr_User5 - INFO - Stored turn da202ca0-34b5-4e01-8929-069f2d3982a8 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:44:00,028 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:44:00,029 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:44:00,029 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~719 / 30000
2025-04-25 01:44:00,029 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:44:00,038 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:44:00,038 - ActionHandler_User5 - INFO - Processing LLM response for session 388e0830-f4d8-482b-967b-9357424eb759, user 5
2025-04-25 01:44:00,038 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 388e0830-f4d8-482b-967b-9357424eb759).
2025-04-25 01:44:00,038 - CtxMemMgr_User5 - INFO - Stored turn d28b182c-0cf5-4c60-a44d-a131f566c917 for active session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:44:00,039 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 388e0830-f4d8-482b-967b-9357424eb759: '...'
2025-04-25 01:44:00,039 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:44:00,039 - CtxMemMgr_User5 - INFO - Session 388e0830-f4d8-482b-967b-9357424eb759: Active history token count ~728 / 30000
2025-04-25 01:44:00,039 - CtxMemMgr_User5 - INFO - Saving active session context for 388e0830-f4d8-482b-967b-9357424eb759 to /app/data/sessions/5/388e0830-f4d8-482b-967b-9357424eb759/context.json
2025-04-25 01:44:00,047 - CtxMemMgr_User5 - INFO - Successfully saved context for session 388e0830-f4d8-482b-967b-9357424eb759
2025-04-25 01:44:00,048 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:44:00,048 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:44:00Z",
    "speaker": "User...
2025-04-25 01:45:56,849 - core.database.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 01:45:56,849 - core.database.connection - INFO - Using MySQL database URL: mysql+pymysql://rai_user:rai_password@mysql:3306/rai_chat
2025-04-25 01:45:56,849 - core.database.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 01:45:56,864 - core.database.connection - INFO - Database connection successful!
2025-04-25 01:45:56,865 - core.database.connection - INFO - Creating database tables if they don't exist...
2025-04-25 01:45:56,867 - core.database.connection - INFO - Database tables created or already exist.
2025-04-25 01:45:56,875 - core.database.connection - INFO - Default user already exists.
2025-04-25 01:45:56,890 - app - INFO - Auth blueprint registered successfully
2025-04-25 01:45:56,903 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 01:45:56,903 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 01:45:56,903 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 01:45:56,903 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 01:45:56,903 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 01:45:56,903 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 01:45:56,903 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 01:45:56,903 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 01:45:56,910 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 01:45:56,910 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 01:45:56,910 - components.action_handler - INFO - Web search functionality is available
2025-04-25 01:45:56,911 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 01:45:56,911 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 01:45:56,911 - app - INFO - Chat blueprint registered successfully
2025-04-25 01:45:56,912 - root - INFO - MySQL connection: rai_user@mysql:3306/rai_chat
2025-04-25 01:45:56,914 - app - INFO - Session blueprint registered successfully
2025-04-25 01:45:56,915 - app - INFO - Memory blueprint registered successfully
2025-04-25 01:45:56,916 - app - INFO - System Messages blueprint registered successfully
2025-04-25 01:45:56,917 - app - INFO - Test Search blueprint registered successfully
2025-04-25 01:45:56,918 - app - INFO - Basic endpoints registered successfully
2025-04-25 01:45:56,921 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 01:46:32,170 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:32,170 - managers.session - INFO - Creating new UserSessionManager instance
2025-04-25 01:46:32,171 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 01:46:32,171 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 01:46:32,172 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:32,173 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:46:32,173 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:46:32,173 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:46:32,173 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:46:32,178 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:32,179 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:46:32,183 - utils.imports - INFO - Added /app/ to Python path
2025-04-25 01:46:32,186 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:46:32,186 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:46:32,186 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:46:32,187 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:46:32,187 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:46:32,188 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:46:32,189 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:46:32,189 - ConvMgr_User5 - INFO - Loading session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:32,189 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:46:32,189 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:46:32,190 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:46:32,197 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:32,203 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_3ee650f6-6bdc-4225-9f0c-71c6328716b3', 'timestamp': '2025-04-25T01:46:32.197631', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:32.190905"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:32,205 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:32,205 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:32,208 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 01:46:32,208 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:46:32,209 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:46:32,210 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:46:32,210 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:32,210 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:46:32,210 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 01:46:32,210 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:32,210 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:32,210 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:32,211 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:46:32,212 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:32,212 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:34,326 - CtxMemMgr_User5 - INFO - Loading session 9b5a907e-fe89-4252-915f-17eac69ee4d5 for processing assistant message
2025-04-25 01:46:34,326 - CtxMemMgr_User5 - INFO - Loading session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 from /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:34,327 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json not found. Initializing empty context for new session 9b5a907e-fe89-4252-915f-17eac69ee4d5.
2025-04-25 01:46:34,327 - CtxMemMgr_User5 - INFO - Stored turn a549504d-6815-4bbd-919f-e78fe89fa6bc for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:34,328 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:34,333 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:34,333 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~15 / 30000
2025-04-25 01:46:34,333 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:34,336 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:34,336 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:34,337 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:34,338 - CtxMemMgr_User5 - INFO - Stored turn 5c99084f-eaac-41d3-ab7f-ca796e35aef5 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:34,338 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:34,338 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:34,339 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~30 / 30000
2025-04-25 01:46:34,339 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:34,340 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:34,341 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:34,341 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:35,352 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:35,362 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:35,369 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c573924c-80b4-4c2e-880e-ad130b9642ca', 'timestamp': '2025-04-25T01:46:35.363048', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:35.353705"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:35,375 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:35,375 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:35,377 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:35,377 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 01:46:35,377 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:35,378 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:35,378 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:35,381 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:35,381 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:37,585 - CtxMemMgr_User5 - INFO - Stored turn 2b5388f0-cb7f-4f17-925d-c4ba8ff053ed for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:37,586 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:37,587 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:37,589 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~49 / 30000
2025-04-25 01:46:37,589 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:37,591 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:37,592 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:37,593 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:37,593 - CtxMemMgr_User5 - INFO - Stored turn c6b2c2ef-2508-43fc-a4b3-2aa876bbdfef for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:37,593 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:37,594 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:37,594 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~68 / 30000
2025-04-25 01:46:37,595 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:37,597 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:37,597 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:37,598 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:38,609 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:38,619 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:38,625 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2eeeb473-8779-45c2-bacc-81b80d5bc801', 'timestamp': '2025-04-25T01:46:38.619888', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:38.610622"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:38,628 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:38,629 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:38,630 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:38,630 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 01:46:38,630 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:38,631 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:38,631 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:38,632 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:38,633 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:40,801 - CtxMemMgr_User5 - INFO - Stored turn 6257911e-0773-48ca-ba77-d838e16596a1 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:40,801 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:40,802 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:40,802 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~87 / 30000
2025-04-25 01:46:40,803 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:40,807 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:40,807 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:40,807 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:40,808 - CtxMemMgr_User5 - INFO - Stored turn 148b3e7d-632f-4f8b-af7f-800ec979e364 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:40,808 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:40,808 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:40,809 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~106 / 30000
2025-04-25 01:46:40,810 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:40,812 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:40,812 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:40,812 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:41,821 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:41,826 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:41,830 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_95676563-d1fd-4c7c-8740-fffaf685804e', 'timestamp': '2025-04-25T01:46:41.827059', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:41.821940"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:41,834 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:41,835 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:41,836 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 01:46:41,837 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:46:41,839 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:46:41,841 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:46:41,841 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:41,842 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 01:46:41,842 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:41,842 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:41,843 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:41,846 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:41,847 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:44,216 - CtxMemMgr_User5 - INFO - Stored turn 2ed62ecb-baac-4098-8d83-7467f71fa324 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:44,217 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:44,217 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:44,218 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~122 / 30000
2025-04-25 01:46:44,218 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:44,222 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:44,222 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:44,223 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:44,223 - CtxMemMgr_User5 - INFO - Stored turn 1471a181-e3be-4c0e-9f69-2f5e3361a839 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:44,223 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:44,224 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:44,224 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~138 / 30000
2025-04-25 01:46:44,224 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:44,226 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:44,227 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:44,227 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:45,239 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:45,248 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:45,256 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0a2738ad-9aae-4559-a3f7-db0f02b3739f', 'timestamp': '2025-04-25T01:46:45.249507', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:45.241754"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:45,262 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:45,263 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:45,264 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:45,264 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 01:46:45,264 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:45,264 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:45,265 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:45,267 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:45,267 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:47,818 - CtxMemMgr_User5 - INFO - Stored turn 353ebc83-f98a-4a21-a77b-08e06b0b583c for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:47,818 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:47,818 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:47,819 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~158 / 30000
2025-04-25 01:46:47,819 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:47,823 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:47,823 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:47,823 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:47,824 - CtxMemMgr_User5 - INFO - Stored turn 7fd4797c-4c75-4f27-97c5-8b901e3869bf for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:47,824 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:47,824 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:47,825 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~178 / 30000
2025-04-25 01:46:47,825 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:47,828 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:47,828 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:47,828 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:48,839 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:48,848 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:48,853 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_085f255a-28e6-4791-8d2d-74ffd932c26a', 'timestamp': '2025-04-25T01:46:48.848744', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:48.842012"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:48,857 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:48,858 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:48,860 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:48,860 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 01:46:48,861 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:48,861 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:48,861 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:48,864 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:48,865 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:51,243 - CtxMemMgr_User5 - INFO - Stored turn 887d6f07-0614-4904-8f2e-575ddb3776e1 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:51,244 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:51,245 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:51,245 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~197 / 30000
2025-04-25 01:46:51,246 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:51,250 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:51,250 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:51,251 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:51,251 - CtxMemMgr_User5 - INFO - Stored turn 3a664776-6fc4-43a0-87b5-118f5cd32700 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:51,251 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:51,252 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:51,253 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~216 / 30000
2025-04-25 01:46:51,253 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:51,256 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:51,257 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:51,257 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:52,273 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:52,279 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:52,286 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4e7f00ab-2fe7-4379-ad68-27cdeb86e87a', 'timestamp': '2025-04-25T01:46:52.280113', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:52.274705"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:52,290 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:52,291 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:52,291 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:52,292 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 01:46:52,292 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:52,292 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:52,292 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:52,294 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:52,294 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:54,847 - CtxMemMgr_User5 - INFO - Stored turn 5faef86a-ebd5-41cf-b715-1fabbc85e8e3 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:54,847 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:54,847 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:54,848 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~235 / 30000
2025-04-25 01:46:54,848 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:54,852 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:54,853 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:54,853 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:54,854 - CtxMemMgr_User5 - INFO - Stored turn b66b634e-809a-4e1e-9d25-dc5d50697274 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:54,854 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:54,854 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:54,855 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~254 / 30000
2025-04-25 01:46:54,855 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:54,858 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:54,859 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:54,859 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:55,867 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:55,878 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:55,883 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c91b0e27-ff97-4f8c-8461-2c51f2e5b986', 'timestamp': '2025-04-25T01:46:55.878723', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:55.868366"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:55,887 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:55,888 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:55,889 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:55,889 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 01:46:55,890 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:55,890 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:55,890 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:55,892 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:55,892 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:46:58,005 - CtxMemMgr_User5 - INFO - Stored turn 1898f65b-e5e2-4941-81a4-136ab9dd7e55 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:58,006 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:58,006 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:58,007 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~271 / 30000
2025-04-25 01:46:58,007 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:58,013 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:58,014 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:46:58,015 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:46:58,015 - CtxMemMgr_User5 - INFO - Stored turn 5472731d-790c-462b-a057-8c44dc211dac for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:58,015 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:46:58,016 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:46:58,016 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~288 / 30000
2025-04-25 01:46:58,016 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:46:58,019 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:46:58,019 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:46:58,020 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:46:59,034 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:59,042 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:46:59,047 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_08314aef-f2fb-490e-b21b-febae50d4b00', 'timestamp': '2025-04-25T01:46:59.042905', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:46:59.036882"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:46:59,051 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:59,051 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:46:59,052 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:46:59,053 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 01:46:59,053 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:46:59,053 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:46:59,053 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:46:59,055 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:46:59,055 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:01,133 - CtxMemMgr_User5 - INFO - Stored turn 68323ecc-ec21-4027-8e17-efebf26175cb for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:01,134 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:01,135 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:01,136 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~302 / 30000
2025-04-25 01:47:01,136 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:01,141 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:01,142 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:01,142 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:01,143 - CtxMemMgr_User5 - INFO - Stored turn 43fbeb85-06ba-4975-80ff-76e2bda36fcb for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:01,143 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:01,143 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:01,144 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~316 / 30000
2025-04-25 01:47:01,144 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:01,147 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:01,148 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:01,148 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:47:00Z",
    "speaker": "User...
2025-04-25 01:47:02,158 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:02,167 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:02,173 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0091fc36-858d-4e84-8ac7-30f589b42867', 'timestamp': '2025-04-25T01:47:02.167825', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:02.159455"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:02,178 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:02,179 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:02,181 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:02,181 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 01:47:02,181 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:02,182 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:02,182 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:02,183 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:02,183 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:04,297 - CtxMemMgr_User5 - INFO - Stored turn 1d20764b-350a-4235-8bbf-a058f68588f3 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:04,297 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:04,298 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:04,298 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~336 / 30000
2025-04-25 01:47:04,299 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:04,302 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:04,303 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:04,303 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:04,303 - CtxMemMgr_User5 - INFO - Stored turn a5c784b2-0b51-45aa-b820-7d2b72c1077e for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:04,304 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:04,304 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:04,304 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~356 / 30000
2025-04-25 01:47:04,304 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:04,308 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:04,308 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:04,309 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:05,316 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:05,323 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:05,329 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d0ce49a3-fc0c-4b97-835b-d4443f6bcb23', 'timestamp': '2025-04-25T01:47:05.324547', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:05.317752"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:05,335 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:05,335 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:05,336 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:05,336 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 01:47:05,337 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:05,337 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:05,337 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:05,339 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:05,339 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:09,839 - CtxMemMgr_User5 - INFO - Stored turn d3e372c5-2f2d-4a05-85b0-767000d8140f for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:09,839 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:09,840 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:09,840 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~365 / 30000
2025-04-25 01:47:09,841 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:09,847 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:09,847 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:09,847 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 01:47:09,848 - ActionHandler_User5 - INFO - Extracted query: 'History of chocolate production and consumption'
2025-04-25 01:47:09,848 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'History of chocolate production and consumption' (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:47:09,848 - CtxMemMgr_User5 - INFO - Stored turn 3a51b172-4602-4b21-af69-c7c2113df7ed for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:09,849 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:09,849 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:09,849 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~374 / 30000
2025-04-25 01:47:09,850 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:09,855 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:09,855 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745545629-9b5a907e) ***
2025-04-25 01:47:09,855 - ActionHandler_User5 - INFO - Storing search status for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: active
2025-04-25 01:47:09,860 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:09,864 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f32cfb4e-eb65-44a1-bb8f-5b232cd35de4', 'timestamp': '2025-04-25T01:47:09.860886', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: History of chocolate production and consumption", "search_id": "search-1745545629-9b5a907e", "timestamp": "2025-04-25T01:47:09.855527"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:09,865 - ActionHandler_User5 - INFO - Stored system message ID sys_f32cfb4e-eb65-44a1-bb8f-5b232cd35de4 for search ID search-1745545629-9b5a907e
2025-04-25 01:47:09,865 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:09,866 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'History of chocolate production and consumption'
2025-04-25 01:47:09,866 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 01:47:09,866 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 01:47:09,867 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 01:47:09,867 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'History of chocolate production and consumption'
2025-04-25 01:47:09,867 - components.action_handler - INFO - Performing Tavily search for query: 'History of chocolate production and consumption'
2025-04-25 01:47:09,868 - components.action_handler - INFO - Calling Tavily search API with query: 'History of chocolate production and consumption'
2025-04-25 01:47:13,091 - components.action_handler - INFO - Tavily search response: {'query': 'History of chocolate production and consumption', 'follow_up_questions': None, 'answer': 'Chocolate originated from cacao beans in Central America, spread to Europe in the 16th century, and...
2025-04-25 01:47:13,091 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: History of chocolate production and consumption

Summary: Chocolate originated from cacao beans in Central America, spread to Europe in the 16th century, and became popular worldwi...
2025-04-25 01:47:13,092 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 01:47:13,092 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 01:47:13,093 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 2053
2025-04-25 01:47:13,093 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: History of chocolate production and consumption

Summary: Chocolate originated f...
2025-04-25 01:47:13,093 - ActionHandler_User5 - INFO - Updating system message sys_f32cfb4e-eb65-44a1-bb8f-5b232cd35de4 for search ID search-1745545629-9b5a907e
2025-04-25 01:47:13,096 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:13,099 - api.endpoints.system_messages - INFO - Updated system message sys_f32cfb4e-eb65-44a1-bb8f-5b232cd35de4 in database
2025-04-25 01:47:13,100 - ActionHandler_User5 - INFO - Successfully updated system message sys_f32cfb4e-eb65-44a1-bb8f-5b232cd35de4
2025-04-25 01:47:13,104 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:13,112 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1f5dc91f-ac3c-424c-8d94-d6caae89d6b2', 'timestamp': '2025-04-25T01:47:13.105054', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: History of chocolate production and consumption\\n\\nSummary: Chocolate originated from cacao  ... (1883 characters truncated) ... ntal and social costs of cacao farming. Approximately 70% of global cacao production occurs in ...\\n\\n", "timestamp": "2025-04-25T01:47:13.101039"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:14,125 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:14,134 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:14,141 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1841eb18-2a06-41f5-a119-6fdbc46ef618', 'timestamp': '2025-04-25T01:47:14.135095', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:14.127276"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:14,147 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:14,147 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:14,149 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:14,150 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 01:47:14,150 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:14,150 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:14,150 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:14,152 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:14,152 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:18,114 - CtxMemMgr_User5 - INFO - Stored turn 393a05ac-22b6-4b40-b4f8-62ef7ee582c0 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:18,114 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:18,115 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:18,116 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~388 / 30000
2025-04-25 01:47:18,116 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:18,122 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:18,122 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:18,122 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:18,123 - CtxMemMgr_User5 - INFO - Stored turn 585db595-9de9-47f5-9298-21fc694a4bf7 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:18,123 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:18,123 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:18,123 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~402 / 30000
2025-04-25 01:47:18,123 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:18,127 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:18,127 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:18,128 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:19,139 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:19,147 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:19,154 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4db1d75a-a835-4c06-ab18-46f11b4cce2f', 'timestamp': '2025-04-25T01:47:19.147872', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:19.140352"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:19,158 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:19,159 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:19,161 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:19,161 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 01:47:19,161 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:19,161 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:19,162 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:19,164 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:19,164 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:22,786 - CtxMemMgr_User5 - INFO - Stored turn 23565f76-6895-4fb4-a39e-cf249fdd14b0 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:22,787 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:22,787 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:22,787 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~409 / 30000
2025-04-25 01:47:22,788 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:22,794 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:22,794 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:22,795 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:22,795 - CtxMemMgr_User5 - INFO - Stored turn 8399e77f-cc71-438d-8d55-7681c14ee716 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:22,795 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:22,795 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:22,796 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~416 / 30000
2025-04-25 01:47:22,796 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:22,800 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:22,800 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:22,801 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:23,808 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:23,817 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:23,822 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_09a5d0c0-975d-4573-ac23-a3991d7dc112', 'timestamp': '2025-04-25T01:47:23.818225', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:23.810285"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:23,826 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:23,826 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:23,827 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:23,827 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's your opinion on modern art?'
2025-04-25 01:47:23,828 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:23,828 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:23,828 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:23,829 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:23,830 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:26,785 - CtxMemMgr_User5 - INFO - Stored turn 21017ad4-6549-4e1a-988d-d5242793a06f for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:26,785 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:26,787 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:26,788 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~424 / 30000
2025-04-25 01:47:26,788 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:26,794 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:26,794 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:26,795 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:26,795 - CtxMemMgr_User5 - INFO - Stored turn 6ee571d8-58d3-43af-a60f-67a3500c5afd for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:26,795 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:26,796 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:26,796 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~432 / 30000
2025-04-25 01:47:26,796 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:26,800 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:26,800 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:26,800 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:27,812 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:27,822 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:27,828 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c9b12c7f-1f50-4f93-b46b-ae9b2c13eff5', 'timestamp': '2025-04-25T01:47:27.822716', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:27.814404"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:27,833 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:27,834 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:27,835 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:27,836 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the cultural significance of tea ceremonies.'
2025-04-25 01:47:27,836 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:27,836 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:27,836 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:27,838 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:27,838 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:30,964 - CtxMemMgr_User5 - INFO - Stored turn 52f0f188-6c82-45bf-8e85-764f7fcf26d3 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:30,965 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:30,966 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:30,966 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~446 / 30000
2025-04-25 01:47:30,967 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:30,971 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:30,972 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:30,972 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:30,973 - CtxMemMgr_User5 - INFO - Stored turn e6777e85-899d-4b76-a7a2-511772543761 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:30,973 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:30,973 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:30,973 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~460 / 30000
2025-04-25 01:47:30,973 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:30,978 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:30,979 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:30,979 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:31,991 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:32,000 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:32,006 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_26273976-ac49-403a-9bd7-e63b8c2fba4f', 'timestamp': '2025-04-25T01:47:32.001462', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:31.992843"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:32,012 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:32,012 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:32,013 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:32,013 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do airplanes generate lift?'
2025-04-25 01:47:32,014 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:32,014 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:32,014 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:32,016 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:32,016 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:35,366 - CtxMemMgr_User5 - INFO - Stored turn 798a0c4e-bf76-456e-8207-382f394c2b35 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:35,367 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:35,368 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:35,368 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~467 / 30000
2025-04-25 01:47:35,368 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:35,377 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:35,377 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:35,378 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:35,378 - CtxMemMgr_User5 - INFO - Stored turn dbec9b01-ee1a-428e-b7d7-a9c4ea9639f2 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:35,379 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:35,380 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:35,380 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~474 / 30000
2025-04-25 01:47:35,380 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:35,386 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:35,386 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:35,387 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:36,397 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:36,401 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:36,405 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_aa08bbcb-62cf-488c-a038-fba41f137358', 'timestamp': '2025-04-25T01:47:36.402091', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:36.398269"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:36,407 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:36,407 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:36,408 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:36,409 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a symphony different from other musical compositions?'
2025-04-25 01:47:36,409 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:36,409 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:36,409 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:36,410 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:36,410 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:40,225 - CtxMemMgr_User5 - INFO - Stored turn 73684325-649d-4878-b9f8-18636ef10d61 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:40,226 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:40,226 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:40,226 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~490 / 30000
2025-04-25 01:47:40,227 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:40,233 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:40,233 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:40,234 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:40,234 - CtxMemMgr_User5 - INFO - Stored turn e1c24c71-f7ac-40b8-b824-20293a0964a3 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:40,234 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:40,234 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:40,235 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~506 / 30000
2025-04-25 01:47:40,235 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:40,240 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:40,240 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:40,241 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:41,239 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:41,246 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:41,250 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6c92f652-091b-45b1-bd73-c270fcaeb9ff', 'timestamp': '2025-04-25T01:47:41.246622', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:41.240606"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:41,253 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:41,254 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:41,255 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:41,255 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the basics of photography.'
2025-04-25 01:47:41,255 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:41,255 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:41,255 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:41,257 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:41,257 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:45,774 - CtxMemMgr_User5 - INFO - Stored turn 55ace575-1e8e-4739-8d4e-bdea3bb8c5ec for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:45,775 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:45,775 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:45,776 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~514 / 30000
2025-04-25 01:47:45,776 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:45,787 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:45,787 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:45,788 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:45,788 - CtxMemMgr_User5 - INFO - Stored turn 4aef8ad2-ce58-48bc-8933-d9529d038fa4 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:45,788 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:45,788 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:45,789 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~522 / 30000
2025-04-25 01:47:45,789 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:45,796 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:45,797 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:45,797 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:46,808 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:46,814 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:46,819 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f40fe32e-4f35-45b4-bf40-be24f2c0ebe7', 'timestamp': '2025-04-25T01:47:46.815352', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:46.809380"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:46,822 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:46,823 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:46,823 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:46,824 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about traditional cuisines from South America.'
2025-04-25 01:47:46,824 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:46,824 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:46,824 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:46,826 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:46,826 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:51,611 - CtxMemMgr_User5 - INFO - Stored turn c647f369-1c71-4af0-8bd0-c968abbcde96 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:51,612 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:51,612 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:51,612 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~535 / 30000
2025-04-25 01:47:51,613 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:51,619 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:51,620 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:51,621 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:51,621 - CtxMemMgr_User5 - INFO - Stored turn 792004a9-cb79-4aa0-af05-19cbf3ff5778 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:51,621 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:51,622 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:51,622 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~548 / 30000
2025-04-25 01:47:51,623 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:51,632 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:51,633 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:51,634 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:52,645 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:52,658 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:52,665 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_59da667e-faa5-4040-bea7-5c04f20fa324', 'timestamp': '2025-04-25T01:47:52.659398', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:52.646086"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:52,668 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:52,668 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:52,669 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:52,670 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does cloud computing work?'
2025-04-25 01:47:52,670 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:52,670 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:52,670 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:52,672 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:52,673 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:47:56,833 - CtxMemMgr_User5 - INFO - Stored turn 6dd98086-2655-4ce7-85f7-52c20e42782a for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:56,835 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:56,836 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:56,836 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~555 / 30000
2025-04-25 01:47:56,837 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:56,846 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:56,847 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:47:56,847 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5).
2025-04-25 01:47:56,847 - CtxMemMgr_User5 - INFO - Stored turn d6ca0418-bbaa-4cce-a130-e4ba552b3367 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:56,848 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:47:56,848 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:47:56,849 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~562 / 30000
2025-04-25 01:47:56,849 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:47:56,863 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:47:56,864 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:47:56,865 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:48:00Z",
    "speaker": "User...
2025-04-25 01:47:57,873 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:57,879 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:47:57,885 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_77e13671-4283-4dc0-9476-3ae6e3c367c1', 'timestamp': '2025-04-25T01:47:57.880644', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:47:57.874408"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:47:57,888 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:57,888 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:47:57,888 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:47:57,888 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my favorite animal again?'
2025-04-25 01:47:57,889 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:47:57,889 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:47:57,889 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:47:57,890 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:47:57,890 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:00,218 - CtxMemMgr_User5 - INFO - Stored turn 3ec37f3b-0c3b-409e-baa9-0a6d06f37c01 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:00,218 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:00,218 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:00,219 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~570 / 30000
2025-04-25 01:48:00,219 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:00,225 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:00,225 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:00,226 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:00,226 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:00,227 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:48:00,227 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:48:00,234 - managers.memory.request_parser - WARNING - Message all not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:00,236 - managers.memory.request_parser - WARNING - Message all not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:00,236 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:00,237 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:48:00,237 - managers.memory.request_parser - INFO - Found episodic memory request: favorite animal
2025-04-25 01:48:00,237 - managers.memory.request_parser - INFO - Found episodic memory request: favorite animal
2025-04-25 01:48:00,237 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:00,238 - CtxMemMgr_User5 - INFO - Stored turn 41eee1a2-0883-46be-ac01-fda2e0b7b6cc for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:00,238 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:00,238 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:00,238 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~578 / 30000
2025-04-25 01:48:00,238 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:00,243 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:01,249 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:01,257 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:01,263 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fa7460c6-379d-4592-9104-a72ee6415b67', 'timestamp': '2025-04-25T01:48:01.258037', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:01.251838"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:01,267 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:01,267 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:01,268 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:01,268 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 01:48:01,269 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:01,269 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:01,269 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:01,271 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:01,271 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:03,572 - CtxMemMgr_User5 - INFO - Stored turn 157bcdb0-e7d9-446a-962c-112a08266956 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:03,573 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:03,575 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:03,577 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~589 / 30000
2025-04-25 01:48:03,585 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:03,595 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:03,595 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:03,595 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:03,595 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:03,595 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:03,597 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:03,597 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:03,597 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:48:03,597 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:48:03,597 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:48:03,597 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:03,598 - CtxMemMgr_User5 - INFO - Stored turn c6c0a173-e1cd-4f5f-a17f-0373059ad0ec for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:03,598 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:03,598 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:03,598 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~600 / 30000
2025-04-25 01:48:03,598 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:03,601 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:04,613 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:04,620 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:04,624 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_80091a5b-be9e-449a-ad6f-f2e2f2dcba3e', 'timestamp': '2025-04-25T01:48:04.620786', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:04.614457"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:04,628 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:04,628 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:04,629 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:04,629 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 01:48:04,629 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:04,630 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:04,630 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:04,630 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:04,631 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:07,163 - CtxMemMgr_User5 - INFO - Stored turn d8afff42-9b94-48ac-ae6e-ca6fa0375f69 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,164 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:07,164 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:07,164 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~611 / 30000
2025-04-25 01:48:07,164 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:07,173 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,173 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:07,174 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id'), ('2', 'message_id'), ('3', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:07,174 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:07,174 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:07,174 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:48:07,174 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:07,175 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:48:07,177 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,181 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,183 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,184 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,185 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:07,185 - managers.memory.request_parser - INFO - Found 4 tier requests, will regenerate response
2025-04-25 01:48:07,185 - managers.memory.request_parser - INFO - Found episodic memory request: favorite instrument
2025-04-25 01:48:07,185 - managers.memory.request_parser - INFO - Found episodic memory request: favorite instrument
2025-04-25 01:48:07,186 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,186 - CtxMemMgr_User5 - INFO - Stored turn a3365ef6-6f55-487a-aa30-9e72944ac0a3 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:07,186 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:07,186 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:07,187 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~622 / 30000
2025-04-25 01:48:07,187 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:07,194 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:08,205 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:08,213 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:08,221 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_238df960-50ad-4cb8-b447-bf71381f37af', 'timestamp': '2025-04-25T01:48:08.213655', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:08.207200"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:08,225 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:08,225 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:08,226 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:08,226 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 01:48:08,227 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:08,227 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:08,227 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:08,229 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:08,229 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:10,554 - CtxMemMgr_User5 - INFO - Stored turn e85ab325-c12a-4fbb-9aec-62d7ae6c7e50 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:10,554 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:10,554 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:10,555 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~629 / 30000
2025-04-25 01:48:10,555 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:10,564 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:10,564 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:10,564 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:10,565 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:10,565 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:10,567 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:10,569 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:10,570 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:48:10,570 - managers.memory.request_parser - INFO - Found episodic memory request: college major
2025-04-25 01:48:10,570 - managers.memory.request_parser - INFO - Found episodic memory request: college major
2025-04-25 01:48:10,570 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:10,570 - CtxMemMgr_User5 - INFO - Stored turn 9beb492f-0700-4cf1-9df5-b0906ae5e481 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:10,571 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:10,571 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:10,571 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~636 / 30000
2025-04-25 01:48:10,571 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:10,578 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:11,596 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:11,602 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:11,607 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1d768c7f-2b84-4a45-a119-92b7b0851e9a', 'timestamp': '2025-04-25T01:48:11.603029', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:11.596866"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:11,612 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:11,613 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:11,614 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:11,614 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 01:48:11,614 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:11,614 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:11,615 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:11,616 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:11,616 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:13,708 - CtxMemMgr_User5 - INFO - Stored turn c02e0977-c00a-4963-bcd5-2317bf6887c7 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:13,709 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:13,709 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:13,710 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~641 / 30000
2025-04-25 01:48:13,710 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:13,716 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:13,716 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:13,717 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:13,717 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:13,717 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:48:13,717 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:48:13,720 - managers.memory.request_parser - WARNING - Message all not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:13,722 - managers.memory.request_parser - WARNING - Message all not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:13,723 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:13,723 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:48:13,723 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:48:13,724 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:48:13,724 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:13,724 - CtxMemMgr_User5 - INFO - Stored turn a936df29-a9e8-4353-95b8-3a1c43610127 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:13,724 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:13,725 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:13,725 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~646 / 30000
2025-04-25 01:48:13,725 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:13,734 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:14,744 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:14,751 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:14,756 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_79c4e0da-bfcc-4703-8734-77ae7f00e393', 'timestamp': '2025-04-25T01:48:14.752023', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:14.745807"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:14,760 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:14,760 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:14,762 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:14,762 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 01:48:14,762 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:14,762 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:14,762 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:14,764 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:14,764 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:16,754 - CtxMemMgr_User5 - INFO - Stored turn 40c1f550-683f-41c5-9bad-59124eb13907 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:16,754 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:16,755 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:16,755 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~654 / 30000
2025-04-25 01:48:16,756 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:16,766 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:16,767 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:16,767 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:16,767 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:16,768 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:16,770 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:16,771 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:16,772 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:48:16,772 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:48:16,772 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:48:16,772 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:16,772 - CtxMemMgr_User5 - INFO - Stored turn 89689148-8c24-42d7-b21b-09910208f1ee for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:16,773 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:16,773 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:16,773 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~662 / 30000
2025-04-25 01:48:16,773 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:16,779 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:17,786 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:17,794 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:17,800 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b26e7fea-ee79-4149-a87b-86b239622f85', 'timestamp': '2025-04-25T01:48:17.795512', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:17.787270"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:17,804 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:17,804 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:17,805 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:17,805 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 01:48:17,805 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:17,806 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:17,806 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:17,807 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:17,807 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:19,844 - CtxMemMgr_User5 - INFO - Stored turn 092ec19b-0422-4993-931c-e21d9b28fc58 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:19,845 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:19,845 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:19,846 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~670 / 30000
2025-04-25 01:48:19,846 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:19,854 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:19,854 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:19,854 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:19,855 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:19,855 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:19,855 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:48:19,858 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:19,860 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:19,862 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:19,862 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:48:19,862 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:48:19,862 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:48:19,863 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:19,863 - CtxMemMgr_User5 - INFO - Stored turn cb27d553-7239-4d77-9522-31b1f2bd7e14 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:19,863 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:19,863 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:19,863 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~678 / 30000
2025-04-25 01:48:19,864 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:19,870 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:20,877 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:20,885 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:20,890 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c4b0cf82-3dd9-4d15-b82e-40dd4bec6972', 'timestamp': '2025-04-25T01:48:20.885806', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:20.878861"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:20,896 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:20,897 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:20,898 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:20,898 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 01:48:20,898 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:20,898 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:20,899 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:20,900 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:20,900 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:23,054 - CtxMemMgr_User5 - INFO - Stored turn 63139bf7-47ba-44f5-8f3f-23afd64b422c for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:23,055 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:23,055 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:23,055 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~686 / 30000
2025-04-25 01:48:23,055 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:23,061 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:23,062 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:23,062 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:23,062 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:23,062 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:23,062 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:48:23,064 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:23,066 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:23,066 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:23,067 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:48:23,067 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:48:23,067 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:48:23,068 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:23,068 - CtxMemMgr_User5 - INFO - Stored turn 47323c83-1e49-43d9-8931-a8d9ff230ac9 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:23,068 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:23,069 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:23,069 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~694 / 30000
2025-04-25 01:48:23,069 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:23,076 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:24,083 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:24,090 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:24,097 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e4011a03-c3d4-4b05-bc5a-91c9a7165ec3', 'timestamp': '2025-04-25T01:48:24.091524', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:24.084914"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:24,101 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:24,102 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:24,103 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:24,103 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 01:48:24,103 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:24,104 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:24,104 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:24,107 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:24,108 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:26,038 - CtxMemMgr_User5 - INFO - Stored turn d7ca2c47-0453-4080-ac7c-a8ac764529f1 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:26,038 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:26,039 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:26,039 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~702 / 30000
2025-04-25 01:48:26,040 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:26,050 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:26,050 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:26,051 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:26,052 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:26,052 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:26,052 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:48:26,055 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:26,057 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:26,058 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:26,058 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:48:26,058 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:48:26,058 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:48:26,059 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:26,059 - CtxMemMgr_User5 - INFO - Stored turn 67808de5-aef5-4491-8325-be597556db71 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:26,059 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:26,059 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:26,060 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~710 / 30000
2025-04-25 01:48:26,060 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:26,068 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:27,075 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:27,082 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:48:27,088 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e617afd5-98ae-45aa-8bda-8cf43bf238ba', 'timestamp': '2025-04-25T01:48:27.083323', 'session_id': '9b5a907e-fe89-4252-915f-17eac69ee4d5', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:48:27.076447"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:48:27,091 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:27,091 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:48:27,092 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 01:48:27,092 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:48:27,094 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:48:27,094 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:48:27,095 - components.prompt_builder - INFO - Constructing prompt for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5, depth 0
2025-04-25 01:48:27,095 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 01:48:27,095 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:48:27,095 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:48:27,095 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:48:27,097 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:48:27,097 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:48:29,149 - CtxMemMgr_User5 - INFO - Stored turn 43f91564-df3b-4fe6-a2a9-15641f41a36f for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:29,150 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:29,151 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:29,151 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~719 / 30000
2025-04-25 01:48:29,152 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:29,164 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:29,165 - ActionHandler_User5 - INFO - Processing LLM response for session 9b5a907e-fe89-4252-915f-17eac69ee4d5, user 5
2025-04-25 01:48:29,165 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: 9b5a907e-fe89-4252-915f-17eac69ee4d5)
2025-04-25 01:48:29,165 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:48:29,166 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:48:29,168 - managers.memory.request_parser - WARNING - Message message_id not found in session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:29,169 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:48:29,170 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:48:29,170 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:48:29,170 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:48:29,170 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:29,170 - CtxMemMgr_User5 - INFO - Stored turn a91a17c6-d974-4dff-b5cf-23b316822551 for active session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:48:29,171 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 9b5a907e-fe89-4252-915f-17eac69ee4d5: '...'
2025-04-25 01:48:29,171 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:48:29,171 - CtxMemMgr_User5 - INFO - Session 9b5a907e-fe89-4252-915f-17eac69ee4d5: Active history token count ~728 / 30000
2025-04-25 01:48:29,171 - CtxMemMgr_User5 - INFO - Saving active session context for 9b5a907e-fe89-4252-915f-17eac69ee4d5 to /app/data/sessions/5/9b5a907e-fe89-4252-915f-17eac69ee4d5/context.json
2025-04-25 01:48:29,179 - CtxMemMgr_User5 - INFO - Successfully saved context for session 9b5a907e-fe89-4252-915f-17eac69ee4d5
2025-04-25 01:53:40,135 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:40,136 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:40,137 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:53:40,138 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:53:40,138 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:53:40,141 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:40,143 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:53:40,143 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:53:40,144 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:53:40,144 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:53:40,144 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:53:40,144 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:53:40,144 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:53:40,144 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:53:40,145 - ConvMgr_User5 - INFO - Loading session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:40,145 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:53:40,145 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:53:40,145 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:53:40,152 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:40,157 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_642cdc02-860a-4e8b-937c-b0afd79a74b1', 'timestamp': '2025-04-25T01:53:40.153886', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:53:40.145926"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:53:40,162 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:40,162 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:53:40,162 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 01:53:40,163 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:53:40,164 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:53:40,165 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:53:40,165 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:53:40,165 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:53:40,165 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 01:53:40,166 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:53:40,166 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:53:40,166 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:53:40,166 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:53:40,167 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:40,168 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:53:42,232 - CtxMemMgr_User5 - INFO - Loading session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 for processing assistant message
2025-04-25 01:53:42,232 - CtxMemMgr_User5 - INFO - Loading session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 from /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:42,233 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json not found. Initializing empty context for new session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19.
2025-04-25 01:53:42,233 - CtxMemMgr_User5 - INFO - Stored turn 01ccb189-bf07-43d7-8fcb-264104129db4 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:42,233 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:42,234 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:42,234 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~15 / 30000
2025-04-25 01:53:42,235 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:42,237 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:42,238 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:53:42,238 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:53:42,238 - CtxMemMgr_User5 - INFO - Stored turn 512618fd-87c1-40b5-8fcd-3486a3c7a489 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:42,239 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:42,240 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:42,240 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~30 / 30000
2025-04-25 01:53:42,240 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:42,242 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:42,242 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:53:42,242 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:54:00Z",
    "speaker": "User...
2025-04-25 01:53:43,250 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:43,258 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:43,263 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c29bf4b7-6444-4fad-949e-37dc53e899d5', 'timestamp': '2025-04-25T01:53:43.259033', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:53:43.251557"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:53:43,267 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:43,267 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:53:43,268 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:53:43,268 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 01:53:43,269 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:53:43,269 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:53:43,269 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:53:43,271 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:43,272 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:53:45,671 - CtxMemMgr_User5 - INFO - Stored turn cca0a2ff-099a-46e9-a646-8b2ae76495bd for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:45,671 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:45,676 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:45,679 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~49 / 30000
2025-04-25 01:53:45,680 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:45,684 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:45,684 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:53:45,685 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:53:45,685 - CtxMemMgr_User5 - INFO - Stored turn 2f2359c7-4e40-4964-b2e1-d61ea7ef6d98 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:45,685 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:45,686 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:45,686 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~68 / 30000
2025-04-25 01:53:45,686 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:45,688 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:45,690 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:53:45,690 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:53:46,699 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:46,711 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:46,719 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7b955dea-704b-4477-8b64-28b54dc17bdd', 'timestamp': '2025-04-25T01:53:46.712500', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:53:46.702185"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:53:46,725 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:46,725 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:53:46,727 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:53:46,727 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 01:53:46,728 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:53:46,728 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:53:46,728 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:53:46,730 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:46,730 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:53:49,100 - CtxMemMgr_User5 - INFO - Stored turn 0b167386-a142-41b4-8e4f-c5f81bb7d5e1 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:49,100 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:49,101 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:49,101 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~87 / 30000
2025-04-25 01:53:49,101 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:49,105 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:49,105 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:53:49,106 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:53:49,107 - CtxMemMgr_User5 - INFO - Stored turn 8fc723a8-2729-48a1-9c05-508cfe873e7b for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:49,107 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:49,107 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:49,107 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~106 / 30000
2025-04-25 01:53:49,108 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:49,109 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:49,109 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:53:49,110 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:54:00Z",
    "speaker": "User...
2025-04-25 01:53:50,120 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:50,127 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:50,134 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0610e24c-3926-4277-9aab-7556f4fb162b', 'timestamp': '2025-04-25T01:53:50.128200', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:53:50.122245"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:53:50,138 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:50,138 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:53:50,140 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 01:53:50,140 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:53:50,143 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:53:50,144 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:53:50,144 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:53:50,144 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 01:53:50,144 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:53:50,144 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:53:50,145 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:53:50,146 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:50,147 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:53:52,281 - CtxMemMgr_User5 - INFO - Stored turn 047f0ad7-c887-4ad7-b9b5-acd57ffb7b5c for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:52,281 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:52,282 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:52,282 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~122 / 30000
2025-04-25 01:53:52,282 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:52,285 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:52,286 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:53:52,286 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:53:52,287 - CtxMemMgr_User5 - INFO - Stored turn d72ff32b-9418-4260-b0fd-f9e5a4fb68ff for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:52,287 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:52,287 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:52,288 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~138 / 30000
2025-04-25 01:53:52,288 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:52,291 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:52,292 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:53:52,292 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:53:53,309 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:53,316 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:53,323 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6183c611-bfce-4e8f-bc3d-84a742143df8', 'timestamp': '2025-04-25T01:53:53.318138', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:53:53.310817"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:53:53,328 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:53,329 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:53:53,333 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:53:53,334 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 01:53:53,334 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:53:53,334 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:53:53,334 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:53:53,336 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:53,337 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:53:55,861 - CtxMemMgr_User5 - INFO - Stored turn 0ffece77-9516-42c4-ab8a-b55ed9526582 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:55,862 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:55,863 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:55,863 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~158 / 30000
2025-04-25 01:53:55,863 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:55,867 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:55,867 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:53:55,868 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:53:55,868 - CtxMemMgr_User5 - INFO - Stored turn a2f5d68d-c1eb-4175-97b4-5c38d00bbbde for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:55,868 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:55,868 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:55,869 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~178 / 30000
2025-04-25 01:53:55,869 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:55,871 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:55,872 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:53:55,874 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:53:56,882 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:56,888 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:53:56,893 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_011472f1-2741-4f6c-accb-5ee938638adc', 'timestamp': '2025-04-25T01:53:56.889483', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:53:56.883874"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:53:56,896 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:56,896 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:53:56,896 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:53:56,897 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 01:53:56,897 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:53:56,897 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:53:56,897 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:53:56,898 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:53:56,898 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:53:59,114 - CtxMemMgr_User5 - INFO - Stored turn eaad51e9-2ab6-4b28-b030-5ed041667597 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:59,115 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:59,116 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:59,117 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~197 / 30000
2025-04-25 01:53:59,118 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:59,125 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:59,125 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:53:59,126 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:53:59,126 - CtxMemMgr_User5 - INFO - Stored turn eb98b73c-d0a5-46e0-a934-a5de3d6fb70b for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:59,126 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:53:59,126 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:53:59,127 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~216 / 30000
2025-04-25 01:53:59,127 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:53:59,129 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:53:59,130 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:53:59,131 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:54:00Z",
    "speaker": "User...
2025-04-25 01:54:00,137 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:00,145 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:00,151 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7f592cfd-7d11-469e-a608-6329e54552ca', 'timestamp': '2025-04-25T01:54:00.146195', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:00.139386"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:00,156 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:00,156 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:00,158 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:00,158 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 01:54:00,158 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:00,159 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:00,159 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:00,160 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:00,161 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:02,825 - CtxMemMgr_User5 - INFO - Stored turn b041ee63-5b90-4f05-91e7-5d24f7a33baf for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:02,825 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:02,825 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:02,826 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~235 / 30000
2025-04-25 01:54:02,826 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:02,830 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:02,830 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:02,831 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:02,831 - CtxMemMgr_User5 - INFO - Stored turn f2152f91-ea1c-485d-8d80-898eaa6a68e6 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:02,831 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:02,831 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:02,832 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~254 / 30000
2025-04-25 01:54:02,832 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:02,834 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:02,834 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:02,834 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:55:00Z",
    "speaker": "User...
2025-04-25 01:54:03,841 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:03,846 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:03,850 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0598e302-2127-4b14-8414-98056e31c923', 'timestamp': '2025-04-25T01:54:03.846518', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:03.842247"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:03,855 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:03,856 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:03,858 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:03,859 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 01:54:03,860 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:03,860 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:03,861 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:03,863 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:03,864 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:06,198 - CtxMemMgr_User5 - INFO - Stored turn 65f16011-b0d6-4a7c-922b-f8f92580847f for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:06,199 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:06,199 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:06,200 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~271 / 30000
2025-04-25 01:54:06,200 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:06,204 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:06,205 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:06,206 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:06,206 - CtxMemMgr_User5 - INFO - Stored turn bb0cc4e9-5f90-4d86-880b-ce88d636b5e2 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:06,206 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:06,206 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:06,206 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~288 / 30000
2025-04-25 01:54:06,207 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:06,209 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:06,210 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:06,210 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:55:00Z",
    "speaker": "User...
2025-04-25 01:54:07,219 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:07,224 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:07,228 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8e3e9a91-ea86-4a23-b919-cffa1146bd79', 'timestamp': '2025-04-25T01:54:07.225026', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:07.220098"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:07,232 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:07,232 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:07,233 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:07,233 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 01:54:07,233 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:07,234 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:07,234 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:07,236 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:07,237 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:09,277 - CtxMemMgr_User5 - INFO - Stored turn 0ea5f63a-a00c-41c3-8e1c-502bd17d1b17 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:09,278 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:09,278 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:09,279 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~302 / 30000
2025-04-25 01:54:09,279 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:09,284 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:09,285 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:09,286 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:09,286 - CtxMemMgr_User5 - INFO - Stored turn 4de81921-5afb-496e-8b0a-02ed0db4ba5e for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:09,287 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:09,287 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:09,287 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~316 / 30000
2025-04-25 01:54:09,288 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:09,292 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:09,292 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:09,292 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:55:00Z",
    "speaker": "User...
2025-04-25 01:54:10,303 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:10,309 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:10,313 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_87531296-14e4-4113-8b08-6cb4f0b9825d', 'timestamp': '2025-04-25T01:54:10.309745', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:10.305234"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:10,318 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:10,319 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:10,320 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:10,320 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 01:54:10,321 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:10,321 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:10,321 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:10,323 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:10,324 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:12,354 - CtxMemMgr_User5 - INFO - Stored turn 67610cf9-73d6-4851-97ec-5b3b163dd422 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:12,355 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:12,356 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:12,356 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~336 / 30000
2025-04-25 01:54:12,357 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:12,363 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:12,363 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:12,364 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:12,364 - CtxMemMgr_User5 - INFO - Stored turn 7b146280-4809-4a34-8ecc-e7562184dd2d for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:12,364 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:12,365 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:12,365 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~356 / 30000
2025-04-25 01:54:12,365 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:12,370 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:12,370 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:12,371 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:55:00Z",
    "speaker": "User...
2025-04-25 01:54:13,382 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:13,391 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:13,397 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_84e272e2-3de5-49bf-8460-cca81399886d', 'timestamp': '2025-04-25T01:54:13.391631', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:13.384507"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:13,401 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:13,402 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:13,403 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:13,403 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 01:54:13,403 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:13,404 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:13,404 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:13,406 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:13,406 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:16,849 - CtxMemMgr_User5 - INFO - Stored turn f23bbc29-89c9-4800-b3f5-32d3131d8ea5 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:16,849 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:16,850 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:16,850 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~365 / 30000
2025-04-25 01:54:16,851 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:16,857 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:16,857 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:16,858 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:16,858 - CtxMemMgr_User5 - INFO - Stored turn e62793ec-5654-4183-b6ca-69e92beaaffb for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:16,859 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:16,859 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:16,859 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~374 / 30000
2025-04-25 01:54:16,860 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:16,863 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:16,864 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:16,864 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:17,880 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:17,886 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:17,891 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1eeaf014-d828-4733-9222-ee1506b82ebf', 'timestamp': '2025-04-25T01:54:17.886451', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:17.881099"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:17,895 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:17,895 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:17,896 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:17,896 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 01:54:17,897 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:17,897 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:17,897 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:17,898 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:17,899 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:21,495 - CtxMemMgr_User5 - INFO - Stored turn 7fc6735d-5911-4873-8add-d77c39089ae9 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:21,496 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:21,496 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:21,496 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~388 / 30000
2025-04-25 01:54:21,497 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:21,503 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:21,504 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:21,509 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:21,511 - CtxMemMgr_User5 - INFO - Stored turn 57ab3d6e-f7b4-43a0-a111-5ca8ab4cc17e for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:21,512 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:21,513 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:21,513 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~402 / 30000
2025-04-25 01:54:21,514 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:21,518 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:21,518 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:21,519 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:22,529 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:22,536 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:22,542 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b587d5d5-79b1-479c-b1b6-5a7f288afd9b', 'timestamp': '2025-04-25T01:54:22.537416', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:22.530987"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:22,546 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:22,547 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:22,549 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:22,549 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 01:54:22,550 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:22,550 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:22,551 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:22,553 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:22,553 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:26,066 - CtxMemMgr_User5 - INFO - Stored turn c26aec70-4fab-4811-aebd-cf9872fd9a5a for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:26,066 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:26,066 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:26,067 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~409 / 30000
2025-04-25 01:54:26,067 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:26,072 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:26,072 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:26,073 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:26,073 - CtxMemMgr_User5 - INFO - Stored turn 89fd23da-216d-4dfb-aff2-8cacbf85edf7 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:26,073 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:26,073 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:26,073 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~416 / 30000
2025-04-25 01:54:26,074 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:26,077 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:26,077 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:26,077 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:27,083 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:27,088 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:27,093 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5061738a-a314-4625-a4be-90f3d6c276f9', 'timestamp': '2025-04-25T01:54:27.089268', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:27.084219"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:27,097 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:27,097 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:27,099 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:27,099 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are the benefits of meditation?'
2025-04-25 01:54:27,099 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:27,100 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:27,100 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:27,102 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:27,102 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:30,426 - CtxMemMgr_User5 - INFO - Stored turn 99c95ff5-d476-4f4c-b6b5-1e24bdbe9edb for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:30,427 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:30,427 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:30,428 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~425 / 30000
2025-04-25 01:54:30,428 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:30,437 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:30,437 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:30,438 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:30,438 - CtxMemMgr_User5 - INFO - Stored turn 028e1369-5553-4b94-bda9-42d84f7afa62 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:30,438 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:30,439 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:30,439 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~434 / 30000
2025-04-25 01:54:30,439 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:30,444 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:30,444 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:30,444 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:31,455 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:31,462 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:31,467 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_652ed91c-63f3-40d6-b3c6-bf7279bc8641', 'timestamp': '2025-04-25T01:54:31.463507', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:31.456667"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:31,471 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:31,472 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:31,473 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:31,473 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the Renaissance period in Europe.'
2025-04-25 01:54:31,474 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:31,474 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:31,474 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:31,476 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:31,476 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:36,347 - CtxMemMgr_User5 - INFO - Stored turn 93db9e27-aeca-4450-af63-e0f8797e96d7 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:36,347 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:36,348 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:36,348 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~445 / 30000
2025-04-25 01:54:36,349 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:36,357 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:36,357 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:36,358 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:36,358 - CtxMemMgr_User5 - INFO - Stored turn cb9868a5-4936-43b4-b9fe-af047f321c2a for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:36,359 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:36,359 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:36,360 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~456 / 30000
2025-04-25 01:54:36,360 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:36,365 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:36,365 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:36,366 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:37,371 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:37,377 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:37,381 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2af0d4e1-a916-4f32-b59e-63267323387c', 'timestamp': '2025-04-25T01:54:37.377666', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:37.372531"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:37,385 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:37,385 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:37,386 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:37,386 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does machine learning work?'
2025-04-25 01:54:37,386 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:37,389 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:37,390 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:37,391 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:37,391 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:41,503 - CtxMemMgr_User5 - INFO - Stored turn 13ad64e4-b347-4d10-8acf-0d8c4a1fc059 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:41,504 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:41,504 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:41,505 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~463 / 30000
2025-04-25 01:54:41,505 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:41,512 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:41,513 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:41,513 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:41,514 - CtxMemMgr_User5 - INFO - Stored turn d62cb276-7cf7-4c5e-8ec9-77b52d42d8b5 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:41,514 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:41,514 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:41,515 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~470 / 30000
2025-04-25 01:54:41,515 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:41,520 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:41,521 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:41,522 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:42,532 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:42,540 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:42,545 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_986789e3-e8b1-4067-b571-444ecd56849f', 'timestamp': '2025-04-25T01:54:42.540868', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:42.533620"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:42,550 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:42,550 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:42,551 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:42,552 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a good novel?'
2025-04-25 01:54:42,552 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:42,552 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:42,552 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:42,554 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:42,554 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:46,683 - CtxMemMgr_User5 - INFO - Stored turn 24f8e83e-359f-449f-9c5d-19a3bbeeba00 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:46,683 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:46,684 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:46,684 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~476 / 30000
2025-04-25 01:54:46,685 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:46,694 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:46,694 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:46,694 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:46,694 - CtxMemMgr_User5 - INFO - Stored turn 93edf271-0281-438d-af87-c0c889ea007e for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:46,695 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:46,695 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:46,695 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~482 / 30000
2025-04-25 01:54:46,695 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:46,700 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:46,701 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:46,701 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:47,706 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:47,711 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:47,715 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4a02da95-18a6-4d24-81ba-17250b08eb66', 'timestamp': '2025-04-25T01:54:47.711599', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:47.707000"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:47,718 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:47,719 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:47,720 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:47,720 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the concept of black holes.'
2025-04-25 01:54:47,721 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:47,721 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:47,721 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:47,723 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:47,723 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:51,552 - CtxMemMgr_User5 - INFO - Stored turn 49e049ee-356d-4e1d-b6f0-59c11ece8732 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:51,553 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:51,553 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:51,553 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~490 / 30000
2025-04-25 01:54:51,554 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:51,561 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:51,561 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:51,562 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:51,562 - CtxMemMgr_User5 - INFO - Stored turn e361be54-482d-4e81-a96b-d3221a3fb378 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:51,562 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:51,563 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:51,563 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~498 / 30000
2025-04-25 01:54:51,563 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:51,570 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:51,570 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:51,571 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:52,579 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:52,584 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:52,588 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5563654c-95a7-4571-9b39-bb3695995e23', 'timestamp': '2025-04-25T01:54:52.584940', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:52.580274"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:52,591 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:52,591 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:52,592 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:52,592 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some sustainable living practices?'
2025-04-25 01:54:52,592 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:52,592 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:52,592 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:52,593 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:52,593 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:54:56,965 - CtxMemMgr_User5 - INFO - Stored turn 393ccefe-25c5-4831-9026-eccf1289098b for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:56,965 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:56,966 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:56,966 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~508 / 30000
2025-04-25 01:54:56,968 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:56,979 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:56,979 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:54:56,980 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:54:56,980 - CtxMemMgr_User5 - INFO - Stored turn e3d7055e-4143-47c4-9727-9900d2ee7415 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:56,980 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:54:56,981 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:54:56,981 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~518 / 30000
2025-04-25 01:54:56,981 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:54:56,990 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:54:56,990 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:54:56,991 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:54:58,000 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:58,011 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:54:58,019 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_109ab582-f620-4cfe-a34e-5e29808b3f94', 'timestamp': '2025-04-25T01:54:58.011486', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:54:58.005037"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:54:58,023 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:58,024 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:54:58,025 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:54:58,025 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do vaccines work?'
2025-04-25 01:54:58,025 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:54:58,025 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:54:58,026 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:54:58,027 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:54:58,027 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:00,915 - CtxMemMgr_User5 - INFO - Stored turn 7b89341d-e991-4cf1-a857-3122d7292cb0 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:00,915 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:00,916 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:00,916 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~523 / 30000
2025-04-25 01:55:00,917 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:00,928 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:00,928 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:00,929 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:55:00,929 - CtxMemMgr_User5 - INFO - Stored turn d600ac13-8c8b-455b-9ba4-2ce6ddfed0f6 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:00,929 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:00,930 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:00,930 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~528 / 30000
2025-04-25 01:55:00,931 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:00,936 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:00,936 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:55:00,936 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:55:01,947 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:01,957 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:01,962 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5edc766e-e2c4-4ed3-a8a5-4161b195b206', 'timestamp': '2025-04-25T01:55:01.958039', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:01.948097"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:01,965 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:01,966 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:01,967 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:01,967 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my favorite animal was?'
2025-04-25 01:55:01,968 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:01,968 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:01,968 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:01,970 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:01,971 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:04,158 - CtxMemMgr_User5 - INFO - Stored turn b3f33c72-0285-423c-8efe-d2157c557b76 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:04,158 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:04,159 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:04,160 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~539 / 30000
2025-04-25 01:55:04,160 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:04,171 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:04,171 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:04,172 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19).
2025-04-25 01:55:04,172 - CtxMemMgr_User5 - INFO - Stored turn 11205348-a486-4ca8-ba23-f08d742a9b8e for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:04,172 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:04,172 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:04,173 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~550 / 30000
2025-04-25 01:55:04,173 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:04,179 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:04,179 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:55:04,180 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:56:00Z",
    "speaker": "User...
2025-04-25 01:55:05,189 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:05,195 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:05,201 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_de8d8014-a8c1-4af2-9400-2f76e8103373', 'timestamp': '2025-04-25T01:55:05.196258', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:05.190341"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:05,206 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:05,207 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:05,208 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:05,208 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 01:55:05,208 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:05,209 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:05,209 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:05,210 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:05,211 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:07,697 - CtxMemMgr_User5 - INFO - Stored turn dc2080e1-94a0-4138-b38e-fb4959edb391 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:07,698 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:07,698 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:07,698 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~561 / 30000
2025-04-25 01:55:07,699 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:07,705 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:07,706 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:07,706 - ActionHandler_User5 - INFO - Tier request detected: [('2', '0'), ('3', '0')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:07,706 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:07,706 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 0
2025-04-25 01:55:07,706 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 0
2025-04-25 01:55:07,709 - managers.memory.request_parser - WARNING - Message 0 not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:07,710 - managers.memory.request_parser - WARNING - Message 0 not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:07,711 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:07,711 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:55:07,711 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:55:07,711 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:55:07,711 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:07,712 - CtxMemMgr_User5 - INFO - Stored turn 377ae2ad-454a-46f3-86a2-4c343ec1c393 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:07,712 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:07,712 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:07,712 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~572 / 30000
2025-04-25 01:55:07,712 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:07,716 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:08,724 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:08,734 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:08,742 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_922e14ea-b894-4cfb-bc27-eb905902b952', 'timestamp': '2025-04-25T01:55:08.735169', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:08.725626"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:08,746 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:08,747 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:08,748 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:08,748 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 01:55:08,748 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:08,748 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:08,749 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:08,751 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:08,751 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:11,118 - CtxMemMgr_User5 - INFO - Stored turn 52b91bda-6995-4a74-95fa-e84f0eafbfdb for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:11,118 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:11,118 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:11,119 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~583 / 30000
2025-04-25 01:55:11,119 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:11,126 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:11,126 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:11,126 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:11,127 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:11,127 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:55:11,127 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:55:11,130 - managers.memory.request_parser - WARNING - Message all not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:11,132 - managers.memory.request_parser - WARNING - Message all not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:11,134 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:11,135 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:55:11,135 - managers.memory.request_parser - INFO - Found episodic memory request: favorite instrument
2025-04-25 01:55:11,135 - managers.memory.request_parser - INFO - Found episodic memory request: favorite instrument
2025-04-25 01:55:11,136 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:11,136 - CtxMemMgr_User5 - INFO - Stored turn 8b1aaafb-6c77-4d2b-a046-7358981b2bbf for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:11,136 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:11,137 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:11,137 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~594 / 30000
2025-04-25 01:55:11,137 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:11,143 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:12,150 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:12,160 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:12,167 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7d3582ff-fc1a-48ed-a52f-c491166b001b', 'timestamp': '2025-04-25T01:55:12.161303', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:12.151459"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:12,171 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:12,172 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:12,173 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:12,173 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 01:55:12,173 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:12,173 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:12,174 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:12,175 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:12,176 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:14,375 - CtxMemMgr_User5 - INFO - Stored turn ad561dfd-6cdf-455f-8168-8c4dd1627468 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:14,376 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:14,376 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:14,377 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~601 / 30000
2025-04-25 01:55:14,377 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:14,384 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:14,385 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:14,385 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:14,385 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:14,386 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:55:14,388 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:55:14,392 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:14,394 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:14,395 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:14,395 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:55:14,396 - managers.memory.request_parser - INFO - Found episodic memory request: college
2025-04-25 01:55:14,396 - managers.memory.request_parser - INFO - Found episodic memory request: college
2025-04-25 01:55:14,396 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:14,397 - CtxMemMgr_User5 - INFO - Stored turn a233de8f-452f-4fa4-8a8a-2a9e5a25207c for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:14,397 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:14,398 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:14,398 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~608 / 30000
2025-04-25 01:55:14,398 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:14,404 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:15,415 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:15,425 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:15,431 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a667ec99-36fd-4bdf-974b-397f5f74d7f8', 'timestamp': '2025-04-25T01:55:15.425807', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:15.416779"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:15,437 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:15,437 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:15,438 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:15,439 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 01:55:15,439 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:15,439 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:15,439 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:15,441 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:15,442 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:17,465 - CtxMemMgr_User5 - INFO - Stored turn 51840c1f-3668-4d04-90ce-e5bfea9b1caf for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:17,466 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:17,466 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:17,467 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~613 / 30000
2025-04-25 01:55:17,467 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:17,477 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:17,478 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:17,478 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:17,479 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:17,479 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:55:17,480 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:55:17,485 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:17,488 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:17,489 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:17,489 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:55:17,489 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:55:17,490 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:55:17,490 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:17,490 - CtxMemMgr_User5 - INFO - Stored turn f29510be-b5c9-453f-9a84-e7fe78880c0c for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:17,490 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:17,491 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:17,491 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~618 / 30000
2025-04-25 01:55:17,491 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:17,497 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:18,507 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:18,513 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:18,520 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5540b7d9-120a-4dcb-a22e-56b91166cb95', 'timestamp': '2025-04-25T01:55:18.514140', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:18.508143"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:18,526 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:18,526 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:18,528 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:18,528 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 01:55:18,529 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:18,529 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:18,530 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:18,531 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:18,532 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:20,543 - CtxMemMgr_User5 - INFO - Stored turn 3470914f-11f3-4ae1-ba2c-376d4bbab00e for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:20,544 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:20,544 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:20,545 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~626 / 30000
2025-04-25 01:55:20,545 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:20,552 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:20,552 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:20,553 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:20,553 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:20,553 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:55:20,557 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:20,559 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:20,559 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:55:20,559 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:55:20,560 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:55:20,560 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:20,560 - CtxMemMgr_User5 - INFO - Stored turn babcb698-10f6-42c1-a7fd-814d65273f88 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:20,560 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:20,561 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:20,561 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~634 / 30000
2025-04-25 01:55:20,561 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:20,567 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:21,578 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:21,585 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:21,592 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fa783cd8-fc25-43c1-8e6a-2836d5446936', 'timestamp': '2025-04-25T01:55:21.586516', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:21.579231"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:21,597 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:21,597 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:21,598 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:21,598 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 01:55:21,599 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:21,599 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:21,599 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:21,601 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:21,601 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:23,917 - CtxMemMgr_User5 - INFO - Stored turn 8b9e611a-9db4-4cae-acad-1f8a3c44e45c for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:23,918 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:23,918 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:23,918 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~642 / 30000
2025-04-25 01:55:23,919 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:23,927 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:23,928 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:23,928 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:23,928 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:23,928 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:55:23,930 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:23,931 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:23,931 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:55:23,931 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:55:23,931 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:55:23,932 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:23,932 - CtxMemMgr_User5 - INFO - Stored turn 7b090050-706a-4bff-8912-d8ebadf522f2 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:23,932 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:23,932 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:23,932 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~650 / 30000
2025-04-25 01:55:23,933 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:23,937 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:24,948 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:24,960 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:24,968 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_81728368-7947-40e9-96dd-430748eb617b', 'timestamp': '2025-04-25T01:55:24.961201', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:24.950770"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:24,975 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:24,975 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:24,976 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:24,976 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 01:55:24,977 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:24,977 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:24,977 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:24,979 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:24,979 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:27,212 - CtxMemMgr_User5 - INFO - Stored turn 20dc53c0-4b47-48a8-abb3-11bbfe7dc8cf for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:27,213 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:27,214 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:27,214 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~658 / 30000
2025-04-25 01:55:27,214 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:27,225 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:27,225 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:27,226 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:27,226 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:27,226 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:55:27,226 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:55:27,231 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:27,233 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:27,234 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:27,234 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:55:27,235 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:55:27,235 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:55:27,235 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:27,235 - CtxMemMgr_User5 - INFO - Stored turn 28f405f8-381f-41b0-8801-0fca8a6a195a for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:27,235 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:27,235 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:27,235 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~666 / 30000
2025-04-25 01:55:27,235 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:27,239 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:28,250 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:28,261 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:28,269 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f31cdf5a-ea64-41b1-a17b-18b41b532dbb', 'timestamp': '2025-04-25T01:55:28.262472', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:28.252068"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:28,276 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:28,276 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:28,277 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:28,278 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 01:55:28,278 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:28,278 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:28,278 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:28,281 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:28,281 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:30,375 - CtxMemMgr_User5 - INFO - Stored turn ee870f18-f856-4793-9258-cc88a084fdb2 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:30,376 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:30,376 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:30,377 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~674 / 30000
2025-04-25 01:55:30,377 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:30,391 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:30,391 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:30,392 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:30,392 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:30,392 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:55:30,395 - managers.memory.request_parser - WARNING - Message message_id not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:30,396 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:30,396 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:55:30,397 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:55:30,397 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:55:30,397 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:30,397 - CtxMemMgr_User5 - INFO - Stored turn c1f1a77a-ac61-4aee-95fe-097d9f9d9151 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:30,398 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:30,398 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:30,398 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~682 / 30000
2025-04-25 01:55:30,398 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:30,406 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:31,415 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:31,423 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:55:31,429 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_be4587bd-3f4e-4cdc-b525-eab57240d89f', 'timestamp': '2025-04-25T01:55:31.423909', 'session_id': '2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:55:31.416287"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:55:31,435 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:31,436 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:55:31,437 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 01:55:31,437 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:55:31,441 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:55:31,442 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:55:31,443 - components.prompt_builder - INFO - Constructing prompt for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5, depth 0
2025-04-25 01:55:31,443 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 01:55:31,444 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:55:31,444 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:55:31,444 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:55:31,447 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:55:31,447 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:55:33,439 - CtxMemMgr_User5 - INFO - Stored turn 965aad92-27e0-46cb-94a5-3a0d6d105c39 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:33,440 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:33,440 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:33,440 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~691 / 30000
2025-04-25 01:55:33,441 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:33,452 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:33,453 - ActionHandler_User5 - INFO - Processing LLM response for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19, user 5
2025-04-25 01:55:33,454 - ActionHandler_User5 - INFO - Tier request detected: [('3', '1'), ('2', '1')] (Session: 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19)
2025-04-25 01:55:33,455 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:55:33,456 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 1
2025-04-25 01:55:33,456 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 1
2025-04-25 01:55:33,459 - managers.memory.request_parser - WARNING - Message 1 not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:33,460 - managers.memory.request_parser - WARNING - Message 1 not found in session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:33,461 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:55:33,461 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:55:33,461 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:55:33,462 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:55:33,462 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:33,462 - CtxMemMgr_User5 - INFO - Stored turn 4069e9c1-a957-4b4b-8811-259cb81538e1 for active session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:55:33,462 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: '...'
2025-04-25 01:55:33,463 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:55:33,463 - CtxMemMgr_User5 - INFO - Session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19: Active history token count ~700 / 30000
2025-04-25 01:55:33,463 - CtxMemMgr_User5 - INFO - Saving active session context for 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19 to /app/data/sessions/5/2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19/context.json
2025-04-25 01:55:33,472 - CtxMemMgr_User5 - INFO - Successfully saved context for session 2fcd8aaa-e1ff-4920-aefa-f5ecffe93f19
2025-04-25 01:56:09,881 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:09,881 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:09,883 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:56:09,883 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:56:09,883 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:56:09,886 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:09,887 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:56:09,888 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:56:09,888 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:56:09,888 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:56:09,888 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:09,889 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:56:09,889 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:56:09,889 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:56:09,889 - ConvMgr_User5 - INFO - Loading session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:09,889 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:56:09,889 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:56:09,890 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:56:09,895 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:09,901 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e6f411ca-44fe-44dd-bddc-fab2dca0d254', 'timestamp': '2025-04-25T01:56:09.895729', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:09.890905"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:09,904 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:09,904 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:09,906 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 01:56:09,906 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:56:09,908 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:56:09,909 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:56:09,909 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:09,909 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:56:09,909 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 01:56:09,909 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:09,910 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:09,910 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:09,910 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:56:09,911 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:09,911 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:10,912 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:10,918 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:10,922 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e485fbd0-27ec-4642-b57f-cde1730fb3d9', 'timestamp': '2025-04-25T01:56:10.918442', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:10.913262"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:10,925 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:10,925 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:10,927 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:10,927 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:56:10,927 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 01:56:10,927 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:10,928 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:10,928 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:10,928 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:56:10,930 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:10,931 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:11,934 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:11,944 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:11,950 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_de326642-c60b-4cd6-97bd-f0571c5974b9', 'timestamp': '2025-04-25T01:56:11.945578', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:11.936459"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:11,954 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:11,954 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:11,955 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:11,955 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:56:11,956 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 01:56:11,956 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:11,956 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:11,956 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:11,956 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:56:11,958 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:11,958 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:11,975 - CtxMemMgr_User5 - INFO - Loading session 3a091dea-1f11-49d1-8455-c5b294a4ecca for processing assistant message
2025-04-25 01:56:11,975 - CtxMemMgr_User5 - INFO - Loading session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca from /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:11,975 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json not found. Initializing empty context for new session 3a091dea-1f11-49d1-8455-c5b294a4ecca.
2025-04-25 01:56:11,975 - CtxMemMgr_User5 - INFO - Stored turn bce2fd73-6b38-4f87-a041-98048fdf0641 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:11,975 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:11,976 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:11,976 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~15 / 30000
2025-04-25 01:56:11,976 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:11,978 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:11,978 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:11,978 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:11,978 - CtxMemMgr_User5 - INFO - Stored turn 2d18b59d-2fe6-4dda-a4bb-e57595614b37 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:11,978 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:11,979 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:11,979 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~30 / 30000
2025-04-25 01:56:11,979 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:11,980 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:11,980 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:11,980 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:12,964 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:12,975 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:12,981 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7468c318-e400-411a-b5a6-92f051ef2eeb', 'timestamp': '2025-04-25T01:56:12.976141', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:12.965362"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:12,986 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:12,987 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:12,988 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 01:56:12,988 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:56:12,990 - CtxMemMgr_User5 - INFO - Stored turn 5616a676-22bd-4705-8889-a90be9cac3d4 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:12,991 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:12,992 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:56:12,993 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:12,993 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~49 / 30000
2025-04-25 01:56:12,993 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:12,994 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:56:12,994 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:12,994 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 01:56:12,994 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:12,994 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:12,995 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:12,995 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:12,995 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:12,996 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:12,996 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:12,996 - CtxMemMgr_User5 - INFO - Stored turn b395655a-c8b6-4b41-a156-c0ee64a46af2 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:12,997 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:12,997 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:12,997 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:12,997 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~68 / 30000
2025-04-25 01:56:12,999 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:13,000 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:13,000 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:13,000 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:13,992 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:13,998 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:14,003 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_99afc23b-1b9f-492d-9edf-efa523a80bf0', 'timestamp': '2025-04-25T01:56:13.998850', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:13.993020"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:14,007 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:14,007 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:14,008 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:14,009 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 01:56:14,009 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:14,009 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:14,009 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:14,011 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:14,011 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:14,030 - CtxMemMgr_User5 - INFO - Stored turn 2365e145-320f-417e-89ec-43c4bc864221 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:14,030 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:14,030 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:14,030 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~87 / 30000
2025-04-25 01:56:14,031 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:14,033 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:14,033 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:14,033 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:14,033 - CtxMemMgr_User5 - INFO - Stored turn 13a126b5-bdd5-4686-99f7-5a662333b841 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:14,034 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:14,034 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:14,034 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~106 / 30000
2025-04-25 01:56:14,034 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:14,036 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:14,036 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:14,036 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:15,014 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:15,021 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:15,025 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c0ce65d0-6e6f-4823-827d-3604b44b80ff', 'timestamp': '2025-04-25T01:56:15.021534', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:15.015641"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:15,029 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:15,029 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:15,030 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:15,030 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 01:56:15,030 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:15,030 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:15,030 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:15,032 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:15,032 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:15,257 - CtxMemMgr_User5 - INFO - Stored turn c8cdafbf-3104-4358-ae6a-0827bb8d299b for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:15,258 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:15,258 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:15,258 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~122 / 30000
2025-04-25 01:56:15,259 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:15,262 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:15,262 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:15,263 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:15,263 - CtxMemMgr_User5 - INFO - Stored turn 914850ed-2326-4fad-9ae7-ecdcfd75fa23 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:15,263 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:15,264 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:15,264 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~138 / 30000
2025-04-25 01:56:15,264 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:15,266 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:15,267 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:15,267 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:16,036 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:16,040 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:16,045 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_53161d0d-1693-43e7-821a-19dff6788447', 'timestamp': '2025-04-25T01:56:16.041294', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:16.036780"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:16,047 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:16,047 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:16,048 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:16,048 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 01:56:16,048 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:16,048 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:16,048 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:16,049 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:16,049 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:16,451 - CtxMemMgr_User5 - INFO - Stored turn 9afb8a46-6e09-4adb-b65d-bb9802dbd5dc for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:16,452 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:16,452 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:16,453 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~158 / 30000
2025-04-25 01:56:16,453 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:16,457 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:16,457 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:16,458 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:16,458 - CtxMemMgr_User5 - INFO - Stored turn 5e059f23-2716-4887-94e3-76bffad75a9b for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:16,458 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:16,459 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:16,459 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~178 / 30000
2025-04-25 01:56:16,459 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:16,462 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:16,462 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:16,463 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:17,051 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:17,058 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:17,063 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_847d1bf5-654c-4e69-a1ef-8dd77fbd3423', 'timestamp': '2025-04-25T01:56:17.059009', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:17.053127"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:17,067 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:17,067 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:17,068 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:17,068 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 01:56:17,069 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:17,069 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:17,069 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:17,071 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:17,071 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:17,248 - CtxMemMgr_User5 - INFO - Stored turn 87a8dafb-14c4-4fd6-ad75-6ee7e2a396fd for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:17,249 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:17,250 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:17,250 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~197 / 30000
2025-04-25 01:56:17,251 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:17,254 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:17,255 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:17,255 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:17,256 - CtxMemMgr_User5 - INFO - Stored turn 63f609b4-cf7b-46c3-a220-50a7c190d862 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:17,256 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:17,256 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:17,257 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~216 / 30000
2025-04-25 01:56:17,257 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:17,259 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:17,260 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:17,260 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:18,073 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:18,079 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:18,085 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_3fceeda2-8d50-4de3-9b62-2b8dea3f8a9e', 'timestamp': '2025-04-25T01:56:18.079854', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:18.074438"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:18,089 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:18,089 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:18,090 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:18,091 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 01:56:18,091 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:18,091 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:18,091 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:18,093 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:18,093 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:18,361 - CtxMemMgr_User5 - INFO - Stored turn 4552da71-3694-4470-940d-8ccdb632875e for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:18,361 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:18,362 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:18,362 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~235 / 30000
2025-04-25 01:56:18,363 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:18,365 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:18,365 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:18,366 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:18,366 - CtxMemMgr_User5 - INFO - Stored turn b6ee66a1-d33f-44c5-b868-5c2227fdd434 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:18,366 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:18,366 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:18,366 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~254 / 30000
2025-04-25 01:56:18,366 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:18,368 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:18,368 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:18,369 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:19,095 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:19,101 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:19,105 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_db198176-64d7-4594-afc5-cfc975a76aa1', 'timestamp': '2025-04-25T01:56:19.101799', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:19.096264"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:19,109 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:19,110 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:19,111 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:19,111 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 01:56:19,111 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:19,111 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:19,112 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:19,113 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:19,114 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:19,310 - CtxMemMgr_User5 - INFO - Stored turn 315fe99f-f0d6-4793-96b3-b865c4ca3d93 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:19,310 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:19,311 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:19,311 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~271 / 30000
2025-04-25 01:56:19,311 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:19,314 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:19,315 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:19,315 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:19,315 - CtxMemMgr_User5 - INFO - Stored turn 7d2f5727-d972-4b15-8a73-6116a2941d62 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:19,315 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:19,316 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:19,316 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~288 / 30000
2025-04-25 01:56:19,316 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:19,318 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:19,318 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:19,318 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:20,116 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:20,125 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:20,132 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5f5fe6fe-ba13-4f50-83f2-a9cbaf9bd3cb', 'timestamp': '2025-04-25T01:56:20.125750', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:20.118362"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:20,137 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:20,138 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:20,139 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:20,139 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 01:56:20,139 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:20,139 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:20,140 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:20,142 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:20,142 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:20,210 - CtxMemMgr_User5 - INFO - Stored turn e4249954-11ae-494c-9098-f8fe70ba0061 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:20,210 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:20,211 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:20,211 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~302 / 30000
2025-04-25 01:56:20,211 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:20,214 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:20,214 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:20,215 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:20,215 - CtxMemMgr_User5 - INFO - Stored turn 08d5ca0e-ae3f-4e29-9d8c-8e3ebe5798f7 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:20,215 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:20,215 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:20,215 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~316 / 30000
2025-04-25 01:56:20,216 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:20,218 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:20,218 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:20,219 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:21,143 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:21,153 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:21,160 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d453bcda-2029-40fb-8e0f-fb392e8efe7d', 'timestamp': '2025-04-25T01:56:21.154479', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:21.145338"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:21,164 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:21,164 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:21,165 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:21,166 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 01:56:21,166 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:21,166 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:21,166 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:21,168 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:21,168 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:21,295 - CtxMemMgr_User5 - INFO - Stored turn ac74a42f-13d0-4547-a805-66385efd1c81 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:21,296 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:21,296 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:21,296 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~336 / 30000
2025-04-25 01:56:21,297 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:21,302 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:21,302 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:21,303 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:21,303 - CtxMemMgr_User5 - INFO - Stored turn 6de6294e-619d-4e15-813f-f8ab875bcdd0 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:21,303 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:21,303 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:21,304 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~356 / 30000
2025-04-25 01:56:21,304 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:21,306 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:21,307 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:21,307 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:22,170 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:22,178 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:22,186 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cb0d3547-987b-4cb4-b055-fdf2bf1542f5', 'timestamp': '2025-04-25T01:56:22.178917', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:22.171724"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:22,192 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:22,192 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:22,193 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:22,194 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 01:56:22,194 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:22,194 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:22,194 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:22,198 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:22,198 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:23,200 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:23,210 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:23,218 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4892e567-13ee-41d5-b18d-47d1eadffcec', 'timestamp': '2025-04-25T01:56:23.211293', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:23.201940"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:23,223 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:23,223 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:23,224 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:23,225 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are the benefits of meditation?'
2025-04-25 01:56:23,225 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:23,225 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:23,225 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:23,227 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:23,228 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:24,149 - CtxMemMgr_User5 - INFO - Stored turn fb7fa527-b6a8-4950-9669-906ac0427734 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:24,149 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:24,150 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:24,150 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~365 / 30000
2025-04-25 01:56:24,151 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:24,157 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:24,157 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:24,158 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:24,159 - CtxMemMgr_User5 - INFO - Stored turn 22521c07-dfd4-4518-b8bc-42c7fa1a305a for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:24,159 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:24,159 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:24,159 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~374 / 30000
2025-04-25 01:56:24,160 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:24,162 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:24,163 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:24,163 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:24,232 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:24,241 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:24,250 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7ce10df9-8c28-4c64-88d1-64834163a307', 'timestamp': '2025-04-25T01:56:24.242353', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:24.235106"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:24,257 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:24,257 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:24,258 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:24,259 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the Renaissance period in Europe.'
2025-04-25 01:56:24,259 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:24,259 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:24,259 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:24,261 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:24,261 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:25,261 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:25,267 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:25,272 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cb538919-644d-49d9-8344-a529e1676de6', 'timestamp': '2025-04-25T01:56:25.268027', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:25.262502"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:25,276 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:25,276 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:25,277 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:25,277 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does machine learning work?'
2025-04-25 01:56:25,277 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:25,278 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:25,278 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:25,279 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:25,280 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:25,361 - CtxMemMgr_User5 - INFO - Stored turn a7879b2a-8d4f-4e6c-928b-9a807dc3d6f3 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,361 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:25,362 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:25,362 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~388 / 30000
2025-04-25 01:56:25,362 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:25,369 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,369 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:25,370 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:25,370 - CtxMemMgr_User5 - INFO - Stored turn 9ca08270-abc4-416f-987b-dc08c69acc16 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,370 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:25,370 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:25,371 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~402 / 30000
2025-04-25 01:56:25,371 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:25,376 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,377 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:25,377 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:25,496 - CtxMemMgr_User5 - INFO - Stored turn d146f909-cb98-42db-8dc9-c94719ca2cab for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,497 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:25,497 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:25,498 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~409 / 30000
2025-04-25 01:56:25,498 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:25,504 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,504 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:25,505 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:25,505 - CtxMemMgr_User5 - INFO - Stored turn ab7e367a-bae2-4b06-8b9e-e80bebd35086 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,505 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:25,505 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:25,506 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~416 / 30000
2025-04-25 01:56:25,506 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:25,509 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:25,510 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:25,511 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:26,290 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:26,299 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:26,308 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_985ffa88-d616-4542-a971-ca09f4ee4f84', 'timestamp': '2025-04-25T01:56:26.300741', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:26.291796"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:26,313 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:26,313 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:26,314 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:26,315 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a good novel?'
2025-04-25 01:56:26,316 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:26,316 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:26,317 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:26,318 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:26,318 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:26,902 - CtxMemMgr_User5 - INFO - Stored turn 47121ea1-a505-44e6-a9bc-3209f6c7c2c4 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:26,903 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:26,904 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:26,905 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~425 / 30000
2025-04-25 01:56:26,906 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:26,913 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:26,914 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:26,915 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:26,918 - CtxMemMgr_User5 - INFO - Stored turn 454f8db4-882d-4e68-b038-7e508a1a8b39 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:26,919 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:26,922 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:26,922 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~434 / 30000
2025-04-25 01:56:26,922 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:26,929 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:26,929 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:26,930 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:27,323 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:27,334 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:27,339 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0f88c840-2d3e-4c32-bee5-75ef51aaaa52', 'timestamp': '2025-04-25T01:56:27.334919', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:27.326804"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:27,344 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:27,344 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:27,346 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:27,346 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the concept of black holes.'
2025-04-25 01:56:27,346 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:27,346 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:27,347 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:27,349 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:27,350 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:28,355 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:28,365 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:28,372 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e680106e-f5a5-400a-bec3-b89b0e2f1345', 'timestamp': '2025-04-25T01:56:28.365795', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:28.357848"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:28,377 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:28,377 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:28,379 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:28,379 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some sustainable living practices?'
2025-04-25 01:56:28,380 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:28,380 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:28,380 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:28,384 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:28,384 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:28,959 - CtxMemMgr_User5 - INFO - Stored turn 2f88c80a-e0c9-4084-b14b-19d8c77e46e6 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:28,959 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:28,960 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:28,960 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~441 / 30000
2025-04-25 01:56:28,961 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:28,969 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:28,970 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:28,971 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:28,971 - CtxMemMgr_User5 - INFO - Stored turn c9757473-288c-4b2b-a561-d1b35ac8d574 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:28,971 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:28,972 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:28,972 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~448 / 30000
2025-04-25 01:56:28,972 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:28,978 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:28,979 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:28,980 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:29,354 - CtxMemMgr_User5 - INFO - Stored turn 7b654a75-d3ee-46aa-b828-0ea97b6e0bfd for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:29,354 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:29,355 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:29,355 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~459 / 30000
2025-04-25 01:56:29,356 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:29,363 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:29,364 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:29,365 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:29,365 - CtxMemMgr_User5 - INFO - Stored turn 91c2dc9d-a1ea-4e22-9eb8-3ce04273b15a for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:29,365 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:29,366 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:29,366 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~470 / 30000
2025-04-25 01:56:29,366 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:29,373 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:29,374 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:29,374 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:29,387 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:29,394 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:29,399 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ab7f860c-6e5c-4f31-bff0-768c5938f0ab', 'timestamp': '2025-04-25T01:56:29.394827', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:29.388812"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:29,401 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:29,402 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:29,402 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:29,402 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do vaccines work?'
2025-04-25 01:56:29,402 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:29,403 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:29,403 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:29,404 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:29,404 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:30,420 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:30,430 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:30,436 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1aac342b-b3cf-4b4d-8811-804c0a5338dd', 'timestamp': '2025-04-25T01:56:30.431150', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:30.422385"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:30,441 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:30,441 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:30,442 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:30,443 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my favorite animal was?'
2025-04-25 01:56:30,443 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:30,443 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:30,443 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:30,445 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:30,445 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:30,707 - CtxMemMgr_User5 - INFO - Stored turn df8d4393-6b46-4a27-a229-6c75ce34e550 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:30,708 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:30,708 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:30,708 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~476 / 30000
2025-04-25 01:56:30,709 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:30,716 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:30,716 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:30,717 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:30,718 - CtxMemMgr_User5 - INFO - Stored turn 7d74bc11-5b33-4aa0-a2ea-31ec49c92992 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:30,718 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:30,718 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:30,718 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~482 / 30000
2025-04-25 01:56:30,719 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:30,724 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:30,724 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:30,725 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:31,019 - CtxMemMgr_User5 - INFO - Stored turn 7dccf24e-1ca7-4db5-8b73-733c2ab53464 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:31,020 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:31,020 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:31,020 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~490 / 30000
2025-04-25 01:56:31,020 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:31,027 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:31,027 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:31,028 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:31,028 - CtxMemMgr_User5 - INFO - Stored turn 2d833659-23a3-462a-8002-dfd6a77eaeec for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:31,028 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:31,029 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:31,029 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~498 / 30000
2025-04-25 01:56:31,029 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:31,036 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:31,036 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:31,037 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:31,446 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:31,455 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:31,461 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_24b150b3-dc2e-445a-9d1a-a087cd13487a', 'timestamp': '2025-04-25T01:56:31.455764', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:31.448084"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:31,466 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:31,466 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:31,468 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:31,469 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 01:56:31,469 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:31,469 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:31,469 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:31,471 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:31,472 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:32,471 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:32,480 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:32,487 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_da71353e-9363-4da9-a6fd-fd94a392597b', 'timestamp': '2025-04-25T01:56:32.481115', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:32.473492"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:32,491 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:32,492 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:32,493 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:32,493 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 01:56:32,493 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:32,493 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:32,494 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:32,496 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:32,496 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:32,576 - CtxMemMgr_User5 - INFO - Stored turn f4128158-b74b-4745-ba36-2882d4f398c8 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,576 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:32,577 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:32,577 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~503 / 30000
2025-04-25 01:56:32,577 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:32,588 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,591 - CtxMemMgr_User5 - INFO - Stored turn 013809cf-5fca-4d13-9853-c21f3d31dcda for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,591 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:32,592 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:32,593 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:32,593 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:32,594 - CtxMemMgr_User5 - INFO - Stored turn 1e8770ba-e427-4cbf-a2e3-b3886fbb7c07 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,594 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~518 / 30000
2025-04-25 01:56:32,594 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:32,594 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:32,595 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:32,595 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~518 / 30000
2025-04-25 01:56:32,595 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:32,602 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,602 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:32,602 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,602 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca).
2025-04-25 01:56:32,603 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:32,603 - CtxMemMgr_User5 - INFO - Stored turn c0e263ce-33bd-4b69-993c-235734ad7154 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,603 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:57:00Z",
    "speaker": "User...
2025-04-25 01:56:32,604 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:32,604 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:32,604 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~528 / 30000
2025-04-25 01:56:32,604 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:32,607 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:32,607 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:56:32,607 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:56:33,249 - CtxMemMgr_User5 - INFO - Stored turn e4c4d4b3-31f2-41b5-8975-f01d728b97e0 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,250 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:33,250 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:33,251 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~539 / 30000
2025-04-25 01:56:33,252 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:33,260 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,260 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:33,261 - ActionHandler_User5 - INFO - Episodic search detected for query: favorite animal (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:33,261 - EpisodicMemMgr_User5 - INFO - search_episodic_memory called with query: 'favorite animal', session_id: 3a091dea-1f11-49d1-8455-c5b294a4ecca, top_k: 5, search_depth: 0
2025-04-25 01:56:33,261 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'favorite animal'
2025-04-25 01:56:33,261 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:33,261 - ActionHandler_User5 - INFO - No episodic memory results found for query: favorite animal
2025-04-25 01:56:33,494 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:33,502 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:33,507 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_69a62020-b6ec-41bb-9363-45645d9db0bf', 'timestamp': '2025-04-25T01:56:33.502768', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:33.496110"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:33,511 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:33,511 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:33,512 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:33,512 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 01:56:33,513 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:33,513 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:33,513 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:33,515 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:33,515 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:33,696 - CtxMemMgr_User5 - INFO - Stored turn 5bf3bddc-43e0-4843-a625-d6c1f4611d61 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,696 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:33,696 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:33,697 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~550 / 30000
2025-04-25 01:56:33,697 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:33,707 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,707 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:33,708 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:33,708 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:33,708 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:56:33,708 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:56:33,709 - managers.memory.request_parser - WARNING - Message all not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,710 - managers.memory.request_parser - WARNING - Message all not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,711 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:33,711 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:56:33,711 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:56:33,711 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:56:33,711 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,711 - CtxMemMgr_User5 - INFO - Stored turn 029634fb-8311-4c8e-b628-909d53c6b722 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:33,711 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:33,711 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:33,712 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~561 / 30000
2025-04-25 01:56:33,712 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:33,715 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,517 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:34,526 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:34,533 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_71ca384e-5871-4062-a4c1-05c52d28c6e1', 'timestamp': '2025-04-25T01:56:34.527155', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:34.519199"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:34,537 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:34,537 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:34,538 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:34,538 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 01:56:34,539 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:34,539 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:34,539 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:34,541 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:34,541 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:34,675 - CtxMemMgr_User5 - INFO - Stored turn c731b344-c0db-4232-acf9-63dbffa1eea9 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,676 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:34,676 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:34,677 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~572 / 30000
2025-04-25 01:56:34,677 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:34,687 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,687 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:34,688 - ActionHandler_User5 - INFO - Tier request detected: [('2', '1'), ('3', '1'), ('3', '1')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:34,688 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:34,689 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 1
2025-04-25 01:56:34,689 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 1
2025-04-25 01:56:34,689 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 1
2025-04-25 01:56:34,692 - managers.memory.request_parser - WARNING - Message 1 not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,694 - managers.memory.request_parser - WARNING - Message 1 not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,695 - managers.memory.request_parser - WARNING - Message 1 not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,696 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:34,696 - managers.memory.request_parser - INFO - Found 3 tier requests, will regenerate response
2025-04-25 01:56:34,696 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,697 - CtxMemMgr_User5 - INFO - Stored turn a4a89ee3-f919-4144-8848-76d736dd9467 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:34,697 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:34,697 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:34,697 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~583 / 30000
2025-04-25 01:56:34,697 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:34,703 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:35,541 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:35,545 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:35,550 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c3b3baae-62dc-4150-92da-8a2db5f7c880', 'timestamp': '2025-04-25T01:56:35.546217', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:35.541987"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:35,554 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:35,554 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:35,555 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:35,555 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 01:56:35,555 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:35,555 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:35,556 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:35,557 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:35,557 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:35,653 - CtxMemMgr_User5 - INFO - Stored turn b06cd9aa-260f-4fca-a4a0-cc75416237c4 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:35,654 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:35,654 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:35,654 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~590 / 30000
2025-04-25 01:56:35,655 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:35,661 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:35,662 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:35,662 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:35,662 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:35,662 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:56:35,663 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:56:35,665 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:35,667 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:35,668 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:35,669 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:56:35,669 - managers.memory.request_parser - INFO - Found episodic memory request: college studies
2025-04-25 01:56:35,670 - managers.memory.request_parser - INFO - Found episodic memory request: college studies
2025-04-25 01:56:35,670 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:35,670 - CtxMemMgr_User5 - INFO - Stored turn 12489f5a-951d-4c8b-b37d-732fb1c60806 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:35,670 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:35,670 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:35,671 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~597 / 30000
2025-04-25 01:56:35,671 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:35,675 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:36,563 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:36,574 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:36,581 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e0084c1c-d7c2-43cb-8330-0f947d22e36e', 'timestamp': '2025-04-25T01:56:36.575580', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:36.565807"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:36,587 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:36,587 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:36,588 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:36,589 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 01:56:36,589 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:36,589 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:36,590 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:36,593 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:36,593 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:36,738 - CtxMemMgr_User5 - INFO - Stored turn 70852853-131f-487c-91cd-1cb49869e3c2 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:36,739 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:36,739 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:36,739 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~602 / 30000
2025-04-25 01:56:36,740 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:36,748 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:36,749 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:36,749 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:36,750 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:36,750 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:56:36,750 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:56:36,753 - managers.memory.request_parser - WARNING - Message all not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:36,756 - managers.memory.request_parser - WARNING - Message all not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:36,757 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:36,757 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:56:36,757 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:56:36,757 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:56:36,758 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:36,758 - CtxMemMgr_User5 - INFO - Stored turn 4db5e62f-b375-41d0-bc9a-1d2b993d64c3 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:36,758 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:36,758 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:36,758 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~607 / 30000
2025-04-25 01:56:36,759 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:36,764 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:37,593 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:37,601 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:37,605 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b1be5a40-7c9d-453a-a620-cfbac75531db', 'timestamp': '2025-04-25T01:56:37.601507', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:37.594095"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:37,609 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:37,609 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:37,610 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:37,610 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 01:56:37,610 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:37,611 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:37,611 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:37,613 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:37,613 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:37,646 - CtxMemMgr_User5 - INFO - Stored turn bf75dbe9-91e4-4246-878e-918020327841 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:37,646 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:37,646 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:37,646 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~615 / 30000
2025-04-25 01:56:37,647 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:37,654 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:37,654 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:37,655 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:37,655 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:37,655 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:56:37,655 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:56:37,656 - managers.memory.request_parser - WARNING - Message all not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:37,657 - managers.memory.request_parser - WARNING - Message all not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:37,657 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:37,657 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:56:37,657 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:56:37,657 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:56:37,657 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:37,657 - CtxMemMgr_User5 - INFO - Stored turn 67afb55e-af52-4196-a8a2-ce3104a4740c for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:37,658 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:37,658 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:37,658 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~623 / 30000
2025-04-25 01:56:37,658 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:37,660 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:38,611 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:38,616 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:38,621 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2037b2f7-4d90-404f-8b77-0bef3317f3fd', 'timestamp': '2025-04-25T01:56:38.616605', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:38.611926"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:38,624 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:38,625 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:38,626 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:38,626 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 01:56:38,626 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:38,626 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:38,626 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:38,628 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:38,628 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:39,208 - CtxMemMgr_User5 - INFO - Stored turn ebf3e5f9-f3e6-4dd7-8c12-a9a187a19314 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,209 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:39,209 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:39,209 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~631 / 30000
2025-04-25 01:56:39,209 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:39,212 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,212 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:39,213 - ActionHandler_User5 - INFO - Tier request detected: [('2', '0'), ('3', '0'), ('2', '0'), ('3', '0')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:39,213 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:39,213 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 0
2025-04-25 01:56:39,213 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 0
2025-04-25 01:56:39,213 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 0
2025-04-25 01:56:39,213 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 0
2025-04-25 01:56:39,214 - managers.memory.request_parser - WARNING - Message 0 not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,215 - managers.memory.request_parser - WARNING - Message 0 not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,215 - managers.memory.request_parser - WARNING - Message 0 not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,216 - managers.memory.request_parser - WARNING - Message 0 not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,216 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:39,216 - managers.memory.request_parser - INFO - Found 4 tier requests, will regenerate response
2025-04-25 01:56:39,216 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:56:39,216 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:56:39,216 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,216 - CtxMemMgr_User5 - INFO - Stored turn 4292f20d-88ad-4036-8aae-d66e6768c952 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,216 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:39,216 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:39,216 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~639 / 30000
2025-04-25 01:56:39,216 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:39,219 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,631 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:39,637 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:56:39,642 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7804cca1-17ef-431c-9e7e-127c3d5832a5', 'timestamp': '2025-04-25T01:56:39.637565', 'session_id': '3a091dea-1f11-49d1-8455-c5b294a4ecca', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:56:39.632285"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:56:39,646 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:39,646 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:56:39,647 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 01:56:39,647 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:56:39,649 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:56:39,650 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:56:39,650 - components.prompt_builder - INFO - Constructing prompt for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5, depth 0
2025-04-25 01:56:39,651 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 01:56:39,651 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:56:39,651 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:56:39,651 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:56:39,653 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:56:39,653 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:56:39,834 - CtxMemMgr_User5 - INFO - Stored turn 21fff2d4-a434-4a18-9ca9-b6859c64ad60 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,834 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:39,835 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:39,836 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~647 / 30000
2025-04-25 01:56:39,837 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:39,849 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,849 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:39,850 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:39,850 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:39,851 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:56:39,852 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:56:39,854 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,856 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,856 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:39,857 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:56:39,857 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:56:39,857 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:56:39,858 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,858 - CtxMemMgr_User5 - INFO - Stored turn 015358a3-2c24-4659-b979-cb35e8c423da for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:39,858 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:39,858 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:39,859 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~655 / 30000
2025-04-25 01:56:39,859 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:39,864 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,934 - CtxMemMgr_User5 - INFO - Stored turn bdde2abc-acde-4e3a-bbb9-419b5c915023 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,935 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:40,935 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:40,935 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~663 / 30000
2025-04-25 01:56:40,936 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:40,942 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,942 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:40,943 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id'), ('2', 'message_id'), ('3', 'message_id')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:40,943 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:40,943 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:56:40,944 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:56:40,944 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:56:40,944 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:56:40,947 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,950 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,951 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,953 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,954 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:40,954 - managers.memory.request_parser - INFO - Found 4 tier requests, will regenerate response
2025-04-25 01:56:40,954 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:56:40,954 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:56:40,954 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,954 - CtxMemMgr_User5 - INFO - Stored turn bfefee9b-9982-47cc-beb4-6ffded4059de for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:40,955 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:40,955 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:40,955 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~671 / 30000
2025-04-25 01:56:40,955 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:40,961 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:41,615 - CtxMemMgr_User5 - INFO - Stored turn f63c00b8-7a46-48c6-b0bc-e73ed0c58ff4 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:41,616 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:41,616 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:41,616 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~680 / 30000
2025-04-25 01:56:41,617 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:41,626 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:41,626 - ActionHandler_User5 - INFO - Processing LLM response for session 3a091dea-1f11-49d1-8455-c5b294a4ecca, user 5
2025-04-25 01:56:41,627 - ActionHandler_User5 - INFO - Tier request detected: [('3', 'message_id')] (Session: 3a091dea-1f11-49d1-8455-c5b294a4ecca)
2025-04-25 01:56:41,627 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:56:41,627 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:56:41,631 - managers.memory.request_parser - WARNING - Message message_id not found in session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:41,633 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:56:41,634 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:56:41,634 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:56:41,634 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:56:41,634 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:41,634 - CtxMemMgr_User5 - INFO - Stored turn c1754698-75b3-4fd0-bf42-4c117855bbb3 for active session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:56:41,634 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 3a091dea-1f11-49d1-8455-c5b294a4ecca: '...'
2025-04-25 01:56:41,635 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:56:41,635 - CtxMemMgr_User5 - INFO - Session 3a091dea-1f11-49d1-8455-c5b294a4ecca: Active history token count ~689 / 30000
2025-04-25 01:56:41,635 - CtxMemMgr_User5 - INFO - Saving active session context for 3a091dea-1f11-49d1-8455-c5b294a4ecca to /app/data/sessions/5/3a091dea-1f11-49d1-8455-c5b294a4ecca/context.json
2025-04-25 01:56:41,641 - CtxMemMgr_User5 - INFO - Successfully saved context for session 3a091dea-1f11-49d1-8455-c5b294a4ecca
2025-04-25 01:57:28,099 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:28,100 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:28,101 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 01:57:28,101 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 01:57:28,101 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 01:57:28,104 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:28,106 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 01:57:28,106 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 01:57:28,106 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 01:57:28,107 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 01:57:28,107 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:57:28,107 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 01:57:28,107 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 01:57:28,107 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 01:57:28,107 - ConvMgr_User5 - INFO - Loading session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:28,108 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 01:57:28,108 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:57:28,108 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 01:57:28,114 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:28,118 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_017ff79a-96e0-42d7-8df3-a6df0a4f84ec', 'timestamp': '2025-04-25T01:57:28.114695', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:28.108848"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:28,122 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:28,122 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:28,123 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 01:57:28,123 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:57:28,126 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:57:28,126 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:57:28,127 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:28,127 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 01:57:28,127 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 01:57:28,127 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:28,127 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:28,127 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:28,128 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 01:57:28,129 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:28,130 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:30,125 - CtxMemMgr_User5 - INFO - Loading session ffceb89b-29a0-4b78-878b-99c64038eb8f for processing assistant message
2025-04-25 01:57:30,125 - CtxMemMgr_User5 - INFO - Loading session context for ffceb89b-29a0-4b78-878b-99c64038eb8f from /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:30,126 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json not found. Initializing empty context for new session ffceb89b-29a0-4b78-878b-99c64038eb8f.
2025-04-25 01:57:30,126 - CtxMemMgr_User5 - INFO - Stored turn d740b9cc-a9e6-44bb-9d3e-7b2beb5c79a1 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:30,126 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:30,127 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:30,127 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~15 / 30000
2025-04-25 01:57:30,127 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:30,130 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:30,130 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:30,131 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:30,131 - CtxMemMgr_User5 - INFO - Stored turn 21b8f998-6819-4a82-baba-d74ebfa4f13c for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:30,132 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:30,132 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:30,132 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~30 / 30000
2025-04-25 01:57:30,133 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:30,135 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:30,135 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:30,135 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:31,144 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:31,153 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:31,161 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_14f8b12e-81d1-4548-919a-3452124a012c', 'timestamp': '2025-04-25T01:57:31.154538', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:31.146178"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:31,167 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:31,168 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:31,169 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:31,169 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 01:57:31,170 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:31,170 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:31,171 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:31,175 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:31,175 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:33,549 - CtxMemMgr_User5 - INFO - Stored turn 200589b7-8eab-4f89-ad4f-75f68c45ea1e for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:33,550 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:33,551 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:33,551 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~49 / 30000
2025-04-25 01:57:33,552 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:33,554 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:33,554 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:33,555 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:33,555 - CtxMemMgr_User5 - INFO - Stored turn b283bea9-2916-40c1-8004-036aebb33c44 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:33,555 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:33,556 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:33,556 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~68 / 30000
2025-04-25 01:57:33,557 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:33,558 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:33,558 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:33,558 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:34,565 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:34,572 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:34,578 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7931d018-eaf5-4bba-8844-54bee067942a', 'timestamp': '2025-04-25T01:57:34.572600', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:34.566929"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:34,583 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:34,583 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:34,584 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:34,584 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 01:57:34,585 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:34,585 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:34,585 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:34,587 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:34,587 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:36,756 - CtxMemMgr_User5 - INFO - Stored turn 992427a7-33cb-43d6-bdfa-a2d7626d3dbc for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:36,757 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:36,757 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:36,758 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~87 / 30000
2025-04-25 01:57:36,758 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:36,761 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:36,761 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:36,762 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:36,762 - CtxMemMgr_User5 - INFO - Stored turn 4b990bbc-7ef1-47cc-9f89-38559d273cd4 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:36,762 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:36,763 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:36,763 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~106 / 30000
2025-04-25 01:57:36,763 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:36,764 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:36,765 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:36,765 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:37,771 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:37,779 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:37,783 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_58d27474-6ffc-46d3-8d40-33f62595353b', 'timestamp': '2025-04-25T01:57:37.779326', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:37.772172"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:37,786 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:37,786 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:37,787 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 01:57:37,787 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:57:37,789 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:57:37,790 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:57:37,790 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:37,790 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 01:57:37,790 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:37,790 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:37,791 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:37,792 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:37,792 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:40,110 - CtxMemMgr_User5 - INFO - Stored turn 3feb04da-c181-40f9-b3e5-e616f6744075 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:40,110 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:40,111 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:40,111 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~122 / 30000
2025-04-25 01:57:40,112 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:40,115 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:40,116 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:40,116 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:40,117 - CtxMemMgr_User5 - INFO - Stored turn 0d7639b6-80a1-49ff-9954-8d703b279cfa for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:40,117 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:40,117 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:40,117 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~138 / 30000
2025-04-25 01:57:40,118 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:40,119 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:40,120 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:40,120 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:41,132 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:41,139 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:41,146 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_404aa17c-7a2b-4257-bd69-0c4486a6f495', 'timestamp': '2025-04-25T01:57:41.139768', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:41.133214"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:41,150 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:41,150 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:41,151 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:41,151 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 01:57:41,151 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:41,151 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:41,151 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:41,153 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:41,153 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:43,338 - CtxMemMgr_User5 - INFO - Stored turn 1cb1a601-9332-4a39-86bd-477c1f614b17 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:43,338 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:43,338 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:43,339 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~158 / 30000
2025-04-25 01:57:43,339 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:43,341 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:43,341 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:43,342 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:43,342 - CtxMemMgr_User5 - INFO - Stored turn 39606ae8-70ae-470c-830f-3593466e64d1 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:43,342 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:43,343 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:43,343 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~178 / 30000
2025-04-25 01:57:43,344 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:43,346 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:43,346 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:43,346 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:44,354 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:44,363 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:44,369 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e511c3ef-8097-4e14-ac96-5439222c5755', 'timestamp': '2025-04-25T01:57:44.363690', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:44.356127"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:44,373 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:44,373 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:44,374 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:44,375 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 01:57:44,375 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:44,375 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:44,375 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:44,378 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:44,378 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:46,553 - CtxMemMgr_User5 - INFO - Stored turn 74d8560f-6087-4c4b-b57d-b87fc65d463e for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:46,554 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:46,554 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:46,555 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~197 / 30000
2025-04-25 01:57:46,555 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:46,559 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:46,560 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:46,560 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:46,561 - CtxMemMgr_User5 - INFO - Stored turn ef3785e9-6e49-49ef-b369-f7103c164359 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:46,561 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:46,561 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:46,562 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~216 / 30000
2025-04-25 01:57:46,562 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:46,564 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:46,565 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:46,565 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:47,572 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:47,580 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:47,585 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c13e702f-a3b3-44c1-bac9-c990b85af720', 'timestamp': '2025-04-25T01:57:47.580510', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:47.573370"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:47,590 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:47,590 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:47,592 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:47,592 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 01:57:47,594 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:47,594 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:47,594 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:47,597 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:47,597 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:49,812 - CtxMemMgr_User5 - INFO - Stored turn dca8e6c0-1405-4516-85e6-7d43b73439ad for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:49,813 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:49,813 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:49,813 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~235 / 30000
2025-04-25 01:57:49,813 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:49,816 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:49,816 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:49,816 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:49,817 - CtxMemMgr_User5 - INFO - Stored turn cf5cc74c-6003-437e-b9fd-9287740e51ca for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:49,817 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:49,817 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:49,817 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~254 / 30000
2025-04-25 01:57:49,817 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:49,819 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:49,819 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:49,820 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:50,826 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:50,835 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:50,839 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0ab74f68-a114-455d-abcd-d267371804e2', 'timestamp': '2025-04-25T01:57:50.835741', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:50.829282"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:50,844 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:50,845 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:50,846 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:50,846 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 01:57:50,846 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:50,846 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:50,847 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:50,848 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:50,849 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:53,265 - CtxMemMgr_User5 - INFO - Stored turn 3c43d652-c96b-416b-9a6b-5575f3a85fea for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:53,265 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:53,266 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:53,266 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~271 / 30000
2025-04-25 01:57:53,266 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:53,270 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:53,270 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:53,270 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:53,271 - CtxMemMgr_User5 - INFO - Stored turn 10e14839-ab1f-49c4-8708-b2c4a80f0528 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:53,271 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:53,271 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:53,272 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~288 / 30000
2025-04-25 01:57:53,272 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:53,275 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:53,275 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:53,275 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:54,282 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:54,290 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:54,295 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e4da6d0b-9f08-41ae-a6fc-e5c993aa1778', 'timestamp': '2025-04-25T01:57:54.290858', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:54.284006"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:54,301 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:54,302 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:54,306 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:54,306 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 01:57:54,307 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:54,307 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:54,307 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:54,309 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:54,309 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:56,384 - CtxMemMgr_User5 - INFO - Stored turn 380d8807-058b-427d-b7c6-ad22b4df43cc for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:56,385 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:56,385 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:56,385 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~302 / 30000
2025-04-25 01:57:56,386 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:56,391 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:56,391 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:56,391 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:56,392 - CtxMemMgr_User5 - INFO - Stored turn 35bee341-b27c-4b73-9b17-e16cea7350db for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:56,392 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:56,393 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:56,393 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~316 / 30000
2025-04-25 01:57:56,393 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:56,396 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:56,397 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:56,398 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:57:57,410 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:57,419 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:57:57,424 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_93e95524-5f6b-41d3-a66c-200f84a3fafa', 'timestamp': '2025-04-25T01:57:57.419781', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:57:57.411259"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:57:57,428 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:57,429 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:57:57,430 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:57:57,430 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 01:57:57,430 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:57:57,430 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:57:57,431 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:57:57,432 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:57:57,432 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:57:59,556 - CtxMemMgr_User5 - INFO - Stored turn 71a2e1fb-c5dd-4338-a32b-27afaf25032b for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:59,556 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:59,557 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:59,557 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~336 / 30000
2025-04-25 01:57:59,558 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:59,562 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:59,562 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:57:59,563 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:57:59,563 - CtxMemMgr_User5 - INFO - Stored turn 95ad5e4e-d4b4-4d68-bc96-0bb53af360e5 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:59,563 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:57:59,563 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:57:59,563 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~356 / 30000
2025-04-25 01:57:59,564 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:57:59,566 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:57:59,567 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:57:59,567 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:58:00Z",
    "speaker": "User...
2025-04-25 01:58:00,571 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:00,577 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:00,581 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e2c89e25-672a-4a9d-ae79-92672031c0e8', 'timestamp': '2025-04-25T01:58:00.577494', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:00.572184"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:00,584 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:00,585 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:00,586 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:00,586 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 01:58:00,586 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:00,586 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:00,586 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:00,588 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:00,589 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:04,268 - CtxMemMgr_User5 - INFO - Stored turn c33e6bdc-1fbe-48ad-af71-84f4d7e68237 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:04,269 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:04,269 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:04,270 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~365 / 30000
2025-04-25 01:58:04,270 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:04,277 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:04,277 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:04,278 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:04,278 - CtxMemMgr_User5 - INFO - Stored turn 8a4fa394-3d85-4494-a134-b2d123dd1719 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:04,278 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:04,279 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:04,279 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~374 / 30000
2025-04-25 01:58:04,280 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:04,283 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:04,283 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:04,284 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:05,292 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:05,328 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:05,331 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5b08fbf8-6f50-4c64-8ccc-f446e2fe509c', 'timestamp': '2025-04-25T01:58:05.329017', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:05.293200"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:05,332 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:05,332 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:05,333 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:05,333 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 01:58:05,333 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:05,333 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:05,333 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:05,334 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:05,335 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:08,979 - CtxMemMgr_User5 - INFO - Stored turn d558b75e-27ad-4721-a306-ee82fa99575a for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:08,979 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:08,980 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:08,981 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~388 / 30000
2025-04-25 01:58:08,981 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:08,987 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:08,988 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:08,988 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:08,989 - CtxMemMgr_User5 - INFO - Stored turn aaaa0189-9df0-46de-8ed7-44d7b3626b55 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:08,989 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:08,990 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:08,990 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~402 / 30000
2025-04-25 01:58:08,990 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:08,994 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:08,995 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:08,996 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:10,002 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:10,007 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:10,012 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8965e321-be37-49e4-b3ad-0337f016a17b', 'timestamp': '2025-04-25T01:58:10.008019', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:10.003533"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:10,015 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:10,016 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:10,017 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:10,017 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 01:58:10,017 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:10,017 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:10,017 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:10,019 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:10,019 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:13,507 - CtxMemMgr_User5 - INFO - Stored turn eefb27f9-d16b-4bf8-9863-30ab18d160d4 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:13,508 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:13,508 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:13,509 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~409 / 30000
2025-04-25 01:58:13,510 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:13,517 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:13,517 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:13,518 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:13,518 - CtxMemMgr_User5 - INFO - Stored turn 7827c01a-1e78-4169-87b2-2fcc88b01a24 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:13,519 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:13,519 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:13,519 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~416 / 30000
2025-04-25 01:58:13,520 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:13,525 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:13,525 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:13,526 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:14,541 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:14,547 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:14,552 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_11f71c1e-a962-464b-8c8d-a483d31e4afe', 'timestamp': '2025-04-25T01:58:14.547600', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:14.542484"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:14,555 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:14,556 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:14,557 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:14,558 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are the benefits of meditation?'
2025-04-25 01:58:14,558 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:14,558 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:14,558 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:14,560 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:14,560 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:17,757 - CtxMemMgr_User5 - INFO - Stored turn 3dfe55f0-e5cf-4c18-8d52-afe938c6a011 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:17,757 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:17,758 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:17,759 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~425 / 30000
2025-04-25 01:58:17,760 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:17,765 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:17,766 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:17,766 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:17,767 - CtxMemMgr_User5 - INFO - Stored turn ba274090-bbcc-4605-8140-ca88694b6ef7 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:17,767 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:17,767 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:17,767 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~434 / 30000
2025-04-25 01:58:17,767 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:17,771 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:17,771 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:17,772 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:18,780 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:18,787 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:18,791 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_49803249-675d-44ef-ae93-6d13f930dfb5', 'timestamp': '2025-04-25T01:58:18.787443', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:18.781833"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:18,795 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:18,796 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:18,797 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:18,797 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the Renaissance period in Europe.'
2025-04-25 01:58:18,797 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:18,797 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:18,797 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:18,799 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:18,800 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:22,098 - CtxMemMgr_User5 - INFO - Stored turn b99129f6-bc98-421a-97b0-521e0354cb2a for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:22,099 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:22,099 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:22,099 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~445 / 30000
2025-04-25 01:58:22,100 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:22,104 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:22,105 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:22,105 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:22,105 - CtxMemMgr_User5 - INFO - Stored turn 2073ccda-7363-45c0-b337-97c897086b7e for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:22,105 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:22,106 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:22,106 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~456 / 30000
2025-04-25 01:58:22,106 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:22,112 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:22,112 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:22,112 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:23,122 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:23,129 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:23,135 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_59faa720-80f7-434e-842e-58c253825a83', 'timestamp': '2025-04-25T01:58:23.129862', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:23.123676"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:23,140 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:23,140 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:23,141 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:23,142 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does machine learning work?'
2025-04-25 01:58:23,142 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:23,142 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:23,142 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:23,144 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:23,145 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:26,842 - CtxMemMgr_User5 - INFO - Stored turn b8639ed8-0490-4b86-8670-d1e0da9c2495 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:26,842 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:26,843 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:26,843 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~463 / 30000
2025-04-25 01:58:26,844 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:26,851 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:26,851 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:26,852 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:26,852 - CtxMemMgr_User5 - INFO - Stored turn 1fb75551-eb92-42b4-942c-59259e115a53 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:26,852 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:26,853 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:26,853 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~470 / 30000
2025-04-25 01:58:26,853 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:26,858 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:26,859 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:26,859 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:27,868 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:27,876 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:27,884 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_831f34c2-c682-4874-a6f1-ac69a9c9820a', 'timestamp': '2025-04-25T01:58:27.877399', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:27.870749"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:27,888 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:27,888 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:27,890 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:27,890 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a good novel?'
2025-04-25 01:58:27,890 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:27,891 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:27,891 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:27,892 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:27,893 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:31,821 - CtxMemMgr_User5 - INFO - Stored turn 158741da-24b9-417f-ba3a-a6cb20771161 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:31,821 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:31,822 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:31,822 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~476 / 30000
2025-04-25 01:58:31,823 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:31,829 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:31,830 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:31,830 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:31,830 - CtxMemMgr_User5 - INFO - Stored turn 34e0a5a0-90b6-4f7c-8920-b617ff40d0a1 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:31,831 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:31,831 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:31,831 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~482 / 30000
2025-04-25 01:58:31,831 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:31,836 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:31,837 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:31,837 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:32,846 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:32,854 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:32,858 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_bfb92e9e-6b37-423a-b42f-0ffb79c713d5', 'timestamp': '2025-04-25T01:58:32.854517', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:32.847713"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:32,862 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:32,863 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:32,864 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:32,864 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the concept of black holes.'
2025-04-25 01:58:32,864 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:32,864 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:32,864 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:32,866 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:32,866 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:36,465 - CtxMemMgr_User5 - INFO - Stored turn a00fab5c-c33a-45d3-ada1-bd2140ed6f65 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:36,465 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:36,466 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:36,467 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~490 / 30000
2025-04-25 01:58:36,467 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:36,474 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:36,474 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:36,475 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:36,475 - CtxMemMgr_User5 - INFO - Stored turn b2e79c4f-b094-413f-bea4-a8bf1fa774b4 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:36,476 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:36,476 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:36,476 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~498 / 30000
2025-04-25 01:58:36,476 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:36,481 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:36,482 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:36,482 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:37,492 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:37,501 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:37,506 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_54b0c061-3cc2-4a53-b6f3-0a62637455db', 'timestamp': '2025-04-25T01:58:37.501916', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:37.494097"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:37,511 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:37,511 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:37,512 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:37,512 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some sustainable living practices?'
2025-04-25 01:58:37,512 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:37,513 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:37,513 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:37,514 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:37,515 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:41,365 - CtxMemMgr_User5 - INFO - Stored turn 79156134-c2b3-4f52-baba-9dcedcf527c5 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:41,365 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:41,365 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:41,366 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~508 / 30000
2025-04-25 01:58:41,366 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:41,375 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:41,376 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:41,376 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:41,376 - CtxMemMgr_User5 - INFO - Stored turn 5b66dbaf-d3b7-4bd0-9526-985d39b5f98e for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:41,377 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:41,377 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:41,377 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~518 / 30000
2025-04-25 01:58:41,378 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:41,384 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:41,385 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:41,385 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:42,394 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:42,400 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:42,405 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f8cb128f-d303-421b-bf72-cbd18d3b6d2c', 'timestamp': '2025-04-25T01:58:42.400825', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:42.395263"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:42,408 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:42,409 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:42,409 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:42,410 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do vaccines work?'
2025-04-25 01:58:42,410 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:42,410 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:42,410 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:42,412 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:42,412 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:45,611 - CtxMemMgr_User5 - INFO - Stored turn db05f3a6-11f2-40ef-bcdb-917d0bf5da59 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:45,612 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:45,612 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:45,613 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~523 / 30000
2025-04-25 01:58:45,613 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:45,623 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:45,623 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:45,624 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f).
2025-04-25 01:58:45,624 - CtxMemMgr_User5 - INFO - Stored turn 51e6dea1-fdec-4dd0-93d4-d42d196edf37 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:45,624 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:45,625 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:45,625 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~528 / 30000
2025-04-25 01:58:45,626 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:45,631 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:45,632 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 01:58:45,632 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T01:59:00Z",
    "speaker": "User...
2025-04-25 01:58:46,639 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:46,645 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:46,650 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0b203e67-50db-4d4b-a54f-fbbe3b8dcb72', 'timestamp': '2025-04-25T01:58:46.646233', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:46.640635"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:46,653 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:46,654 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:46,654 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:46,655 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my favorite animal was?'
2025-04-25 01:58:46,655 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:46,655 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:46,655 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:46,657 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:46,657 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:48,781 - CtxMemMgr_User5 - INFO - Stored turn bfca8123-cdec-4403-840c-d501bb36fb83 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:48,782 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:48,782 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:48,782 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~539 / 30000
2025-04-25 01:58:48,783 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:48,791 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:48,792 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:48,792 - ActionHandler_User5 - INFO - Tier request detected: [('2', '0'), ('3', '0')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:58:48,792 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:58:48,792 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 0
2025-04-25 01:58:48,793 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 0
2025-04-25 01:58:48,795 - managers.memory.request_parser - WARNING - Message 0 not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:48,798 - managers.memory.request_parser - WARNING - Message 0 not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:48,798 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:58:48,799 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:58:48,799 - managers.memory.request_parser - INFO - Found episodic memory request: favorite animal
2025-04-25 01:58:48,799 - managers.memory.request_parser - INFO - Found episodic memory request: favorite animal
2025-04-25 01:58:48,800 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:48,800 - CtxMemMgr_User5 - INFO - Stored turn 5bbb3a55-23ff-4c91-95f0-a3236df56497 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:48,800 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:48,800 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:48,801 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~550 / 30000
2025-04-25 01:58:48,801 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:48,808 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:49,817 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:49,824 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:49,830 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4e932e7a-d5a8-45dc-9546-0f4e8d58c246', 'timestamp': '2025-04-25T01:58:49.825107', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:49.818635"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:49,834 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:49,835 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:49,836 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:49,836 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 01:58:49,836 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:49,836 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:49,836 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:49,838 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:49,839 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:51,965 - CtxMemMgr_User5 - INFO - Stored turn fa5a0ea0-c099-490f-9e8b-ff4aec15047c for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:51,965 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:51,966 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:51,966 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~561 / 30000
2025-04-25 01:58:51,967 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:51,974 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:51,975 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:51,976 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:58:51,977 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:58:51,977 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:58:51,981 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:51,983 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:58:51,983 - managers.memory.request_parser - INFO - Found 1 tier requests, will regenerate response
2025-04-25 01:58:51,983 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:58:51,984 - managers.memory.request_parser - INFO - Found episodic memory request: childhood pet
2025-04-25 01:58:51,984 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:51,984 - CtxMemMgr_User5 - INFO - Stored turn 26b62505-5fee-49e9-9b11-e25b561d1b8e for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:51,984 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:51,984 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:51,985 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~572 / 30000
2025-04-25 01:58:51,985 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:51,990 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:53,000 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:53,006 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:53,013 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e7e4d25a-2f2b-4090-b96a-769fb94b8b95', 'timestamp': '2025-04-25T01:58:53.007336', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:53.001737"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:53,016 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:53,017 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:53,017 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:53,018 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 01:58:53,018 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:53,018 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:53,018 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:53,021 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:53,021 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:55,467 - CtxMemMgr_User5 - INFO - Stored turn 8fd206c4-005e-40d3-bd27-3a658991c290 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:55,467 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:55,468 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:55,468 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~583 / 30000
2025-04-25 01:58:55,469 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:55,476 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:55,476 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:55,477 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:58:55,477 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:58:55,477 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:58:55,478 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:58:55,481 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:55,483 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:55,484 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:58:55,485 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:58:55,485 - managers.memory.request_parser - INFO - Found episodic memory request: favorite instrument
2025-04-25 01:58:55,485 - managers.memory.request_parser - INFO - Found episodic memory request: favorite instrument
2025-04-25 01:58:55,485 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:55,486 - CtxMemMgr_User5 - INFO - Stored turn 1c11fb94-e9e3-4bda-86f0-d29af4dd0400 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:55,486 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:55,486 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:55,486 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~594 / 30000
2025-04-25 01:58:55,486 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:55,492 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:56,506 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:56,512 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:56,519 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7d14a777-5755-49e2-9346-16e986012992', 'timestamp': '2025-04-25T01:58:56.513119', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:56.507097"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:56,523 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:56,523 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:56,524 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:56,524 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 01:58:56,525 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:56,525 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:56,525 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:56,526 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:56,527 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:58:58,492 - CtxMemMgr_User5 - INFO - Stored turn cff64340-e550-43c9-aa00-1c52a87d580f for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:58,492 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:58,493 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:58,493 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~601 / 30000
2025-04-25 01:58:58,493 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:58,500 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:58,500 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:58:58,500 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:58:58,501 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:58:58,501 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:58:58,501 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:58:58,504 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:58,505 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:58,506 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:58:58,507 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:58:58,507 - managers.memory.request_parser - INFO - Found episodic memory request: college major
2025-04-25 01:58:58,507 - managers.memory.request_parser - INFO - Found episodic memory request: college major
2025-04-25 01:58:58,508 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:58,508 - CtxMemMgr_User5 - INFO - Stored turn 04e9f031-4fec-4590-9daf-6d448613a639 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:58,508 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:58:58,509 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:58:58,509 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~608 / 30000
2025-04-25 01:58:58,510 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:58:58,514 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:58:59,526 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:59,533 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:58:59,539 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_291e1088-be7f-4b2a-8714-8f148378a7cd', 'timestamp': '2025-04-25T01:58:59.534115', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:58:59.527556"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:58:59,544 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:59,544 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:58:59,545 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:58:59,545 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 01:58:59,545 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:58:59,545 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:58:59,545 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:58:59,547 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:58:59,547 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:59:02,529 - CtxMemMgr_User5 - INFO - Stored turn 71c51a73-ad44-4125-ab3e-c1de3926c094 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,529 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:02,530 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:02,530 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~613 / 30000
2025-04-25 01:59:02,530 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:02,537 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,537 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:59:02,537 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id'), ('2', 'message_id'), ('3', 'message_id')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:59:02,538 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:59:02,538 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:59:02,538 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:59:02,538 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:59:02,539 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:59:02,541 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,543 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,546 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,548 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,548 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:59:02,548 - managers.memory.request_parser - INFO - Found 4 tier requests, will regenerate response
2025-04-25 01:59:02,549 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:59:02,549 - managers.memory.request_parser - INFO - Found episodic memory request: lucky number
2025-04-25 01:59:02,549 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,549 - CtxMemMgr_User5 - INFO - Stored turn 593c3d65-d38c-4fa6-a270-512b0a26dbb2 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:02,550 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:02,550 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:02,550 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~618 / 30000
2025-04-25 01:59:02,550 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:02,555 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:03,563 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:03,570 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:03,575 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_238d36d6-9937-4d28-b243-9aa1b025f096', 'timestamp': '2025-04-25T01:59:03.571539', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:59:03.564989"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:59:03,581 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:03,581 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:59:03,582 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:59:03,583 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 01:59:03,583 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:59:03,583 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:59:03,583 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:59:03,585 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:03,585 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:59:05,650 - CtxMemMgr_User5 - INFO - Stored turn 6d47f6f5-ab46-4d38-86b7-73ecef9d7a71 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:05,651 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:05,651 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:05,652 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~626 / 30000
2025-04-25 01:59:05,653 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:05,664 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:05,664 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:59:05,664 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:59:05,665 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:59:05,665 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:59:05,665 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:59:05,668 - managers.memory.request_parser - WARNING - Message all not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:05,670 - managers.memory.request_parser - WARNING - Message all not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:05,671 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:59:05,671 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:59:05,672 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:59:05,672 - managers.memory.request_parser - INFO - Found episodic memory request: least favorite food
2025-04-25 01:59:05,672 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:05,672 - CtxMemMgr_User5 - INFO - Stored turn 09fc3044-6d83-4066-bc16-e98a362a857d for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:05,672 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:05,673 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:05,673 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~634 / 30000
2025-04-25 01:59:05,673 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:05,677 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:06,683 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:06,690 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:06,696 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6aad2b9a-e8d0-4259-b661-c645c8dcd048', 'timestamp': '2025-04-25T01:59:06.691067', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:59:06.685032"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:59:06,699 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:06,700 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:59:06,701 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:59:06,701 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 01:59:06,701 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:59:06,701 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:59:06,701 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:59:06,703 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:06,703 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:59:09,272 - CtxMemMgr_User5 - INFO - Stored turn 2f69cd94-b142-4c42-844d-6af1eb7a29d8 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,273 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:09,273 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:09,274 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~642 / 30000
2025-04-25 01:59:09,274 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:09,282 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,283 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:59:09,283 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'all'), ('3', 'all'), ('2', 'all'), ('3', 'all')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:59:09,283 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:59:09,284 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:59:09,284 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:59:09,284 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message all
2025-04-25 01:59:09,284 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message all
2025-04-25 01:59:09,291 - managers.memory.request_parser - WARNING - Message all not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,293 - managers.memory.request_parser - WARNING - Message all not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,295 - managers.memory.request_parser - WARNING - Message all not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,298 - managers.memory.request_parser - WARNING - Message all not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,299 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:59:09,299 - managers.memory.request_parser - INFO - Found 4 tier requests, will regenerate response
2025-04-25 01:59:09,300 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:59:09,300 - managers.memory.request_parser - INFO - Found episodic memory request: dream vacation
2025-04-25 01:59:09,300 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,300 - CtxMemMgr_User5 - INFO - Stored turn 3a530573-fea4-4a30-a3e2-3b24d5d36187 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:09,301 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:09,301 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:09,301 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~650 / 30000
2025-04-25 01:59:09,301 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:09,305 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:10,315 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:10,323 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:10,330 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1f56ea49-3acf-428c-a4d5-3be6c593d697', 'timestamp': '2025-04-25T01:59:10.324414', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:59:10.316673"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:59:10,335 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:10,335 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:59:10,336 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:59:10,337 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 01:59:10,337 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:59:10,337 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:59:10,337 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:59:10,340 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:10,340 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:59:12,439 - CtxMemMgr_User5 - INFO - Stored turn bc79fe07-632b-414e-a7f0-d5ee556b91f1 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:12,440 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:12,440 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:12,440 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~658 / 30000
2025-04-25 01:59:12,441 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:12,447 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:12,448 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:59:12,448 - ActionHandler_User5 - INFO - Tier request detected: [('2', '0'), ('3', '0')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:59:12,449 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:59:12,450 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 0
2025-04-25 01:59:12,450 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 0
2025-04-25 01:59:12,454 - managers.memory.request_parser - WARNING - Message 0 not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:12,457 - managers.memory.request_parser - WARNING - Message 0 not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:12,458 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:59:12,458 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:59:12,459 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:59:12,459 - managers.memory.request_parser - INFO - Found episodic memory request: first job
2025-04-25 01:59:12,459 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:12,459 - CtxMemMgr_User5 - INFO - Stored turn 1af292ed-b699-4c6e-adf4-35059c80140f for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:12,459 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:12,460 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:12,460 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~666 / 30000
2025-04-25 01:59:12,460 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:12,465 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:13,475 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:13,485 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:13,493 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0cf77775-25e1-42e9-8d10-de1aebf34b57', 'timestamp': '2025-04-25T01:59:13.486616', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:59:13.476304"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:59:13,498 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:13,499 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:59:13,500 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:59:13,501 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 01:59:13,501 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:59:13,502 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:59:13,502 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:59:13,504 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:13,504 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:59:15,776 - CtxMemMgr_User5 - INFO - Stored turn fa1a8800-bd8f-4497-ad49-cb24f734a499 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,776 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:15,777 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:15,778 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~674 / 30000
2025-04-25 01:59:15,779 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:15,792 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,793 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:59:15,793 - ActionHandler_User5 - INFO - Tier request detected: [('2', 'message_id'), ('3', 'message_id'), ('2', 'message_id'), ('3', 'message_id')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:59:15,794 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:59:15,794 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:59:15,795 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:59:15,795 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message message_id
2025-04-25 01:59:15,796 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message message_id
2025-04-25 01:59:15,799 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,800 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,802 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,803 - managers.memory.request_parser - WARNING - Message message_id not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,804 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:59:15,804 - managers.memory.request_parser - INFO - Found 4 tier requests, will regenerate response
2025-04-25 01:59:15,804 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:59:15,805 - managers.memory.request_parser - INFO - Found episodic memory request: favorite season
2025-04-25 01:59:15,805 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,805 - CtxMemMgr_User5 - INFO - Stored turn 590831a3-96b9-40b3-9f49-7d75d07ce505 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:15,805 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:15,805 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:15,806 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~682 / 30000
2025-04-25 01:59:15,806 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:15,811 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:16,825 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:16,834 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 01:59:16,841 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1cc9e934-09a9-43ee-8e41-e8f6011b9b33', 'timestamp': '2025-04-25T01:59:16.835308', 'session_id': 'ffceb89b-29a0-4b78-878b-99c64038eb8f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T01:59:16.827838"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 01:59:16,844 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:16,844 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 01:59:16,846 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 01:59:16,846 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 01:59:16,848 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 01:59:16,849 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 01:59:16,850 - components.prompt_builder - INFO - Constructing prompt for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5, depth 0
2025-04-25 01:59:16,850 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 01:59:16,850 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 01:59:16,851 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 01:59:16,851 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 01:59:16,853 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 01:59:16,853 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 01:59:18,857 - CtxMemMgr_User5 - INFO - Stored turn 3e171ee9-95bb-4a68-a351-68fd91def9d9 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:18,857 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:18,858 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:18,858 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~691 / 30000
2025-04-25 01:59:18,858 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:18,869 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:18,870 - ActionHandler_User5 - INFO - Processing LLM response for session ffceb89b-29a0-4b78-878b-99c64038eb8f, user 5
2025-04-25 01:59:18,872 - ActionHandler_User5 - INFO - Tier request detected: [('2', '1'), ('3', '1')] (Session: ffceb89b-29a0-4b78-878b-99c64038eb8f)
2025-04-25 01:59:18,872 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 01:59:18,873 - managers.memory.request_parser - INFO - Found tier request: Tier 2 for message 1
2025-04-25 01:59:18,873 - managers.memory.request_parser - INFO - Found tier request: Tier 3 for message 1
2025-04-25 01:59:18,877 - managers.memory.request_parser - WARNING - Message 1 not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:18,878 - managers.memory.request_parser - WARNING - Message 1 not found in session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:18,880 - managers.memory.request_parser - INFO - Committed tier level updates to database
2025-04-25 01:59:18,880 - managers.memory.request_parser - INFO - Found 2 tier requests, will regenerate response
2025-04-25 01:59:18,880 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:59:18,880 - managers.memory.request_parser - INFO - Found episodic memory request: favorite book
2025-04-25 01:59:18,881 - ActionHandler_User5 - INFO - Regenerating response with upgraded tiers for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:18,881 - CtxMemMgr_User5 - INFO - Stored turn c1e329b4-f100-4ef9-b468-8545a50a1a83 for active session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 01:59:18,881 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session ffceb89b-29a0-4b78-878b-99c64038eb8f: '...'
2025-04-25 01:59:18,882 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 01:59:18,882 - CtxMemMgr_User5 - INFO - Session ffceb89b-29a0-4b78-878b-99c64038eb8f: Active history token count ~700 / 30000
2025-04-25 01:59:18,882 - CtxMemMgr_User5 - INFO - Saving active session context for ffceb89b-29a0-4b78-878b-99c64038eb8f to /app/data/sessions/5/ffceb89b-29a0-4b78-878b-99c64038eb8f/context.json
2025-04-25 01:59:18,890 - CtxMemMgr_User5 - INFO - Successfully saved context for session ffceb89b-29a0-4b78-878b-99c64038eb8f
2025-04-25 02:19:36,002 - core.database.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 02:19:36,002 - core.database.connection - INFO - Using MySQL database URL: mysql+pymysql://rai_user:rai_password@mysql:3306/rai_chat
2025-04-25 02:19:36,002 - core.database.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 02:19:36,020 - core.database.connection - INFO - Database connection successful!
2025-04-25 02:19:36,020 - core.database.connection - INFO - Creating database tables if they don't exist...
2025-04-25 02:19:36,024 - core.database.connection - INFO - Database tables created or already exist.
2025-04-25 02:19:36,030 - core.database.connection - INFO - Default user already exists.
2025-04-25 02:19:36,047 - app - INFO - Auth blueprint registered successfully
2025-04-25 02:19:36,072 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 02:19:36,073 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 02:19:36,073 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 02:19:36,073 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 02:19:36,073 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 02:19:36,073 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 02:19:36,074 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 02:19:36,074 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 02:19:36,088 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 02:19:36,088 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 02:19:36,088 - components.action_handler - INFO - Web search functionality is available
2025-04-25 02:19:36,089 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 02:19:36,089 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 02:19:36,090 - app - INFO - Chat blueprint registered successfully
2025-04-25 02:19:36,093 - root - INFO - MySQL connection: rai_user@mysql:3306/rai_chat
2025-04-25 02:19:36,094 - app - INFO - Session blueprint registered successfully
2025-04-25 02:19:36,101 - app - INFO - Memory blueprint registered successfully
2025-04-25 02:19:36,105 - app - INFO - System Messages blueprint registered successfully
2025-04-25 02:19:36,107 - app - INFO - Test Search blueprint registered successfully
2025-04-25 02:19:36,108 - app - INFO - Basic endpoints registered successfully
2025-04-25 02:19:36,113 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 02:19:47,135 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:47,137 - managers.session - INFO - Creating new UserSessionManager instance
2025-04-25 02:19:47,143 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 02:19:47,145 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 02:19:47,145 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:47,146 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 02:19:47,147 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 02:19:47,147 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 02:19:47,147 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 02:19:47,151 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:47,152 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 02:19:47,154 - utils.imports - INFO - Added /app/ to Python path
2025-04-25 02:19:47,155 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 02:19:47,155 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 02:19:47,155 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 02:19:47,155 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 02:19:47,155 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 02:19:47,155 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 02:19:47,155 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 02:19:47,155 - ConvMgr_User5 - INFO - Loading session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:47,156 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 02:19:47,156 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 02:19:47,156 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 02:19:47,159 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:47,163 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b468524e-72c2-4e34-80e2-91f48c87da80', 'timestamp': '2025-04-25T02:19:47.159740', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:19:47.156545"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:19:47,165 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:47,165 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:19:47,168 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 02:19:47,168 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 02:19:47,169 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 02:19:47,169 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 02:19:47,169 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:19:47,169 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 02:19:47,169 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 02:19:47,170 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:19:47,170 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:19:47,170 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:19:47,170 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 02:19:47,170 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:47,171 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:19:49,278 - CtxMemMgr_User5 - INFO - Loading session 1c54cbc3-0461-483b-8137-79d952bd2c6f for processing assistant message
2025-04-25 02:19:49,278 - CtxMemMgr_User5 - INFO - Loading session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f from /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:49,279 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json not found. Initializing empty context for new session 1c54cbc3-0461-483b-8137-79d952bd2c6f.
2025-04-25 02:19:49,279 - CtxMemMgr_User5 - INFO - Stored turn e9a67bcc-26dc-4e8b-b17b-4058e23d9aa7 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:49,279 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:49,284 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:49,285 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~15 / 30000
2025-04-25 02:19:49,285 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:49,287 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:49,288 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:19:49,289 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:19:49,289 - CtxMemMgr_User5 - INFO - Stored turn 37117dcb-f117-4fd4-9f6a-caef4de1a65c for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:49,289 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:49,290 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:49,290 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~30 / 30000
2025-04-25 02:19:49,290 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:49,292 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:49,293 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:19:49,294 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:20:00Z",
    "speaker": "User...
2025-04-25 02:19:50,300 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:50,305 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:50,310 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6be98e77-f324-4dc1-a588-5f04149431a4', 'timestamp': '2025-04-25T02:19:50.305778', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:19:50.301104"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:19:50,315 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:50,315 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:19:50,316 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:19:50,317 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 02:19:50,317 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:19:50,317 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:19:50,317 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:19:50,319 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:50,319 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:19:52,525 - CtxMemMgr_User5 - INFO - Stored turn 81774402-3cf8-4865-953f-9f883adf1094 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:52,526 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:52,526 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:52,527 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~49 / 30000
2025-04-25 02:19:52,527 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:52,531 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:52,531 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:19:52,532 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:19:52,532 - CtxMemMgr_User5 - INFO - Stored turn 81787927-3ce9-4eae-ab8f-b1ab7b19ba11 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:52,533 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:52,533 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:52,533 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~68 / 30000
2025-04-25 02:19:52,533 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:52,536 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:52,537 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:19:52,538 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:20:00Z",
    "speaker": "User...
2025-04-25 02:19:53,549 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:53,556 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:53,565 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c65a02c5-fe76-4b9b-ad3e-a75926b83a70', 'timestamp': '2025-04-25T02:19:53.557313', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:19:53.550959"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:19:53,572 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:53,573 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:19:53,574 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:19:53,574 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 02:19:53,575 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:19:53,575 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:19:53,575 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:19:53,577 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:53,578 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:19:55,737 - CtxMemMgr_User5 - INFO - Stored turn 18ae2562-b3b0-4903-a1b2-460b63fe616e for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:55,737 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:55,737 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:55,738 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~87 / 30000
2025-04-25 02:19:55,738 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:55,740 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:55,741 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:19:55,741 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:19:55,742 - CtxMemMgr_User5 - INFO - Stored turn 708ef9f3-99f4-4c0f-85af-5c050b2461ca for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:55,742 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:55,743 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:55,743 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~106 / 30000
2025-04-25 02:19:55,743 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:55,746 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:55,746 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:19:55,746 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:20:00Z",
    "speaker": "User...
2025-04-25 02:19:56,750 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:56,755 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:19:56,759 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7040391d-7ded-46d0-8f48-2f1ea50bc7be', 'timestamp': '2025-04-25T02:19:56.756102', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:19:56.751656"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:19:56,763 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:56,763 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:19:56,764 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 02:19:56,764 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 02:19:56,766 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 02:19:56,766 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 02:19:56,767 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:19:56,767 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 02:19:56,767 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:19:56,768 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:19:56,768 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:19:56,769 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:19:56,770 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:19:59,161 - CtxMemMgr_User5 - INFO - Stored turn 946e8acd-cc23-46cb-a9f6-2be4e7e27071 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:59,161 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:59,162 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:59,162 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~122 / 30000
2025-04-25 02:19:59,162 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:59,165 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:59,165 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:19:59,165 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:19:59,165 - CtxMemMgr_User5 - INFO - Stored turn dd45e40d-0175-482b-89c9-52099f6aaf3e for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:59,166 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:19:59,166 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:19:59,166 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~138 / 30000
2025-04-25 02:19:59,166 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:19:59,168 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:19:59,168 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:19:59,169 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:20:00Z",
    "speaker": "User...
2025-04-25 02:20:00,176 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:00,181 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:00,186 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_9bc218e1-9306-4cc6-b190-b2fd906f2401', 'timestamp': '2025-04-25T02:20:00.182464', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:00.177039"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:00,191 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:00,191 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:00,192 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:00,192 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 02:20:00,193 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:00,193 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:00,193 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:00,195 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:00,195 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:02,461 - CtxMemMgr_User5 - INFO - Stored turn 51ff03e6-289f-46de-9885-9b37835915a3 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:02,461 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:02,462 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:02,463 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~158 / 30000
2025-04-25 02:20:02,463 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:02,475 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:02,475 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:02,476 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:02,477 - CtxMemMgr_User5 - INFO - Stored turn 9613b97e-8096-40bc-bf48-77c105c4904e for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:02,478 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:02,478 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:02,479 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~178 / 30000
2025-04-25 02:20:02,479 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:02,485 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:02,486 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:02,486 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:03,493 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:03,498 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:03,502 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_03964e22-b9fc-47a3-ae3e-d5f4737c285c', 'timestamp': '2025-04-25T02:20:03.498778', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:03.493959"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:03,506 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:03,506 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:03,507 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:03,508 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 02:20:03,508 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:03,508 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:03,509 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:03,510 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:03,510 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:05,663 - CtxMemMgr_User5 - INFO - Stored turn efa795e1-f48e-402a-8059-5c9356de7d43 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:05,663 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:05,663 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:05,664 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~197 / 30000
2025-04-25 02:20:05,664 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:05,666 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:05,667 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:05,667 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:05,667 - CtxMemMgr_User5 - INFO - Stored turn 1eeb1564-e414-4926-bf93-1a8efae7dcba for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:05,668 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:05,668 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:05,668 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~216 / 30000
2025-04-25 02:20:05,669 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:05,671 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:05,671 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:05,672 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:06,679 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:06,685 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:06,689 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ef5d347b-d3bd-4149-953c-c68d8052ca5a', 'timestamp': '2025-04-25T02:20:06.685557', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:06.680393"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:06,694 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:06,694 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:06,695 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:06,695 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 02:20:06,695 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:06,695 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:06,696 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:06,698 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:06,698 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:08,851 - CtxMemMgr_User5 - INFO - Stored turn eaa80ab6-603c-4e48-a052-a43516f55477 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:08,852 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:08,852 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:08,852 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~235 / 30000
2025-04-25 02:20:08,853 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:08,857 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:08,857 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:08,858 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:08,858 - CtxMemMgr_User5 - INFO - Stored turn a5e433ec-eecd-482b-9466-34a3a2c8ee44 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:08,859 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:08,859 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:08,859 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~254 / 30000
2025-04-25 02:20:08,860 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:08,863 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:08,863 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:08,864 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:21:00Z",
    "speaker": "User...
2025-04-25 02:20:09,872 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:09,884 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:09,893 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_17bedc50-8a66-46bf-829a-b7688aa23313', 'timestamp': '2025-04-25T02:20:09.885600', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:09.874037"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:09,901 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:09,901 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:09,902 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:09,902 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 02:20:09,902 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:09,903 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:09,903 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:09,904 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:09,904 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:12,082 - CtxMemMgr_User5 - INFO - Stored turn 1044ecff-17e0-494f-9118-71a53520d0f7 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:12,082 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:12,082 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:12,083 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~271 / 30000
2025-04-25 02:20:12,083 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:12,085 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:12,086 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:12,086 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:12,086 - CtxMemMgr_User5 - INFO - Stored turn e18cdb29-ae66-46b3-851e-dddd79cb4dd9 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:12,086 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:12,086 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:12,087 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~288 / 30000
2025-04-25 02:20:12,088 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:12,090 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:12,091 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:12,091 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:13,098 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:13,102 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:13,106 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_936e6d3d-7ad8-41c2-b527-cf7d209fef57', 'timestamp': '2025-04-25T02:20:13.103228', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:13.099072"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:13,109 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:13,121 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:13,123 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:13,123 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 02:20:13,125 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:13,129 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:13,130 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:13,132 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:13,132 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:15,183 - CtxMemMgr_User5 - INFO - Stored turn 4b014157-0b59-4ca9-915e-ad3633477c63 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:15,184 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:15,184 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:15,184 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~302 / 30000
2025-04-25 02:20:15,185 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:15,187 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:15,187 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:15,187 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:15,187 - CtxMemMgr_User5 - INFO - Stored turn d6441f55-39ed-4e22-890b-190490cfde06 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:15,188 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:15,188 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:15,188 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~316 / 30000
2025-04-25 02:20:15,188 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:15,190 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:15,190 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:15,191 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:16,195 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:16,202 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:16,207 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_9ec31ee8-16c1-439f-bdb7-be0d981887ef', 'timestamp': '2025-04-25T02:20:16.202767', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:16.196525"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:16,213 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:16,213 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:16,215 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:16,215 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 02:20:16,216 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:16,216 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:16,216 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:16,219 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:16,220 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:18,273 - CtxMemMgr_User5 - INFO - Stored turn 9ad3392b-a9d4-4572-b7df-7cfbb0b17ab2 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:18,274 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:18,274 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:18,275 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~336 / 30000
2025-04-25 02:20:18,275 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:18,280 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:18,280 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:18,281 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:18,281 - CtxMemMgr_User5 - INFO - Stored turn d1557de3-3f35-4c70-bab7-f4de3e5d648f for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:18,282 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:18,282 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:18,282 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~356 / 30000
2025-04-25 02:20:18,283 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:18,288 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:18,288 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:18,289 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:19,304 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:19,312 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:19,324 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e4e33509-a789-4388-85af-91d185a31c0a', 'timestamp': '2025-04-25T02:20:19.312824', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:19.306022"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:19,330 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:19,331 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:19,333 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:19,333 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 02:20:19,333 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:19,334 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:19,334 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:19,335 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:19,335 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:23,651 - CtxMemMgr_User5 - INFO - Stored turn cbdf5a19-2f17-447d-a870-44c728ea350e for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:23,651 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:23,652 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:23,653 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~365 / 30000
2025-04-25 02:20:23,653 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:23,660 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:23,660 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:23,661 - ActionHandler_User5 - INFO - Web search detected with pattern: \[SEARCH:\s*(.+?)\s*\]
2025-04-25 02:20:23,661 - ActionHandler_User5 - INFO - Extracted query: 'history of chocolate production'
2025-04-25 02:20:23,662 - ActionHandler_User5 - INFO - WEB SEARCH signal detected for query: 'history of chocolate production' (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:20:23,662 - CtxMemMgr_User5 - INFO - Stored turn ea3cebad-1762-41cd-9d32-5c1d9e271d1d for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:23,663 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:23,664 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:23,664 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~374 / 30000
2025-04-25 02:20:23,664 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:23,670 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:23,670 - ActionHandler_User5 - INFO - *** SENDING SEARCH STATUS TO FRONTEND (ID: search-1745547623-1c54cbc3) ***
2025-04-25 02:20:23,671 - ActionHandler_User5 - INFO - Storing search status for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: active
2025-04-25 02:20:23,678 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:23,682 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7e4d6039-0f49-4acb-951a-bcc9e74d79e8', 'timestamp': '2025-04-25T02:20:23.678964', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'web_search', 'content': '{"status": "active", "message": "Searching the web for: history of chocolate production", "search_id": "search-1745547623-1c54cbc3", "timestamp": "2025-04-25T02:20:23.671112"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:23,683 - ActionHandler_User5 - INFO - Stored system message ID sys_7e4d6039-0f49-4acb-951a-bcc9e74d79e8 for search ID search-1745547623-1c54cbc3
2025-04-25 02:20:23,683 - ActionHandler_User5 - INFO - Successfully posted system message to dedicated API for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:23,683 - ActionHandler_User5 - INFO - EXECUTING WEB SEARCH for query: 'history of chocolate production'
2025-04-25 02:20:23,683 - ActionHandler_User5 - INFO - TAVILY_AVAILABLE = True
2025-04-25 02:20:23,683 - ActionHandler_User5 - INFO - TAVILY_API_KEY from env: Present
2025-04-25 02:20:23,683 - ActionHandler_User5 - INFO - TAVILY_API_KEY value (first/last 4 chars): tvly...VPLb
2025-04-25 02:20:23,683 - ActionHandler_User5 - INFO - Calling perform_search function for query: 'history of chocolate production'
2025-04-25 02:20:23,683 - components.action_handler - INFO - Performing Tavily search for query: 'history of chocolate production'
2025-04-25 02:20:23,683 - components.action_handler - INFO - Calling Tavily search API with query: 'history of chocolate production'
2025-04-25 02:20:26,906 - components.action_handler - INFO - Tavily search response: {'query': 'history of chocolate production', 'follow_up_questions': None, 'answer': 'Chocolate originates from cacao beans, first domesticated by ancient Mesoamerican civilizations. It became popular ...
2025-04-25 02:20:26,906 - components.action_handler - INFO - Formatted search results (first 200 chars): Search results for: history of chocolate production

Summary: Chocolate originates from cacao beans, first domesticated by ancient Mesoamerican civilizations. It became popular in Europe after Spanish...
2025-04-25 02:20:26,907 - ActionHandler_User5 - INFO - perform_search function call completed successfully
2025-04-25 02:20:26,907 - ActionHandler_User5 - INFO - SEARCH RESULTS TYPE: <class 'str'>
2025-04-25 02:20:26,907 - ActionHandler_User5 - INFO - SEARCH RESULTS LENGTH: 2015
2025-04-25 02:20:26,907 - ActionHandler_User5 - INFO - Received valid web search results (first 100 chars): Search results for: history of chocolate production

Summary: Chocolate originates from cacao beans,...
2025-04-25 02:20:26,907 - ActionHandler_User5 - INFO - Updating system message sys_7e4d6039-0f49-4acb-951a-bcc9e74d79e8 for search ID search-1745547623-1c54cbc3
2025-04-25 02:20:26,909 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:26,912 - api.endpoints.system_messages - INFO - Updated system message sys_7e4d6039-0f49-4acb-951a-bcc9e74d79e8 in database
2025-04-25 02:20:26,913 - ActionHandler_User5 - INFO - Successfully updated system message sys_7e4d6039-0f49-4acb-951a-bcc9e74d79e8
2025-04-25 02:20:26,917 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:26,921 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c59d499d-1068-4a4a-a41f-7671a17431ce', 'timestamp': '2025-04-25T02:20:26.917711', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'web_search', 'content': '{"status": "complete", "message": "Search results for: history of chocolate production\\n\\nSummary: Chocolate originates from cacao beans, first dom ... (1845 characters truncated) ... yan Chocolate3 Xocolatl4 Spanish Hot Chocolate5 Chocolate in the American Colonies6 Cacao Powde...\\n\\n", "timestamp": "2025-04-25T02:20:26.913875"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:27,929 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:27,933 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:27,938 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c2a474f7-7ceb-467f-84de-363a7a839a34', 'timestamp': '2025-04-25T02:20:27.934286', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:27.930283"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:27,942 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:27,942 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:27,943 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:27,943 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 02:20:27,944 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:27,944 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:27,944 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:27,946 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:27,946 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:31,815 - CtxMemMgr_User5 - INFO - Stored turn 404ac5ea-9979-4787-84de-906dabfc9b10 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:31,815 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:31,816 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:31,816 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~388 / 30000
2025-04-25 02:20:31,816 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:31,820 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:31,821 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:31,822 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:31,823 - CtxMemMgr_User5 - INFO - Stored turn 0dca283e-b510-4237-b7bb-dc7d3a563518 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:31,824 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:31,824 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:31,824 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~402 / 30000
2025-04-25 02:20:31,825 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:31,827 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:31,827 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:31,828 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:32,835 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:32,839 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:32,844 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2c65ee26-3356-41a1-b8eb-fbd0f6cf307a', 'timestamp': '2025-04-25T02:20:32.840156', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:32.836157"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:32,847 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:32,848 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:32,848 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:32,849 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 02:20:32,849 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:32,849 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:32,849 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:32,851 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:32,851 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:36,389 - CtxMemMgr_User5 - INFO - Stored turn 1eeb032f-9c56-4166-b6d1-67afb530c5dd for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:36,390 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:36,390 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:36,390 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~409 / 30000
2025-04-25 02:20:36,390 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:36,394 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:36,394 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:36,395 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:36,395 - CtxMemMgr_User5 - INFO - Stored turn 7e65e298-2c0c-4e88-8fe4-90a34c50e0f8 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:36,395 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:36,395 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:36,396 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~416 / 30000
2025-04-25 02:20:36,396 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:36,398 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:36,398 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:36,399 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:37,407 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:37,413 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:37,417 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0c6ac22c-6f07-4ca1-87dc-3261528136c9', 'timestamp': '2025-04-25T02:20:37.413452', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:37.408543"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:37,421 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:37,421 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:37,423 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:37,423 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are the benefits of meditation?'
2025-04-25 02:20:37,423 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:37,424 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:37,424 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:37,427 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:37,429 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:40,688 - CtxMemMgr_User5 - INFO - Stored turn c8e6aba9-6235-406a-8690-43fd343450d0 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:40,688 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:40,689 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:40,689 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~425 / 30000
2025-04-25 02:20:40,689 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:40,695 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:40,696 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:40,696 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:40,696 - CtxMemMgr_User5 - INFO - Stored turn c42233c5-f79f-47bc-b247-d0231d7b41d3 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:40,698 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:40,698 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:40,699 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~434 / 30000
2025-04-25 02:20:40,699 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:40,705 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:40,705 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:40,706 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:41,718 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:41,723 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:41,728 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_766aa1a9-b419-4d9b-b8bc-f707cbeeb81c', 'timestamp': '2025-04-25T02:20:41.724348', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:41.719247"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:41,731 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:41,731 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:41,732 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:41,733 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the Renaissance period in Europe.'
2025-04-25 02:20:41,733 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:41,733 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:41,733 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:41,735 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:41,735 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:45,157 - CtxMemMgr_User5 - INFO - Stored turn 553d7390-ea73-49f3-bb34-838f2f918fa6 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:45,158 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:45,159 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:45,160 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~445 / 30000
2025-04-25 02:20:45,160 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:45,164 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:45,165 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:45,165 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:45,165 - CtxMemMgr_User5 - INFO - Stored turn 8294ce99-0483-48b7-ad3e-b40dbd5591d6 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:45,166 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:45,166 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:45,166 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~456 / 30000
2025-04-25 02:20:45,167 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:45,171 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:45,172 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:45,173 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:46,181 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:46,184 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:46,186 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8efc8546-1776-4809-bb43-8808177fd25d', 'timestamp': '2025-04-25T02:20:46.184226', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:46.182289"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:46,188 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:46,188 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:46,188 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:46,188 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does machine learning work?'
2025-04-25 02:20:46,188 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:46,188 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:46,189 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:46,189 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:46,189 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:49,995 - CtxMemMgr_User5 - INFO - Stored turn b638da38-864f-4e30-a2d5-6c6862f37e72 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:49,996 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:49,996 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:49,996 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~463 / 30000
2025-04-25 02:20:49,997 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:50,003 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:50,003 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:50,004 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:50,004 - CtxMemMgr_User5 - INFO - Stored turn 2516cf3b-5629-4cf6-a405-8cec7319cd6e for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:50,005 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:50,005 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:50,005 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~470 / 30000
2025-04-25 02:20:50,005 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:50,010 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:50,010 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:50,010 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:51,017 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:51,025 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:51,033 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0efc3139-ba79-4c2a-bf61-fa769cd9b963', 'timestamp': '2025-04-25T02:20:51.025872', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:51.019334"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:51,040 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:51,040 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:51,041 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:51,042 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a good novel?'
2025-04-25 02:20:51,042 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:51,042 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:51,042 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:51,045 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:51,046 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:55,080 - CtxMemMgr_User5 - INFO - Stored turn 0d622e3c-444d-4dad-bfe1-4bf808497367 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:55,080 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:55,080 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:55,080 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~476 / 30000
2025-04-25 02:20:55,081 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:55,083 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:55,083 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:55,083 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:55,083 - CtxMemMgr_User5 - INFO - Stored turn c4ed64ab-2fa7-482e-91a0-87982aa670c6 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:55,083 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:55,084 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:55,084 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~482 / 30000
2025-04-25 02:20:55,084 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:55,086 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:55,086 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:55,086 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:20:56,095 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:56,103 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:20:56,108 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a0330d09-5f36-4e19-bdae-560108fdd6a8', 'timestamp': '2025-04-25T02:20:56.104080', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:20:56.095996"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:20:56,111 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:56,112 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:20:56,112 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:20:56,113 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the concept of black holes.'
2025-04-25 02:20:56,113 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:20:56,113 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:20:56,113 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:20:56,115 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:20:56,115 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:20:59,794 - CtxMemMgr_User5 - INFO - Stored turn 1b55ddd0-f4b2-4fd8-9b3a-cc95b0b95be1 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:59,795 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:59,795 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:59,796 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~490 / 30000
2025-04-25 02:20:59,796 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:59,809 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:59,809 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:20:59,810 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:20:59,810 - CtxMemMgr_User5 - INFO - Stored turn 9f65e0be-7076-4acc-a3a2-ae5e03add6a9 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:59,811 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:20:59,811 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:20:59,811 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~498 / 30000
2025-04-25 02:20:59,812 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:20:59,820 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:20:59,821 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:20:59,822 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:22:00Z",
    "speaker": "User...
2025-04-25 02:21:00,833 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:00,846 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:00,855 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8960d29d-3347-4268-9cea-0e8e0570f65d', 'timestamp': '2025-04-25T02:21:00.847166', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:00.838042"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:00,861 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:00,861 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:00,863 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:00,864 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some sustainable living practices?'
2025-04-25 02:21:00,864 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:00,864 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:00,865 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:00,866 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:00,866 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:05,050 - CtxMemMgr_User5 - INFO - Stored turn aafb004f-677b-4cfe-9f8a-67ae00cd17df for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:05,050 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:05,051 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:05,051 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~508 / 30000
2025-04-25 02:21:05,051 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:05,054 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:05,054 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:05,054 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:21:05,055 - CtxMemMgr_User5 - INFO - Stored turn 2864af7b-735b-4bad-b45e-d9bff9b07a99 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:05,055 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:05,055 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:05,055 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~518 / 30000
2025-04-25 02:21:05,055 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:05,057 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:05,057 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:21:05,058 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:23:00Z",
    "speaker": "User...
2025-04-25 02:21:06,066 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:06,075 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:06,084 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_75f8fda4-7984-4437-a344-eaef6f6e5057', 'timestamp': '2025-04-25T02:21:06.076958', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:06.067954"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:06,091 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:06,092 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:06,093 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:06,094 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do vaccines work?'
2025-04-25 02:21:06,094 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:06,094 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:06,094 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:06,096 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:06,096 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:09,122 - CtxMemMgr_User5 - INFO - Stored turn 61726d88-4d88-41a6-8fe4-bd153723f9e3 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:09,123 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:09,124 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:09,124 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~523 / 30000
2025-04-25 02:21:09,125 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:09,136 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:09,138 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:09,139 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:21:09,140 - CtxMemMgr_User5 - INFO - Stored turn 4989f059-fc6b-41ed-ae31-1adbe6f87cac for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:09,140 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:09,141 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:09,141 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~528 / 30000
2025-04-25 02:21:09,141 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:09,152 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:09,153 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:21:09,153 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:23:00Z",
    "speaker": "User...
2025-04-25 02:21:10,161 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:10,165 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:10,170 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cbde57d6-9e8f-485f-b033-c5115bfa1762', 'timestamp': '2025-04-25T02:21:10.166082', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:10.161774"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:10,173 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:10,174 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:10,175 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:10,175 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my favorite animal was?'
2025-04-25 02:21:10,176 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:10,176 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:10,176 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:10,178 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:10,178 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:12,187 - CtxMemMgr_User5 - INFO - Stored turn f81b5e0e-10b7-47b3-8f6f-e38180f5bf9f for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:12,187 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:12,187 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:12,188 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~539 / 30000
2025-04-25 02:21:12,188 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:12,195 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:12,195 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:12,195 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:21:12,195 - CtxMemMgr_User5 - INFO - Stored turn ff17cf49-d157-40ff-87c0-99b94c883e3f for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:12,196 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:12,196 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:12,196 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~550 / 30000
2025-04-25 02:21:12,196 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:12,202 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:12,202 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:21:12,202 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:23:00Z",
    "speaker": "User...
2025-04-25 02:21:13,210 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:13,217 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:13,222 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_9734f7e8-cfb5-4e1f-b73f-083075dbfe77', 'timestamp': '2025-04-25T02:21:13.218311', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:13.211585"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:13,226 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:13,226 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:13,227 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:13,227 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 02:21:13,227 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:13,228 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:13,228 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:13,230 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:13,230 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:15,282 - CtxMemMgr_User5 - INFO - Stored turn 0e82469d-b9e8-4e4f-a947-f479b09cf19b for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:15,283 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:15,283 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:15,284 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~561 / 30000
2025-04-25 02:21:15,284 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:15,293 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:15,293 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:15,294 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:21:16,306 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:16,315 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:16,322 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6cb1a408-9950-4ac9-b3f0-1692fe794041', 'timestamp': '2025-04-25T02:21:16.316710', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:16.309517"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:16,329 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:16,329 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:16,331 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:16,332 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 02:21:16,332 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:16,332 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:16,332 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:16,335 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:16,335 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:18,463 - CtxMemMgr_User5 - INFO - Stored turn 20e604af-bb71-4b76-bb01-218a8d3adaa6 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:18,463 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:18,464 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:18,465 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~572 / 30000
2025-04-25 02:21:18,465 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:18,476 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:18,476 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:18,476 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:21:19,494 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:19,504 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:19,524 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e865c548-26bc-445d-9967-3713366fdce8', 'timestamp': '2025-04-25T02:21:19.505647', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:19.496677"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:19,528 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:19,529 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:19,529 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:19,529 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 02:21:19,529 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:19,529 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:19,530 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:19,530 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:19,530 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:21,701 - CtxMemMgr_User5 - INFO - Stored turn 7337032a-4cdb-486e-a737-578d526e5c3e for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:21,702 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:21,702 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:21,703 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~579 / 30000
2025-04-25 02:21:21,703 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:21,716 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:21,717 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:21,717 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:21:22,724 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:22,728 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:22,733 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_80c70d84-46bc-47e4-8872-8a02261f1116', 'timestamp': '2025-04-25T02:21:22.729361', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:22.725071"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:22,736 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:22,737 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:22,738 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:22,738 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 02:21:22,738 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:22,738 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:22,739 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:22,741 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:22,741 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:25,396 - CtxMemMgr_User5 - INFO - Stored turn 9697f4a4-6592-461a-af02-4d8afea9fb20 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:25,396 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:25,397 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:25,398 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~584 / 30000
2025-04-25 02:21:25,398 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:25,402 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:25,402 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:25,402 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f).
2025-04-25 02:21:25,403 - CtxMemMgr_User5 - INFO - Stored turn 0f1b8715-c0e0-423a-ae9b-650bbfa4ff4e for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:25,403 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:25,403 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:25,403 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~589 / 30000
2025-04-25 02:21:25,403 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:25,405 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:25,405 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:21:25,405 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:23:00Z",
    "speaker": "User...
2025-04-25 02:21:26,417 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:26,424 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:26,427 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_79c7b64d-e475-41fe-a6cd-dfd2873b30f2', 'timestamp': '2025-04-25T02:21:26.424520', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:26.418436"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:26,429 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:26,430 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:26,430 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:26,430 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 02:21:26,430 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:26,430 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:26,430 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:26,431 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:26,431 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:28,470 - CtxMemMgr_User5 - INFO - Stored turn 15cc0576-02be-45ad-ab8d-e12f9d7a9dc8 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:28,471 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:28,471 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:28,472 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~597 / 30000
2025-04-25 02:21:28,472 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:28,489 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:28,490 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:28,490 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:21:29,506 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:29,517 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:29,524 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ef7a9a47-bf04-4a70-8341-0040f14f62eb', 'timestamp': '2025-04-25T02:21:29.518415', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:29.507940"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:29,531 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:29,532 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:29,534 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:29,535 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 02:21:29,535 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:29,535 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:29,536 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:29,538 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:29,538 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:31,960 - CtxMemMgr_User5 - INFO - Stored turn da1876e3-0788-47b5-8522-229218518538 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:31,960 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:31,960 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:31,961 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~605 / 30000
2025-04-25 02:21:31,961 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:31,971 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:31,971 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:31,972 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:21:32,982 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:32,991 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:32,996 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d0e6c995-ce88-44e6-be14-71aabea45ec1', 'timestamp': '2025-04-25T02:21:32.991468', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:32.984822"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:33,002 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:33,002 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:33,004 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:33,004 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 02:21:33,004 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:33,005 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:33,005 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:33,009 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:33,009 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:34,960 - CtxMemMgr_User5 - INFO - Stored turn 79cfed67-8284-46e6-8336-a53681b1d855 for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:34,960 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:34,960 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:34,961 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~613 / 30000
2025-04-25 02:21:34,961 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:34,972 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:34,973 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:34,973 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:21:35,990 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:35,999 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:36,010 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_492a3ce9-7213-4494-b992-f22b06556d86', 'timestamp': '2025-04-25T02:21:36', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:35.993506"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:36,015 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:36,016 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:36,017 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:36,017 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 02:21:36,018 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:36,018 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:36,018 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:36,019 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:36,020 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:38,198 - CtxMemMgr_User5 - INFO - Stored turn 17d9ccdd-4f39-44a5-b26e-0f74f06cfbdc for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:38,199 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:38,199 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:38,199 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~621 / 30000
2025-04-25 02:21:38,200 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:38,209 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:38,209 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:38,210 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:21:39,224 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:39,233 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:21:39,241 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5dc200c2-53de-40f3-ae64-436b4e883bb3', 'timestamp': '2025-04-25T02:21:39.234459', 'session_id': '1c54cbc3-0461-483b-8137-79d952bd2c6f', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:21:39.225984"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:21:39,246 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:39,247 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:21:39,248 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 02:21:39,248 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 02:21:39,251 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 02:21:39,252 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 02:21:39,252 - components.prompt_builder - INFO - Constructing prompt for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5, depth 0
2025-04-25 02:21:39,253 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 02:21:39,253 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:21:39,253 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:21:39,253 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:21:39,254 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:21:39,255 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:21:41,135 - CtxMemMgr_User5 - INFO - Stored turn 2b3e5927-2cd7-4c52-8a0e-b215e02d55df for active session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:41,136 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 1c54cbc3-0461-483b-8137-79d952bd2c6f: '...'
2025-04-25 02:21:41,136 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:21:41,137 - CtxMemMgr_User5 - INFO - Session 1c54cbc3-0461-483b-8137-79d952bd2c6f: Active history token count ~630 / 30000
2025-04-25 02:21:41,140 - CtxMemMgr_User5 - INFO - Saving active session context for 1c54cbc3-0461-483b-8137-79d952bd2c6f to /app/data/sessions/5/1c54cbc3-0461-483b-8137-79d952bd2c6f/context.json
2025-04-25 02:21:41,150 - CtxMemMgr_User5 - INFO - Successfully saved context for session 1c54cbc3-0461-483b-8137-79d952bd2c6f
2025-04-25 02:21:41,151 - ActionHandler_User5 - INFO - Processing LLM response for session 1c54cbc3-0461-483b-8137-79d952bd2c6f, user 5
2025-04-25 02:21:41,151 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 1c54cbc3-0461-483b-8137-79d952bd2c6f)
2025-04-25 02:23:25,256 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:25,256 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:25,257 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 02:23:25,257 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 02:23:25,257 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 02:23:25,259 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:25,261 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 02:23:25,261 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 02:23:25,261 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 02:23:25,261 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 02:23:25,261 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 02:23:25,262 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 02:23:25,262 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 02:23:25,262 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 02:23:25,263 - ConvMgr_User5 - INFO - Loading session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:25,263 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 02:23:25,263 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 02:23:25,263 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 02:23:25,269 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:25,273 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b65845bf-9627-4cd9-bcf7-1989361c00d0', 'timestamp': '2025-04-25T02:23:25.269666', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:25.264238"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:25,277 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:25,277 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:25,278 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 02:23:25,278 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 02:23:25,279 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 02:23:25,280 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 02:23:25,280 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:25,280 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 02:23:25,281 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 02:23:25,281 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:25,281 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:25,281 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:25,281 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 02:23:25,283 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:25,283 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:27,466 - CtxMemMgr_User5 - INFO - Loading session 969e43a7-67c5-4567-93e7-182f5c19d19c for processing assistant message
2025-04-25 02:23:27,466 - CtxMemMgr_User5 - INFO - Loading session context for 969e43a7-67c5-4567-93e7-182f5c19d19c from /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:27,467 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json not found. Initializing empty context for new session 969e43a7-67c5-4567-93e7-182f5c19d19c.
2025-04-25 02:23:27,468 - CtxMemMgr_User5 - INFO - Stored turn 83cda686-d6e6-4115-a233-b814120f8902 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:27,468 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:27,468 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:27,469 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~15 / 30000
2025-04-25 02:23:27,469 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:27,473 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:27,473 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:27,474 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:27,474 - CtxMemMgr_User5 - INFO - Stored turn 8d073da3-03e4-48fe-a6bf-00193529461e for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:27,475 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:27,475 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:27,476 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~30 / 30000
2025-04-25 02:23:27,476 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:27,478 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:27,478 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:27,479 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:24:00Z",
    "speaker": "User...
2025-04-25 02:23:28,489 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:28,497 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:28,504 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ba1149d6-9a2d-4626-a82a-1ef626511611', 'timestamp': '2025-04-25T02:23:28.498041', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:28.491037"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:28,507 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:28,508 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:28,509 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:28,509 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 02:23:28,509 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:28,509 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:28,510 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:28,511 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:28,512 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:30,690 - CtxMemMgr_User5 - INFO - Stored turn 0d5f8c3f-62f7-4c2b-9033-14978578e0f6 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:30,692 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:30,693 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:30,694 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~49 / 30000
2025-04-25 02:23:30,694 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:30,696 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:30,697 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:30,697 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:30,697 - CtxMemMgr_User5 - INFO - Stored turn 2e06a429-fb55-4408-ac65-3e58fe7fc3ca for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:30,698 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:30,698 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:30,698 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~68 / 30000
2025-04-25 02:23:30,699 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:30,701 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:30,701 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:30,702 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:23:31,715 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:31,726 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:31,737 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f57d0578-3e4b-468d-94b7-07592f405cff', 'timestamp': '2025-04-25T02:23:31.726705', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:31.716681"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:31,743 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:31,743 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:31,745 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:31,745 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 02:23:31,746 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:31,746 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:31,746 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:31,748 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:31,749 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:33,915 - CtxMemMgr_User5 - INFO - Stored turn d77a02d8-0d0b-47f8-91f2-25c27a11bfc8 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:33,915 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:33,916 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:33,916 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~87 / 30000
2025-04-25 02:23:33,917 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:33,921 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:33,921 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:33,921 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:33,922 - CtxMemMgr_User5 - INFO - Stored turn 65872f26-c46f-4d42-9e06-2cfd1cf9eab5 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:33,922 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:33,923 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:33,923 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~106 / 30000
2025-04-25 02:23:33,923 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:33,926 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:33,926 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:33,926 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:23:34,941 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:34,950 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:34,956 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_fc601d77-cd43-4d71-9744-d01f6b000f87', 'timestamp': '2025-04-25T02:23:34.950881', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:34.943039"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:34,960 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:34,960 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:34,962 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 02:23:34,962 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 02:23:34,963 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 02:23:34,964 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 02:23:34,964 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:34,965 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 02:23:34,965 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:34,965 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:34,965 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:34,967 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:34,967 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:37,151 - CtxMemMgr_User5 - INFO - Stored turn b8f528c2-7826-4198-acb9-4457411d1be8 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:37,151 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:37,152 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:37,152 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~122 / 30000
2025-04-25 02:23:37,153 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:37,156 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:37,156 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:37,156 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:37,157 - CtxMemMgr_User5 - INFO - Stored turn 9ddd30f2-4f93-4e88-8bb3-ed916fe54c45 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:37,157 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:37,158 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:37,158 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~138 / 30000
2025-04-25 02:23:37,158 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:37,159 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:37,159 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:37,159 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:25:00Z",
    "speaker": "User...
2025-04-25 02:23:38,170 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:38,177 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:38,183 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6eff69cd-925e-41b9-bdf6-83e680fca863', 'timestamp': '2025-04-25T02:23:38.177899', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:38.172412"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:38,187 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:38,187 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:38,188 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:38,188 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 02:23:38,188 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:38,189 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:38,189 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:38,190 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:38,190 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:40,151 - CtxMemMgr_User5 - INFO - Stored turn 90dafc35-807c-483a-9c75-f8d0a54f53ef for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:40,152 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:40,152 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:40,153 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~158 / 30000
2025-04-25 02:23:40,153 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:40,157 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:40,157 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:40,158 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:40,158 - CtxMemMgr_User5 - INFO - Stored turn 0a36c4b9-aea7-45ab-ad44-fc012165424a for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:40,158 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:40,159 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:40,159 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~178 / 30000
2025-04-25 02:23:40,159 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:40,162 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:40,163 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:40,163 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:24:00Z",
    "speaker": "User...
2025-04-25 02:23:41,173 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:41,180 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:41,186 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d38527af-ea63-4df8-917f-1a83e71021a7', 'timestamp': '2025-04-25T02:23:41.180693', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:41.174615"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:41,190 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:41,190 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:41,191 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:41,191 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 02:23:41,191 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:41,192 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:41,192 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:41,193 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:41,194 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:43,415 - CtxMemMgr_User5 - INFO - Stored turn 77ba5b0c-536d-480a-9b5d-834c2cb37ae7 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:43,416 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:43,416 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:43,417 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~197 / 30000
2025-04-25 02:23:43,417 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:43,422 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:43,423 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:43,423 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:43,424 - CtxMemMgr_User5 - INFO - Stored turn bbb8e8fe-0e6b-4ecd-a529-d98969d572e3 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:43,424 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:43,424 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:43,425 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~216 / 30000
2025-04-25 02:23:43,425 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:43,428 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:43,428 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:43,429 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:25:00Z",
    "speaker": "User...
2025-04-25 02:23:44,439 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:44,447 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:44,453 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4217cbe5-b5f6-4812-a491-5eb253f2d842', 'timestamp': '2025-04-25T02:23:44.447979', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:44.441920"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:44,460 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:44,460 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:44,461 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:44,462 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 02:23:44,462 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:44,462 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:44,462 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:44,463 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:44,464 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:46,615 - CtxMemMgr_User5 - INFO - Stored turn 95c4506d-41d3-4ae1-b4c8-bc08aa90a189 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:46,615 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:46,616 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:46,617 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~235 / 30000
2025-04-25 02:23:46,617 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:46,623 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:46,623 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:46,623 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:46,624 - CtxMemMgr_User5 - INFO - Stored turn 34435a5e-637c-4ee2-ade8-97d17f556b8c for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:46,624 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:46,625 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:46,625 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~254 / 30000
2025-04-25 02:23:46,626 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:46,628 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:46,629 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:46,629 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:24:00Z",
    "speaker": "User...
2025-04-25 02:23:47,641 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:47,650 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:47,655 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4dc31356-18c6-4501-937d-eb078b7e38bc', 'timestamp': '2025-04-25T02:23:47.651703', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:47.643116"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:47,659 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:47,660 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:47,661 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:47,661 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 02:23:47,661 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:47,661 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:47,662 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:47,663 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:47,664 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:49,682 - CtxMemMgr_User5 - INFO - Stored turn 314468f5-8545-44f9-99bd-ca5772dda29c for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:49,682 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:49,683 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:49,683 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~271 / 30000
2025-04-25 02:23:49,684 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:49,686 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:49,686 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:49,686 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:49,687 - CtxMemMgr_User5 - INFO - Stored turn 5930b925-bccc-43ab-8e05-9278b20716a1 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:49,687 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:49,687 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:49,687 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~288 / 30000
2025-04-25 02:23:49,687 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:49,689 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:49,689 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:49,690 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:25:00Z",
    "speaker": "User...
2025-04-25 02:23:50,706 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:50,710 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:50,715 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2273ac7a-3947-4d71-960c-b2be743656ef', 'timestamp': '2025-04-25T02:23:50.711084', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:50.706902"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:50,718 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:50,718 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:50,719 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:50,719 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 02:23:50,719 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:50,719 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:50,720 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:50,721 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:50,721 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:52,845 - CtxMemMgr_User5 - INFO - Stored turn d2d8c4b1-236b-4b4d-bb3f-4a52ae865aea for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:52,846 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:52,846 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:52,847 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~302 / 30000
2025-04-25 02:23:52,847 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:52,850 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:52,850 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:52,850 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:52,851 - CtxMemMgr_User5 - INFO - Stored turn 3025ce01-7213-4d65-aa49-c7f160794433 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:52,851 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:52,851 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:52,852 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~316 / 30000
2025-04-25 02:23:52,852 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:52,854 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:52,855 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:52,855 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:23:53,863 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:53,871 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:53,884 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_070faa6b-5742-453f-a9be-03b985eb100b', 'timestamp': '2025-04-25T02:23:53.871852', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:53.864944"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:53,890 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:53,891 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:53,892 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:53,892 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 02:23:53,897 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:53,898 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:53,902 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:53,904 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:53,905 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:23:56,067 - CtxMemMgr_User5 - INFO - Stored turn 4060dd47-71b9-4f06-b9d8-60e62740865b for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:56,068 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:56,068 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:56,069 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~336 / 30000
2025-04-25 02:23:56,069 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:56,074 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:56,075 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:23:56,075 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:23:56,075 - CtxMemMgr_User5 - INFO - Stored turn 03ad0c04-52dc-4213-9385-4603f03a83cd for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:56,076 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:23:56,076 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:23:56,076 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~356 / 30000
2025-04-25 02:23:56,077 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:23:56,081 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:23:56,082 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:23:56,083 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:24:00Z",
    "speaker": "User...
2025-04-25 02:23:57,093 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:57,102 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:23:57,107 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_69aa41a1-ca14-486c-b10e-ea242a731143', 'timestamp': '2025-04-25T02:23:57.102501', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:23:57.095086"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:23:57,110 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:57,110 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:23:57,111 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:23:57,112 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 02:23:57,112 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:23:57,112 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:23:57,112 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:23:57,114 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:23:57,114 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:02,013 - CtxMemMgr_User5 - INFO - Stored turn dd7d944d-968e-4563-aba2-d7f42a0099f3 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:02,013 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:02,014 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:02,014 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~365 / 30000
2025-04-25 02:24:02,015 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:02,020 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:02,020 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:02,021 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:02,021 - CtxMemMgr_User5 - INFO - Stored turn 8440d7b3-7c11-4089-aa4b-8eafec5d0c03 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:02,021 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:02,021 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:02,022 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~374 / 30000
2025-04-25 02:24:02,022 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:02,025 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:02,025 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:02,025 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:24:03,034 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:03,042 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:03,051 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f481b262-cc13-499e-8c0d-ce2eec6b6864', 'timestamp': '2025-04-25T02:24:03.043477', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:03.035889"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:03,055 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:03,055 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:03,056 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:03,057 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 02:24:03,057 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:03,057 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:03,057 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:03,059 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:03,059 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:06,983 - CtxMemMgr_User5 - INFO - Stored turn 852ccd9b-6e3e-4d58-a4ff-88d3adbca5ca for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:06,984 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:06,985 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:06,985 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~388 / 30000
2025-04-25 02:24:06,986 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:06,990 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:06,990 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:06,991 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:06,991 - CtxMemMgr_User5 - INFO - Stored turn 52c61349-5f59-4927-a898-f7d1f88dce91 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:06,991 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:06,991 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:06,992 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~402 / 30000
2025-04-25 02:24:06,992 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:06,995 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:06,995 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:06,996 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:24:08,003 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:08,015 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:08,024 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cebd85c2-28f2-493c-96ec-204bef624b3f', 'timestamp': '2025-04-25T02:24:08.016367', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:08.005091"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:08,031 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:08,031 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:08,032 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:08,033 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 02:24:08,033 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:08,033 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:08,033 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:08,035 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:08,035 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:11,363 - CtxMemMgr_User5 - INFO - Stored turn a17e2f93-90ac-4064-b1b5-50cecbe31f7a for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:11,364 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:11,364 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:11,365 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~409 / 30000
2025-04-25 02:24:11,365 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:11,371 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:11,371 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:11,372 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:11,373 - CtxMemMgr_User5 - INFO - Stored turn ff8d258f-5a71-4ad6-9396-9af5bd4a23f6 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:11,373 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:11,373 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:11,373 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~416 / 30000
2025-04-25 02:24:11,374 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:11,377 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:11,378 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:11,378 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:24:12,387 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:12,403 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:12,409 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c1d02069-8f09-45f6-8cb5-93ef289a44b0', 'timestamp': '2025-04-25T02:24:12.404559', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:12.388355"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:12,414 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:12,415 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:12,415 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:12,416 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are the benefits of meditation?'
2025-04-25 02:24:12,416 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:12,416 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:12,416 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:12,418 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:12,419 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:15,702 - CtxMemMgr_User5 - INFO - Stored turn 0b0dfdf7-1ade-4713-861c-7d5c62e716ed for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:15,703 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:15,704 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:15,704 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~425 / 30000
2025-04-25 02:24:15,705 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:15,711 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:15,712 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:15,712 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:15,713 - CtxMemMgr_User5 - INFO - Stored turn 85e8df7c-c907-4020-ad29-5adae8dfe5fb for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:15,713 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:15,713 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:15,713 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~434 / 30000
2025-04-25 02:24:15,714 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:15,719 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:15,719 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:15,720 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:24:16,728 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:16,736 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:16,742 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0322cfc2-628c-4813-a67a-5398ae47da95', 'timestamp': '2025-04-25T02:24:16.737338', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:16.729534"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:16,747 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:16,747 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:16,748 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:16,748 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the Renaissance period in Europe.'
2025-04-25 02:24:16,749 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:16,749 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:16,749 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:16,750 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:16,751 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:21,882 - CtxMemMgr_User5 - INFO - Stored turn c76bd122-48e2-4827-a249-4f2873e46b57 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:21,882 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:21,883 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:21,884 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~445 / 30000
2025-04-25 02:24:21,884 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:21,889 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:21,889 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:21,890 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:21,890 - CtxMemMgr_User5 - INFO - Stored turn 8d06a4d5-34d9-4f8a-b308-5c044c24081d for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:21,890 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:21,890 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:21,891 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~456 / 30000
2025-04-25 02:24:21,891 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:21,895 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:21,896 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:21,896 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:24:22,905 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:22,916 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:22,922 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f0791acf-0191-4aa4-a76c-139f2da131d5', 'timestamp': '2025-04-25T02:24:22.917221', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:22.907493"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:22,927 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:22,927 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:22,928 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:22,928 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does machine learning work?'
2025-04-25 02:24:22,929 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:22,929 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:22,929 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:22,932 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:22,932 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:26,634 - CtxMemMgr_User5 - INFO - Stored turn aaeb2ae9-e78a-4602-8d40-c7e62ba2e117 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:26,635 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:26,635 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:26,636 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~463 / 30000
2025-04-25 02:24:26,636 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:26,640 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:26,641 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:26,641 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:26,641 - CtxMemMgr_User5 - INFO - Stored turn 076df567-e163-4a02-a421-41c0bf91c7eb for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:26,642 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:26,642 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:26,642 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~470 / 30000
2025-04-25 02:24:26,642 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:26,645 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:26,646 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:26,646 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:24:27,658 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:27,668 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:27,675 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e9f4a315-d43c-49bb-af06-0c6287f0d0dd', 'timestamp': '2025-04-25T02:24:27.669583', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:27.660827"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:27,680 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:27,681 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:27,682 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:27,683 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a good novel?'
2025-04-25 02:24:27,683 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:27,683 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:27,683 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:27,686 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:27,686 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:32,040 - CtxMemMgr_User5 - INFO - Stored turn c0e93160-347e-43c1-a8b1-8f916c88148e for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:32,040 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:32,040 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:32,041 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~476 / 30000
2025-04-25 02:24:32,041 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:32,046 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:32,046 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:32,046 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:32,047 - CtxMemMgr_User5 - INFO - Stored turn 2ac43a87-e109-4564-a58a-334ea33001e5 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:32,047 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:32,047 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:32,048 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~482 / 30000
2025-04-25 02:24:32,048 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:32,052 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:32,052 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:32,053 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:26:00Z",
    "speaker": "User...
2025-04-25 02:24:33,062 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:33,070 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:33,075 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4854b35e-3f92-48b1-a115-82d0ae7140da', 'timestamp': '2025-04-25T02:24:33.070859', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:33.063580"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:33,080 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:33,080 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:33,081 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:33,081 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the concept of black holes.'
2025-04-25 02:24:33,082 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:33,082 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:33,082 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:33,084 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:33,084 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:36,899 - CtxMemMgr_User5 - INFO - Stored turn 8512dce0-199c-455e-b70a-9e56359cb9f9 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:36,900 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:36,901 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:36,901 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~490 / 30000
2025-04-25 02:24:36,902 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:36,911 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:36,912 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:36,913 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:36,913 - CtxMemMgr_User5 - INFO - Stored turn e131e2a6-12b8-4795-a641-72adf98084ce for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:36,913 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:36,913 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:36,914 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~498 / 30000
2025-04-25 02:24:36,914 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:36,924 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:36,925 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:36,925 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:25:00Z",
    "speaker": "User...
2025-04-25 02:24:37,944 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:37,954 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:37,962 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b1edbd62-e425-427b-9a0b-2d6b61be3f66', 'timestamp': '2025-04-25T02:24:37.955551', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:37.945798"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:37,968 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:37,968 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:37,969 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:37,970 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some sustainable living practices?'
2025-04-25 02:24:37,970 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:37,970 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:37,970 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:37,971 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:37,971 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:42,028 - CtxMemMgr_User5 - INFO - Stored turn f79d456b-5669-4376-8561-e24e07d24907 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:42,029 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:42,029 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:42,029 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~508 / 30000
2025-04-25 02:24:42,030 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:42,037 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:42,037 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:42,038 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:42,038 - CtxMemMgr_User5 - INFO - Stored turn 4ae2d750-d566-4a13-911e-fa7a95ac91a8 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:42,038 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:42,039 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:42,039 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~518 / 30000
2025-04-25 02:24:42,040 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:42,046 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:42,047 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:42,047 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:25:00Z",
    "speaker": "User...
2025-04-25 02:24:43,054 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:43,061 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:43,066 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e7666aae-a6b3-42ad-86cf-f88d1023ba7a', 'timestamp': '2025-04-25T02:24:43.062242', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:43.055489"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:43,071 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:43,072 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:43,073 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:43,073 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do vaccines work?'
2025-04-25 02:24:43,073 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:43,073 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:43,074 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:43,075 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:43,075 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:46,275 - CtxMemMgr_User5 - INFO - Stored turn 9c318f3e-597e-4398-bcd9-4d0e571e79f2 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:46,276 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:46,276 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:46,276 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~523 / 30000
2025-04-25 02:24:46,276 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:46,284 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:46,285 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:46,285 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c).
2025-04-25 02:24:46,286 - CtxMemMgr_User5 - INFO - Stored turn 2dace001-43ee-40dd-9157-a483a73c27dc for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:46,286 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:46,286 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:46,286 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~528 / 30000
2025-04-25 02:24:46,287 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:46,293 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:46,293 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 02:24:46,293 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T02:25:00Z",
    "speaker": "User...
2025-04-25 02:24:47,300 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:47,302 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:47,305 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2fd99d3c-d493-44f6-aa00-cc2f9d133ce1', 'timestamp': '2025-04-25T02:24:47.302663', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:47.300888"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:47,306 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:47,306 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:47,307 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:47,307 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my favorite animal was?'
2025-04-25 02:24:47,307 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:47,307 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:47,307 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:47,308 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:47,308 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:49,695 - CtxMemMgr_User5 - INFO - Stored turn 9c67edc5-2a44-4883-a880-b7c73fad0065 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:49,696 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:49,696 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:49,697 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~539 / 30000
2025-04-25 02:24:49,697 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:49,710 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:49,711 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:49,712 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:24:50,726 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:50,734 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:50,741 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_268f62bd-0c62-4753-ab90-3966ef6bb5b0', 'timestamp': '2025-04-25T02:24:50.735135', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:50.727465"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:50,744 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:50,744 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:50,745 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:50,746 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 02:24:50,746 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:50,746 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:50,746 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:50,748 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:50,749 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:53,047 - CtxMemMgr_User5 - INFO - Stored turn 92edaef3-6d70-4019-bd76-07f315003efe for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:53,047 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:53,048 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:53,048 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~550 / 30000
2025-04-25 02:24:53,048 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:53,062 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:53,062 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:53,063 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:24:54,069 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:54,074 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:54,083 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_37e975eb-0457-4813-b168-b74e00a6825a', 'timestamp': '2025-04-25T02:24:54.074976', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:54.070133"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:54,087 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:54,087 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:54,088 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:54,089 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 02:24:54,089 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:54,089 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:54,089 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:54,090 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:54,091 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:56,076 - CtxMemMgr_User5 - INFO - Stored turn 3bfcfc2e-07e1-4fa4-9f74-e0ce23e90ead for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:56,076 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:56,077 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:56,077 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~561 / 30000
2025-04-25 02:24:56,077 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:56,080 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:56,080 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:56,080 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:24:57,089 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:57,095 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:24:57,100 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_eecc0f8f-a03f-4fde-a624-d91a7b50e290', 'timestamp': '2025-04-25T02:24:57.095729', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:24:57.089856"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:24:57,103 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:57,103 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:24:57,104 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:24:57,104 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 02:24:57,105 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:24:57,105 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:24:57,107 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:24:57,109 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:24:57,109 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:24:59,086 - CtxMemMgr_User5 - INFO - Stored turn b680525b-0afd-4962-b4ea-4360bb364888 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:59,087 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:24:59,087 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:24:59,087 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~568 / 30000
2025-04-25 02:24:59,088 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:24:59,095 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:24:59,095 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:24:59,096 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:25:00,103 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:00,109 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:00,115 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_145f139c-9f10-482c-ab0e-e6677288ddd7', 'timestamp': '2025-04-25T02:25:00.109573', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:25:00.104172"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:25:00,119 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:00,119 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:25:00,120 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:25:00,121 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 02:25:00,121 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:25:00,121 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:25:00,121 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:25:00,123 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:00,123 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:25:02,008 - CtxMemMgr_User5 - INFO - Stored turn e7e544ab-3524-4ccd-8850-bf672e482754 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:02,008 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:25:02,008 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:25:02,009 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~573 / 30000
2025-04-25 02:25:02,009 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:25:02,019 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:02,019 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:25:02,019 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:25:03,027 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:03,034 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:03,041 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ac17c93c-5dad-492e-bacf-bf72dc8e7681', 'timestamp': '2025-04-25T02:25:03.034514', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:25:03.028952"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:25:03,046 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:03,046 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:25:03,048 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:25:03,048 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 02:25:03,048 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:25:03,049 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:25:03,049 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:25:03,050 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:03,051 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:25:05,116 - CtxMemMgr_User5 - INFO - Stored turn c4e2f198-be48-4445-ab32-b544f1524235 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:05,116 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:25:05,117 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:25:05,117 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~581 / 30000
2025-04-25 02:25:05,117 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:25:05,137 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:05,137 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:25:05,138 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:25:06,145 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:06,151 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:06,157 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d973a761-a032-46d0-baf6-7a1e9640cf10', 'timestamp': '2025-04-25T02:25:06.152495', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:25:06.146289"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:25:06,163 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:06,163 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:25:06,164 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:25:06,165 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 02:25:06,165 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:25:06,165 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:25:06,166 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:25:06,168 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:06,169 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:25:08,708 - CtxMemMgr_User5 - INFO - Stored turn 87ae8cba-3cfd-41b9-bc74-8a445233a4ae for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:08,709 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:25:08,709 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:25:08,710 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~589 / 30000
2025-04-25 02:25:08,710 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:25:08,720 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:08,720 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:25:08,721 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:25:09,730 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:09,736 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:09,741 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_41e6818a-4c5f-4a83-9ebd-16a14a00c215', 'timestamp': '2025-04-25T02:25:09.737287', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:25:09.732030"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:25:09,746 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:09,746 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:25:09,748 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:25:09,748 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 02:25:09,748 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:25:09,748 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:25:09,748 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:25:09,750 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:09,750 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:25:11,693 - CtxMemMgr_User5 - INFO - Stored turn 0a41e356-d613-4e68-9203-56c03c7bf8d8 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:11,693 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:25:11,694 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:25:11,694 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~597 / 30000
2025-04-25 02:25:11,694 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:25:11,704 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:11,704 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:25:11,704 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:25:12,714 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:12,720 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:12,725 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_10e22082-609c-4884-b193-8bae9848c30e', 'timestamp': '2025-04-25T02:25:12.721102', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:25:12.716019"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:25:12,731 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:12,732 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:25:12,733 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:25:12,733 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 02:25:12,733 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:25:12,733 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:25:12,733 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:25:12,735 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:12,735 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:25:14,603 - CtxMemMgr_User5 - INFO - Stored turn 699a9cbd-8fac-42a0-9009-8194f8a59539 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:14,605 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:25:14,606 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:25:14,606 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~605 / 30000
2025-04-25 02:25:14,607 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:25:14,619 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:14,619 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:25:14,619 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 02:25:15,630 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:15,636 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 02:25:15,642 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ced2b94a-9685-4874-9095-91dc06ca9e78', 'timestamp': '2025-04-25T02:25:15.637495', 'session_id': '969e43a7-67c5-4567-93e7-182f5c19d19c', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T02:25:15.631526"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 02:25:15,646 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:15,647 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 02:25:15,647 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 02:25:15,647 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 02:25:15,649 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 02:25:15,650 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 02:25:15,650 - components.prompt_builder - INFO - Constructing prompt for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5, depth 0
2025-04-25 02:25:15,650 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 02:25:15,650 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 02:25:15,651 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 02:25:15,651 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 02:25:15,652 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 02:25:15,652 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 02:25:17,587 - CtxMemMgr_User5 - INFO - Stored turn 58295c7f-8e84-4855-8b33-5690d45ff565 for active session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:17,588 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 969e43a7-67c5-4567-93e7-182f5c19d19c: '...'
2025-04-25 02:25:17,588 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 02:25:17,589 - CtxMemMgr_User5 - INFO - Session 969e43a7-67c5-4567-93e7-182f5c19d19c: Active history token count ~614 / 30000
2025-04-25 02:25:17,589 - CtxMemMgr_User5 - INFO - Saving active session context for 969e43a7-67c5-4567-93e7-182f5c19d19c to /app/data/sessions/5/969e43a7-67c5-4567-93e7-182f5c19d19c/context.json
2025-04-25 02:25:17,600 - CtxMemMgr_User5 - INFO - Successfully saved context for session 969e43a7-67c5-4567-93e7-182f5c19d19c
2025-04-25 02:25:17,600 - ActionHandler_User5 - INFO - Processing LLM response for session 969e43a7-67c5-4567-93e7-182f5c19d19c, user 5
2025-04-25 02:25:17,601 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: 969e43a7-67c5-4567-93e7-182f5c19d19c)
2025-04-25 03:56:30,457 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:30,458 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:30,460 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 03:56:30,461 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 03:56:30,461 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 03:56:30,466 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:30,467 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 03:56:30,467 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 03:56:30,467 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 03:56:30,468 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 03:56:30,468 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 03:56:30,468 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 03:56:30,468 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 03:56:30,468 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 03:56:30,468 - ConvMgr_User5 - INFO - Loading session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:30,468 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 03:56:30,468 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 03:56:30,469 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 03:56:30,473 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:30,478 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_270eea7b-3195-417e-8af2-41f39f72a315', 'timestamp': '2025-04-25T03:56:30.473469', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:30.469524"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:30,481 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:30,481 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:30,482 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 03:56:30,482 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 03:56:30,484 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 03:56:30,484 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 03:56:30,484 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:30,485 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 03:56:30,485 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 03:56:30,485 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:30,485 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:30,485 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:30,485 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 03:56:30,487 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:30,487 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:32,681 - CtxMemMgr_User5 - INFO - Loading session eb277301-80d5-40d9-9d31-533df808abff for processing assistant message
2025-04-25 03:56:32,682 - CtxMemMgr_User5 - INFO - Loading session context for eb277301-80d5-40d9-9d31-533df808abff from /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:32,682 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json not found. Initializing empty context for new session eb277301-80d5-40d9-9d31-533df808abff.
2025-04-25 03:56:32,683 - CtxMemMgr_User5 - INFO - Stored turn 4f1b7140-03f9-4727-8032-8b09f17ef4ff for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:32,683 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:32,684 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:32,684 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~15 / 30000
2025-04-25 03:56:32,685 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:32,687 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:32,687 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:32,687 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:32,688 - CtxMemMgr_User5 - INFO - Stored turn 774d276f-99b0-4511-ad42-cfac08d49c39 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:32,688 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:32,688 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:32,688 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~30 / 30000
2025-04-25 03:56:32,689 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:32,690 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:32,690 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:32,690 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:56:33,699 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:33,705 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:33,709 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a61a911f-d12d-4b2a-9ec4-4974d8daa403', 'timestamp': '2025-04-25T03:56:33.705582', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:33.699653"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:33,713 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:33,713 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:33,714 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:33,714 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 03:56:33,714 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:33,715 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:33,715 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:33,716 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:33,717 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:36,315 - CtxMemMgr_User5 - INFO - Stored turn 180a8d4c-273b-4fc6-b5fb-918b8cdae895 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:36,316 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:36,316 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:36,316 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~49 / 30000
2025-04-25 03:56:36,316 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:36,318 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:36,318 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:36,318 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:36,319 - CtxMemMgr_User5 - INFO - Stored turn 9d0894f4-37cf-4a55-af3b-1f0e836fbe8d for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:36,319 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:36,319 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:36,320 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~68 / 30000
2025-04-25 03:56:36,320 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:36,321 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:36,321 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:36,322 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:56:37,332 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:37,339 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:37,344 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5a2c6dc3-83da-4ab5-8e38-171c2b1189f2', 'timestamp': '2025-04-25T03:56:37.340569', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:37.333630"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:37,347 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:37,347 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:37,348 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:37,348 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 03:56:37,348 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:37,348 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:37,349 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:37,351 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:37,351 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:39,645 - CtxMemMgr_User5 - INFO - Stored turn f3d097a1-161e-4dac-8bc9-a9ff4f047ecc for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:39,646 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:39,646 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:39,647 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~87 / 30000
2025-04-25 03:56:39,647 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:39,650 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:39,650 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:39,650 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:39,651 - CtxMemMgr_User5 - INFO - Stored turn bee693df-7452-4b88-a517-01be9c7c97c2 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:39,651 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:39,651 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:39,651 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~106 / 30000
2025-04-25 03:56:39,651 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:39,653 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:39,653 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:39,654 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:56:40,664 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:40,675 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:40,679 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_de08efee-bdfb-4748-a1b5-057d3bbf1e59', 'timestamp': '2025-04-25T03:56:40.675883', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:40.665860"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:40,683 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:40,684 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:40,684 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 03:56:40,685 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 03:56:40,686 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 03:56:40,687 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 03:56:40,687 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:40,688 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 03:56:40,688 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:40,688 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:40,688 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:40,690 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:40,691 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:42,938 - CtxMemMgr_User5 - INFO - Stored turn 7f158838-5c1d-4e18-bbdd-9e0b737777dc for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:42,939 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:42,940 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:42,940 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~122 / 30000
2025-04-25 03:56:42,941 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:42,944 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:42,944 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:42,945 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:42,945 - CtxMemMgr_User5 - INFO - Stored turn 8731ba62-abdb-4490-99f9-ac6261c7327f for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:42,945 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:42,946 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:42,946 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~138 / 30000
2025-04-25 03:56:42,946 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:42,948 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:42,949 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:42,949 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:56:43,955 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:43,961 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:43,965 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_78e2e497-255d-4bde-9665-769f7f77eb62', 'timestamp': '2025-04-25T03:56:43.961492', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:43.956156"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:43,969 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:43,970 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:43,971 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:43,971 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 03:56:43,971 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:43,972 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:43,972 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:43,973 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:43,974 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:46,098 - CtxMemMgr_User5 - INFO - Stored turn 2f842e8f-2e0d-4e3e-893b-d2528492013a for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:46,099 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:46,099 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:46,099 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~158 / 30000
2025-04-25 03:56:46,100 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:46,103 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:46,104 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:46,104 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:46,105 - CtxMemMgr_User5 - INFO - Stored turn c5f91597-58fa-4c18-b733-62148f63cfaa for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:46,105 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:46,105 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:46,105 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~178 / 30000
2025-04-25 03:56:46,106 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:46,109 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:46,109 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:46,110 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:56:47,119 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:47,126 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:47,132 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_3efa6e72-e4bc-4854-9ea9-8219c78ed1a9', 'timestamp': '2025-04-25T03:56:47.127335', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:47.120254"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:47,136 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:47,137 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:47,138 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:47,138 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 03:56:47,139 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:47,139 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:47,139 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:47,142 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:47,142 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:49,684 - CtxMemMgr_User5 - INFO - Stored turn 0a46dad5-2a2e-4a0d-b886-323c5e75d741 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:49,685 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:49,685 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:49,685 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~197 / 30000
2025-04-25 03:56:49,686 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:49,691 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:49,691 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:49,691 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:49,692 - CtxMemMgr_User5 - INFO - Stored turn 4883452a-9066-4597-b102-2fcf86c70517 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:49,692 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:49,692 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:49,693 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~216 / 30000
2025-04-25 03:56:49,693 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:49,695 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:49,695 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:49,696 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:56:50,703 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:50,708 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:50,713 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_14815c2e-940b-43b0-8221-e780b9d8a127', 'timestamp': '2025-04-25T03:56:50.709095', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:50.704371"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:50,719 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:50,719 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:50,721 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:50,721 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 03:56:50,721 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:50,721 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:50,722 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:50,723 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:50,724 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:53,040 - CtxMemMgr_User5 - INFO - Stored turn 0cf0fe37-c18a-4a7e-a114-d59e42f6fd2e for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:53,040 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:53,041 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:53,041 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~235 / 30000
2025-04-25 03:56:53,041 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:53,044 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:53,044 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:53,045 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:53,045 - CtxMemMgr_User5 - INFO - Stored turn b8bbd61d-14dd-49da-b88d-97f6e359dd9c for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:53,045 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:53,045 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:53,046 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~254 / 30000
2025-04-25 03:56:53,046 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:53,049 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:53,049 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:53,050 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:56:54,054 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:54,060 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:54,064 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d11e3610-3350-4eec-adf6-e2674d1055fe', 'timestamp': '2025-04-25T03:56:54.060939', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:54.055568"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:54,068 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:54,068 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:54,069 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:54,069 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 03:56:54,070 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:54,070 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:54,070 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:54,072 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:54,072 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:56,264 - CtxMemMgr_User5 - INFO - Stored turn e9394a2d-5795-4481-8011-9309105d6704 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:56,265 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:56,265 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:56,265 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~271 / 30000
2025-04-25 03:56:56,265 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:56,268 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:56,268 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:56,268 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:56,269 - CtxMemMgr_User5 - INFO - Stored turn 0af7bf6c-a63b-4c1d-889c-31ea1171bdc1 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:56,269 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:56,269 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:56,269 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~288 / 30000
2025-04-25 03:56:56,269 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:56,271 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:56,271 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:56,272 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:56:57,288 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:57,295 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:56:57,301 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_baf1613c-8603-40b3-9cdb-731e56ae72cf', 'timestamp': '2025-04-25T03:56:57.296347', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:56:57.290064"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:56:57,304 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:57,304 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:56:57,304 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:56:57,304 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 03:56:57,305 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:56:57,305 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:56:57,305 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:56:57,305 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:56:57,306 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:56:59,398 - CtxMemMgr_User5 - INFO - Stored turn 8df229ad-860d-4e24-8592-4b6587a6cd74 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:59,399 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:59,399 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:59,399 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~302 / 30000
2025-04-25 03:56:59,399 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:59,402 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:59,402 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:56:59,403 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:56:59,403 - CtxMemMgr_User5 - INFO - Stored turn a291a153-37d5-4e09-9186-669bdc0f760c for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:59,403 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:56:59,403 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:56:59,404 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~316 / 30000
2025-04-25 03:56:59,404 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:56:59,406 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:56:59,407 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:56:59,407 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:57:00,411 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:00,416 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:00,421 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_594502ca-d8e3-403a-a381-72056e29002b', 'timestamp': '2025-04-25T03:57:00.417217', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:00.412434"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:00,424 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:00,424 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:00,425 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:00,426 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 03:57:00,426 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:00,426 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:00,426 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:00,428 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:00,428 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:02,582 - CtxMemMgr_User5 - INFO - Stored turn c8704248-34cc-41bb-9660-5ea37ea52222 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:02,582 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:02,582 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:02,582 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~336 / 30000
2025-04-25 03:57:02,583 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:02,585 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:02,585 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:02,585 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:02,585 - CtxMemMgr_User5 - INFO - Stored turn 8c178bd1-fa4e-41e3-a8b9-cc134e0c09c2 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:02,586 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:02,586 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:02,586 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~356 / 30000
2025-04-25 03:57:02,586 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:02,589 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:02,589 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:02,589 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:03,597 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:03,602 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:03,610 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ed0744c7-d152-4c38-88d7-a926c456c1ba', 'timestamp': '2025-04-25T03:57:03.603552', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:03.598701"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:03,615 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:03,615 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:03,616 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:03,616 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 03:57:03,616 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:03,616 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:03,617 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:03,618 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:03,618 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:08,113 - CtxMemMgr_User5 - INFO - Stored turn 32072828-c94e-4fea-acda-fc4e18976688 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:08,114 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:08,114 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:08,115 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~365 / 30000
2025-04-25 03:57:08,115 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:08,119 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:08,120 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:08,120 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:08,120 - CtxMemMgr_User5 - INFO - Stored turn 3fc7e773-8808-4f09-bdf0-1b646576ff00 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:08,121 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:08,121 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:08,121 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~374 / 30000
2025-04-25 03:57:08,121 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:08,123 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:08,124 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:08,124 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:57:00Z",
    "speaker": "User...
2025-04-25 03:57:09,132 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:09,139 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:09,144 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_795f0329-df30-47a9-b894-3bc04cfc631f', 'timestamp': '2025-04-25T03:57:09.139961', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:09.133974"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:09,148 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:09,148 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:09,149 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:09,149 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 03:57:09,149 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:09,150 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:09,150 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:09,152 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:09,152 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:12,909 - CtxMemMgr_User5 - INFO - Stored turn adf82666-1b6b-4ae4-95dc-86b7ce7c6589 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:12,910 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:12,911 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:12,912 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~388 / 30000
2025-04-25 03:57:12,912 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:12,919 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:12,919 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:12,920 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:12,920 - CtxMemMgr_User5 - INFO - Stored turn ee4b0118-057a-4187-bc1d-ba9491a5165b for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:12,920 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:12,921 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:12,921 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~402 / 30000
2025-04-25 03:57:12,921 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:12,926 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:12,926 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:12,927 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:13,937 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:13,939 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:13,942 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f6e75bf2-0664-4aa8-94fc-43232bcdb358', 'timestamp': '2025-04-25T03:57:13.939881', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:13.937939"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:13,943 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:13,943 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:13,943 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:13,943 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 03:57:13,944 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:13,944 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:13,944 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:13,944 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:13,944 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:17,128 - CtxMemMgr_User5 - INFO - Stored turn d554ec48-f0c0-41c6-8810-1a9e9ddd8af0 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:17,129 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:17,130 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:17,130 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~409 / 30000
2025-04-25 03:57:17,131 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:17,136 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:17,136 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:17,137 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:17,137 - CtxMemMgr_User5 - INFO - Stored turn 698241c6-7d18-4a43-b858-8b37c3adb11c for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:17,138 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:17,138 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:17,138 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~416 / 30000
2025-04-25 03:57:17,139 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:17,145 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:17,146 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:17,147 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:18,155 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:18,163 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:18,168 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_163fd862-fd59-40e2-a649-a24d565adc41', 'timestamp': '2025-04-25T03:57:18.163790', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:18.156835"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:18,173 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:18,174 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:18,175 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:18,175 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are the benefits of meditation?'
2025-04-25 03:57:18,176 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:18,176 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:18,176 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:18,178 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:18,179 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:22,656 - CtxMemMgr_User5 - INFO - Stored turn 5a1e2920-d023-4355-9a65-eb2ba4016564 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:22,656 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:22,658 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:22,659 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~425 / 30000
2025-04-25 03:57:22,659 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:22,665 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:22,665 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:22,666 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:22,666 - CtxMemMgr_User5 - INFO - Stored turn 69013721-3ea8-4b8d-bc09-b2737114b9e0 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:22,667 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:22,667 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:22,668 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~434 / 30000
2025-04-25 03:57:22,669 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:22,677 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:22,677 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:22,678 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:23,685 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:23,692 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:23,698 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_7e5d3c15-3d80-4c0e-b435-aa1387f6fbcf', 'timestamp': '2025-04-25T03:57:23.693254', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:23.686598"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:23,705 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:23,705 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:23,706 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:23,707 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the Renaissance period in Europe.'
2025-04-25 03:57:23,707 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:23,707 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:23,707 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:23,709 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:23,710 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:26,958 - CtxMemMgr_User5 - INFO - Stored turn eaca16a1-e477-46e8-810e-dae0216a9fba for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:26,958 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:26,959 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:26,959 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~445 / 30000
2025-04-25 03:57:26,959 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:26,969 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:26,969 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:26,970 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:26,971 - CtxMemMgr_User5 - INFO - Stored turn 1db770d9-7735-4e5c-b21f-72e70c4f99ca for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:26,972 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:26,972 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:26,975 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~456 / 30000
2025-04-25 03:57:26,975 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:26,983 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:26,983 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:26,984 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:27,996 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:28,007 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:28,017 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_82130dd6-7729-4d75-a817-95b4aa4d31ef', 'timestamp': '2025-04-25T03:57:28.009713', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:27.998248"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:28,024 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:28,024 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:28,025 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:28,026 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does machine learning work?'
2025-04-25 03:57:28,026 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:28,026 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:28,026 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:28,029 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:28,029 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:32,159 - CtxMemMgr_User5 - INFO - Stored turn db4f1a1e-d2b3-4b27-af60-aaef98d20be7 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:32,159 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:32,160 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:32,160 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~463 / 30000
2025-04-25 03:57:32,161 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:32,170 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:32,170 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:32,171 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:32,171 - CtxMemMgr_User5 - INFO - Stored turn 9b3b9a6c-60dd-4b51-b11e-106c195268cb for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:32,171 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:32,171 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:32,172 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~470 / 30000
2025-04-25 03:57:32,172 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:32,178 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:32,178 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:32,179 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:33,187 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:33,193 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:33,198 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_88dc042b-4d98-4480-89bf-1a376375abdf', 'timestamp': '2025-04-25T03:57:33.193938', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:33.188702"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:33,201 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:33,202 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:33,203 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:33,203 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a good novel?'
2025-04-25 03:57:33,203 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:33,204 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:33,204 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:33,206 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:33,206 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:37,110 - CtxMemMgr_User5 - INFO - Stored turn de725d37-4572-42a9-ac64-0a8fcb2c4e8c for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:37,111 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:37,111 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:37,111 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~476 / 30000
2025-04-25 03:57:37,111 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:37,116 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:37,116 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:37,116 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:37,117 - CtxMemMgr_User5 - INFO - Stored turn c29837ef-006d-49be-9c87-5496bb82783e for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:37,117 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:37,117 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:37,117 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~482 / 30000
2025-04-25 03:57:37,118 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:37,122 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:37,122 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:37,123 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:38,128 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:38,133 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:38,139 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_968953f0-a38d-4913-bcaa-1092be6a94e4', 'timestamp': '2025-04-25T03:57:38.134582', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:38.128797"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:38,143 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:38,143 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:38,144 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:38,144 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the concept of black holes.'
2025-04-25 03:57:38,144 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:38,144 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:38,144 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:38,146 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:38,146 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:41,409 - CtxMemMgr_User5 - INFO - Stored turn 8e9a159f-091a-4f60-8b4c-3f9d59b1cca6 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:41,409 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:41,410 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:41,410 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~490 / 30000
2025-04-25 03:57:41,410 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:41,416 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:41,416 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:41,417 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:41,417 - CtxMemMgr_User5 - INFO - Stored turn 763fee3c-1658-4f04-b0f4-fed1db95f7b1 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:41,417 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:41,418 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:41,418 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~498 / 30000
2025-04-25 03:57:41,418 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:41,423 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:41,424 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:41,424 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:42,436 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:42,445 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:42,451 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a852525c-f822-4923-9ca9-ef3bf33fa09b', 'timestamp': '2025-04-25T03:57:42.446059', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:42.437770"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:42,456 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:42,456 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:42,458 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:42,458 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some sustainable living practices?'
2025-04-25 03:57:42,459 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:42,459 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:42,459 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:42,462 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:42,462 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:46,189 - CtxMemMgr_User5 - INFO - Stored turn 4c2abb67-5e82-4be5-b49b-c40a651c141f for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:46,190 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:46,191 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:46,191 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~508 / 30000
2025-04-25 03:57:46,191 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:46,201 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:46,201 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:46,202 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:46,202 - CtxMemMgr_User5 - INFO - Stored turn f5e638af-1f6e-4306-9f11-31c4f4bb4b73 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:46,203 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:46,203 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:46,203 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~518 / 30000
2025-04-25 03:57:46,204 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:46,211 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:46,212 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:46,213 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:47,224 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:47,231 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:47,237 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_3e4d8ea8-6b3e-4232-b37a-1550e178ac7c', 'timestamp': '2025-04-25T03:57:47.231870', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:47.224942"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:47,243 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:47,243 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:47,245 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:47,246 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do vaccines work?'
2025-04-25 03:57:47,246 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:47,247 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:47,247 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:47,250 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:47,251 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:50,332 - CtxMemMgr_User5 - INFO - Stored turn a58ce63d-8393-4337-bd8a-9ae11536ff30 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:50,333 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:50,333 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:50,334 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~523 / 30000
2025-04-25 03:57:50,334 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:50,344 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:50,344 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:50,345 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:57:50,345 - CtxMemMgr_User5 - INFO - Stored turn 98d15a47-d237-4149-a598-0e0cff8dd047 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:50,345 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:50,345 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:50,345 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~528 / 30000
2025-04-25 03:57:50,345 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:50,354 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:50,354 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:57:50,355 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:58:00Z",
    "speaker": "User...
2025-04-25 03:57:51,363 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:51,370 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:51,376 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_436e3463-eceb-414c-adcd-5f8c4708c066', 'timestamp': '2025-04-25T03:57:51.370938', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:51.364738"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:51,383 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:51,383 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:51,385 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:51,386 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my favorite animal was?'
2025-04-25 03:57:51,387 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:51,388 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:51,388 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:51,390 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:51,390 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:53,499 - CtxMemMgr_User5 - INFO - Stored turn e1064725-4804-402a-9c1a-15e3f1fb869f for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:53,500 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:53,500 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:53,500 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~539 / 30000
2025-04-25 03:57:53,501 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:53,510 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:53,511 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:53,511 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:57:54,519 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:54,524 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:54,530 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_18eeaf81-bfbe-458c-9588-03c2526c2ce7', 'timestamp': '2025-04-25T03:57:54.525561', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:54.520616"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:54,533 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:54,534 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:54,536 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:54,536 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 03:57:54,537 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:54,537 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:54,537 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:54,539 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:54,539 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:56,631 - CtxMemMgr_User5 - INFO - Stored turn 33eedca5-ccab-4673-a6c7-70258e92ae61 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:56,632 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:56,632 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:56,633 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~550 / 30000
2025-04-25 03:57:56,633 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:56,642 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:56,642 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:56,643 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:57:57,648 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:57,654 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:57:57,659 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6c17abf5-3734-46a5-a910-479c30ec7311', 'timestamp': '2025-04-25T03:57:57.654703', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:57:57.649023"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:57:57,665 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:57,665 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:57:57,666 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:57:57,667 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 03:57:57,667 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:57:57,667 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:57:57,667 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:57:57,669 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:57:57,669 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:57:59,731 - CtxMemMgr_User5 - INFO - Stored turn 4f29ad59-8ef4-43b4-9bc5-5ec86d41544b for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:59,731 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:57:59,731 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:57:59,731 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~561 / 30000
2025-04-25 03:57:59,732 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:57:59,740 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:57:59,740 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:57:59,740 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:58:00,750 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:00,755 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:00,761 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_c6dfd7d4-6e67-4fab-97eb-d9b8f2460f75', 'timestamp': '2025-04-25T03:58:00.755688', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:58:00.751315"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:58:00,764 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:00,765 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:58:00,766 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:58:00,766 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 03:58:00,766 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:58:00,766 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:58:00,766 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:58:00,768 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:00,768 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:58:02,925 - CtxMemMgr_User5 - INFO - Stored turn 7fbd7170-317c-4147-adb5-435aaaf61fa1 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:02,928 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:02,929 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:02,929 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~568 / 30000
2025-04-25 03:58:02,930 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:02,954 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:02,954 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:58:02,955 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:58:03,969 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:03,976 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:03,984 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_dbb53e27-7475-486d-9f95-78db0ed35bd4', 'timestamp': '2025-04-25T03:58:03.976991', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:58:03.970326"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:58:03,989 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:03,990 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:58:03,992 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:58:03,992 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 03:58:03,993 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:58:03,993 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:58:03,995 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:58:03,997 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:03,998 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:58:06,315 - CtxMemMgr_User5 - INFO - Stored turn f7132ac0-6c21-42b0-8c63-ab1ac0cd9d48 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:06,316 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:06,317 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:06,317 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~573 / 30000
2025-04-25 03:58:06,320 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:06,327 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:06,327 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:58:06,328 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: eb277301-80d5-40d9-9d31-533df808abff).
2025-04-25 03:58:06,328 - CtxMemMgr_User5 - INFO - Stored turn e7bcf2bf-51bb-4b96-b2bd-8cb3a6e2ddc2 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:06,328 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:06,328 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:06,328 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~578 / 30000
2025-04-25 03:58:06,329 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:06,333 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:06,334 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:58:06,334 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:58:07,340 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:07,346 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:07,352 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_cb0ee684-c6f1-4270-9f98-caad15dc1837', 'timestamp': '2025-04-25T03:58:07.347327', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:58:07.341637"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:58:07,355 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:07,355 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:58:07,357 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:58:07,357 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 03:58:07,357 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:58:07,358 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:58:07,358 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:58:07,359 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:07,359 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:58:09,355 - CtxMemMgr_User5 - INFO - Stored turn 857d96eb-a27d-4a36-8c87-68cd8bc03f03 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:09,355 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:09,356 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:09,358 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~586 / 30000
2025-04-25 03:58:09,362 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:09,372 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:09,373 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:58:09,373 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:58:10,379 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:10,387 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:10,393 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8cb2500e-4200-404d-8be8-876a555f9de2', 'timestamp': '2025-04-25T03:58:10.387971', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:58:10.380646"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:58:10,396 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:10,397 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:58:10,398 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:58:10,398 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 03:58:10,398 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:58:10,398 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:58:10,399 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:58:10,400 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:10,401 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:58:12,711 - CtxMemMgr_User5 - INFO - Stored turn 517dc5ed-9535-4564-8fde-1c133556931c for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:12,711 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:12,712 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:12,712 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~594 / 30000
2025-04-25 03:58:12,712 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:12,719 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:12,719 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:58:12,719 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:58:13,741 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:13,746 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:13,751 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_289e4cea-471c-4c0c-93b0-a21d53683299', 'timestamp': '2025-04-25T03:58:13.746568', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:58:13.742808"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:58:13,754 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:13,754 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:58:13,755 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:58:13,756 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 03:58:13,756 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:58:13,756 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:58:13,756 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:58:13,758 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:13,758 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:58:15,689 - CtxMemMgr_User5 - INFO - Stored turn 754f162b-68e5-4f51-9a46-7d3cd8127a98 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:15,689 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:15,689 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:15,690 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~602 / 30000
2025-04-25 03:58:15,690 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:15,697 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:15,698 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:58:15,698 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:58:16,705 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:16,710 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:16,715 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_e2471a25-7a87-4d5a-aea0-02fb0b41163e', 'timestamp': '2025-04-25T03:58:16.711252', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:58:16.705945"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:58:16,719 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:16,719 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:58:16,720 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:58:16,720 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 03:58:16,720 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:58:16,721 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:58:16,721 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:58:16,722 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:16,723 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:58:18,768 - CtxMemMgr_User5 - INFO - Stored turn 05290308-6283-47e1-98cb-5e0d7dd463a8 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:18,768 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:18,769 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:18,769 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~610 / 30000
2025-04-25 03:58:18,770 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:18,778 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:18,778 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:58:18,779 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:58:19,784 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:19,794 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:58:19,805 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d4f6a63c-668e-4171-ad48-81094d3e75d6', 'timestamp': '2025-04-25T03:58:19.795725', 'session_id': 'eb277301-80d5-40d9-9d31-533df808abff', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:58:19.785330"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:58:19,811 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:19,811 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:58:19,813 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 03:58:19,813 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 03:58:19,815 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 03:58:19,816 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 03:58:19,816 - components.prompt_builder - INFO - Constructing prompt for session eb277301-80d5-40d9-9d31-533df808abff, user 5, depth 0
2025-04-25 03:58:19,816 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 03:58:19,816 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:58:19,817 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:58:19,817 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:58:19,818 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:58:19,818 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:58:21,943 - CtxMemMgr_User5 - INFO - Stored turn e4b4180a-63ad-4f71-b1a7-72c02a2fc7c6 for active session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:21,943 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session eb277301-80d5-40d9-9d31-533df808abff: '...'
2025-04-25 03:58:21,944 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:58:21,944 - CtxMemMgr_User5 - INFO - Session eb277301-80d5-40d9-9d31-533df808abff: Active history token count ~619 / 30000
2025-04-25 03:58:21,944 - CtxMemMgr_User5 - INFO - Saving active session context for eb277301-80d5-40d9-9d31-533df808abff to /app/data/sessions/5/eb277301-80d5-40d9-9d31-533df808abff/context.json
2025-04-25 03:58:21,952 - CtxMemMgr_User5 - INFO - Successfully saved context for session eb277301-80d5-40d9-9d31-533df808abff
2025-04-25 03:58:21,952 - ActionHandler_User5 - INFO - Processing LLM response for session eb277301-80d5-40d9-9d31-533df808abff, user 5
2025-04-25 03:58:21,953 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: eb277301-80d5-40d9-9d31-533df808abff)
2025-04-25 03:59:29,550 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:29,551 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:29,552 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 03:59:29,552 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 03:59:29,552 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 03:59:29,554 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:29,555 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 03:59:29,555 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 03:59:29,555 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 03:59:29,555 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 03:59:29,555 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 03:59:29,556 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 03:59:29,556 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 03:59:29,556 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 03:59:29,556 - ConvMgr_User5 - INFO - Loading session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:29,556 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 03:59:29,556 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 03:59:29,556 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 03:59:29,559 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:29,562 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_f4752d65-8f17-4415-9b8e-aa54cdaa237f', 'timestamp': '2025-04-25T03:59:29.559946', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:29.557224"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:29,564 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:29,565 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:29,565 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 03:59:29,565 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 03:59:29,566 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 03:59:29,566 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 03:59:29,567 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:29,567 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 03:59:29,567 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 03:59:29,567 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:29,567 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:29,567 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:29,567 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 03:59:29,568 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:29,568 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:31,634 - CtxMemMgr_User5 - INFO - Loading session cac2bc61-de3c-48bf-ac75-152a7dc0a82a for processing assistant message
2025-04-25 03:59:31,634 - CtxMemMgr_User5 - INFO - Loading session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a from /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:31,635 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json not found. Initializing empty context for new session cac2bc61-de3c-48bf-ac75-152a7dc0a82a.
2025-04-25 03:59:31,635 - CtxMemMgr_User5 - INFO - Stored turn a6aaf14e-724e-4dec-975c-1f79da3e8637 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:31,635 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:31,635 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:31,636 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~15 / 30000
2025-04-25 03:59:31,636 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:31,638 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:31,638 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:31,638 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:31,639 - CtxMemMgr_User5 - INFO - Stored turn f43399b1-ae30-4364-9b50-3da1eaaad42b for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:31,639 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:31,639 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:31,639 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~30 / 30000
2025-04-25 03:59:31,639 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:31,641 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:31,641 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:31,641 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:32,647 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:32,654 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:32,660 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_bcc7ac49-1747-4f51-8cb1-5198da44605b', 'timestamp': '2025-04-25T03:59:32.654705', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:32.648616"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:32,663 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:32,663 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:32,664 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:32,664 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 03:59:32,664 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:32,664 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:32,664 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:32,665 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:32,665 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:34,755 - CtxMemMgr_User5 - INFO - Stored turn 17fe157c-9a9f-4a2f-9803-89327d6b557d for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:34,755 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:34,756 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:34,757 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~49 / 30000
2025-04-25 03:59:34,757 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:34,759 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:34,760 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:34,760 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:34,760 - CtxMemMgr_User5 - INFO - Stored turn 509769db-4201-4a8d-8e26-06fe8aaa0be6 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:34,761 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:34,761 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:34,762 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~68 / 30000
2025-04-25 03:59:34,762 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:34,764 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:34,764 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:34,766 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:35,775 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:35,780 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:35,784 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_ac6c5c02-afc6-44c8-9f9a-cb2ad105432c', 'timestamp': '2025-04-25T03:59:35.780586', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:35.776919"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:35,787 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:35,787 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:35,788 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:35,788 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 03:59:35,788 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:35,789 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:35,789 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:35,790 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:35,791 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:38,129 - CtxMemMgr_User5 - INFO - Stored turn 855c9c23-bb89-47b2-9d6e-7af9844fb399 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:38,129 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:38,131 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:38,132 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~87 / 30000
2025-04-25 03:59:38,132 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:38,134 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:38,134 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:38,135 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:38,135 - CtxMemMgr_User5 - INFO - Stored turn f2a50235-284f-4ca4-bbd0-80fc0da9b647 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:38,135 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:38,136 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:38,136 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~106 / 30000
2025-04-25 03:59:38,137 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:38,139 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:38,139 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:38,140 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:39,152 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:39,161 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:39,168 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6ae18edf-6ce7-4a0a-b4e1-98b06dacfe15', 'timestamp': '2025-04-25T03:59:39.162077', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:39.153388"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:39,178 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:39,178 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:39,183 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 03:59:39,183 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 03:59:39,186 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 03:59:39,188 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 03:59:39,188 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:39,188 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 03:59:39,188 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:39,188 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:39,189 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:39,190 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:39,190 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:41,300 - CtxMemMgr_User5 - INFO - Stored turn dda89f01-dc62-491a-b0a3-6afa8cbc647c for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:41,301 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:41,301 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:41,301 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~122 / 30000
2025-04-25 03:59:41,301 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:41,303 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:41,303 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:41,303 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:41,304 - CtxMemMgr_User5 - INFO - Stored turn 2fbe562e-dd1c-4de6-8e9d-d55fdef3bbcd for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:41,304 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:41,304 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:41,304 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~138 / 30000
2025-04-25 03:59:41,304 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:41,306 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:41,307 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:41,307 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:42,317 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:42,321 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:42,326 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_390de589-c380-4336-af69-d7d1ca43899d', 'timestamp': '2025-04-25T03:59:42.322377', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:42.318092"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:42,329 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:42,329 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:42,330 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:42,331 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my college degree is A Bachelor's in Marine Biology.'
2025-04-25 03:59:42,331 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:42,332 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:42,332 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:42,334 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:42,335 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:44,365 - CtxMemMgr_User5 - INFO - Stored turn c81c7401-9dd8-4d46-92a5-6eba22c990f9 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:44,366 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:44,366 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:44,367 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~158 / 30000
2025-04-25 03:59:44,367 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:44,371 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:44,372 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:44,372 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:44,373 - CtxMemMgr_User5 - INFO - Stored turn 4393348c-c9c7-4eb6-8fc1-71b5a953f259 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:44,373 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:44,373 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:44,373 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~178 / 30000
2025-04-25 03:59:44,374 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:44,376 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:44,377 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:44,377 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:45,386 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:45,395 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:45,401 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2e9294b4-5fe5-40d8-beaa-6e1e88c01562', 'timestamp': '2025-04-25T03:59:45.395588', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:45.388216"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:45,405 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:45,406 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:45,407 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:45,407 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my dream vacation is A month-long tour of Japan.'
2025-04-25 03:59:45,408 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:45,408 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:45,408 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:45,411 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:45,412 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:47,558 - CtxMemMgr_User5 - INFO - Stored turn 4aa83f8e-69bc-4bed-897e-10a2f18e9dae for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:47,558 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:47,559 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:47,559 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~197 / 30000
2025-04-25 03:59:47,559 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:47,563 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:47,564 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:47,564 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:47,565 - CtxMemMgr_User5 - INFO - Stored turn 78ebdbba-2012-4524-aff8-5d8b1e193f6e for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:47,565 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:47,566 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:47,566 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~216 / 30000
2025-04-25 03:59:47,566 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:47,569 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:47,569 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:47,570 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:48,577 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:48,583 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:48,590 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_882e067e-fefc-4dc2-957d-f9dc9f37c242', 'timestamp': '2025-04-25T03:59:48.584423', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:48.578888"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:48,595 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:48,595 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:48,596 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:48,597 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite book is One Hundred Years of Solitude.'
2025-04-25 03:59:48,597 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:48,597 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:48,597 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:48,599 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:48,600 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:50,802 - CtxMemMgr_User5 - INFO - Stored turn bbcfd1ea-aaca-48e9-bd3b-c8ff8b09f9a0 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:50,803 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:50,803 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:50,803 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~235 / 30000
2025-04-25 03:59:50,804 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:50,808 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:50,809 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:50,809 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:50,809 - CtxMemMgr_User5 - INFO - Stored turn f2e86e50-0168-4f54-8018-e4c2419a9dc2 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:50,810 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:50,810 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:50,810 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~254 / 30000
2025-04-25 03:59:50,811 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:50,814 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:50,814 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:50,814 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:51,825 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:51,831 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:51,835 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_80b8803c-a54b-4cfa-b979-7b70cc4e1e4e', 'timestamp': '2025-04-25T03:59:51.831596', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:51.826526"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:51,838 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:51,838 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:51,839 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:51,840 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my least favorite food is Brussels sprouts.'
2025-04-25 03:59:51,840 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:51,840 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:51,840 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:51,842 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:51,842 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:54,046 - CtxMemMgr_User5 - INFO - Stored turn e5bc732b-f054-4162-99a4-1158cf1eb53d for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:54,046 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:54,047 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:54,047 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~271 / 30000
2025-04-25 03:59:54,047 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:54,050 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:54,050 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:54,050 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:54,050 - CtxMemMgr_User5 - INFO - Stored turn 55b90828-0ee0-49f3-a4a5-54c5fef5ec69 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:54,051 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:54,051 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:54,051 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~288 / 30000
2025-04-25 03:59:54,052 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:54,053 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:54,054 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:54,054 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:55,065 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:55,070 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:55,076 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0e9cce6f-3c9f-4017-ac39-87462a413efd', 'timestamp': '2025-04-25T03:59:55.071053', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:55.066299"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:55,080 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:55,080 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:55,081 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:55,082 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my lucky number is Seventeen.'
2025-04-25 03:59:55,082 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:55,082 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:55,082 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:55,085 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:55,085 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 03:59:57,169 - CtxMemMgr_User5 - INFO - Stored turn d03f2086-8be4-484a-aa52-499f2eb2218d for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:57,170 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:57,170 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:57,171 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~302 / 30000
2025-04-25 03:59:57,172 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:57,175 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:57,176 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 03:59:57,176 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 03:59:57,176 - CtxMemMgr_User5 - INFO - Stored turn 1e874064-4066-40ac-8053-080b22666949 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:57,176 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 03:59:57,177 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 03:59:57,177 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~316 / 30000
2025-04-25 03:59:57,177 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 03:59:57,180 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 03:59:57,180 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 03:59:57,181 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 03:59:58,195 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:58,203 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 03:59:58,208 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_dd4addc4-d91b-4537-acfc-8b11c3ddaab7', 'timestamp': '2025-04-25T03:59:58.203721', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T03:59:58.197425"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 03:59:58,214 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:58,214 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 03:59:58,215 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 03:59:58,215 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite season is Autumn, for the colorful leaves.'
2025-04-25 03:59:58,215 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 03:59:58,216 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 03:59:58,216 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 03:59:58,219 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 03:59:58,220 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:00,480 - CtxMemMgr_User5 - INFO - Stored turn 1a97303d-acb6-465c-aa99-57ab559a8479 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:00,481 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:00,481 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:00,482 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~336 / 30000
2025-04-25 04:00:00,482 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:00,485 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:00,485 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:00,485 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:00,486 - CtxMemMgr_User5 - INFO - Stored turn c9801d5f-4eb2-4c13-9908-b43c6e61dd80 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:00,486 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:00,486 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:00,486 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~356 / 30000
2025-04-25 04:00:00,486 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:00,488 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:00,489 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:00,489 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T03:59:00Z",
    "speaker": "User...
2025-04-25 04:00:01,497 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:01,506 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:01,512 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_6809cbcf-26c3-46da-a83d-c5da2265ac9d', 'timestamp': '2025-04-25T04:00:01.507394', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:01.498282"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:01,518 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:01,518 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:01,520 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:01,521 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the history of chocolate.'
2025-04-25 04:00:01,521 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:01,521 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:01,522 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:01,524 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:01,524 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:05,334 - CtxMemMgr_User5 - INFO - Stored turn 26ad1532-85ea-4db2-853b-210074a7e919 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:05,335 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:05,335 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:05,336 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~365 / 30000
2025-04-25 04:00:05,336 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:05,341 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:05,341 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:05,342 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:05,342 - CtxMemMgr_User5 - INFO - Stored turn 741a21e8-7a2d-4a76-8d25-c7b5a0bc7bf9 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:05,343 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:05,344 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:05,344 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~374 / 30000
2025-04-25 04:00:05,345 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:05,351 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:05,351 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:05,351 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:02:00Z",
    "speaker": "User...
2025-04-25 04:00:06,359 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:06,368 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:06,377 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d55f0791-4440-48aa-96f8-2c4227b6e4ed', 'timestamp': '2025-04-25T04:00:06.369243', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:06.361727"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:06,384 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:06,384 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:06,385 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:06,386 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some interesting facts about deep sea creatures?'
2025-04-25 04:00:06,386 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:06,386 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:06,386 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:06,387 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:06,387 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:10,591 - CtxMemMgr_User5 - INFO - Stored turn 771dc1ed-5b60-4f7a-b16b-1105f298d205 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:10,592 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:10,593 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:10,593 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~388 / 30000
2025-04-25 04:00:10,594 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:10,599 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:10,599 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:10,599 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:10,600 - CtxMemMgr_User5 - INFO - Stored turn 753dc870-04ba-4d95-ba83-f1bc5e1ebb55 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:10,600 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:10,601 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:10,601 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~402 / 30000
2025-04-25 04:00:10,601 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:10,604 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:10,604 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:10,605 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:02:00Z",
    "speaker": "User...
2025-04-25 04:00:11,617 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:11,623 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:11,627 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b8685562-8526-47db-bbb4-bb983f7fe7ca', 'timestamp': '2025-04-25T04:00:11.623883', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:11.619064"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:11,632 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:11,632 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:11,632 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:11,633 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain how solar panels work.'
2025-04-25 04:00:11,633 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:11,633 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:11,633 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:11,635 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:11,635 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:15,198 - CtxMemMgr_User5 - INFO - Stored turn ba50587c-5cdf-4c39-89a1-c8a5d5eb195b for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:15,199 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:15,199 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:15,200 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~409 / 30000
2025-04-25 04:00:15,200 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:15,205 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:15,205 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:15,206 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:15,206 - CtxMemMgr_User5 - INFO - Stored turn 3d0b4d88-f3c6-475f-a3d6-55c87e24ae47 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:15,206 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:15,206 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:15,206 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~416 / 30000
2025-04-25 04:00:15,207 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:15,211 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:15,211 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:15,212 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:02:00Z",
    "speaker": "User...
2025-04-25 04:00:16,227 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:16,262 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:16,264 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b628bc66-e12f-44a4-b7a9-2a85f4bd987d', 'timestamp': '2025-04-25T04:00:16.262479', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:16.228212"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:16,266 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:16,266 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:16,266 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:16,266 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are the benefits of meditation?'
2025-04-25 04:00:16,266 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:16,267 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:16,267 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:16,267 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:16,267 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:19,793 - CtxMemMgr_User5 - INFO - Stored turn 3f4bf945-e348-40fa-af04-389142a8f08a for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:19,793 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:19,794 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:19,795 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~425 / 30000
2025-04-25 04:00:19,796 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:19,800 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:19,801 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:19,801 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:19,802 - CtxMemMgr_User5 - INFO - Stored turn 15f2e173-3e4a-495b-8e81-0abf4f886193 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:19,802 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:19,802 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:19,802 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~434 / 30000
2025-04-25 04:00:19,802 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:19,806 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:19,807 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:19,808 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:02:00Z",
    "speaker": "User...
2025-04-25 04:00:20,820 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:20,826 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:20,831 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_884b6eff-447e-4566-b993-7eecb130c15c', 'timestamp': '2025-04-25T04:00:20.826911', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:20.821276"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:20,835 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:20,835 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:20,836 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:20,837 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about the Renaissance period in Europe.'
2025-04-25 04:00:20,837 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:20,837 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:20,837 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:20,839 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:20,839 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:24,312 - CtxMemMgr_User5 - INFO - Stored turn fec8341b-6915-4da5-991f-9c292dc894ef for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:24,313 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:24,313 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:24,313 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~445 / 30000
2025-04-25 04:00:24,313 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:24,317 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:24,317 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:24,317 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:24,318 - CtxMemMgr_User5 - INFO - Stored turn aeedf66c-d3d8-4087-9b4e-0d4f4f8a04c4 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:24,318 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:24,318 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:24,318 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~456 / 30000
2025-04-25 04:00:24,319 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:24,322 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:24,323 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:24,323 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:01:00Z",
    "speaker": "User...
2025-04-25 04:00:25,331 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:25,337 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:25,342 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_4d407882-f847-4b3f-b0ec-c45e0438c1eb', 'timestamp': '2025-04-25T04:00:25.337986', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:25.333030"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:25,345 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:25,345 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:25,346 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:25,346 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How does machine learning work?'
2025-04-25 04:00:25,346 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:25,347 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:25,347 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:25,349 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:25,349 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:29,244 - CtxMemMgr_User5 - INFO - Stored turn 9730eced-f581-47d6-bc0d-9fe50467553a for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:29,245 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:29,245 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:29,246 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~463 / 30000
2025-04-25 04:00:29,246 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:29,251 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:29,251 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:29,251 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:29,252 - CtxMemMgr_User5 - INFO - Stored turn 6e42b297-dcde-4087-93cd-241b598e9d49 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:29,252 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:29,252 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:29,252 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~470 / 30000
2025-04-25 04:00:29,253 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:29,256 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:29,256 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:29,257 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:00:00Z",
    "speaker": "User...
2025-04-25 04:00:30,266 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:30,274 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:30,282 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d9314d83-d845-4385-8d80-99f871e524cc', 'timestamp': '2025-04-25T04:00:30.275213', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:30.267288"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:30,287 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:30,288 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:30,289 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:30,289 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What makes a good novel?'
2025-04-25 04:00:30,289 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:30,290 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:30,290 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:30,292 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:30,292 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:34,693 - CtxMemMgr_User5 - INFO - Stored turn 630107bc-5fb5-40af-9516-962a45f694ea for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:34,693 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:34,694 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:34,694 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~476 / 30000
2025-04-25 04:00:34,695 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:34,702 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:34,703 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:34,703 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:34,704 - CtxMemMgr_User5 - INFO - Stored turn a2ffec55-1f79-4329-8126-64021b1c9bf9 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:34,704 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:34,704 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:34,705 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~482 / 30000
2025-04-25 04:00:34,705 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:34,711 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:34,711 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:34,712 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:02:00Z",
    "speaker": "User...
2025-04-25 04:00:35,721 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:35,727 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:35,732 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_5297e55f-9a60-4061-af43-22f4abcecce8', 'timestamp': '2025-04-25T04:00:35.727839', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:35.722401"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:35,736 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:35,736 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:35,737 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:35,738 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Explain the concept of black holes.'
2025-04-25 04:00:35,738 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:35,738 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:35,738 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:35,740 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:35,740 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:38,550 - CtxMemMgr_User5 - INFO - Stored turn 6293bb75-893b-458c-bb53-1a8f330f8828 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:38,550 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:38,551 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:38,551 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~490 / 30000
2025-04-25 04:00:38,551 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:38,557 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:38,558 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:38,558 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:38,559 - CtxMemMgr_User5 - INFO - Stored turn ed89e805-8f3c-44c0-805f-5390f1ee187e for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:38,559 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:38,559 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:38,559 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~498 / 30000
2025-04-25 04:00:38,560 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:38,564 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:38,565 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:38,565 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:01:00Z",
    "speaker": "User...
2025-04-25 04:00:39,574 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:39,580 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:39,584 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_88983b3a-5697-4b6c-b377-6c5c963b69da', 'timestamp': '2025-04-25T04:00:39.580883', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:39.575374"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:39,588 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:39,588 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:39,589 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:39,589 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What are some sustainable living practices?'
2025-04-25 04:00:39,589 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:39,589 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:39,590 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:39,591 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:39,592 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:43,687 - CtxMemMgr_User5 - INFO - Stored turn c8521894-39ab-42c4-b7e3-78622e6194cc for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:43,687 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:43,687 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:43,688 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~508 / 30000
2025-04-25 04:00:43,688 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:43,695 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:43,696 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:43,696 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:43,696 - CtxMemMgr_User5 - INFO - Stored turn facb0b4b-11c2-4b41-a703-cbb5c0d54e62 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:43,697 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:43,697 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:43,697 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~518 / 30000
2025-04-25 04:00:43,697 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:43,702 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:43,703 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:43,703 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:01:00Z",
    "speaker": "User...
2025-04-25 04:00:44,710 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:44,715 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:44,721 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8c96ea7a-b930-47fd-8c76-ccb26579bbde', 'timestamp': '2025-04-25T04:00:44.716763', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:44.711393"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:44,726 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:44,726 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:44,728 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:44,728 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'How do vaccines work?'
2025-04-25 04:00:44,728 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:44,729 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:44,729 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:44,731 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:44,732 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:48,067 - CtxMemMgr_User5 - INFO - Stored turn 2b51c8de-f9e7-4b34-b3e1-1b2630ccd17a for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:48,067 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:48,068 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:48,068 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~523 / 30000
2025-04-25 04:00:48,068 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:48,074 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:48,074 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:48,075 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:00:48,075 - CtxMemMgr_User5 - INFO - Stored turn b8e9c893-de61-4ef1-8ee7-0f8382f8a3a0 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:48,075 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:48,075 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:48,076 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~528 / 30000
2025-04-25 04:00:48,076 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:48,082 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:48,082 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:00:48,083 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:01:00Z",
    "speaker": "User...
2025-04-25 04:00:49,092 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:49,097 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:49,102 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_379df71a-ba39-48bc-bea0-f1e6f60820e7', 'timestamp': '2025-04-25T04:00:49.098525', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:49.092893"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:49,105 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:49,106 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:49,106 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:49,107 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my favorite animal was?'
2025-04-25 04:00:49,107 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:49,107 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:49,107 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:49,108 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:49,109 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:51,240 - CtxMemMgr_User5 - INFO - Stored turn 4bf27550-b4f8-4a14-bacd-11ab7bcb100c for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:51,240 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:51,240 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:51,240 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~539 / 30000
2025-04-25 04:00:51,241 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:51,247 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:51,247 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:51,248 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:00:52,256 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:52,263 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:52,270 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a4d8097e-8da6-4ed6-aa8d-c765cdb5e4be', 'timestamp': '2025-04-25T04:00:52.264298', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:52.258481"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:52,274 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:52,275 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:52,276 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:52,277 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Can you remind me what my childhood pet was?'
2025-04-25 04:00:52,277 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:52,277 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:52,278 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:52,280 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:52,280 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:54,440 - CtxMemMgr_User5 - INFO - Stored turn 0bc8f639-6d62-4691-bcf4-5c60d44996c4 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:54,440 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:54,441 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:54,441 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~550 / 30000
2025-04-25 04:00:54,441 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:54,447 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:54,447 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:54,448 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:00:55,456 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:55,461 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:55,466 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_b186bf26-a82b-48d5-ba5a-d36dc19c31a2', 'timestamp': '2025-04-25T04:00:55.462454', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:55.457185"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:55,470 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:55,470 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:55,471 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:55,471 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What instrument did I tell you I like the most?'
2025-04-25 04:00:55,471 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:55,471 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:55,472 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:55,473 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:55,473 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:00:57,461 - CtxMemMgr_User5 - INFO - Stored turn 9295d8f9-28ea-4e5e-a428-a8d8658a4114 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:57,461 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:00:57,462 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:00:57,462 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~561 / 30000
2025-04-25 04:00:57,462 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:00:57,469 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:00:57,469 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:00:57,469 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:00:58,479 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:58,485 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:00:58,490 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_2436a840-08b3-4ef5-8f4a-a43e73c5f5f5', 'timestamp': '2025-04-25T04:00:58.485815', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:00:58.480451"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:00:58,493 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:58,494 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:00:58,494 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:00:58,495 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I study in college?'
2025-04-25 04:00:58,495 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:00:58,495 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:00:58,495 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:00:58,496 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:00:58,497 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:01:00,375 - CtxMemMgr_User5 - INFO - Stored turn 4d337ac8-f987-41dc-9153-f1171064b184 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:00,376 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:00,376 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:00,376 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~568 / 30000
2025-04-25 04:01:00,377 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:00,385 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:00,386 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:01:00,386 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:01:01,399 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:01,407 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:01,415 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_8f7af80f-76f6-4830-862b-c846391724d1', 'timestamp': '2025-04-25T04:01:01.408016', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:01:01.401413"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:01:01,422 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:01,422 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:01:01,424 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:01:01,424 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What's my lucky number?'
2025-04-25 04:01:01,424 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:01:01,425 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:01:01,425 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:01:01,427 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:01,428 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:01:03,531 - CtxMemMgr_User5 - INFO - Stored turn f15dc27f-d8c3-407c-8088-58ac74f6d129 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:03,531 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:03,531 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:03,532 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~573 / 30000
2025-04-25 04:01:03,532 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:03,538 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:03,538 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:01:03,538 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a).
2025-04-25 04:01:03,538 - CtxMemMgr_User5 - INFO - Stored turn 81caed19-8744-4cf0-b61f-17dd251b3d95 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:03,538 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:03,539 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:03,539 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~578 / 30000
2025-04-25 04:01:03,539 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:03,544 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:03,545 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:01:03,545 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:03:00Z",
    "speaker": "User...
2025-04-25 04:01:04,552 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:04,558 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:04,563 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_0962d4c6-cfdc-48ff-b0e5-db9d0407b7ca', 'timestamp': '2025-04-25T04:01:04.559021', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:01:04.554215"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:01:04,566 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:04,566 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:01:04,567 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:01:04,567 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What was my least favorite food?'
2025-04-25 04:01:04,567 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:01:04,567 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:01:04,567 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:01:04,569 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:04,569 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:01:06,509 - CtxMemMgr_User5 - INFO - Stored turn b9560ad1-7388-42c6-b687-120e386fee30 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:06,510 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:06,510 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:06,511 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~586 / 30000
2025-04-25 04:01:06,511 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:06,517 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:06,518 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:01:06,518 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:01:07,526 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:07,531 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:07,537 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_88db5314-4808-417c-a243-a52f890ce8f0', 'timestamp': '2025-04-25T04:01:07.532409', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:01:07.527328"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:01:07,541 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:07,542 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:01:07,542 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:01:07,543 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Tell me about my dream vacation.'
2025-04-25 04:01:07,543 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:01:07,543 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:01:07,544 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:01:07,545 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:07,546 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:01:09,867 - CtxMemMgr_User5 - INFO - Stored turn 4a764cae-89b1-4801-8de4-845ba7c287df for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:09,867 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:09,868 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:09,868 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~594 / 30000
2025-04-25 04:01:09,869 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:09,878 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:09,878 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:01:09,878 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:01:10,886 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:10,891 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:10,897 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_a8648326-129d-410a-a272-69dc22b99f0d', 'timestamp': '2025-04-25T04:01:10.892126', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:01:10.886765"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:01:10,902 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:10,902 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:01:10,903 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:01:10,903 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What did I say about my first job?'
2025-04-25 04:01:10,903 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:01:10,903 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:01:10,903 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:01:10,907 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:10,907 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:01:12,848 - CtxMemMgr_User5 - INFO - Stored turn 07620d8e-fb87-475e-ae7d-08b41732925e for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:12,848 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:12,849 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:12,849 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~602 / 30000
2025-04-25 04:01:12,849 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:12,856 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:12,856 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:01:12,856 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:01:13,863 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:13,870 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:13,875 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_1bb1222f-8d3b-4f4f-b93e-7500546ec9ea', 'timestamp': '2025-04-25T04:01:13.871188', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:01:13.865019"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:01:13,881 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:13,881 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:01:13,882 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:01:13,883 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Which season do I like the most?'
2025-04-25 04:01:13,883 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:01:13,883 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:01:13,883 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:01:13,885 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:13,885 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:01:15,801 - CtxMemMgr_User5 - INFO - Stored turn d532b14c-8db1-42d8-9064-4d17a27a4244 for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:15,801 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:15,803 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:15,803 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~610 / 30000
2025-04-25 04:01:15,803 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:15,812 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:15,812 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:01:15,812 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:01:16,820 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:16,825 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:01:16,829 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_706c794a-bafe-4647-b60f-7a88b7776eef', 'timestamp': '2025-04-25T04:01:16.825839', 'session_id': 'cac2bc61-de3c-48bf-ac75-152a7dc0a82a', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:01:16.821292"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:01:16,833 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:16,833 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:01:16,834 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses mention for the favorite.
2025-04-25 04:01:16,834 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 04:01:16,836 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 04:01:16,836 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 04:01:16,837 - components.prompt_builder - INFO - Constructing prompt for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5, depth 0
2025-04-25 04:01:16,837 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'What book did I mention as my favorite?'
2025-04-25 04:01:16,837 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:01:16,837 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:01:16,837 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:01:16,839 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:01:16,839 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:01:18,899 - CtxMemMgr_User5 - INFO - Stored turn 87b35527-d536-4086-9eb1-db816096509e for active session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:18,900 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: '...'
2025-04-25 04:01:18,900 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:01:18,901 - CtxMemMgr_User5 - INFO - Session cac2bc61-de3c-48bf-ac75-152a7dc0a82a: Active history token count ~619 / 30000
2025-04-25 04:01:18,901 - CtxMemMgr_User5 - INFO - Saving active session context for cac2bc61-de3c-48bf-ac75-152a7dc0a82a to /app/data/sessions/5/cac2bc61-de3c-48bf-ac75-152a7dc0a82a/context.json
2025-04-25 04:01:18,907 - CtxMemMgr_User5 - INFO - Successfully saved context for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a
2025-04-25 04:01:18,908 - ActionHandler_User5 - INFO - Processing LLM response for session cac2bc61-de3c-48bf-ac75-152a7dc0a82a, user 5
2025-04-25 04:01:18,908 - ActionHandler_User5 - INFO - Detected tier requests or episodic search in LLM response (Session: cac2bc61-de3c-48bf-ac75-152a7dc0a82a)
2025-04-25 04:08:34,717 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:34,718 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:34,719 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 04:08:34,720 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 04:08:34,720 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 04:08:34,723 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:34,724 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 04:08:34,725 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 04:08:34,726 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 04:08:34,726 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 04:08:34,726 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 04:08:34,727 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 04:08:34,727 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 04:08:34,727 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 04:08:34,728 - ConvMgr_User5 - INFO - Loading session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:34,728 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 04:08:34,728 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 04:08:34,729 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 04:08:34,733 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:34,738 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_9864715a-e0a0-4d38-b3c6-6d248082aec7', 'timestamp': '2025-04-25T04:08:34.734233', 'session_id': '5ca4fb24-47b2-492a-a67d-a93d22c19430', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:08:34.729649"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:08:34,741 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:34,741 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:08:34,742 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses animal for the capybara.
2025-04-25 04:08:34,742 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 04:08:34,744 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 04:08:34,745 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 04:08:34,745 - components.prompt_builder - INFO - Constructing prompt for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5, depth 0
2025-04-25 04:08:34,745 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 04:08:34,745 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite animal is The capybara.'
2025-04-25 04:08:34,745 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:08:34,745 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:08:34,746 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:08:34,746 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 04:08:34,747 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:34,747 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:08:36,934 - CtxMemMgr_User5 - INFO - Loading session 5ca4fb24-47b2-492a-a67d-a93d22c19430 for processing assistant message
2025-04-25 04:08:36,935 - CtxMemMgr_User5 - INFO - Loading session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 from /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:36,935 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json not found. Initializing empty context for new session 5ca4fb24-47b2-492a-a67d-a93d22c19430.
2025-04-25 04:08:36,936 - CtxMemMgr_User5 - INFO - Stored turn f25c898f-7e4a-4f4b-9fb8-212511853b43 for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:36,936 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:36,936 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:36,936 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~15 / 30000
2025-04-25 04:08:36,936 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:36,938 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:36,939 - ActionHandler_User5 - INFO - Processing LLM response for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5
2025-04-25 04:08:36,939 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 5ca4fb24-47b2-492a-a67d-a93d22c19430).
2025-04-25 04:08:36,939 - CtxMemMgr_User5 - INFO - Stored turn ed06bc5e-11f5-48ff-a1b1-d75fa027756a for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:36,939 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:36,939 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:36,940 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~30 / 30000
2025-04-25 04:08:36,940 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:36,941 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:36,941 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:08:36,942 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:09:00Z",
    "speaker": "User...
2025-04-25 04:08:37,951 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:37,956 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:37,961 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_37df3b48-56a1-4450-aca1-b87435b10b39', 'timestamp': '2025-04-25T04:08:37.956478', 'session_id': '5ca4fb24-47b2-492a-a67d-a93d22c19430', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:08:37.951975"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:08:37,964 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:37,965 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:08:37,966 - components.prompt_builder - INFO - Constructing prompt for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5, depth 0
2025-04-25 04:08:37,966 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my childhood pet is A calico cat named Whiskers.'
2025-04-25 04:08:37,966 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:08:37,967 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:08:37,967 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:08:37,969 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:37,969 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:08:40,113 - CtxMemMgr_User5 - INFO - Stored turn 86d8422e-2f8e-46ad-9012-2e8c5e73d0e1 for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:40,114 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:40,114 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:40,114 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~49 / 30000
2025-04-25 04:08:40,114 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:40,116 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:40,116 - ActionHandler_User5 - INFO - Processing LLM response for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5
2025-04-25 04:08:40,116 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 5ca4fb24-47b2-492a-a67d-a93d22c19430).
2025-04-25 04:08:40,117 - CtxMemMgr_User5 - INFO - Stored turn ca17443f-1921-40ac-bd64-fdbcfbd274c7 for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:40,117 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:40,117 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:40,117 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~68 / 30000
2025-04-25 04:08:40,118 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:40,119 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:40,119 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:08:40,120 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:09:00Z",
    "speaker": "User...
2025-04-25 04:08:41,126 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:41,132 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:41,137 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_d418573a-ef46-4140-892d-976bc3437eec', 'timestamp': '2025-04-25T04:08:41.132918', 'session_id': '5ca4fb24-47b2-492a-a67d-a93d22c19430', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:08:41.127234"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:08:41,140 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:41,141 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:08:41,142 - components.prompt_builder - INFO - Constructing prompt for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5, depth 0
2025-04-25 04:08:41,142 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my first job is A barista at a local coffee shop.'
2025-04-25 04:08:41,142 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:08:41,142 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:08:41,142 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:08:41,144 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:41,144 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:08:43,568 - CtxMemMgr_User5 - INFO - Stored turn cddb2a6a-b212-4aa0-b180-c2f46d4ac775 for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:43,568 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:43,568 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:43,568 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~87 / 30000
2025-04-25 04:08:43,569 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:43,571 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:43,571 - ActionHandler_User5 - INFO - Processing LLM response for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5
2025-04-25 04:08:43,571 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 5ca4fb24-47b2-492a-a67d-a93d22c19430).
2025-04-25 04:08:43,571 - CtxMemMgr_User5 - INFO - Stored turn 54c8e013-f9bf-4883-a06e-5af7c4b63ccc for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:43,572 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:43,572 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:43,572 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~106 / 30000
2025-04-25 04:08:43,572 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:43,573 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:43,574 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:08:43,574 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:09:00Z",
    "speaker": "User...
2025-04-25 04:08:44,584 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:44,591 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:08:44,597 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_3ea7ea0d-487e-4ad9-85b1-1f51549f4904', 'timestamp': '2025-04-25T04:08:44.592427', 'session_id': '5ca4fb24-47b2-492a-a67d-a93d22c19430', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:08:44.585358"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:08:44,602 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:44,602 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:08:44,603 - ConvMgr_User5 - INFO - Pattern match extracted: User's project uses instrument for the cello.
2025-04-25 04:08:44,603 - ConvMgr_User5 - INFO - Added 1 new facts to contextual memory
2025-04-25 04:08:44,605 - CtxMemMgr_User5 - ERROR - User 5 not found in DB. Cannot save facts.
2025-04-25 04:08:44,606 - ConvMgr_User5 - INFO - Saved 1 new facts to database
2025-04-25 04:08:44,606 - components.prompt_builder - INFO - Constructing prompt for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5, depth 0
2025-04-25 04:08:44,607 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'I want you to remember that my favorite instrument is The cello.'
2025-04-25 04:08:44,607 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:08:44,607 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:08:44,607 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:08:44,609 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:08:44,609 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:08:46,759 - CtxMemMgr_User5 - INFO - Stored turn b78afa54-0c65-4f8d-adcf-425dd93d4eb0 for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:46,760 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:46,760 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:46,761 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~122 / 30000
2025-04-25 04:08:46,761 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:46,764 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:46,764 - ActionHandler_User5 - INFO - Processing LLM response for session 5ca4fb24-47b2-492a-a67d-a93d22c19430, user 5
2025-04-25 04:08:46,764 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 5ca4fb24-47b2-492a-a67d-a93d22c19430).
2025-04-25 04:08:46,765 - CtxMemMgr_User5 - INFO - Stored turn c4aceebf-cf39-4f88-bc8d-f8050289a076 for active session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:46,765 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 5ca4fb24-47b2-492a-a67d-a93d22c19430: '...'
2025-04-25 04:08:46,765 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:08:46,766 - CtxMemMgr_User5 - INFO - Session 5ca4fb24-47b2-492a-a67d-a93d22c19430: Active history token count ~138 / 30000
2025-04-25 04:08:46,766 - CtxMemMgr_User5 - INFO - Saving active session context for 5ca4fb24-47b2-492a-a67d-a93d22c19430 to /app/data/sessions/5/5ca4fb24-47b2-492a-a67d-a93d22c19430/context.json
2025-04-25 04:08:46,767 - CtxMemMgr_User5 - INFO - Successfully saved context for session 5ca4fb24-47b2-492a-a67d-a93d22c19430
2025-04-25 04:08:46,768 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:08:46,768 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:10:00Z",
    "speaker": "User...
2025-04-25 04:32:18,886 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:32:18,887 - managers.user_session_manager - INFO - Creating new conversation manager for user: 5, session: 07fa14cb-18e4-4c25-906c-0b0327d58ddf
2025-04-25 04:32:18,888 - EpisodicMemMgr_User5 - INFO - Summary index file not found for user 5. Initialized empty index.
2025-04-25 04:32:18,888 - EpisodicMemMgr_User5 - INFO - EpisodicMemoryManager initialized for user 5. Episodic path: /app/data/5/episodic
2025-04-25 04:32:18,888 - CtxMemMgr_User5 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 04:32:18,892 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:32:18,893 - CtxMemMgr_User5 - INFO - ContextualMemoryManager initialized for user 5.
2025-04-25 04:32:18,893 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 04:32:18,894 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 04:32:18,894 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 04:32:18,894 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 04:32:18,894 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 04:32:18,894 - components.prompt_builder - INFO - PromptBuilder initialized for user 5
2025-04-25 04:32:18,895 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 04:32:18,895 - ConvMgr_User5 - INFO - Loading session 07fa14cb-18e4-4c25-906c-0b0327d58ddf
2025-04-25 04:32:18,895 - ConvMgr_User5 - INFO - ConversationManager initialized for user 5
2025-04-25 04:32:18,895 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 04:32:18,895 - components.action_handler - INFO - ActionHandler initialized for user 5
2025-04-25 04:32:18,900 - core.auth.utils - INFO - DEV_AUTO_AUTH enabled - auto-authenticating as user testuser5 (ID: 5)
2025-04-25 04:32:18,904 - api.endpoints.system_messages - ERROR - Database error storing system message: (pymysql.err.IntegrityError) (1452, 'Cannot add or update a child row: a foreign key constraint fails (`rai_chat`.`system_messages`, CONSTRAINT `system_messages_ibfk_1` FOREIGN KEY (`session_id`) REFERENCES `sessions` (`session_id`))')
[SQL: INSERT INTO system_messages 
                          (id, timestamp, session_id, message_type, content) 
                          VALUES (%(id)s, %(timestamp)s, %(session_id)s, %(message_type)s, %(content)s)]
[parameters: {'id': 'sys_93da617f-86ed-47ce-a0e6-cdfb6ccff4b6', 'timestamp': '2025-04-25T04:32:18.901130', 'session_id': '07fa14cb-18e4-4c25-906c-0b0327d58ddf', 'message_type': 'status_update', 'content': '{"status": "processing", "message": "Processing your message...", "timestamp": "2025-04-25T04:32:18.896138"}'}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-04-25 04:32:18,907 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:32:18,907 - ConvMgr_User5 - INFO - Loaded remembered facts from database for user 5
2025-04-25 04:32:18,908 - components.prompt_builder - INFO - Constructing prompt for session 07fa14cb-18e4-4c25-906c-0b0327d58ddf, user 5, depth 0
2025-04-25 04:32:18,909 - CtxMemMgr_User5 - WARNING - Cannot get context summary: No active session.
2025-04-25 04:32:18,909 - EpisodicMemMgr_User5 - INFO - Searching all episodic summaries for user 5, query: 'Remember that my favorite fruit is a dragon fruit'
2025-04-25 04:32:18,909 - EpisodicMemMgr_User5 - INFO - No relevant summaries found across all sessions for user 5.
2025-04-25 04:32:18,909 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 04:32:18,909 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 04:32:18,909 - CtxMemMgr_User5 - WARNING - Cannot get formatted history: No active session.
2025-04-25 04:32:18,911 - CtxMemMgr_User5 - ERROR - User 5 not found in DB during fact loading.
2025-04-25 04:32:18,911 - CtxMemMgr_User5 - INFO - Reloaded 0 facts from database for prompt generation
2025-04-25 04:32:20,929 - CtxMemMgr_User5 - INFO - Loading session 07fa14cb-18e4-4c25-906c-0b0327d58ddf for processing assistant message
2025-04-25 04:32:20,929 - CtxMemMgr_User5 - INFO - Loading session context for 07fa14cb-18e4-4c25-906c-0b0327d58ddf from /app/data/sessions/5/07fa14cb-18e4-4c25-906c-0b0327d58ddf/context.json
2025-04-25 04:32:20,930 - CtxMemMgr_User5 - INFO - Context file /app/data/sessions/5/07fa14cb-18e4-4c25-906c-0b0327d58ddf/context.json not found. Initializing empty context for new session 07fa14cb-18e4-4c25-906c-0b0327d58ddf.
2025-04-25 04:32:20,931 - CtxMemMgr_User5 - INFO - Stored turn df05823c-10c7-4ba6-961f-06a3e5195bfb for active session 07fa14cb-18e4-4c25-906c-0b0327d58ddf
2025-04-25 04:32:20,931 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 07fa14cb-18e4-4c25-906c-0b0327d58ddf: '...'
2025-04-25 04:32:20,932 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:32:20,932 - CtxMemMgr_User5 - INFO - Session 07fa14cb-18e4-4c25-906c-0b0327d58ddf: Active history token count ~12 / 30000
2025-04-25 04:32:20,932 - CtxMemMgr_User5 - INFO - Saving active session context for 07fa14cb-18e4-4c25-906c-0b0327d58ddf to /app/data/sessions/5/07fa14cb-18e4-4c25-906c-0b0327d58ddf/context.json
2025-04-25 04:32:20,934 - CtxMemMgr_User5 - INFO - Successfully saved context for session 07fa14cb-18e4-4c25-906c-0b0327d58ddf
2025-04-25 04:32:20,934 - ActionHandler_User5 - INFO - Processing LLM response for session 07fa14cb-18e4-4c25-906c-0b0327d58ddf, user 5
2025-04-25 04:32:20,935 - ActionHandler_User5 - INFO - No signals detected. Processing as normal answer (Session: 07fa14cb-18e4-4c25-906c-0b0327d58ddf).
2025-04-25 04:32:20,935 - CtxMemMgr_User5 - INFO - Stored turn aa67d756-2acf-4d80-ac07-b57229c510a5 for active session 07fa14cb-18e4-4c25-906c-0b0327d58ddf
2025-04-25 04:32:20,935 - CtxMemMgr_User5 - INFO - Updated current_context_summary for session 07fa14cb-18e4-4c25-906c-0b0327d58ddf: '...'
2025-04-25 04:32:20,936 - CtxMemMgr_User5 - WARNING - Skipping memory extraction (no LLM API or T3 response).
2025-04-25 04:32:20,936 - CtxMemMgr_User5 - INFO - Session 07fa14cb-18e4-4c25-906c-0b0327d58ddf: Active history token count ~24 / 30000
2025-04-25 04:32:20,937 - CtxMemMgr_User5 - INFO - Saving active session context for 07fa14cb-18e4-4c25-906c-0b0327d58ddf to /app/data/sessions/5/07fa14cb-18e4-4c25-906c-0b0327d58ddf/context.json
2025-04-25 04:32:20,940 - CtxMemMgr_User5 - INFO - Successfully saved context for session 07fa14cb-18e4-4c25-906c-0b0327d58ddf
2025-04-25 04:32:20,940 - ActionHandler_User5 - WARNING - Error processing tier3 content: local variable 'json' referenced before assignment
2025-04-25 04:32:20,940 - ActionHandler_User5 - INFO - Final chat response sent (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T04:34:00Z",
    "speaker": "User...
2025-04-25 05:28:21,275 - core.database.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 05:28:21,277 - core.database.connection - INFO - Using MySQL database URL: mysql+pymysql://rai_user:rai_password@mysql:3306/rai_chat
2025-04-25 05:28:21,277 - core.database.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 05:28:21,293 - core.database.connection - INFO - Database connection successful!
2025-04-25 05:28:21,294 - core.database.connection - INFO - Creating database tables if they don't exist...
2025-04-25 05:28:21,297 - core.database.connection - INFO - Database tables created or already exist.
2025-04-25 05:28:21,301 - core.database.connection - INFO - Default user already exists.
2025-04-25 05:28:21,315 - app - INFO - Auth blueprint registered successfully
2025-04-25 05:28:21,327 - app - ERROR - Error registering blueprints: expected 'except' or 'finally' block (conversation_manager.py, line 622)
Traceback (most recent call last):
  File "/app/app.py", line 95, in register_blueprints
    import api.endpoints.chat
  File "/app/api/endpoints/chat.py", line 32, in <module>
    from managers.session import get_user_session_manager
  File "/app/managers/session.py", line 8, in <module>
    from .user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 13, in <module>
    from .conversation_manager import ConversationManager
  File "/app/managers/conversation_manager.py", line 622
    elif action_signal:
    ^^^^
SyntaxError: expected 'except' or 'finally' block
2025-04-25 05:28:21,331 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:16:51,704 - app - ERROR - Error registering blueprints: No module named 'jwt'
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 10, in <module>
    from middleware.auth import token_required
  File "/app/middleware/auth.py", line 9, in <module>
    import jwt
ModuleNotFoundError: No module named 'jwt'
2025-04-25 20:16:51,708 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:21:08,123 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:21:08,123 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:21:08,134 - models.connection - INFO - Database connection successful!
2025-04-25 20:21:08,138 - app - ERROR - Error registering blueprints: No module named 'bcrypt'
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 13, in <module>
    from .handlers.auth import handle_login, handle_register, handle_logout, handle_get_current_user
  File "/app/routes/handlers/auth.py", line 9, in <module>
    from utils.auth_utils import authenticate_user, register_user, generate_token
  File "/app/utils/auth_utils.py", line 10, in <module>
    import bcrypt
ModuleNotFoundError: No module named 'bcrypt'
2025-04-25 20:21:08,142 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:21:47,970 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:21:47,970 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:21:47,981 - models.connection - INFO - Database connection successful!
2025-04-25 20:21:47,990 - app - ERROR - Error registering blueprints: No module named 'core'
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 14, in <module>
    from .handlers.chat import handle_chat, handle_chat_stream, handle_search
  File "/app/routes/handlers/chat.py", line 10, in <module>
    from managers.user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 10, in <module>
    from .chat_file_manager import ChatFileManager
  File "/app/managers/chat_file_manager.py", line 14, in <module>
    from core.database.models import Session as SessionModel
ModuleNotFoundError: No module named 'core'
2025-04-25 20:21:47,994 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:22:51,322 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:22:51,322 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:22:51,332 - models.connection - INFO - Database connection successful!
2025-04-25 20:22:51,344 - app - ERROR - Error registering blueprints: No module named 'utils.path'
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 14, in <module>
    from .handlers.chat import handle_chat, handle_chat_stream, handle_search
  File "/app/routes/handlers/chat.py", line 10, in <module>
    from managers.user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 11, in <module>
    from .memory.contextual_memory import ContextualMemoryManager
  File "/app/managers/memory/contextual_memory.py", line 13, in <module>
    from managers.memory.episodic_memory import EpisodicMemoryManager
  File "/app/managers/memory/episodic_memory.py", line 35, in <module>
    from utils.path import ensure_directory_exists, LOGS_DIR, DATA_DIR # Use full path and import necessary paths/functions (removed get_user_memory_dir)
ModuleNotFoundError: No module named 'utils.path'
2025-04-25 20:22:51,348 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:25:22,905 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:25:22,905 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:25:22,915 - models.connection - INFO - Database connection successful!
2025-04-25 20:25:22,933 - app - ERROR - Error registering blueprints: No module named 'core'
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 14, in <module>
    from .handlers.chat import handle_chat, handle_chat_stream, handle_search
  File "/app/routes/handlers/chat.py", line 10, in <module>
    from managers.user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 13, in <module>
    from .conversation_manager import ConversationManager
  File "/app/managers/conversation_manager.py", line 16, in <module>
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 20:25:22,938 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:26:16,672 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:26:16,672 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:26:16,683 - models.connection - INFO - Database connection successful!
2025-04-25 20:26:16,703 - app - ERROR - Error registering blueprints: No module named 'core'
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 14, in <module>
    from .handlers.chat import handle_chat, handle_chat_stream, handle_search
  File "/app/routes/handlers/chat.py", line 10, in <module>
    from managers.user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 13, in <module>
    from .conversation_manager import ConversationManager
  File "/app/managers/conversation_manager.py", line 24, in <module>
    from components.action_handler import ActionHandler, ACTION_COMMAND_DETECTED  # Import the constant
  File "/app/components/action_handler.py", line 10, in <module>
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 20:26:16,707 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:26:56,961 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:26:56,962 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:26:56,973 - models.connection - INFO - Database connection successful!
2025-04-25 20:26:56,988 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:26:56,988 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:26:56,989 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:26:56,989 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:26:56,989 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:26:56,989 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:26:56,989 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:26:56,989 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:26:56,989 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:26:56,989 - app - ERROR - Error registering blueprints: name 'TYPE_CHECKING' is not defined
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 14, in <module>
    from .handlers.chat import handle_chat, handle_chat_stream, handle_search
  File "/app/routes/handlers/chat.py", line 10, in <module>
    from managers.user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 13, in <module>
    from .conversation_manager import ConversationManager
  File "/app/managers/conversation_manager.py", line 24, in <module>
    from components.action_handler import ActionHandler, ACTION_COMMAND_DETECTED  # Import the constant
  File "/app/components/action_handler.py", line 134, in <module>
    if TYPE_CHECKING:
NameError: name 'TYPE_CHECKING' is not defined
2025-04-25 20:26:56,994 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:30:04,039 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:30:04,039 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:30:04,051 - models.connection - INFO - Database connection successful!
2025-04-25 20:30:04,064 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:30:04,065 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:30:04,065 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:30:04,065 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:30:04,065 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:30:04,065 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:30:04,065 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:30:04,065 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:30:04,065 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:30:04,065 - app - ERROR - Error registering blueprints: name 'Generator' is not defined
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 14, in <module>
    from .handlers.chat import handle_chat, handle_chat_stream, handle_search
  File "/app/routes/handlers/chat.py", line 10, in <module>
    from managers.user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 13, in <module>
    from .conversation_manager import ConversationManager
  File "/app/managers/conversation_manager.py", line 24, in <module>
    from components.action_handler import ActionHandler, ACTION_COMMAND_DETECTED  # Import the constant
  File "/app/components/action_handler.py", line 178, in <module>
    class ActionHandler:
  File "/app/components/action_handler.py", line 376, in ActionHandler
    ) -> Generator[Dict[str, Any], None, Tuple[str, Optional[Any], Optional[str]]]:
NameError: name 'Generator' is not defined
2025-04-25 20:30:04,070 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:31:12,609 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:31:12,609 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:31:12,620 - models.connection - INFO - Database connection successful!
2025-04-25 20:31:12,636 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:31:12,636 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:31:12,636 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:31:12,636 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:31:12,636 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:31:12,636 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:31:12,636 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:31:12,636 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:31:12,636 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:31:12,637 - app - ERROR - Error registering blueprints: cannot import name 'ensure_directory_exists_str' from 'utils.pathconfig' (/app/utils/pathconfig.py)
Traceback (most recent call last):
  File "/app/app.py", line 81, in register_blueprints
    from routes.frontend_api import frontend_api
  File "/app/routes/frontend_api.py", line 14, in <module>
    from .handlers.chat import handle_chat, handle_chat_stream, handle_search
  File "/app/routes/handlers/chat.py", line 10, in <module>
    from managers.user_session_manager import UserSessionManager
  File "/app/managers/user_session_manager.py", line 13, in <module>
    from .conversation_manager import ConversationManager
  File "/app/managers/conversation_manager.py", line 25, in <module>
    from utils.pathconfig import ensure_directory_exists_str
ImportError: cannot import name 'ensure_directory_exists_str' from 'utils.pathconfig' (/app/utils/pathconfig.py)
2025-04-25 20:31:12,641 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:32:16,525 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:32:16,525 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:32:16,537 - models.connection - INFO - Database connection successful!
2025-04-25 20:32:16,552 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:32:16,552 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:32:16,552 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:32:16,553 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:32:16,553 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:32:16,553 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:32:16,553 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:32:16,553 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:32:16,553 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:32:16,554 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:32:16,554 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:32:16,560 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:32:16,560 - app - ERROR - Error registering blueprints: 'Config' object has no attribute 'DEBUG'
Traceback (most recent call last):
  File "/app/app.py", line 87, in register_blueprints
    if app.config.DEBUG:
AttributeError: 'Config' object has no attribute 'DEBUG'
2025-04-25 20:32:16,563 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:33:04,772 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:33:04,772 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:33:04,783 - models.connection - INFO - Database connection successful!
2025-04-25 20:33:04,794 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:33:04,794 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:33:04,794 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:33:04,794 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:33:04,794 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:33:04,794 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:33:04,795 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:33:04,795 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:33:04,795 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:33:04,795 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:33:04,795 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:33:04,799 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:33:04,802 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:34:03,496 - routes.handlers.auth - INFO - Registration attempt for username: jordan, email: jordanahardison@gmail.com
2025-04-25 20:34:03,507 - routes.handlers.auth - ERROR - Registration error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.email' in 'field list'")
[SQL: SELECT users.user_id AS users_user_id, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.is_active AS users_is_active, users.crm_user_id AS users_crm_user_id, users.remembered_facts AS users_remembered_facts 
FROM users 
WHERE users.username = %(username_1)s OR users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'username_1': 'jordan', 'email_1': 'jordanahardison@gmail.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 822, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "/usr/local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.email' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/routes/handlers/auth.py", line 68, in handle_register
    user, error = register_user(username, email, password)
  File "/app/utils/auth_utils.py", line 127, in register_user
    ).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 822, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "/usr/local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.email' in 'field list'")
[SQL: SELECT users.user_id AS users_user_id, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.is_active AS users_is_active, users.crm_user_id AS users_crm_user_id, users.remembered_facts AS users_remembered_facts 
FROM users 
WHERE users.username = %(username_1)s OR users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'username_1': 'jordan', 'email_1': 'jordanahardison@gmail.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-25 20:34:04,587 - routes.handlers.auth - INFO - Registration attempt for username: jordan, email: jordanahardison@gmail.com
2025-04-25 20:34:04,591 - routes.handlers.auth - ERROR - Registration error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.email' in 'field list'")
[SQL: SELECT users.user_id AS users_user_id, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.is_active AS users_is_active, users.crm_user_id AS users_crm_user_id, users.remembered_facts AS users_remembered_facts 
FROM users 
WHERE users.username = %(username_1)s OR users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'username_1': 'jordan', 'email_1': 'jordanahardison@gmail.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 822, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "/usr/local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.email' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/routes/handlers/auth.py", line 68, in handle_register
    user, error = register_user(username, email, password)
  File "/app/utils/auth_utils.py", line 127, in register_user
    ).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 822, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "/usr/local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.email' in 'field list'")
[SQL: SELECT users.user_id AS users_user_id, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.is_active AS users_is_active, users.crm_user_id AS users_crm_user_id, users.remembered_facts AS users_remembered_facts 
FROM users 
WHERE users.username = %(username_1)s OR users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'username_1': 'jordan', 'email_1': 'jordanahardison@gmail.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-25 20:34:13,195 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:34:13,196 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:34:14,921 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:34:28,186 - routes.handlers.auth - INFO - Registration attempt for username: jordan, email: jordanahardison@gmail.com
2025-04-25 20:34:28,191 - routes.handlers.auth - ERROR - Registration error: (pymysql.err.OperationalError) (1054, "Unknown column 'users.email' in 'field list'")
[SQL: SELECT users.user_id AS users_user_id, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.is_active AS users_is_active, users.crm_user_id AS users_crm_user_id, users.remembered_facts AS users_remembered_facts 
FROM users 
WHERE users.username = %(username_1)s OR users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'username_1': 'jordan', 'email_1': 'jordanahardison@gmail.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 822, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "/usr/local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, "Unknown column 'users.email' in 'field list'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/routes/handlers/auth.py", line 68, in handle_register
    user, error = register_user(username, email, password)
  File "/app/utils/auth_utils.py", line 127, in register_user
    ).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2748, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2847, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2308, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2190, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 516, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1639, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1848, in _execute_context
    return self._exec_single_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1988, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2343, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1969, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 922, in do_execute
    cursor.execute(statement, parameters)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
  File "/usr/local/lib/python3.10/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 822, in _read_query_result
    result.read()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 1200, in read
    first_packet = self.connection._read_packet()
  File "/usr/local/lib/python3.10/site-packages/pymysql/connections.py", line 772, in _read_packet
    packet.raise_for_error()
  File "/usr/local/lib/python3.10/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/usr/local/lib/python3.10/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1054, "Unknown column 'users.email' in 'field list'")
[SQL: SELECT users.user_id AS users_user_id, users.username AS users_username, users.email AS users_email, users.hashed_password AS users_hashed_password, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.is_active AS users_is_active, users.crm_user_id AS users_crm_user_id, users.remembered_facts AS users_remembered_facts 
FROM users 
WHERE users.username = %(username_1)s OR users.email = %(email_1)s 
 LIMIT %(param_1)s]
[parameters: {'username_1': 'jordan', 'email_1': 'jordanahardison@gmail.com', 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-25 20:36:53,584 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:36:53,584 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:36:53,600 - models.connection - INFO - Database connection successful!
2025-04-25 20:36:53,600 - models.connection - INFO - Creating database tables if they don't exist...
2025-04-25 20:36:53,604 - models.connection - INFO - Database tables created or already exist.
2025-04-25 20:36:53,620 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:36:53,620 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:36:53,620 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:36:53,620 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:36:53,620 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:36:53,620 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:36:53,620 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:36:53,620 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:36:53,620 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:36:53,621 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:36:53,621 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:36:53,624 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:36:53,628 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:37:50,530 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:37:50,531 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:37:50,548 - models.connection - INFO - Database connection successful!
2025-04-25 20:37:50,548 - models.connection - INFO - Creating database tables if they don't exist...
2025-04-25 20:37:50,548 - models.connection - INFO - Dropping existing tables to ensure schema consistency...
2025-04-25 20:37:50,641 - models.connection - INFO - Database tables created successfully.
2025-04-25 20:37:50,652 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:37:50,652 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:37:50,653 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:37:50,653 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:37:50,653 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:37:50,653 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:37:50,653 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:37:50,653 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:37:50,653 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:37:50,653 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:37:50,653 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:37:50,657 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:37:50,660 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:38:34,353 - routes.handlers.auth - INFO - Registration attempt for username: jordan, email: jordanahardison@gmail.com
2025-04-25 20:38:34,602 - utils.auth_utils - INFO - User jordan (jordanahardison@gmail.com) successfully registered
2025-04-25 20:38:34,603 - routes.handlers.auth - ERROR - Registration error: cannot unpack non-iterable User object
Traceback (most recent call last):
  File "/app/routes/handlers/auth.py", line 68, in handle_register
    user, error = register_user(username, email, password)
TypeError: cannot unpack non-iterable User object
2025-04-25 20:44:18,978 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:44:18,978 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:44:18,993 - models.connection - INFO - Database connection successful!
2025-04-25 20:44:18,994 - models.connection - INFO - Creating database tables if they don't exist...
2025-04-25 20:44:18,994 - models.connection - INFO - Dropping existing tables to ensure schema consistency...
2025-04-25 20:44:19,085 - models.connection - INFO - Database tables created successfully.
2025-04-25 20:44:19,097 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:44:19,097 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:44:19,097 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:44:19,097 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:44:19,098 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:44:19,098 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:44:19,098 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:44:19,098 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:44:19,098 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:44:19,098 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:44:19,098 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:44:19,102 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:44:19,105 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:45:41,546 - routes.handlers.auth - INFO - Registration attempt for username: jordan, email: jordanahardison@gmail.com
2025-04-25 20:45:41,759 - utils.auth_utils - INFO - User jordan (jordanahardison@gmail.com) successfully registered
2025-04-25 20:45:41,759 - routes.handlers.auth - ERROR - Registration error: Instance <User at 0xffff880289a0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):
  File "/app/routes/handlers/auth.py", line 76, in handle_register
    token = generate_token(user.user_id, user.username)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1582, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <User at 0xffff880289a0> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-04-25 20:45:43,635 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:45:43,635 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:45:45,493 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:45:58,539 - routes.handlers.auth - INFO - Login attempt for user: jordanahardison@gmail.com
2025-04-25 20:45:58,743 - utils.auth_utils - INFO - User jordanahardison@gmail.com successfully authenticated
2025-04-25 20:45:58,743 - routes.handlers.auth - ERROR - Login error: Instance <User at 0xffff87fae020> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
Traceback (most recent call last):
  File "/app/routes/handlers/auth.py", line 37, in handle_login
    token = generate_token(user.user_id, user.username)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/attributes.py", line 566, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/attributes.py", line 1086, in get
    value = self._fire_loader_callables(state, key, passive)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/attributes.py", line 1116, in _fire_loader_callables
    return state._load_expired(state, passive)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state.py", line 798, in _load_expired
    self.manager.expired_attribute_loader(self, toload, passive)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 1582, in load_scalar_attributes
    raise orm_exc.DetachedInstanceError(
sqlalchemy.orm.exc.DetachedInstanceError: Instance <User at 0xffff87fae020> is not bound to a Session; attribute refresh operation cannot proceed (Background on this error at: https://sqlalche.me/e/20/bhk3)
2025-04-25 20:47:55,566 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:47:55,566 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:47:55,582 - models.connection - INFO - Database connection successful!
2025-04-25 20:47:55,582 - models.connection - INFO - Creating database tables if they don't exist...
2025-04-25 20:47:55,582 - models.connection - INFO - Dropping existing tables to ensure schema consistency...
2025-04-25 20:47:55,678 - models.connection - INFO - Database tables created successfully.
2025-04-25 20:47:55,692 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:47:55,692 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:47:55,692 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:47:55,692 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:47:55,692 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:47:55,692 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:47:55,692 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:47:55,692 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:47:55,692 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:47:55,693 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:47:55,693 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:47:55,696 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:47:55,700 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:48:17,559 - routes.handlers.auth - INFO - Login attempt for user: jordanahardison@gmail.com
2025-04-25 20:48:17,571 - utils.auth_utils - WARNING - Authentication failed: no user with email jordanahardison@gmail.com
2025-04-25 20:48:17,572 - routes.handlers.auth - WARNING - Failed login attempt for user: jordanahardison@gmail.com
2025-04-25 20:48:21,090 - routes.handlers.auth - INFO - Login attempt for user: jordanahardison@gmail.com
2025-04-25 20:48:21,097 - utils.auth_utils - WARNING - Authentication failed: no user with email jordanahardison@gmail.com
2025-04-25 20:48:21,099 - routes.handlers.auth - WARNING - Failed login attempt for user: jordanahardison@gmail.com
2025-04-25 20:51:17,718 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:51:17,718 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:51:17,734 - models.connection - INFO - Database connection successful!
2025-04-25 20:51:17,734 - models.connection - INFO - Ensuring database tables exist...
2025-04-25 20:51:17,737 - models.connection - INFO - Database tables check completed
2025-04-25 20:51:17,752 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:51:17,752 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:51:17,752 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:51:17,752 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:51:17,752 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:51:17,753 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:51:17,753 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:51:17,753 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:51:17,753 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:51:17,753 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:51:17,753 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:51:17,757 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:51:17,761 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:53:05,007 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:53:05,007 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:53:05,018 - models.connection - INFO - Database connection successful!
2025-04-25 20:53:05,028 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:53:05,028 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:53:05,029 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:53:05,029 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:53:05,029 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:53:05,029 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:53:05,029 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:53:05,029 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:53:05,029 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:53:05,029 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:53:05,029 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:53:05,033 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:53:05,036 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:53:22,781 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:53:22,783 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:53:25,095 - middleware.auth - WARNING - Invalid token: Signature verification failed
2025-04-25 20:53:36,203 - routes.handlers.auth - INFO - Registration attempt for username: jordan, email: jordanahardison@gmail.com
2025-04-25 20:53:36,405 - utils.auth_utils - INFO - User jordan (jordanahardison@gmail.com) successfully registered
2025-04-25 20:53:36,417 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:53:44,024 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 20:53:44,025 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 20:53:44,025 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 20:53:44,026 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745614424012-7clj9
2025-04-25 20:53:44,028 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 20:53:44,029 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 20:53:44,029 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 20:53:44,029 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 20:53:44,030 - CtxMemMgr_User1 - ERROR - Failed to load user remembered facts during initialization: No module named 'core'
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 197, in __init__
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 20:53:44,031 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 20:53:44,031 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 20:53:44,031 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 20:53:44,031 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 20:53:44,033 - routes.handlers.chat - ERROR - Error processing chat request: No module named 'core'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 227, in __init__
    from managers.memory.tier_manager import TierManager
  File "/app/managers/memory/tier_manager.py", line 27, in <module>
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 20:53:56,425 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:54:16,428 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:54:36,420 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:54:56,423 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:55:16,414 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:55:36,418 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:55:56,419 - routes.handlers.session - ERROR - Error retrieving sessions: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
AttributeError: type object 'UserSessionManager' has no attribute 'get_sessions_for_user'
2025-04-25 20:56:04,748 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:56:04,748 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:56:04,759 - models.connection - INFO - Database connection successful!
2025-04-25 20:56:04,771 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:56:04,771 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:56:04,771 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:56:04,771 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:56:04,771 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:56:04,771 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:56:04,771 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:56:04,771 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:56:04,772 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:56:04,772 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:56:04,772 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:56:04,776 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:56:04,779 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:56:15,920 - routes.handlers.auth - INFO - Login attempt for user: jordanahardison@gmail.com
2025-04-25 20:56:16,129 - utils.auth_utils - INFO - User jordanahardison@gmail.com successfully authenticated
2025-04-25 20:56:16,148 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 20:56:16,148 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 20:56:16,148 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 20:56:16,148 - routes.handlers.session - ERROR - Error retrieving sessions: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
  File "/app/managers/user_session_manager.py", line 240, in get_sessions_for_user
    sessions_data = instance.list_sessions(user_id)
  File "/app/managers/user_session_manager.py", line 206, in list_sessions
    return self.file_manager.list_sessions(user_id)
TypeError: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
2025-04-25 20:56:36,145 - routes.handlers.session - ERROR - Error retrieving sessions: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
  File "/app/managers/user_session_manager.py", line 240, in get_sessions_for_user
    sessions_data = instance.list_sessions(user_id)
  File "/app/managers/user_session_manager.py", line 206, in list_sessions
    return self.file_manager.list_sessions(user_id)
TypeError: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
2025-04-25 20:56:41,378 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745614601370-6z2o5
2025-04-25 20:56:41,380 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 20:56:41,381 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 20:56:41,381 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 20:56:41,381 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 20:56:41,382 - CtxMemMgr_User1 - ERROR - Failed to load user remembered facts during initialization: No module named 'core'
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 197, in __init__
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 20:56:41,383 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 20:56:41,384 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 20:56:41,384 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 20:56:41,384 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 20:56:41,386 - routes.handlers.chat - ERROR - Error processing chat request: No module named 'core'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 227, in __init__
    from managers.memory.tier_manager import TierManager
  File "/app/managers/memory/tier_manager.py", line 27, in <module>
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 20:56:56,146 - routes.handlers.session - ERROR - Error retrieving sessions: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
  File "/app/managers/user_session_manager.py", line 240, in get_sessions_for_user
    List of sessions for the user
  File "/app/managers/user_session_manager.py", line 206, in list_sessions
TypeError: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
2025-04-25 20:57:16,152 - routes.handlers.session - ERROR - Error retrieving sessions: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
Traceback (most recent call last):
  File "/app/routes/handlers/session.py", line 22, in handle_get_sessions
    sessions = UserSessionManager.get_sessions_for_user(user_id)
  File "/app/managers/user_session_manager.py", line 240, in get_sessions_for_user
    user_id: The ID of the user
  File "/app/managers/user_session_manager.py", line 206, in list_sessions
TypeError: ChatFileManager.list_sessions() missing 1 required positional argument: 'user_id'
2025-04-25 20:57:41,988 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:57:41,988 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:57:41,999 - models.connection - INFO - Database connection successful!
2025-04-25 20:57:42,009 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:57:42,009 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:57:42,009 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:57:42,009 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:57:42,010 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:57:42,010 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:57:42,010 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:57:42,010 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:57:42,010 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:57:42,010 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:57:42,010 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:57:42,013 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:57:42,017 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:59:10,937 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 20:59:10,937 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 20:59:10,948 - models.connection - INFO - Database connection successful!
2025-04-25 20:59:10,960 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 20:59:10,960 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 20:59:10,960 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 20:59:10,960 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 20:59:10,960 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 20:59:10,960 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 20:59:10,960 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 20:59:10,960 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 20:59:10,960 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 20:59:10,961 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 20:59:10,961 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 20:59:10,964 - app - INFO - Registered unified frontend API blueprint
2025-04-25 20:59:10,968 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 20:59:41,130 - routes.handlers.auth - INFO - Login attempt for user: jordanahardison@gmail.com
2025-04-25 20:59:41,342 - utils.auth_utils - INFO - User jordanahardison@gmail.com successfully authenticated
2025-04-25 20:59:44,879 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 20:59:44,880 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 20:59:44,880 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 20:59:44,881 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745614784863-u7whw
2025-04-25 20:59:44,881 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 20:59:44,882 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 20:59:44,882 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 20:59:44,882 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 20:59:44,882 - CtxMemMgr_User1 - ERROR - Failed to load user remembered facts during initialization: No module named 'core'
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 197, in __init__
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 20:59:44,883 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 20:59:44,883 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 20:59:44,883 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 20:59:44,883 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 20:59:44,884 - routes.handlers.chat - ERROR - Error processing chat request: No module named 'core'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 227, in __init__
    from managers.memory.tier_manager import TierManager
  File "/app/managers/memory/tier_manager.py", line 27, in <module>
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 21:01:34,015 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745614784863-u7whw
2025-04-25 21:01:34,016 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:01:34,016 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:01:34,016 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:01:34,016 - CtxMemMgr_User1 - ERROR - Failed to load user remembered facts during initialization: No module named 'core'
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 197, in __init__
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 21:01:34,017 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:01:34,017 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:01:34,017 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:01:34,017 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:01:34,022 - routes.handlers.chat - ERROR - Error processing chat request: No module named 'utils.imports'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 228, in __init__
    from managers.memory.context_builder import ContextBuilder
  File "/app/managers/memory/context_builder.py", line 10, in <module>
    from utils.imports import ImportPaths
ModuleNotFoundError: No module named 'utils.imports'
2025-04-25 21:01:49,327 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:01:49,327 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:01:49,338 - models.connection - INFO - Database connection successful!
2025-04-25 21:01:49,352 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:01:49,352 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:01:49,352 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:01:49,352 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:01:49,352 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:01:49,352 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:01:49,352 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:01:49,352 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:01:49,353 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 21:01:49,353 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:01:49,353 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:01:49,356 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:01:49,360 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:03:24,605 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:03:24,605 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:03:24,616 - models.connection - INFO - Database connection successful!
2025-04-25 21:03:24,630 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:03:24,630 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:03:24,630 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:03:24,630 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:03:24,630 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:03:24,630 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:03:24,630 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:03:24,631 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:03:24,631 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 21:03:24,631 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:03:24,631 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:03:24,635 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:03:24,640 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:03:52,901 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:03:52,902 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:03:52,902 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:03:52,902 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745615032909-z6juo
2025-04-25 21:03:52,903 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:03:52,904 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:03:52,904 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:03:52,904 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:03:52,905 - CtxMemMgr_User1 - ERROR - Failed to load user remembered facts during initialization: No module named 'core'
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 197, in __init__
    from core.database.connection import get_db
ModuleNotFoundError: No module named 'core'
2025-04-25 21:03:52,907 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:03:52,907 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:03:52,907 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:03:52,907 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:03:52,914 - routes.handlers.chat - ERROR - Error processing chat request: No module named 'utils.imports'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 229, in __init__
    from managers.memory.request_parser import RequestParser
  File "/app/managers/memory/request_parser.py", line 8, in <module>
    from utils.imports import ImportPaths
ModuleNotFoundError: No module named 'utils.imports'
2025-04-25 21:11:10,501 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:11:10,501 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:11:10,513 - models.connection - INFO - Database connection successful!
2025-04-25 21:11:10,530 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:11:10,530 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:11:10,530 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:11:10,530 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:11:10,530 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:11:10,530 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:11:10,530 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:11:10,530 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:11:10,530 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 21:11:10,531 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:11:10,531 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:11:10,534 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:11:10,538 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:11:41,715 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:11:41,716 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:11:41,716 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:11:41,717 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745615501701-8thep
2025-04-25 21:11:41,718 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:11:41,718 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:11:41,718 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:11:41,719 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:11:41,719 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:11:41,721 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:11:41,722 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:11:41,722 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:11:41,722 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:11:41,722 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:11:41,730 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:11:41,730 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:11:41,730 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:11:41,730 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:11:41,731 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:11:41,731 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:11:41,731 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:11:41,731 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:11:41,731 - routes.handlers.chat - ERROR - Error processing chat request: ActionHandler.__init__() missing 2 required positional arguments: 'contextual_memory_manager' and 'episodic_memory_manager'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 258, in __init__
    self.action_handler = ActionHandler()
TypeError: ActionHandler.__init__() missing 2 required positional arguments: 'contextual_memory_manager' and 'episodic_memory_manager'
2025-04-25 21:12:56,094 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:12:56,094 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:12:56,105 - models.connection - INFO - Database connection successful!
2025-04-25 21:12:56,121 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:12:56,121 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:12:56,121 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:12:56,121 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:12:56,121 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:12:56,121 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:12:56,121 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:12:56,121 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:12:56,122 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 21:12:56,122 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:12:56,122 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:12:56,126 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:12:56,129 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:12:59,451 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:12:59,452 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:12:59,452 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:12:59,452 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745615579435-v5oxy
2025-04-25 21:12:59,453 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:12:59,454 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:12:59,454 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:12:59,455 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:12:59,455 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:12:59,457 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:12:59,458 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:12:59,458 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:12:59,458 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:12:59,458 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:12:59,461 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:12:59,461 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:12:59,461 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:12:59,461 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:12:59,461 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:12:59,462 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:12:59,462 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:12:59,462 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:12:59,462 - routes.handlers.chat - ERROR - Error processing chat request: ActionHandler.__init__() missing 2 required positional arguments: 'contextual_memory_manager' and 'episodic_memory_manager'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 258, in __init__
    self.action_handler = ActionHandler()
TypeError: ActionHandler.__init__() missing 2 required positional arguments: 'contextual_memory_manager' and 'episodic_memory_manager'
2025-04-25 21:17:58,365 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745615878354-zrqmv
2025-04-25 21:17:58,367 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:17:58,368 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:17:58,368 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:17:58,369 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:17:58,371 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:17:58,371 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:17:58,371 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:17:58,371 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:17:58,371 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:17:58,372 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:17:58,372 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:17:58,372 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:17:58,372 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:17:58,372 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:17:58,372 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:17:58,372 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:17:58,372 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:17:58,372 - routes.handlers.chat - ERROR - Error processing chat request: ActionHandler.__init__() missing 2 required positional arguments: 'contextual_memory_manager' and 'episodic_memory_manager'
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 40, in handle_chat
    session_id, conversation_manager = UserSessionManager.get_conversation_manager_for_user_session(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 93, in get_conversation_manager_for_user_session
    return instance.get_conversation_manager(user_id, session_id)
  File "/app/managers/user_session_manager.py", line 136, in get_conversation_manager
    conversation_manager = ConversationManager(
  File "/app/managers/conversation_manager.py", line 258, in __init__
    self.action_handler = ActionHandler(
TypeError: ActionHandler.__init__() missing 2 required positional arguments: 'contextual_memory_manager' and 'episodic_memory_manager'
2025-04-25 21:18:28,424 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:18:28,424 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:18:28,435 - models.connection - INFO - Database connection successful!
2025-04-25 21:18:28,450 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:18:28,450 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:18:28,450 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:18:28,450 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:18:28,450 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:18:28,450 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:18:28,450 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:18:28,450 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:18:28,450 - components.action_handler - ERROR - Failed to initialize Tavily: No module named 'tavily'
2025-04-25 21:18:28,451 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:18:28,451 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:18:28,454 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:18:28,457 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:18:42,159 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:18:42,160 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:18:42,160 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:18:42,160 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745615878354-zrqmv
2025-04-25 21:18:42,161 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:18:42,162 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:18:42,162 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:18:42,163 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:18:42,163 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:18:42,165 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:18:42,166 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:18:42,166 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:18:42,166 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:18:42,166 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:18:42,168 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:18:42,168 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:18:42,168 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:18:42,168 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:18:42,168 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:18:42,169 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:18:42,169 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:18:42,169 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:18:42,169 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:18:42,169 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:18:42,169 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:18:42,169 - conversation_manager_1 - INFO - Loading session session-1745615878354-zrqmv
2025-04-25 21:18:42,169 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:18:42,169 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:18:42,169 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:18:42,169 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:18:42,170 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:18:42,175 - conversation_manager_1 - ERROR - Error storing in contextual memory: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 1009, in _store_user_message
    self.contextual_memory.process_user_message(
TypeError: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
2025-04-25 21:18:42,177 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: type object 'Message' has no attribute 'created_at'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 927, in auto_upgrade_important_messages
    .order_by(Message.created_at.desc())\
AttributeError: type object 'Message' has no attribute 'created_at'
2025-04-25 21:18:42,179 - components.prompt_builder - INFO - Constructing prompt for session session-1745615878354-zrqmv, user 1, depth 0
2025-04-25 21:18:42,179 - CtxMemMgr_User1 - WARNING - Cannot get context summary: No active session.
2025-04-25 21:18:42,180 - conversation_manager_1 - ERROR - Error processing message: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 358, in process_message
    system_prompt = self.prompt_builder.construct_prompt(
  File "/app/components/prompt_builder.py", line 57, in construct_prompt
    episodic_summaries = self.episodic_memory.retrieve_memories(
TypeError: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
2025-04-25 21:18:42,180 - routes.handlers.chat - ERROR - Error processing chat request: name 'jsonify' is not defined
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 53, in handle_chat
    return jsonify(final_chunk), 200
NameError: name 'jsonify' is not defined
2025-04-25 21:18:46,549 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745615926541-u48gu
2025-04-25 21:18:46,550 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:18:46,551 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:18:46,551 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:18:46,551 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:18:46,553 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:18:46,554 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:18:46,554 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:18:46,555 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:18:46,555 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:18:46,555 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:18:46,555 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:18:46,555 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:18:46,555 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:18:46,555 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:18:46,555 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:18:46,556 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:18:46,556 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:18:46,556 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:18:46,556 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:18:46,556 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:18:46,556 - conversation_manager_1 - INFO - Loading session session-1745615926541-u48gu
2025-04-25 21:18:46,556 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:18:46,556 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:18:46,556 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:18:46,557 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:18:46,557 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:18:46,560 - conversation_manager_1 - ERROR - Error storing in contextual memory: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 1009, in _store_user_message
    self.contextual_memory.process_user_message(
TypeError: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
2025-04-25 21:18:46,561 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: type object 'Message' has no attribute 'created_at'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 927, in auto_upgrade_important_messages
    .order_by(Message.created_at.desc())\
AttributeError: type object 'Message' has no attribute 'created_at'
2025-04-25 21:18:46,561 - components.prompt_builder - INFO - Constructing prompt for session session-1745615926541-u48gu, user 1, depth 0
2025-04-25 21:18:46,561 - CtxMemMgr_User1 - WARNING - Cannot get context summary: No active session.
2025-04-25 21:18:46,561 - conversation_manager_1 - ERROR - Error processing message: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 358, in process_message
    system_prompt = self.prompt_builder.construct_prompt(
  File "/app/components/prompt_builder.py", line 57, in construct_prompt
    episodic_summaries = self.episodic_memory.retrieve_memories(
TypeError: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
2025-04-25 21:18:46,562 - routes.handlers.chat - ERROR - Error processing chat request: name 'jsonify' is not defined
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 53, in handle_chat
    return jsonify(final_chunk), 200
NameError: name 'jsonify' is not defined
2025-04-25 21:19:30,212 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:19:30,213 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:19:30,227 - models.connection - INFO - Database connection successful!
2025-04-25 21:19:30,235 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:19:30,235 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:19:30,235 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:19:30,236 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:19:30,236 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:19:30,236 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:19:30,236 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:19:30,236 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:19:30,246 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:19:30,246 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:19:30,246 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:19:30,247 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:19:30,247 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:19:30,250 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:19:30,255 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:19:55,179 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:19:55,180 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:19:55,180 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:19:55,181 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745615926541-u48gu
2025-04-25 21:19:55,182 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:19:55,182 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:19:55,182 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:19:55,183 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:19:55,183 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:19:55,185 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:19:55,186 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:19:55,186 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:19:55,186 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:19:55,187 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:19:55,189 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:19:55,190 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:19:55,190 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:19:55,190 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:19:55,190 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:19:55,190 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:19:55,190 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:19:55,190 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:19:55,190 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:19:55,190 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:19:55,191 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:19:55,191 - conversation_manager_1 - INFO - Loading session session-1745615926541-u48gu
2025-04-25 21:19:55,191 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:19:55,191 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:19:55,191 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:19:55,191 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:19:55,191 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:19:55,196 - conversation_manager_1 - ERROR - Error storing in contextual memory: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 1009, in _store_user_message
    self.contextual_memory.process_user_message(
TypeError: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
2025-04-25 21:19:55,199 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: type object 'Message' has no attribute 'created_at'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 927, in auto_upgrade_important_messages
    .order_by(Message.created_at.desc())\
AttributeError: type object 'Message' has no attribute 'created_at'
2025-04-25 21:19:55,204 - components.prompt_builder - INFO - Constructing prompt for session session-1745615926541-u48gu, user 1, depth 0
2025-04-25 21:19:55,204 - CtxMemMgr_User1 - WARNING - Cannot get context summary: No active session.
2025-04-25 21:19:55,204 - conversation_manager_1 - ERROR - Error processing message: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 358, in process_message
    system_prompt = self.prompt_builder.construct_prompt(
  File "/app/components/prompt_builder.py", line 57, in construct_prompt
    episodic_summaries = self.episodic_memory.retrieve_memories(
TypeError: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
2025-04-25 21:19:55,204 - routes.handlers.chat - ERROR - Error processing chat request: name 'jsonify' is not defined
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 53, in handle_chat
    return jsonify(final_chunk), 200
NameError: name 'jsonify' is not defined
2025-04-25 21:22:31,113 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:22:31,114 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:22:31,114 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:22:31,114 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:22:31,115 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:22:31,121 - conversation_manager_1 - ERROR - Error storing in contextual memory: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 1009, in _store_user_message
    self.contextual_memory.process_user_message(
TypeError: ContextualMemoryManager.process_user_message() got multiple values for argument 'session_id'
2025-04-25 21:22:31,124 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: type object 'Message' has no attribute 'created_at'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 927, in auto_upgrade_important_messages
    .order_by(Message.created_at.desc())\
AttributeError: type object 'Message' has no attribute 'created_at'
2025-04-25 21:22:31,125 - components.prompt_builder - INFO - Constructing prompt for session session-1745615926541-u48gu, user 1, depth 0
2025-04-25 21:22:31,125 - CtxMemMgr_User1 - WARNING - Cannot get context summary: No active session.
2025-04-25 21:22:31,125 - conversation_manager_1 - ERROR - Error processing message: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 358, in process_message
    system_prompt = self.prompt_builder.construct_prompt(
  File "/app/components/prompt_builder.py", line 57, in construct_prompt
    episodic_summaries = self.episodic_memory.retrieve_memories(
TypeError: EpisodicMemoryManager.retrieve_memories() got an unexpected keyword argument 'top_k'
2025-04-25 21:22:31,125 - routes.handlers.chat - ERROR - Error processing chat request: name 'jsonify' is not defined
Traceback (most recent call last):
  File "/app/routes/handlers/chat.py", line 53, in handle_chat
    final_chunk = chunks[-1]
NameError: name 'jsonify' is not defined
2025-04-25 21:24:35,558 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:24:35,558 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:24:35,569 - models.connection - INFO - Database connection successful!
2025-04-25 21:24:35,586 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:24:35,586 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:24:35,586 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:24:35,586 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:24:35,586 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:24:35,586 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:24:35,587 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:24:35,587 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:24:35,591 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:24:35,591 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:24:35,591 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:24:35,591 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:24:35,591 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:24:35,595 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:24:35,599 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:24:56,462 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:24:56,463 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:24:56,463 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:24:56,463 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745616296450-hcev6
2025-04-25 21:24:56,464 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:24:56,464 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:24:56,465 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:24:56,465 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:24:56,465 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:24:56,467 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:24:56,468 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:24:56,468 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:24:56,469 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:24:56,469 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:24:56,473 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:24:56,473 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:24:56,473 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:24:56,473 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:24:56,473 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:24:56,474 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:24:56,474 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:24:56,474 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:24:56,474 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:24:56,474 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:24:56,474 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:24:56,475 - conversation_manager_1 - INFO - Loading session session-1745616296450-hcev6
2025-04-25 21:24:56,475 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:24:56,475 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:24:56,475 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:24:56,475 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:24:56,475 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:24:56,481 - CtxMemMgr_User1 - INFO - Loading session context for session-1745616296450-hcev6 from /app/data/1/session-1745616296450-hcev6/context.json
2025-04-25 21:24:56,481 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745616296450-hcev6/context.json not found. Initializing empty context for new session session-1745616296450-hcev6.
2025-04-25 21:24:56,481 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745616296450-hcev6: hi...
2025-04-25 21:24:56,485 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: look-behind requires fixed-width pattern
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 954, in auto_upgrade_important_messages
    if self.importance_scorer.should_auto_upgrade(message_dict):
  File "/app/managers/memory/memory_importance_scorer.py", line 123, in should_auto_upgrade
    importance = self.score_message(message)
  File "/app/managers/memory/memory_importance_scorer.py", line 77, in score_message
    semantic_score = self._calculate_semantic_score(content)
  File "/app/managers/memory/memory_importance_scorer.py", line 248, in _calculate_semantic_score
    entity_matches = re.findall(r'(?<=[.!?]\s|\s)[A-Z][a-zA-Z]+', content)
  File "/usr/local/lib/python3.10/re.py", line 240, in findall
    return _compile(pattern, flags).findall(string)
  File "/usr/local/lib/python3.10/re.py", line 303, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 792, in compile
    code = _code(p, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 631, in _code
    _compile(code, p.data, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 198, in _compile
    raise error("look-behind requires fixed-width pattern")
re.error: look-behind requires fixed-width pattern
2025-04-25 21:24:56,491 - components.prompt_builder - INFO - Constructing prompt for session session-1745616296450-hcev6, user 1, depth 0
2025-04-25 21:24:56,491 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:24:56,491 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:24:56,491 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:24:56,491 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:24:56,492 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:24:56,494 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:24:56,494 - conversation_manager_1 - ERROR - Error generating or processing LLM response: DockerLLMAPI.generate_response() got an unexpected keyword argument 'user_input'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 412, in process_message
    llm_response = self.llm_api.generate_response(
TypeError: DockerLLMAPI.generate_response() got an unexpected keyword argument 'user_input'
2025-04-25 21:25:32,613 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:25:32,614 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:25:32,655 - models.connection - INFO - Database connection successful!
2025-04-25 21:25:32,674 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:25:32,675 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:25:32,675 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:25:32,675 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:25:32,675 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:25:32,675 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:25:32,675 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:25:32,675 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:25:32,683 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:25:32,683 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:25:32,683 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:25:32,683 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:25:32,684 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:25:32,687 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:25:32,692 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:25:56,608 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:25:56,609 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:25:56,610 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:25:56,610 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745616356595-uwrec
2025-04-25 21:25:56,611 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:25:56,612 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:25:56,612 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:25:56,612 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:25:56,613 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:25:56,615 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:25:56,616 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:25:56,616 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:25:56,616 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:25:56,617 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:25:56,620 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:25:56,620 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:25:56,620 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:25:56,620 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:25:56,620 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:25:56,620 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:25:56,620 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:25:56,621 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:25:56,621 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:25:56,621 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:25:56,621 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:25:56,621 - conversation_manager_1 - INFO - Loading session session-1745616356595-uwrec
2025-04-25 21:25:56,621 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:25:56,621 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:25:56,622 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:25:56,622 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:25:56,622 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:25:56,628 - CtxMemMgr_User1 - INFO - Loading session context for session-1745616356595-uwrec from /app/data/1/session-1745616356595-uwrec/context.json
2025-04-25 21:25:56,628 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745616356595-uwrec/context.json not found. Initializing empty context for new session session-1745616356595-uwrec.
2025-04-25 21:25:56,628 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745616356595-uwrec: hi...
2025-04-25 21:25:56,632 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: look-behind requires fixed-width pattern
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 954, in auto_upgrade_important_messages
    if self.importance_scorer.should_auto_upgrade(message_dict):
  File "/app/managers/memory/memory_importance_scorer.py", line 123, in should_auto_upgrade
    importance = self.score_message(message)
  File "/app/managers/memory/memory_importance_scorer.py", line 77, in score_message
    semantic_score = self._calculate_semantic_score(content)
  File "/app/managers/memory/memory_importance_scorer.py", line 248, in _calculate_semantic_score
    entity_matches = re.findall(r'(?<=[.!?]\s|\s)[A-Z][a-zA-Z]+', content)
  File "/usr/local/lib/python3.10/re.py", line 240, in findall
    return _compile(pattern, flags).findall(string)
  File "/usr/local/lib/python3.10/re.py", line 303, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 792, in compile
    code = _code(p, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 631, in _code
    _compile(code, p.data, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 198, in _compile
    raise error("look-behind requires fixed-width pattern")
re.error: look-behind requires fixed-width pattern
2025-04-25 21:25:56,637 - components.prompt_builder - INFO - Constructing prompt for session session-1745616356595-uwrec, user 1, depth 0
2025-04-25 21:25:56,637 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:25:56,637 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:25:56,637 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:25:56,637 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:25:56,638 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:25:56,640 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:25:56,640 - conversation_manager_1 - ERROR - Error generating or processing LLM response: DockerLLMAPI.generate_response() got an unexpected keyword argument 'user_input'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 412, in process_message
    llm_response = self.llm_api.generate_response(
TypeError: DockerLLMAPI.generate_response() got an unexpected keyword argument 'user_input'
2025-04-25 21:27:41,231 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:27:41,231 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:27:41,232 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:27:41,232 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:27:41,232 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:27:41,240 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745616356595-uwrec: hi...
2025-04-25 21:27:41,245 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: look-behind requires fixed-width pattern
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 954, in auto_upgrade_important_messages
    if self.importance_scorer.should_auto_upgrade(message_dict):
  File "/app/managers/memory/memory_importance_scorer.py", line 123, in should_auto_upgrade
    importance = self.score_message(message)
  File "/app/managers/memory/memory_importance_scorer.py", line 77, in score_message
    semantic_score = self._calculate_semantic_score(content)
  File "/app/managers/memory/memory_importance_scorer.py", line 248, in _calculate_semantic_score
    entity_matches = re.findall(r'(?<=[.!?]\s|\s)[A-Z][a-zA-Z]+', content)
  File "/usr/local/lib/python3.10/re.py", line 240, in findall
    return _compile(pattern, flags).findall(string)
  File "/usr/local/lib/python3.10/re.py", line 303, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 792, in compile
    code = _code(p, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 631, in _code
    _compile(code, p.data, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 198, in _compile
    raise error("look-behind requires fixed-width pattern")
re.error: look-behind requires fixed-width pattern
2025-04-25 21:27:41,246 - components.prompt_builder - INFO - Constructing prompt for session session-1745616356595-uwrec, user 1, depth 0
2025-04-25 21:27:41,246 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:27:41,246 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:27:41,246 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:27:41,246 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:27:41,246 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:27:41,250 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:27:41,251 - conversation_manager_1 - ERROR - Error generating or processing LLM response: DockerLLMAPI.generate_response() got an unexpected keyword argument 'user_input'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 412, in process_message
    llm_response = self.llm_api.generate_response(
TypeError: DockerLLMAPI.generate_response() got an unexpected keyword argument 'user_input'
2025-04-25 21:27:55,366 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:27:55,366 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:27:55,377 - models.connection - INFO - Database connection successful!
2025-04-25 21:27:55,392 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:27:55,392 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:27:55,392 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:27:55,393 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:27:55,393 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:27:55,393 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:27:55,393 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:27:55,393 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:27:55,398 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:27:55,398 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:27:55,398 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:27:55,399 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:27:55,399 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:27:55,403 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:27:55,406 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:28:15,263 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:28:15,264 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:28:15,265 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:28:15,265 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745616495252-llibc
2025-04-25 21:28:15,267 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:28:15,268 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:28:15,268 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:28:15,268 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:28:15,268 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:28:15,270 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:28:15,270 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:28:15,270 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:28:15,270 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:28:15,270 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:28:15,273 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:28:15,273 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:28:15,273 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:28:15,273 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:28:15,273 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:28:15,273 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:28:15,273 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:28:15,273 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:28:15,273 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:28:15,274 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:28:15,274 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:28:15,274 - conversation_manager_1 - INFO - Loading session session-1745616495252-llibc
2025-04-25 21:28:15,274 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:28:15,274 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:28:15,274 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:28:15,275 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:28:15,275 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:28:15,280 - CtxMemMgr_User1 - INFO - Loading session context for session-1745616495252-llibc from /app/data/1/session-1745616495252-llibc/context.json
2025-04-25 21:28:15,280 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745616495252-llibc/context.json not found. Initializing empty context for new session session-1745616495252-llibc.
2025-04-25 21:28:15,280 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745616495252-llibc: hi...
2025-04-25 21:28:15,283 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: look-behind requires fixed-width pattern
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 954, in auto_upgrade_important_messages
    if self.importance_scorer.should_auto_upgrade(message_dict):
  File "/app/managers/memory/memory_importance_scorer.py", line 123, in should_auto_upgrade
    importance = self.score_message(message)
  File "/app/managers/memory/memory_importance_scorer.py", line 77, in score_message
    semantic_score = self._calculate_semantic_score(content)
  File "/app/managers/memory/memory_importance_scorer.py", line 248, in _calculate_semantic_score
    entity_matches = re.findall(r'(?<=[.!?]\s|\s)[A-Z][a-zA-Z]+', content)
  File "/usr/local/lib/python3.10/re.py", line 240, in findall
    return _compile(pattern, flags).findall(string)
  File "/usr/local/lib/python3.10/re.py", line 303, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 792, in compile
    code = _code(p, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 631, in _code
    _compile(code, p.data, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 198, in _compile
    raise error("look-behind requires fixed-width pattern")
re.error: look-behind requires fixed-width pattern
2025-04-25 21:28:15,287 - components.prompt_builder - INFO - Constructing prompt for session session-1745616495252-llibc, user 1, depth 0
2025-04-25 21:28:15,287 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:28:15,287 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:28:15,287 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:28:15,287 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:28:15,287 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:28:15,289 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:28:17,431 - conversation_manager_1 - ERROR - Error generating or processing LLM response: ActionHandler.process_llm_response() got an unexpected keyword argument 'llm_response'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 418, in process_message
    action_signal, action_result, action_type = self.action_handler.process_llm_response(
TypeError: ActionHandler.process_llm_response() got an unexpected keyword argument 'llm_response'
2025-04-25 21:29:58,732 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745616598725-5k28p
2025-04-25 21:29:58,733 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:29:58,734 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:29:58,734 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:29:58,734 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:29:58,736 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:29:58,737 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:29:58,737 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:29:58,737 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:29:58,738 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:29:58,738 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:29:58,738 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:29:58,738 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:29:58,738 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:29:58,738 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:29:58,739 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:29:58,739 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:29:58,739 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:29:58,739 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:29:58,739 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:29:58,739 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:29:58,739 - conversation_manager_1 - INFO - Loading session session-1745616598725-5k28p
2025-04-25 21:29:58,740 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:29:58,740 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:29:58,740 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:29:58,740 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:29:58,740 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:29:58,744 - CtxMemMgr_User1 - INFO - Loading session context for session-1745616598725-5k28p from /app/data/1/session-1745616598725-5k28p/context.json
2025-04-25 21:29:58,744 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745616598725-5k28p/context.json not found. Initializing empty context for new session session-1745616598725-5k28p.
2025-04-25 21:29:58,744 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745616598725-5k28p: hi...
2025-04-25 21:29:58,747 - conversation_manager_1 - ERROR - Error in auto_upgrade_important_messages: look-behind requires fixed-width pattern
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 954, in auto_upgrade_important_messages
    if self.importance_scorer.should_auto_upgrade(message_dict):
  File "/app/managers/memory/memory_importance_scorer.py", line 123, in should_auto_upgrade
    importance = self.score_message(message)
  File "/app/managers/memory/memory_importance_scorer.py", line 77, in score_message
    semantic_score = self._calculate_semantic_score(content)
  File "/app/managers/memory/memory_importance_scorer.py", line 248, in _calculate_semantic_score
    entity_matches = re.findall(r'(?<=[.!?]\s|\s)[A-Z][a-zA-Z]+', content)
  File "/usr/local/lib/python3.10/re.py", line 240, in findall
    return _compile(pattern, flags).findall(string)
  File "/usr/local/lib/python3.10/re.py", line 303, in _compile
    p = sre_compile.compile(pattern, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 792, in compile
    code = _code(p, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 631, in _code
    _compile(code, p.data, flags)
  File "/usr/local/lib/python3.10/sre_compile.py", line 198, in _compile
    raise error("look-behind requires fixed-width pattern")
re.error: look-behind requires fixed-width pattern
2025-04-25 21:29:58,748 - components.prompt_builder - INFO - Constructing prompt for session session-1745616598725-5k28p, user 1, depth 0
2025-04-25 21:29:58,748 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:29:58,748 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:29:58,748 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:29:58,748 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:29:58,748 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:29:58,751 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:30:00,459 - conversation_manager_1 - ERROR - Error generating or processing LLM response: ActionHandler.process_llm_response() got an unexpected keyword argument 'llm_response'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 418, in process_message
    action_signal, action_result, action_type = self.action_handler.process_llm_response(
TypeError: ActionHandler.process_llm_response() got an unexpected keyword argument 'llm_response'
2025-04-25 21:31:00,992 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:31:00,992 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:31:01,002 - models.connection - INFO - Database connection successful!
2025-04-25 21:31:01,018 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:31:01,018 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:31:01,019 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:31:01,019 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:31:01,019 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:31:01,019 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:31:01,019 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:31:01,019 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:31:01,023 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:31:01,024 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:31:01,024 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:31:01,024 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:31:01,024 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:31:01,028 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:31:01,032 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:31:11,499 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:31:11,500 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:31:11,500 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:31:11,501 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745616671482-i0njk
2025-04-25 21:31:11,502 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:31:11,502 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:31:11,502 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:31:11,503 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:31:11,503 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:31:11,506 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:31:11,506 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:31:11,506 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:31:11,506 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:31:11,507 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:31:11,510 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:31:11,510 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:31:11,510 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:31:11,510 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:31:11,510 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:31:11,510 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:31:11,510 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:31:11,510 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:31:11,511 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:31:11,511 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:31:11,511 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:31:11,511 - conversation_manager_1 - INFO - Loading session session-1745616671482-i0njk
2025-04-25 21:31:11,511 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:31:11,511 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:31:11,511 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:31:11,511 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:31:11,511 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:31:11,516 - CtxMemMgr_User1 - INFO - Loading session context for session-1745616671482-i0njk from /app/data/1/session-1745616671482-i0njk/context.json
2025-04-25 21:31:11,516 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745616671482-i0njk/context.json not found. Initializing empty context for new session session-1745616671482-i0njk.
2025-04-25 21:31:11,516 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745616671482-i0njk: hi...
2025-04-25 21:31:11,524 - components.prompt_builder - INFO - Constructing prompt for session session-1745616671482-i0njk, user 1, depth 0
2025-04-25 21:31:11,525 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:31:11,525 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:31:11,525 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:31:11,525 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:31:11,525 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:31:11,527 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:31:13,216 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745616671482-i0njk, user 1
2025-04-25 21:31:13,217 - ActionHandler_User1 - ERROR - Invalid or missing response_data received from LLM for session session-1745616671482-i0njk.
2025-04-25 21:31:13,217 - conversation_manager_1 - ERROR - Error generating or processing LLM response: not enough values to unpack (expected 3, got 0)
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 418, in process_message
    action_signal, action_result, action_type = self.action_handler.process_llm_response(
ValueError: not enough values to unpack (expected 3, got 0)
2025-04-25 21:36:31,870 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:36:31,870 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:36:31,880 - models.connection - INFO - Database connection successful!
2025-04-25 21:36:31,894 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:36:31,894 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:36:31,894 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:36:31,894 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:36:31,894 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:36:31,894 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:36:31,894 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:36:31,894 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:36:31,899 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:36:31,899 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:36:31,899 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:36:31,899 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:36:31,900 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:36:31,903 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:36:31,908 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:36:49,637 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:36:49,637 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:36:49,637 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:36:49,638 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745617009623-asz1e
2025-04-25 21:36:49,638 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:36:49,639 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:36:49,639 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:36:49,639 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:36:49,640 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:36:49,641 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:36:49,642 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:36:49,642 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:36:49,642 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:36:49,643 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:36:49,646 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:36:49,646 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:36:49,647 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:36:49,647 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:36:49,647 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:36:49,647 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:36:49,647 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:36:49,647 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:36:49,648 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:36:49,648 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:36:49,648 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:36:49,648 - conversation_manager_1 - INFO - Loading session session-1745617009623-asz1e
2025-04-25 21:36:49,648 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:36:49,648 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:36:49,648 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:36:49,649 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:36:49,649 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:36:49,654 - CtxMemMgr_User1 - INFO - Loading session context for session-1745617009623-asz1e from /app/data/1/session-1745617009623-asz1e/context.json
2025-04-25 21:36:49,654 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745617009623-asz1e/context.json not found. Initializing empty context for new session session-1745617009623-asz1e.
2025-04-25 21:36:49,654 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745617009623-asz1e: hi...
2025-04-25 21:36:49,662 - components.prompt_builder - INFO - Constructing prompt for session session-1745617009623-asz1e, user 1, depth 0
2025-04-25 21:36:49,662 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:36:49,662 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:36:49,662 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:36:49,663 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:36:49,663 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:36:49,665 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:36:52,702 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745617009623-asz1e, user 1
2025-04-25 21:36:52,702 - ActionHandler_User1 - ERROR - Unexpected response_data format: neither 'llm_response' nor 'response' found
2025-04-25 21:36:52,702 - conversation_manager_1 - ERROR - Error generating or processing LLM response: not enough values to unpack (expected 3, got 0)
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 418, in process_message
    action_signal, action_result, action_type = self.action_handler.process_llm_response(
ValueError: not enough values to unpack (expected 3, got 0)
2025-04-25 21:38:46,613 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:38:46,613 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:38:46,624 - models.connection - INFO - Database connection successful!
2025-04-25 21:38:46,640 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:38:46,640 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:38:46,640 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:38:46,640 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:38:46,640 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:38:46,640 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:38:46,640 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:38:46,641 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:38:46,645 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:38:46,645 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:38:46,645 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:38:46,646 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:38:46,646 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:38:46,650 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:38:46,654 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:39:12,769 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:39:12,769 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:39:12,769 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:39:12,770 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745617152756-7adf8
2025-04-25 21:39:12,771 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:39:12,771 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:39:12,772 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:39:12,772 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:39:12,772 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:39:12,774 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:39:12,774 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:39:12,774 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:39:12,774 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:39:12,775 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:39:12,777 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:39:12,777 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:39:12,777 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:39:12,778 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:39:12,778 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:39:12,778 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:39:12,778 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:39:12,778 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:39:12,778 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:39:12,778 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:39:12,778 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:39:12,778 - conversation_manager_1 - INFO - Loading session session-1745617152756-7adf8
2025-04-25 21:39:12,778 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:39:12,778 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:39:12,779 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:39:12,779 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:39:12,779 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:39:12,783 - CtxMemMgr_User1 - INFO - Loading session context for session-1745617152756-7adf8 from /app/data/1/session-1745617152756-7adf8/context.json
2025-04-25 21:39:12,783 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745617152756-7adf8/context.json not found. Initializing empty context for new session session-1745617152756-7adf8.
2025-04-25 21:39:12,783 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745617152756-7adf8: hi...
2025-04-25 21:39:12,789 - components.prompt_builder - INFO - Constructing prompt for session session-1745617152756-7adf8, user 1, depth 0
2025-04-25 21:39:12,789 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:39:12,789 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:39:12,789 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:39:12,789 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:39:12,789 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:39:12,792 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:39:14,666 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T21:40:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 21:39:14,666 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:39:14,667 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:39:14,667 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:39:14,667 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:39:14,667 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 21:39:14,667 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 21:39:14,667 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745617152756-7adf8, user 1
2025-04-25 21:39:14,668 - ActionHandler_User1 - ERROR - Unexpected response_data format: neither 'llm_response' nor 'response' found
2025-04-25 21:39:14,668 - conversation_manager_1 - ERROR - Error generating or processing LLM response: not enough values to unpack (expected 3, got 0)
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 433, in process_message
    action_signal, action_result, action_type = self.action_handler.process_llm_response(
ValueError: not enough values to unpack (expected 3, got 0)
2025-04-25 21:44:15,215 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:44:15,215 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:44:15,225 - models.connection - INFO - Database connection successful!
2025-04-25 21:44:15,240 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:44:15,240 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:44:15,240 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:44:15,240 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:44:15,241 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:44:15,241 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:44:15,241 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:44:15,241 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:44:15,246 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:44:15,246 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:44:15,246 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:44:15,247 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:44:15,247 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:44:15,250 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:44:15,254 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:44:35,578 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:44:35,580 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:44:35,580 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:44:35,580 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745617475566-axrfr
2025-04-25 21:44:35,581 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:44:35,582 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:44:35,582 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:44:35,582 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:44:35,583 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:44:35,585 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:44:35,585 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:44:35,585 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:44:35,585 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:44:35,586 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:44:35,589 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:44:35,589 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:44:35,589 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:44:35,589 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:44:35,589 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:44:35,589 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:44:35,590 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:44:35,590 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:44:35,590 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:44:35,590 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:44:35,590 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:44:35,590 - conversation_manager_1 - INFO - Loading session session-1745617475566-axrfr
2025-04-25 21:44:35,590 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:44:35,590 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:44:35,590 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:44:35,590 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:44:35,590 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:44:35,595 - CtxMemMgr_User1 - INFO - Loading session context for session-1745617475566-axrfr from /app/data/1/session-1745617475566-axrfr/context.json
2025-04-25 21:44:35,596 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745617475566-axrfr/context.json not found. Initializing empty context for new session session-1745617475566-axrfr.
2025-04-25 21:44:35,596 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745617475566-axrfr: hi...
2025-04-25 21:44:35,601 - components.prompt_builder - INFO - Constructing prompt for session session-1745617475566-axrfr, user 1, depth 0
2025-04-25 21:44:35,602 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:44:35,602 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:44:35,602 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:44:35,602 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:44:35,602 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:44:35,604 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:44:37,883 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T21:44:31Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 21:44:37,884 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:44:37,884 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:44:37,884 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:44:37,885 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:44:37,885 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 21:44:37,885 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 21:44:37,885 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745617475566-axrfr, user 1
2025-04-25 21:44:37,886 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 21:44:37,886 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 21:44:37,886 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): ```json
{
  "user_message_analysis": {
    "timestamp": "2025-04-25T21:44:31Z",
    "speaker": "User...
2025-04-25 21:44:37,887 - CtxMemMgr_User1 - INFO - Stored turn 8a853555-1128-4266-b3e3-b8f645cc0f4c for active session session-1745617475566-axrfr
2025-04-25 21:44:37,887 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745617475566-axrfr: '...'
2025-04-25 21:44:38,653 - CtxMemMgr_User1 - INFO - Session session-1745617475566-axrfr: Active history token count ~0 / 30000
2025-04-25 21:44:38,653 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745617475566-axrfr to /app/data/1/session-1745617475566-axrfr/context.json
2025-04-25 21:44:38,655 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745617475566-axrfr
2025-04-25 21:47:25,681 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 21:47:25,681 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 21:47:25,692 - models.connection - INFO - Database connection successful!
2025-04-25 21:47:25,707 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 21:47:25,707 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 21:47:25,707 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 21:47:25,707 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 21:47:25,707 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 21:47:25,707 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 21:47:25,708 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 21:47:25,708 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 21:47:25,712 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 21:47:25,712 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 21:47:25,712 - components.action_handler - INFO - Web search functionality is available
2025-04-25 21:47:25,713 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 21:47:25,713 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 21:47:25,717 - app - INFO - Registered unified frontend API blueprint
2025-04-25 21:47:25,721 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 21:47:49,824 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 21:47:49,826 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 21:47:49,826 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 21:47:49,826 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745617669816-0ekbw
2025-04-25 21:47:49,827 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:47:49,827 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:47:49,827 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:47:49,828 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:47:49,828 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:47:49,830 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:47:49,831 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:47:49,831 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:47:49,831 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:47:49,831 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:47:49,833 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:47:49,834 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:47:49,834 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:47:49,834 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:47:49,834 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:47:49,834 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:47:49,834 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:47:49,834 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:47:49,835 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:47:49,835 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:47:49,835 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:47:49,835 - conversation_manager_1 - INFO - Loading session session-1745617669816-0ekbw
2025-04-25 21:47:49,835 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:47:49,835 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:47:49,835 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:47:49,836 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:47:49,836 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:47:49,840 - CtxMemMgr_User1 - INFO - Loading session context for session-1745617669816-0ekbw from /app/data/1/session-1745617669816-0ekbw/context.json
2025-04-25 21:47:49,840 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745617669816-0ekbw/context.json not found. Initializing empty context for new session session-1745617669816-0ekbw.
2025-04-25 21:47:49,840 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745617669816-0ekbw: hi...
2025-04-25 21:47:49,848 - components.prompt_builder - INFO - Constructing prompt for session session-1745617669816-0ekbw, user 1, depth 0
2025-04-25 21:47:49,848 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:47:49,848 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:47:49,848 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:47:49,848 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:47:49,848 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:47:49,851 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:47:51,941 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T21:47:37Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 21:47:51,941 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:47:51,941 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:47:51,942 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:47:51,942 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:47:51,942 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 21:47:51,942 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 21:47:51,942 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745617669816-0ekbw, user 1
2025-04-25 21:47:51,942 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 21:47:51,942 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 21:47:51,943 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 21:47:51,943 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 21:47:51,943 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello!  It's nice to chat with you.  Is there anything I can assist you with this evening?...
2025-04-25 21:47:51,943 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello!  It's nice to chat with you.  Is there anything I can assist you with this evening?...
2025-04-25 21:47:51,944 - CtxMemMgr_User1 - INFO - Stored turn f1af7be9-94d2-4606-ba5c-28f6f3e75a6d for active session session-1745617669816-0ekbw
2025-04-25 21:47:51,944 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745617669816-0ekbw: '...'
2025-04-25 21:47:52,384 - CtxMemMgr_User1 - INFO - Session session-1745617669816-0ekbw: Active history token count ~0 / 30000
2025-04-25 21:47:52,384 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745617669816-0ekbw to /app/data/1/session-1745617669816-0ekbw/context.json
2025-04-25 21:47:52,386 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745617669816-0ekbw
2025-04-25 21:51:34,394 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745617894388-7n2l2
2025-04-25 21:51:34,395 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:51:34,396 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:51:34,396 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:51:34,396 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:51:34,398 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:51:34,399 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:51:34,399 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:51:34,399 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:51:34,400 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:51:34,400 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:51:34,400 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:51:34,400 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:51:34,401 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:51:34,401 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:51:34,401 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:51:34,401 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:51:34,401 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:51:34,402 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:51:34,402 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:51:34,402 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:51:34,402 - conversation_manager_1 - INFO - Loading session session-1745617894388-7n2l2
2025-04-25 21:51:34,402 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:51:34,402 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:51:34,403 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:51:34,403 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:51:34,403 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:51:34,407 - CtxMemMgr_User1 - INFO - Loading session context for session-1745617894388-7n2l2 from /app/data/1/session-1745617894388-7n2l2/context.json
2025-04-25 21:51:34,407 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745617894388-7n2l2/context.json not found. Initializing empty context for new session session-1745617894388-7n2l2.
2025-04-25 21:51:34,407 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745617894388-7n2l2: hi...
2025-04-25 21:51:34,408 - components.prompt_builder - INFO - Constructing prompt for session session-1745617894388-7n2l2, user 1, depth 0
2025-04-25 21:51:34,408 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:51:34,408 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:51:34,409 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:51:34,409 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:51:34,409 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:51:34,411 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:51:36,336 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T21:53:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 21:51:36,336 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:51:36,337 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:51:36,338 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:51:36,338 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:51:36,339 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 21:51:36,339 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 21:51:36,339 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745617894388-7n2l2, user 1
2025-04-25 21:51:36,340 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 21:51:36,340 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 21:51:36,340 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 21:51:36,340 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 21:51:36,341 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi!  It's nice to chat with you.  Is there anything I can assist you with tonight?...
2025-04-25 21:51:36,341 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi!  It's nice to chat with you.  Is there anything I can assist you with tonight?...
2025-04-25 21:51:36,342 - CtxMemMgr_User1 - INFO - Stored turn b820303f-1121-4ead-ad1b-f1ed1e831ea5 for active session session-1745617894388-7n2l2
2025-04-25 21:51:36,342 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745617894388-7n2l2: '...'
2025-04-25 21:51:36,791 - CtxMemMgr_User1 - INFO - Session session-1745617894388-7n2l2: Active history token count ~0 / 30000
2025-04-25 21:51:36,791 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745617894388-7n2l2 to /app/data/1/session-1745617894388-7n2l2/context.json
2025-04-25 21:51:36,794 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745617894388-7n2l2
2025-04-25 21:57:04,222 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745618224208-8ujkf
2025-04-25 21:57:04,223 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 21:57:04,224 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 21:57:04,224 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 21:57:04,225 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:57:04,227 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:57:04,227 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 21:57:04,228 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 21:57:04,228 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 21:57:04,228 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 21:57:04,228 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 21:57:04,228 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 21:57:04,228 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 21:57:04,229 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 21:57:04,229 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 21:57:04,229 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 21:57:04,229 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 21:57:04,229 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 21:57:04,229 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:57:04,230 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 21:57:04,230 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 21:57:04,230 - conversation_manager_1 - INFO - Loading session session-1745618224208-8ujkf
2025-04-25 21:57:04,230 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:57:04,230 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 21:57:04,231 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 21:57:04,231 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 21:57:04,231 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 21:57:04,235 - CtxMemMgr_User1 - INFO - Loading session context for session-1745618224208-8ujkf from /app/data/1/session-1745618224208-8ujkf/context.json
2025-04-25 21:57:04,235 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745618224208-8ujkf/context.json not found. Initializing empty context for new session session-1745618224208-8ujkf.
2025-04-25 21:57:04,235 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745618224208-8ujkf: hi...
2025-04-25 21:57:04,238 - components.prompt_builder - INFO - Constructing prompt for session session-1745618224208-8ujkf, user 1, depth 0
2025-04-25 21:57:04,238 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 21:57:04,238 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 21:57:04,238 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 21:57:04,238 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 21:57:04,239 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 21:57:04,242 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 21:57:09,970 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T21:58:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 21:57:09,972 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:57:09,972 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:57:09,972 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 21:57:09,973 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 21:57:09,973 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 21:57:09,974 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 21:57:09,974 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745618224208-8ujkf, user 1
2025-04-25 21:57:09,974 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 21:57:09,974 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 21:57:09,975 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 21:57:09,975 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 21:57:09,975 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi! It's good to connect.  Is there anything I can assist you with tonight?...
2025-04-25 21:57:09,976 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi! It's good to connect.  Is there anything I can assist you with tonight?...
2025-04-25 21:57:09,976 - CtxMemMgr_User1 - INFO - Stored turn b4cfe301-8a12-4254-a8fd-ba99a1a0d160 for active session session-1745618224208-8ujkf
2025-04-25 21:57:09,977 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745618224208-8ujkf: '...'
2025-04-25 21:57:10,489 - CtxMemMgr_User1 - INFO - Session session-1745618224208-8ujkf: Active history token count ~0 / 30000
2025-04-25 21:57:10,489 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745618224208-8ujkf to /app/data/1/session-1745618224208-8ujkf/context.json
2025-04-25 21:57:10,491 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745618224208-8ujkf
2025-04-25 22:01:12,610 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 22:01:12,610 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 22:01:12,639 - models.connection - INFO - Database connection successful!
2025-04-25 22:01:12,659 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 22:01:12,659 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 22:01:12,660 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 22:01:12,660 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 22:01:12,660 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 22:01:12,660 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 22:01:12,660 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 22:01:12,660 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 22:01:12,669 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 22:01:12,670 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 22:01:12,670 - components.action_handler - INFO - Web search functionality is available
2025-04-25 22:01:12,670 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 22:01:12,670 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 22:01:12,677 - app - INFO - Registered unified frontend API blueprint
2025-04-25 22:01:12,683 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 22:01:36,261 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 22:01:36,262 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 22:01:36,262 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 22:01:36,262 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745618496246-t0pci
2025-04-25 22:01:36,263 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 22:01:36,263 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 22:01:36,264 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 22:01:36,264 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 22:01:36,264 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:01:36,266 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:01:36,267 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 22:01:36,268 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 22:01:36,268 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 22:01:36,268 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 22:01:36,271 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 22:01:36,271 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 22:01:36,271 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 22:01:36,271 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 22:01:36,271 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 22:01:36,271 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 22:01:36,271 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 22:01:36,272 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 22:01:36,272 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:01:36,272 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:01:36,272 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 22:01:36,272 - conversation_manager_1 - INFO - Loading session session-1745618496246-t0pci
2025-04-25 22:01:36,272 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:01:36,272 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 22:01:36,272 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 22:01:36,272 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:01:36,273 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 22:01:36,278 - CtxMemMgr_User1 - INFO - Loading session context for session-1745618496246-t0pci from /app/data/1/session-1745618496246-t0pci/context.json
2025-04-25 22:01:36,278 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745618496246-t0pci/context.json not found. Initializing empty context for new session session-1745618496246-t0pci.
2025-04-25 22:01:36,278 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745618496246-t0pci: hi...
2025-04-25 22:01:36,284 - components.prompt_builder - INFO - Constructing prompt for session session-1745618496246-t0pci, user 1, depth 0
2025-04-25 22:01:36,285 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 22:01:36,285 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 22:01:36,285 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 22:01:36,285 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 22:01:36,285 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:01:36,287 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:01:38,396 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T22:01:30Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 22:01:38,397 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:01:38,397 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:01:38,398 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:01:38,398 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:01:38,398 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 22:01:38,398 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 22:01:38,398 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745618496246-t0pci, user 1
2025-04-25 22:01:38,399 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 22:01:38,399 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 22:01:38,399 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 22:01:38,400 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 22:01:38,400 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi! It's nice to chat with you.  Is there anything I can assist you with tonight?...
2025-04-25 22:01:38,400 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi! It's nice to chat with you.  Is there anything I can assist you with tonight?...
2025-04-25 22:01:38,401 - CtxMemMgr_User1 - INFO - Stored turn e126bc56-1a01-44b1-a305-3c6e4a89ff1c for active session session-1745618496246-t0pci
2025-04-25 22:01:38,402 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745618496246-t0pci: '...'
2025-04-25 22:01:38,848 - CtxMemMgr_User1 - INFO - Session session-1745618496246-t0pci: Active history token count ~0 / 30000
2025-04-25 22:01:38,849 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745618496246-t0pci to /app/data/1/session-1745618496246-t0pci/context.json
2025-04-25 22:01:38,852 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745618496246-t0pci
2025-04-25 22:51:56,035 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745621516026-sv3d8
2025-04-25 22:51:56,037 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 22:51:56,037 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 22:51:56,037 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 22:51:56,038 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:51:56,041 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:51:56,042 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 22:51:56,042 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 22:51:56,042 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 22:51:56,043 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 22:51:56,043 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 22:51:56,043 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 22:51:56,043 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 22:51:56,043 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 22:51:56,043 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 22:51:56,043 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 22:51:56,043 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 22:51:56,044 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 22:51:56,044 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:51:56,044 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:51:56,044 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 22:51:56,044 - conversation_manager_1 - INFO - Loading session session-1745621516026-sv3d8
2025-04-25 22:51:56,044 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:51:56,044 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 22:51:56,044 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 22:51:56,044 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:51:56,045 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 22:51:56,050 - CtxMemMgr_User1 - INFO - Loading session context for session-1745621516026-sv3d8 from /app/data/1/session-1745621516026-sv3d8/context.json
2025-04-25 22:51:56,050 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745621516026-sv3d8/context.json not found. Initializing empty context for new session session-1745621516026-sv3d8.
2025-04-25 22:51:56,050 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745621516026-sv3d8: Hi...
2025-04-25 22:51:56,052 - components.prompt_builder - INFO - Constructing prompt for session session-1745621516026-sv3d8, user 1, depth 0
2025-04-25 22:51:56,052 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Hi'
2025-04-25 22:51:56,052 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 22:51:56,052 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 22:51:56,052 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 22:51:56,052 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:51:56,054 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:52:46,570 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T22:51:37Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 22:52:46,571 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:52:46,571 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:52:46,571 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:52:46,572 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:52:46,572 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 22:52:46,572 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 22:52:46,573 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745621516026-sv3d8, user 1
2025-04-25 22:52:46,573 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 22:52:46,573 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 22:52:46,574 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 22:52:46,574 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 22:52:46,574 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here and ready to assist.  How can I help you?...
2025-04-25 22:52:46,574 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here and ready to assist.  How can I help you?...
2025-04-25 22:52:46,574 - CtxMemMgr_User1 - INFO - Stored turn 1916fb73-88bf-47a7-aa3b-14bf43fd8f10 for active session session-1745621516026-sv3d8
2025-04-25 22:52:46,575 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745621516026-sv3d8: '...'
2025-04-25 22:52:46,939 - CtxMemMgr_User1 - INFO - Session session-1745621516026-sv3d8: Active history token count ~0 / 30000
2025-04-25 22:52:46,939 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745621516026-sv3d8 to /app/data/1/session-1745621516026-sv3d8/context.json
2025-04-25 22:52:46,940 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745621516026-sv3d8
2025-04-25 22:53:20,119 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745621600110-d0elq
2025-04-25 22:53:20,121 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 22:53:20,121 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 22:53:20,121 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 22:53:20,122 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:53:20,125 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:53:20,126 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 22:53:20,126 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 22:53:20,126 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 22:53:20,127 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 22:53:20,127 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 22:53:20,127 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 22:53:20,127 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 22:53:20,127 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 22:53:20,127 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 22:53:20,127 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 22:53:20,127 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 22:53:20,127 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 22:53:20,127 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:53:20,128 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:53:20,128 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 22:53:20,128 - conversation_manager_1 - INFO - Loading session session-1745621600110-d0elq
2025-04-25 22:53:20,128 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:53:20,128 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 22:53:20,128 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 22:53:20,128 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:53:20,128 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 22:53:20,131 - CtxMemMgr_User1 - INFO - Loading session context for session-1745621600110-d0elq from /app/data/1/session-1745621600110-d0elq/context.json
2025-04-25 22:53:20,131 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745621600110-d0elq/context.json not found. Initializing empty context for new session session-1745621600110-d0elq.
2025-04-25 22:53:20,131 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745621600110-d0elq: hi...
2025-04-25 22:53:20,134 - components.prompt_builder - INFO - Constructing prompt for session session-1745621600110-d0elq, user 1, depth 0
2025-04-25 22:53:20,134 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 22:53:20,134 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 22:53:20,134 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 22:53:20,134 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 22:53:20,134 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:53:20,137 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:53:21,919 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T22:55:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 22:53:21,919 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:53:21,920 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:53:21,920 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:53:21,920 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:53:21,920 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 22:53:21,921 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 22:53:21,921 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745621600110-d0elq, user 1
2025-04-25 22:53:21,921 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 22:53:21,921 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 22:53:21,921 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 22:53:21,922 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 22:53:21,922 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi!  It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 22:53:21,922 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi!  It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 22:53:21,922 - CtxMemMgr_User1 - INFO - Stored turn 449d22ac-71b7-4b1a-bc07-dec1cb4bc03c for active session session-1745621600110-d0elq
2025-04-25 22:53:21,922 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745621600110-d0elq: '...'
2025-04-25 22:53:22,419 - CtxMemMgr_User1 - INFO - Session session-1745621600110-d0elq: Active history token count ~0 / 30000
2025-04-25 22:53:22,420 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745621600110-d0elq to /app/data/1/session-1745621600110-d0elq/context.json
2025-04-25 22:53:22,421 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745621600110-d0elq
2025-04-25 22:55:59,393 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745621759380-f7xge
2025-04-25 22:55:59,394 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 22:55:59,395 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 22:55:59,395 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 22:55:59,396 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:55:59,398 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:55:59,398 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 22:55:59,398 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 22:55:59,398 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 22:55:59,399 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 22:55:59,399 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 22:55:59,399 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 22:55:59,399 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 22:55:59,399 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 22:55:59,399 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 22:55:59,399 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 22:55:59,400 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 22:55:59,400 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 22:55:59,400 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:55:59,400 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:55:59,400 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 22:55:59,400 - conversation_manager_1 - INFO - Loading session session-1745621759380-f7xge
2025-04-25 22:55:59,400 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:55:59,400 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 22:55:59,400 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 22:55:59,400 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:55:59,401 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 22:55:59,404 - CtxMemMgr_User1 - INFO - Loading session context for session-1745621759380-f7xge from /app/data/1/session-1745621759380-f7xge/context.json
2025-04-25 22:55:59,405 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745621759380-f7xge/context.json not found. Initializing empty context for new session session-1745621759380-f7xge.
2025-04-25 22:55:59,405 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745621759380-f7xge: hi...
2025-04-25 22:55:59,407 - components.prompt_builder - INFO - Constructing prompt for session session-1745621759380-f7xge, user 1, depth 0
2025-04-25 22:55:59,407 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 22:55:59,407 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 22:55:59,407 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 22:55:59,407 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 22:55:59,407 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:55:59,409 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:56:01,156 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T22:55:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 22:56:01,156 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:56:01,157 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:56:01,157 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:56:01,157 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:56:01,157 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 22:56:01,157 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 22:56:01,158 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745621759380-f7xge, user 1
2025-04-25 22:56:01,158 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 22:56:01,158 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 22:56:01,158 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 22:56:01,158 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 22:56:01,158 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 22:56:01,159 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 22:56:01,159 - CtxMemMgr_User1 - INFO - Stored turn 42754b63-014c-45d6-acc0-033cbd384769 for active session session-1745621759380-f7xge
2025-04-25 22:56:01,159 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745621759380-f7xge: '...'
2025-04-25 22:56:01,511 - CtxMemMgr_User1 - INFO - Session session-1745621759380-f7xge: Active history token count ~0 / 30000
2025-04-25 22:56:01,513 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745621759380-f7xge to /app/data/1/session-1745621759380-f7xge/context.json
2025-04-25 22:56:01,515 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745621759380-f7xge
2025-04-25 22:57:29,035 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 22:57:29,035 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 22:57:29,045 - models.connection - INFO - Database connection successful!
2025-04-25 22:57:29,063 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 22:57:29,063 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 22:57:29,063 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 22:57:29,063 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 22:57:29,063 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 22:57:29,063 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 22:57:29,063 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 22:57:29,063 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 22:57:29,068 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 22:57:29,068 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 22:57:29,068 - components.action_handler - INFO - Web search functionality is available
2025-04-25 22:57:29,069 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 22:57:29,069 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 22:57:29,073 - app - INFO - Registered unified frontend API blueprint
2025-04-25 22:57:29,077 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 22:58:26,034 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 22:58:26,034 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 22:58:26,035 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 22:58:26,035 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745621906021-o706j
2025-04-25 22:58:26,036 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 22:58:26,036 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 22:58:26,036 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 22:58:26,037 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 22:58:26,037 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:58:26,039 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:58:26,040 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 22:58:26,040 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 22:58:26,040 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 22:58:26,040 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 22:58:26,043 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 22:58:26,043 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 22:58:26,043 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 22:58:26,043 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 22:58:26,043 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 22:58:26,043 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 22:58:26,044 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 22:58:26,044 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 22:58:26,044 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:58:26,044 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 22:58:26,044 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 22:58:26,044 - conversation_manager_1 - INFO - Loading session session-1745621906021-o706j
2025-04-25 22:58:26,044 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:58:26,044 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 22:58:26,044 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 22:58:26,044 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 22:58:26,044 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 22:58:26,048 - CtxMemMgr_User1 - INFO - Loading session context for session-1745621906021-o706j from /app/data/1/session-1745621906021-o706j/context.json
2025-04-25 22:58:26,049 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745621906021-o706j/context.json not found. Initializing empty context for new session session-1745621906021-o706j.
2025-04-25 22:58:26,049 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745621906021-o706j: hi...
2025-04-25 22:58:26,056 - components.prompt_builder - INFO - Constructing prompt for session session-1745621906021-o706j, user 1, depth 0
2025-04-25 22:58:26,057 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 22:58:26,057 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 22:58:26,057 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 22:58:26,057 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 22:58:26,057 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 22:58:26,060 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 22:58:27,866 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T22:59:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 22:58:27,866 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:58:27,866 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:58:27,867 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 22:58:27,867 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 22:58:27,867 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 22:58:27,867 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 22:58:27,867 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745621906021-o706j, user 1
2025-04-25 22:58:27,868 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 22:58:27,868 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 22:58:27,868 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 22:58:27,868 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 22:58:27,868 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 22:58:27,869 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 22:58:27,870 - CtxMemMgr_User1 - INFO - Stored turn 62b70ec0-1b72-4aa1-b097-56c6763f6e78 for active session session-1745621906021-o706j
2025-04-25 22:58:27,870 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745621906021-o706j: '...'
2025-04-25 22:58:28,388 - CtxMemMgr_User1 - INFO - Session session-1745621906021-o706j: Active history token count ~0 / 30000
2025-04-25 22:58:28,389 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745621906021-o706j to /app/data/1/session-1745621906021-o706j/context.json
2025-04-25 22:58:28,390 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745621906021-o706j
2025-04-25 23:00:49,728 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622049720-man3d
2025-04-25 23:00:49,729 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:00:49,729 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:00:49,729 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:00:49,729 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:00:49,730 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:00:49,731 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:00:49,731 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:00:49,731 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:00:49,731 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:00:49,731 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:00:49,732 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:00:49,732 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:00:49,732 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:00:49,732 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:00:49,732 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:00:49,732 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:00:49,732 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:00:49,732 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:00:49,732 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:00:49,732 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:00:49,732 - conversation_manager_1 - INFO - Loading session session-1745622049720-man3d
2025-04-25 23:00:49,733 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:00:49,733 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:00:49,733 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:00:49,733 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:00:49,733 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:00:49,735 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622049720-man3d from /app/data/1/session-1745622049720-man3d/context.json
2025-04-25 23:00:49,735 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622049720-man3d/context.json not found. Initializing empty context for new session session-1745622049720-man3d.
2025-04-25 23:00:49,735 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622049720-man3d: hi...
2025-04-25 23:00:49,737 - components.prompt_builder - INFO - Constructing prompt for session session-1745622049720-man3d, user 1, depth 0
2025-04-25 23:00:49,737 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:00:49,738 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:00:49,738 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:00:49,738 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:00:49,738 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:00:49,740 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:00:51,427 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:00:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me.",...
2025-04-25 23:00:51,427 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:00:51,427 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:00:51,427 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:00:51,427 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:00:51,428 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:00:51,428 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:00:51,428 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622049720-man3d, user 1
2025-04-25 23:00:51,428 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:00:51,428 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:00:51,429 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:00:51,429 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:00:51,429 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:00:51,429 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:00:51,429 - CtxMemMgr_User1 - INFO - Stored turn 418f55fd-b316-4ef4-abb2-bb425a7c8b62 for active session session-1745622049720-man3d
2025-04-25 23:00:51,430 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622049720-man3d: '...'
2025-04-25 23:00:52,175 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: Please provide me with the previous messages or context.  I need the previous user message and assistant response to continue the conversation and identify any relevant information.
2025-04-25 23:00:52,175 - CtxMemMgr_User1 - INFO - Session session-1745622049720-man3d: Active history token count ~0 / 30000
2025-04-25 23:00:52,175 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622049720-man3d to /app/data/1/session-1745622049720-man3d/context.json
2025-04-25 23:00:52,176 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622049720-man3d
2025-04-25 23:01:40,643 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622100628-io7wt
2025-04-25 23:01:40,644 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:01:40,645 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:01:40,645 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:01:40,645 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:01:40,648 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:01:40,648 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:01:40,649 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:01:40,649 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:01:40,649 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:01:40,649 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:01:40,649 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:01:40,649 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:01:40,650 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:01:40,650 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:01:40,650 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:01:40,650 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:01:40,650 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:01:40,650 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:01:40,650 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:01:40,650 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:01:40,650 - conversation_manager_1 - INFO - Loading session session-1745622100628-io7wt
2025-04-25 23:01:40,651 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:01:40,651 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:01:40,651 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:01:40,651 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:01:40,651 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:01:40,654 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622100628-io7wt from /app/data/1/session-1745622100628-io7wt/context.json
2025-04-25 23:01:40,655 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622100628-io7wt/context.json not found. Initializing empty context for new session session-1745622100628-io7wt.
2025-04-25 23:01:40,655 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622100628-io7wt: hi...
2025-04-25 23:01:40,657 - components.prompt_builder - INFO - Constructing prompt for session session-1745622100628-io7wt, user 1, depth 0
2025-04-25 23:01:40,657 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:01:40,658 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:01:40,658 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:01:40,658 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:01:40,658 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:01:40,659 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:01:42,408 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:01:30Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted the a...
2025-04-25 23:01:42,408 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:01:42,409 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:01:42,409 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:01:42,409 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:01:42,409 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:01:42,409 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:01:42,410 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622100628-io7wt, user 1
2025-04-25 23:01:42,410 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:01:42,410 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:01:42,410 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:01:42,410 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:01:42,410 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi!  It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:01:42,411 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi!  It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:01:42,411 - CtxMemMgr_User1 - INFO - Stored turn a42b693c-0dc8-48d3-9a82-68b01128ebf3 for active session session-1745622100628-io7wt
2025-04-25 23:01:42,411 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622100628-io7wt: '...'
2025-04-25 23:01:42,904 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I need the initial user message and assistant response to continue.  I cannot continue a conversation without that context.  Please provide the initial interaction.
2025-04-25 23:01:42,905 - CtxMemMgr_User1 - INFO - Session session-1745622100628-io7wt: Active history token count ~0 / 30000
2025-04-25 23:01:42,905 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622100628-io7wt to /app/data/1/session-1745622100628-io7wt/context.json
2025-04-25 23:01:42,908 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622100628-io7wt
2025-04-25 23:03:50,441 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622230428-sbhme
2025-04-25 23:03:50,442 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:03:50,442 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:03:50,442 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:03:50,443 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:03:50,445 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:03:50,445 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:03:50,446 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:03:50,446 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:03:50,446 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:03:50,446 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:03:50,446 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:03:50,446 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:03:50,447 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:03:50,447 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:03:50,447 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:03:50,447 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:03:50,447 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:03:50,447 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:03:50,447 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:03:50,447 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:03:50,448 - conversation_manager_1 - INFO - Loading session session-1745622230428-sbhme
2025-04-25 23:03:50,448 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:03:50,448 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:03:50,448 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:03:50,448 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:03:50,448 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:03:50,451 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622230428-sbhme from /app/data/1/session-1745622230428-sbhme/context.json
2025-04-25 23:03:50,452 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622230428-sbhme/context.json not found. Initializing empty context for new session session-1745622230428-sbhme.
2025-04-25 23:03:50,452 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622230428-sbhme: hi...
2025-04-25 23:03:50,453 - components.prompt_builder - INFO - Constructing prompt for session session-1745622230428-sbhme, user 1, depth 0
2025-04-25 23:03:50,453 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:03:50,453 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:03:50,453 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:03:50,453 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:03:50,454 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:03:50,455 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:03:52,277 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:04:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:03:52,278 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:03:52,278 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:03:52,278 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:03:52,279 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:03:52,279 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:03:52,279 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:03:52,279 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622230428-sbhme, user 1
2025-04-25 23:03:52,279 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:03:52,280 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:03:52,280 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:03:52,280 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:03:52,280 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:03:52,280 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:03:52,280 - CtxMemMgr_User1 - INFO - Stored turn 54c25fa9-438a-4a4e-904c-ff58471923c6 for active session session-1745622230428-sbhme
2025-04-25 23:03:52,281 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622230428-sbhme: '...'
2025-04-25 23:03:52,785 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue without the initial user message and assistant response.  Please provide that information so I can analyze the conversation and extract relevant user data.
2025-04-25 23:03:52,785 - CtxMemMgr_User1 - INFO - Session session-1745622230428-sbhme: Active history token count ~0 / 30000
2025-04-25 23:03:52,785 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622230428-sbhme to /app/data/1/session-1745622230428-sbhme/context.json
2025-04-25 23:03:52,787 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622230428-sbhme
2025-04-25 23:03:53,698 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:03:53,698 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:03:53,698 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:03:53,699 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:03:53,699 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:03:53,703 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622230428-sbhme: hi...
2025-04-25 23:03:53,706 - components.prompt_builder - INFO - Constructing prompt for session session-1745622230428-sbhme, user 1, depth 0
2025-04-25 23:03:53,706 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:03:53,706 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:03:53,706 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:03:53,707 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:03:53,707 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:03:53,709 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:03:55,607 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:03:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted the a...
2025-04-25 23:03:55,607 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:03:55,607 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:03:55,607 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:03:55,607 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:03:55,607 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:03:55,608 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:03:55,608 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622230428-sbhme, user 1
2025-04-25 23:03:55,608 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:03:55,608 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:03:55,608 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:03:55,608 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:03:55,608 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's 11:03 PM.  I'm ready to help you with anything you need.  Please let me know how I can a...
2025-04-25 23:03:55,609 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's 11:03 PM.  I'm ready to help you with anything you need.  Please let me know how I can a...
2025-04-25 23:03:55,609 - CtxMemMgr_User1 - INFO - Stored turn 410f69e4-9339-4c2c-b9f7-bade6a27d88f for active session session-1745622230428-sbhme
2025-04-25 23:03:55,609 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622230428-sbhme: '...'
2025-04-25 23:03:55,941 - CtxMemMgr_User1 - INFO - Session session-1745622230428-sbhme: Active history token count ~0 / 30000
2025-04-25 23:03:55,941 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622230428-sbhme to /app/data/1/session-1745622230428-sbhme/context.json
2025-04-25 23:03:55,946 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622230428-sbhme
2025-04-25 23:06:34,030 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622394017-c5bcl
2025-04-25 23:06:34,030 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:06:34,031 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:06:34,031 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:06:34,032 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:06:34,033 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:06:34,033 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:06:34,034 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:06:34,034 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:06:34,034 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:06:34,034 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:06:34,034 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:06:34,034 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:06:34,034 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:06:34,034 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:06:34,034 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:06:34,035 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:06:34,035 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:06:34,035 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:06:34,035 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:06:34,035 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:06:34,035 - conversation_manager_1 - INFO - Loading session session-1745622394017-c5bcl
2025-04-25 23:06:34,035 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:06:34,035 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:06:34,035 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:06:34,035 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:06:34,035 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:06:34,038 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622394017-c5bcl from /app/data/1/session-1745622394017-c5bcl/context.json
2025-04-25 23:06:34,038 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622394017-c5bcl/context.json not found. Initializing empty context for new session session-1745622394017-c5bcl.
2025-04-25 23:06:34,038 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622394017-c5bcl: hi...
2025-04-25 23:06:34,040 - components.prompt_builder - INFO - Constructing prompt for session session-1745622394017-c5bcl, user 1, depth 0
2025-04-25 23:06:34,040 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:06:34,040 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:06:34,040 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:06:34,040 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:06:34,040 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:06:34,041 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:06:35,833 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:06:37Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:06:35,834 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:06:35,834 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:06:35,835 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:06:35,836 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:06:35,836 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:06:35,837 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:06:35,837 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622394017-c5bcl, user 1
2025-04-25 23:06:35,838 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:06:35,838 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:06:35,838 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:06:35,839 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:06:35,839 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:06:35,839 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:06:35,840 - CtxMemMgr_User1 - INFO - Stored turn d4dea238-1bf0-4040-8c73-1a13ef3cf96d for active session session-1745622394017-c5bcl
2025-04-25 23:06:35,840 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622394017-c5bcl: '...'
2025-04-25 23:06:36,340 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I need the initial user message and assistant response to continue.  I cannot continue a conversation without that context.  Please provide the initial interaction.
2025-04-25 23:06:36,340 - CtxMemMgr_User1 - INFO - Session session-1745622394017-c5bcl: Active history token count ~0 / 30000
2025-04-25 23:06:36,341 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622394017-c5bcl to /app/data/1/session-1745622394017-c5bcl/context.json
2025-04-25 23:06:36,344 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622394017-c5bcl
2025-04-25 23:08:51,009 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622530999-d3e6i
2025-04-25 23:08:51,010 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:08:51,010 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:08:51,011 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:08:51,011 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:08:51,014 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:08:51,015 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:08:51,015 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:08:51,015 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:08:51,015 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:08:51,015 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:08:51,015 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:08:51,015 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:08:51,015 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:08:51,015 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:08:51,016 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:08:51,016 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:08:51,016 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:08:51,016 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:08:51,016 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:08:51,016 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:08:51,016 - conversation_manager_1 - INFO - Loading session session-1745622530999-d3e6i
2025-04-25 23:08:51,016 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:08:51,016 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:08:51,016 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:08:51,017 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:08:51,017 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:08:51,020 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622530999-d3e6i from /app/data/1/session-1745622530999-d3e6i/context.json
2025-04-25 23:08:51,020 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622530999-d3e6i/context.json not found. Initializing empty context for new session session-1745622530999-d3e6i.
2025-04-25 23:08:51,020 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622530999-d3e6i: hi...
2025-04-25 23:08:51,022 - components.prompt_builder - INFO - Constructing prompt for session session-1745622530999-d3e6i, user 1, depth 0
2025-04-25 23:08:51,023 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:08:51,023 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:08:51,023 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:08:51,023 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:08:51,023 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:08:51,025 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:08:52,830 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:10:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:08:52,831 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:08:52,831 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:08:52,832 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:08:52,832 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:08:52,833 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:08:52,833 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:08:52,834 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622530999-d3e6i, user 1
2025-04-25 23:08:52,834 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:08:52,834 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:08:52,834 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:08:52,835 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:08:52,835 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi!  It's late, but I'm here and ready to assist you. What's on your mind?...
2025-04-25 23:08:52,835 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi!  It's late, but I'm here and ready to assist you. What's on your mind?...
2025-04-25 23:08:52,835 - CtxMemMgr_User1 - INFO - Stored turn 420d36b3-a539-4789-85ef-9bfbd88b746b for active session session-1745622530999-d3e6i
2025-04-25 23:08:52,836 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622530999-d3e6i: '...'
2025-04-25 23:08:53,296 - CtxMemMgr_User1 - INFO - Session session-1745622530999-d3e6i: Active history token count ~0 / 30000
2025-04-25 23:08:53,296 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622530999-d3e6i to /app/data/1/session-1745622530999-d3e6i/context.json
2025-04-25 23:08:53,299 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622530999-d3e6i
2025-04-25 23:09:25,678 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622565665-o796o
2025-04-25 23:09:25,679 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:09:25,680 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:09:25,680 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:09:25,680 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:09:25,682 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:09:25,682 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:09:25,683 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:09:25,683 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:09:25,683 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:09:25,683 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:09:25,683 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:09:25,683 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:09:25,683 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:09:25,683 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:09:25,684 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:09:25,684 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:09:25,684 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:09:25,684 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:09:25,684 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:09:25,684 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:09:25,684 - conversation_manager_1 - INFO - Loading session session-1745622565665-o796o
2025-04-25 23:09:25,684 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:09:25,684 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:09:25,685 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:09:25,685 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:09:25,685 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:09:25,687 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622565665-o796o from /app/data/1/session-1745622565665-o796o/context.json
2025-04-25 23:09:25,687 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622565665-o796o/context.json not found. Initializing empty context for new session session-1745622565665-o796o.
2025-04-25 23:09:25,687 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622565665-o796o: hi...
2025-04-25 23:09:25,689 - components.prompt_builder - INFO - Constructing prompt for session session-1745622565665-o796o, user 1, depth 0
2025-04-25 23:09:25,689 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:09:25,689 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:09:25,689 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:09:25,689 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:09:25,690 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:09:25,692 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:09:27,399 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:11:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:09:27,399 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:09:27,399 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:09:27,400 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:09:27,400 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:09:27,400 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:09:27,400 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:09:27,400 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622565665-o796o, user 1
2025-04-25 23:09:27,400 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:09:27,400 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:09:27,400 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:09:27,401 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:09:27,401 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:09:27,401 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:09:27,401 - CtxMemMgr_User1 - INFO - Stored turn c9d61aea-a9ef-416a-b95e-baccaceea25a for active session session-1745622565665-o796o
2025-04-25 23:09:27,401 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622565665-o796o: '...'
2025-04-25 23:09:28,024 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue without the initial user message and assistant response.  Please provide that information so I can analyze the conversation and extract relevant user data.  My previous responses were correct; a simple "hi" provides no information to remember.
2025-04-25 23:09:28,025 - CtxMemMgr_User1 - INFO - Session session-1745622565665-o796o: Active history token count ~0 / 30000
2025-04-25 23:09:28,025 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622565665-o796o to /app/data/1/session-1745622565665-o796o/context.json
2025-04-25 23:09:28,031 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622565665-o796o
2025-04-25 23:09:42,969 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622582950-o2mwg
2025-04-25 23:09:42,971 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:09:42,971 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:09:42,972 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:09:42,972 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:09:42,974 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:09:42,975 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:09:42,975 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:09:42,975 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:09:42,975 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:09:42,975 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:09:42,975 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:09:42,976 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:09:42,976 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:09:42,976 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:09:42,976 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:09:42,976 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:09:42,976 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:09:42,976 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:09:42,976 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:09:42,976 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:09:42,977 - conversation_manager_1 - INFO - Loading session session-1745622582950-o2mwg
2025-04-25 23:09:42,977 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:09:42,977 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:09:42,977 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:09:42,977 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:09:42,977 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:09:42,980 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622582950-o2mwg from /app/data/1/session-1745622582950-o2mwg/context.json
2025-04-25 23:09:42,981 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622582950-o2mwg/context.json not found. Initializing empty context for new session session-1745622582950-o2mwg.
2025-04-25 23:09:42,981 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622582950-o2mwg: hi...
2025-04-25 23:09:42,984 - components.prompt_builder - INFO - Constructing prompt for session session-1745622582950-o2mwg, user 1, depth 0
2025-04-25 23:09:42,984 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:09:42,984 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:09:42,984 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:09:42,984 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:09:42,984 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:09:42,987 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:09:44,845 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:11:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted with ...
2025-04-25 23:09:44,845 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:09:44,846 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:09:44,846 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:09:44,846 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:09:44,847 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:09:44,847 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:09:44,847 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622582950-o2mwg, user 1
2025-04-25 23:09:44,847 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:09:44,848 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:09:44,848 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:09:44,848 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:09:44,848 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:09:44,848 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:09:44,848 - CtxMemMgr_User1 - INFO - Stored turn 1688c363-babf-47b5-8f8c-f448a7e1b296 for active session session-1745622582950-o2mwg
2025-04-25 23:09:44,849 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622582950-o2mwg: '...'
2025-04-25 23:09:45,471 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue.  I need the initial user message and the assistant's response to that message.  I have no context to build upon.  Please provide the initial interaction.
2025-04-25 23:09:45,471 - CtxMemMgr_User1 - INFO - Session session-1745622582950-o2mwg: Active history token count ~0 / 30000
2025-04-25 23:09:45,471 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622582950-o2mwg to /app/data/1/session-1745622582950-o2mwg/context.json
2025-04-25 23:09:45,473 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622582950-o2mwg
2025-04-25 23:14:09,353 - models.connection - INFO - Using MySQL database at: mysql:3306/rai_chat
2025-04-25 23:14:09,353 - models.connection - INFO - Attempting to connect to database (attempt 1/5)
2025-04-25 23:14:09,374 - models.connection - INFO - Database connection successful!
2025-04-25 23:14:09,386 - components.action_handler - INFO - Current directory: /app/components
2025-04-25 23:14:09,386 - components.action_handler - INFO - Checking for .env at: /app/components/../../Backend/.env
2025-04-25 23:14:09,386 - components.action_handler - INFO - Checking for .env at: /app/components/../../backend/.env
2025-04-25 23:14:09,386 - components.action_handler - INFO - Checking for .env at: /app/components/../../../.env
2025-04-25 23:14:09,386 - components.action_handler - INFO - Checking for .env at: /.env
2025-04-25 23:14:09,386 - components.action_handler - WARNING - Could not find .env file in any of the checked directories.
2025-04-25 23:14:09,386 - components.action_handler - INFO - TAVILY_API_KEY loaded: YES (length: 41)
2025-04-25 23:14:09,386 - components.action_handler - INFO - Checked for .env file in multiple locations
2025-04-25 23:14:09,392 - components.action_handler - INFO - Initializing Tavily client with API key: tvly...VPLb
2025-04-25 23:14:09,392 - components.action_handler - INFO - Tavily client initialized successfully
2025-04-25 23:14:09,392 - components.action_handler - INFO - Web search functionality is available
2025-04-25 23:14:09,393 - managers.conversation_manager - INFO - LLM Engine path: /app/llm_client
2025-04-25 23:14:09,393 - managers.conversation_manager - INFO - Successfully initialized Docker LLM API client
2025-04-25 23:14:09,396 - app - INFO - Registered unified frontend API blueprint
2025-04-25 23:14:09,401 - waitress - INFO - Serving on http://0.0.0.0:6102
2025-04-25 23:14:18,783 - managers.user_session_manager - INFO - Creating new UserSessionManager singleton instance
2025-04-25 23:14:18,783 - managers.chat_file_manager - INFO - ChatFileManager initialized. Base data path: /app/data
2025-04-25 23:14:18,784 - managers.user_session_manager - INFO - UserSessionManager initialized with base path: /app/data
2025-04-25 23:14:18,784 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622858771-zy5t5
2025-04-25 23:14:18,788 - api.llm_engine.llm_api_interface - INFO - Initializing LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:14:18,789 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:14:18,789 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:14:18,789 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:14:18,790 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:14:18,793 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:14:18,794 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:14:18,794 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:14:18,794 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:14:18,794 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:14:18,798 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:14:18,798 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:14:18,798 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:14:18,798 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:14:18,798 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:14:18,798 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:14:18,798 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:14:18,798 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:14:18,799 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:14:18,799 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:14:18,799 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:14:18,799 - conversation_manager_1 - INFO - Loading session session-1745622858771-zy5t5
2025-04-25 23:14:18,799 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:14:18,799 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:14:18,799 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:14:18,799 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:14:18,799 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:14:18,803 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622858771-zy5t5 from /app/data/1/session-1745622858771-zy5t5/context.json
2025-04-25 23:14:18,804 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622858771-zy5t5/context.json not found. Initializing empty context for new session session-1745622858771-zy5t5.
2025-04-25 23:14:18,804 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622858771-zy5t5: hi...
2025-04-25 23:14:18,810 - components.prompt_builder - INFO - Constructing prompt for session session-1745622858771-zy5t5, user 1, depth 0
2025-04-25 23:14:18,810 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:14:18,810 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:14:18,810 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:14:18,810 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:14:18,810 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:14:18,813 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:14:20,602 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:14:30Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:14:20,602 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:14:20,602 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:14:20,603 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:14:20,603 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:14:20,603 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:14:20,603 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:14:20,603 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622858771-zy5t5, user 1
2025-04-25 23:14:20,603 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:14:20,604 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:14:20,604 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:14:20,604 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:14:20,604 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:14:20,604 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:14:20,605 - CtxMemMgr_User1 - INFO - Stored turn 7f13d98c-432e-4a8b-ac4a-4ca4d0758de2 for active session session-1745622858771-zy5t5
2025-04-25 23:14:20,606 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622858771-zy5t5: '...'
2025-04-25 23:14:21,163 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue.  I need the initial user message and the assistant's response to that message.  I have no context to build upon.  Please provide the initial interaction.
2025-04-25 23:14:21,164 - CtxMemMgr_User1 - INFO - Session session-1745622858771-zy5t5: Active history token count ~0 / 30000
2025-04-25 23:14:21,164 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622858771-zy5t5 to /app/data/1/session-1745622858771-zy5t5/context.json
2025-04-25 23:14:21,168 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622858771-zy5t5
2025-04-25 23:14:21,168 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you.", "session_id": "session-1745622858771-zy5t5", "timestamp": "2025-04-25T23:14:21.168882"}
2025-04-25 23:14:45,144 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622885127-p4mgf
2025-04-25 23:14:45,144 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:14:45,145 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:14:45,145 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:14:45,145 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:14:45,147 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:14:45,147 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:14:45,148 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:14:45,148 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:14:45,148 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:14:45,148 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:14:45,148 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:14:45,148 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:14:45,148 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:14:45,148 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:14:45,149 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:14:45,149 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:14:45,149 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:14:45,149 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:14:45,149 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:14:45,149 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:14:45,150 - conversation_manager_1 - INFO - Loading session session-1745622885127-p4mgf
2025-04-25 23:14:45,150 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:14:45,150 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:14:45,150 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:14:45,150 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:14:45,150 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:14:45,155 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622885127-p4mgf from /app/data/1/session-1745622885127-p4mgf/context.json
2025-04-25 23:14:45,155 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622885127-p4mgf/context.json not found. Initializing empty context for new session session-1745622885127-p4mgf.
2025-04-25 23:14:45,155 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622885127-p4mgf: hi...
2025-04-25 23:14:45,157 - components.prompt_builder - INFO - Constructing prompt for session session-1745622885127-p4mgf, user 1, depth 0
2025-04-25 23:14:45,157 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:14:45,157 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:14:45,158 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:14:45,158 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:14:45,158 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:14:45,160 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:14:46,985 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:14:30Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:14:46,985 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:14:46,986 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:14:46,986 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:14:46,986 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:14:46,987 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:14:46,987 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:14:46,988 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622885127-p4mgf, user 1
2025-04-25 23:14:46,988 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:14:46,988 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:14:46,988 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:14:46,989 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:14:46,989 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi!  It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:14:46,989 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi!  It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:14:46,989 - CtxMemMgr_User1 - INFO - Stored turn e7cb1493-e141-473a-8cc4-8e5ff82e8007 for active session session-1745622885127-p4mgf
2025-04-25 23:14:46,989 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622885127-p4mgf: '...'
2025-04-25 23:14:47,552 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue.  I need the initial user message and the assistant's response to that message.  I have no context to build upon.  Please provide the initial interaction.
2025-04-25 23:14:47,552 - CtxMemMgr_User1 - INFO - Session session-1745622885127-p4mgf: Active history token count ~0 / 30000
2025-04-25 23:14:47,552 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622885127-p4mgf to /app/data/1/session-1745622885127-p4mgf/context.json
2025-04-25 23:14:47,554 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622885127-p4mgf
2025-04-25 23:14:47,554 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi!  It's late, but I'm here if you need anything.  Let me know how I can assist you.", "session_id": "session-1745622885127-p4mgf", "timestamp": "2025-04-25T23:14:47.554761"}
2025-04-25 23:15:20,667 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745622920659-iwzsa
2025-04-25 23:15:20,668 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:15:20,669 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:15:20,669 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:15:20,669 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:15:20,671 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:15:20,672 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:15:20,672 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:15:20,672 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:15:20,672 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:15:20,672 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:15:20,672 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:15:20,673 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:15:20,673 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:15:20,673 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:15:20,673 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:15:20,673 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:15:20,673 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:15:20,674 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:15:20,674 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:15:20,674 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:15:20,674 - conversation_manager_1 - INFO - Loading session session-1745622920659-iwzsa
2025-04-25 23:15:20,674 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:15:20,674 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:15:20,674 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:15:20,675 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:15:20,675 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:15:20,681 - CtxMemMgr_User1 - INFO - Loading session context for session-1745622920659-iwzsa from /app/data/1/session-1745622920659-iwzsa/context.json
2025-04-25 23:15:20,681 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745622920659-iwzsa/context.json not found. Initializing empty context for new session session-1745622920659-iwzsa.
2025-04-25 23:15:20,681 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745622920659-iwzsa: hi...
2025-04-25 23:15:20,683 - components.prompt_builder - INFO - Constructing prompt for session session-1745622920659-iwzsa, user 1, depth 0
2025-04-25 23:15:20,683 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:15:20,683 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:15:20,683 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:15:20,683 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:15:20,684 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:15:20,686 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:15:22,508 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:15:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted the L...
2025-04-25 23:15:22,509 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:15:22,509 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:15:22,510 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:15:22,510 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:15:22,511 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:15:22,511 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:15:22,511 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745622920659-iwzsa, user 1
2025-04-25 23:15:22,512 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:15:22,512 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:15:22,512 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:15:22,512 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:15:22,512 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:15:22,513 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:15:22,513 - CtxMemMgr_User1 - INFO - Stored turn a007a60f-dbb6-49aa-8c69-4d7df79ffc68 for active session session-1745622920659-iwzsa
2025-04-25 23:15:22,513 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745622920659-iwzsa: '...'
2025-04-25 23:15:23,077 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue.  I need the initial user message and the assistant's response to that message.  I have no context to build upon.  Please provide the initial interaction.
2025-04-25 23:15:23,078 - CtxMemMgr_User1 - INFO - Session session-1745622920659-iwzsa: Active history token count ~0 / 30000
2025-04-25 23:15:23,078 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745622920659-iwzsa to /app/data/1/session-1745622920659-iwzsa/context.json
2025-04-25 23:15:23,080 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745622920659-iwzsa
2025-04-25 23:15:23,080 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you.", "session_id": "session-1745622920659-iwzsa", "timestamp": "2025-04-25T23:15:23.080746"}
2025-04-25 23:17:16,241 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745623036224-p1kyk
2025-04-25 23:17:16,242 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:17:16,242 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:17:16,242 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:17:16,243 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:17:16,245 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:17:16,246 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:17:16,246 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:17:16,246 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:17:16,246 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:17:16,246 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:17:16,247 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:17:16,247 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:17:16,247 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:17:16,247 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:17:16,247 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:17:16,248 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:17:16,248 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:17:16,248 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:17:16,248 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:17:16,248 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:17:16,248 - conversation_manager_1 - INFO - Loading session session-1745623036224-p1kyk
2025-04-25 23:17:16,249 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:17:16,249 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:17:16,249 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:17:16,249 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:17:16,249 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:17:16,252 - CtxMemMgr_User1 - INFO - Loading session context for session-1745623036224-p1kyk from /app/data/1/session-1745623036224-p1kyk/context.json
2025-04-25 23:17:16,253 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745623036224-p1kyk/context.json not found. Initializing empty context for new session session-1745623036224-p1kyk.
2025-04-25 23:17:16,253 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745623036224-p1kyk: hi...
2025-04-25 23:17:16,255 - components.prompt_builder - INFO - Constructing prompt for session session-1745623036224-p1kyk, user 1, depth 0
2025-04-25 23:17:16,255 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:17:16,255 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:17:16,255 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:17:16,255 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:17:16,255 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:17:16,257 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:17:18,035 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:17:30Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:17:18,035 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:17:18,036 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:17:18,036 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:17:18,036 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:17:18,036 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:17:18,037 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:17:18,037 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745623036224-p1kyk, user 1
2025-04-25 23:17:18,037 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:17:18,037 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:17:18,037 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:17:18,038 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:17:18,038 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:17:18,038 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:17:18,038 - CtxMemMgr_User1 - INFO - Stored turn acc8fcff-d00d-41be-a837-272c30875acf for active session session-1745623036224-p1kyk
2025-04-25 23:17:18,039 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745623036224-p1kyk: '...'
2025-04-25 23:17:18,646 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue.  I need the initial user message and the assistant's response to that message.  I have no context to build upon.  Please provide the initial interaction.
2025-04-25 23:17:18,647 - CtxMemMgr_User1 - INFO - Session session-1745623036224-p1kyk: Active history token count ~0 / 30000
2025-04-25 23:17:18,647 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745623036224-p1kyk to /app/data/1/session-1745623036224-p1kyk/context.json
2025-04-25 23:17:18,649 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745623036224-p1kyk
2025-04-25 23:17:18,650 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi! It's late, but I'm here if you need anything.  Let me know how I can assist you.", "session_id": "session-1745623036224-p1kyk", "timestamp": "2025-04-25T23:17:18.649956"}
2025-04-25 23:17:48,524 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745623068507-by5f2
2025-04-25 23:17:48,525 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:17:48,525 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:17:48,525 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:17:48,525 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:17:48,527 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:17:48,528 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:17:48,528 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:17:48,528 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:17:48,528 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:17:48,528 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:17:48,529 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:17:48,529 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:17:48,529 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:17:48,529 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:17:48,529 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:17:48,529 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:17:48,529 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:17:48,529 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:17:48,530 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:17:48,530 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:17:48,530 - conversation_manager_1 - INFO - Loading session session-1745623068507-by5f2
2025-04-25 23:17:48,530 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:17:48,530 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:17:48,530 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:17:48,530 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:17:48,530 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:17:48,534 - CtxMemMgr_User1 - INFO - Loading session context for session-1745623068507-by5f2 from /app/data/1/session-1745623068507-by5f2/context.json
2025-04-25 23:17:48,534 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745623068507-by5f2/context.json not found. Initializing empty context for new session session-1745623068507-by5f2.
2025-04-25 23:17:48,535 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745623068507-by5f2: hi...
2025-04-25 23:17:48,537 - components.prompt_builder - INFO - Constructing prompt for session session-1745623068507-by5f2, user 1, depth 0
2025-04-25 23:17:48,537 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:17:48,537 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:17:48,537 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:17:48,537 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:17:48,537 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:17:48,539 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:17:50,327 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:17:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted with ...
2025-04-25 23:17:50,328 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:17:50,329 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:17:50,332 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:17:50,332 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:17:50,332 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:17:50,333 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:17:50,333 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745623068507-by5f2, user 1
2025-04-25 23:17:50,333 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:17:50,333 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:17:50,334 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:17:50,334 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:17:50,334 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:17:50,334 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:17:50,335 - CtxMemMgr_User1 - INFO - Stored turn db4b2607-0d73-4ee6-995d-92b3fc2eed8e for active session session-1745623068507-by5f2
2025-04-25 23:17:50,335 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745623068507-by5f2: '...'
2025-04-25 23:17:50,887 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue.  I need the initial user message and the assistant's response to that message.  I have no context to build upon.  Please provide the initial interaction.
2025-04-25 23:17:50,888 - CtxMemMgr_User1 - INFO - Session session-1745623068507-by5f2: Active history token count ~0 / 30000
2025-04-25 23:17:50,888 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745623068507-by5f2 to /app/data/1/session-1745623068507-by5f2/context.json
2025-04-25 23:17:50,890 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745623068507-by5f2
2025-04-25 23:17:50,890 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you.", "session_id": "session-1745623068507-by5f2", "timestamp": "2025-04-25T23:17:50.890705"}
2025-04-25 23:22:36,610 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745623356599-d3oe7
2025-04-25 23:22:36,611 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:22:36,611 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:22:36,612 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:22:36,613 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:22:36,616 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:22:36,617 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:22:36,618 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:22:36,618 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:22:36,618 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:22:36,618 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:22:36,618 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:22:36,618 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:22:36,618 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:22:36,619 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:22:36,619 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:22:36,619 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:22:36,619 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:22:36,619 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:22:36,620 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:22:36,620 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:22:36,620 - conversation_manager_1 - INFO - Loading session session-1745623356599-d3oe7
2025-04-25 23:22:36,620 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:22:36,620 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:22:36,620 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:22:36,621 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:22:36,621 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:22:36,624 - CtxMemMgr_User1 - INFO - Loading session context for session-1745623356599-d3oe7 from /app/data/1/session-1745623356599-d3oe7/context.json
2025-04-25 23:22:36,625 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745623356599-d3oe7/context.json not found. Initializing empty context for new session session-1745623356599-d3oe7.
2025-04-25 23:22:36,625 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745623356599-d3oe7: hi...
2025-04-25 23:22:36,627 - components.prompt_builder - INFO - Constructing prompt for session session-1745623356599-d3oe7, user 1, depth 0
2025-04-25 23:22:36,627 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:22:36,627 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:22:36,627 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:22:36,627 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:22:36,628 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:22:36,631 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:22:39,412 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:23:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me.",...
2025-04-25 23:22:39,413 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:22:39,413 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:22:39,414 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:22:39,415 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:22:39,416 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:22:39,416 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:22:39,416 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745623356599-d3oe7, user 1
2025-04-25 23:22:39,417 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:22:39,417 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:22:39,417 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:22:39,417 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:22:39,417 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here and ready to assist. What can I do for you?...
2025-04-25 23:22:39,417 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here and ready to assist. What can I do for you?...
2025-04-25 23:22:39,417 - CtxMemMgr_User1 - INFO - Stored turn b32f4ae5-5b9c-4747-b7dc-8423f9c06e60 for active session session-1745623356599-d3oe7
2025-04-25 23:22:39,418 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745623356599-d3oe7: '...'
2025-04-25 23:22:40,155 - CtxMemMgr_User1 - INFO - Session session-1745623356599-d3oe7: Active history token count ~0 / 30000
2025-04-25 23:22:40,155 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745623356599-d3oe7 to /app/data/1/session-1745623356599-d3oe7/context.json
2025-04-25 23:22:40,157 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745623356599-d3oe7
2025-04-25 23:22:40,157 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello! It's late, but I'm here and ready to assist. What can I do for you?", "session_id": "session-1745623356599-d3oe7", "timestamp": "2025-04-25T23:22:40.157344"}
2025-04-25 23:25:56,485 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: session-1745623556472-af190
2025-04-25 23:25:56,486 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:25:56,486 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:25:56,486 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:25:56,487 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:25:56,491 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:25:56,492 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:25:56,492 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:25:56,492 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:25:56,492 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:25:56,493 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:25:56,493 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:25:56,493 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:25:56,493 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:25:56,493 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:25:56,493 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:25:56,493 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:25:56,493 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:25:56,494 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:25:56,494 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:25:56,494 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:25:56,494 - conversation_manager_1 - INFO - Loading session session-1745623556472-af190
2025-04-25 23:25:56,494 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:25:56,494 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:25:56,494 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:25:56,495 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:25:56,495 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:25:56,498 - CtxMemMgr_User1 - INFO - Loading session context for session-1745623556472-af190 from /app/data/1/session-1745623556472-af190/context.json
2025-04-25 23:25:56,498 - CtxMemMgr_User1 - INFO - Context file /app/data/1/session-1745623556472-af190/context.json not found. Initializing empty context for new session session-1745623556472-af190.
2025-04-25 23:25:56,498 - CtxMemMgr_User1 - INFO - Processing user input for active session session-1745623556472-af190: hi...
2025-04-25 23:25:56,499 - components.prompt_builder - INFO - Constructing prompt for session session-1745623556472-af190, user 1, depth 0
2025-04-25 23:25:56,500 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:25:56,500 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:25:56,500 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:25:56,500 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:25:56,500 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:25:56,502 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:25:58,617 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:25:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:25:58,618 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:25:58,618 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:25:58,619 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:25:58,619 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:25:58,619 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:25:58,620 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:25:58,620 - ActionHandler_User1 - INFO - Processing LLM response for session session-1745623556472-af190, user 1
2025-04-25 23:25:58,620 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:25:58,620 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:25:58,620 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:25:58,621 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:25:58,621 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:25:58,621 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you....
2025-04-25 23:25:58,622 - CtxMemMgr_User1 - INFO - Stored turn 11128485-8bbb-4468-a22f-ae244e808064 for active session session-1745623556472-af190
2025-04-25 23:25:58,622 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session session-1745623556472-af190: '...'
2025-04-25 23:25:59,552 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I cannot continue.  I need the initial user message and the assistant's response to that message.  I have no context to build upon.  Please provide the initial interaction.
2025-04-25 23:25:59,552 - CtxMemMgr_User1 - INFO - Session session-1745623556472-af190: Active history token count ~0 / 30000
2025-04-25 23:25:59,554 - CtxMemMgr_User1 - INFO - Saving active session context for session-1745623556472-af190 to /app/data/1/session-1745623556472-af190/context.json
2025-04-25 23:25:59,555 - CtxMemMgr_User1 - INFO - Successfully saved context for session session-1745623556472-af190
2025-04-25 23:25:59,556 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello! It's late, but I'm here if you need anything.  Let me know how I can assist you.", "session_id": "session-1745623556472-af190", "timestamp": "2025-04-25T23:25:59.556211"}
2025-04-25 23:28:53,902 - managers.user_session_manager - INFO - Creating new conversation manager for user: 1, session: new_chat
2025-04-25 23:28:53,904 - EpisodicMemMgr_User1 - INFO - Summary index file not found for user 1. Initialized empty index.
2025-04-25 23:28:53,905 - EpisodicMemMgr_User1 - INFO - EpisodicMemoryManager initialized for user 1. Episodic path: /app/data/1/episodic
2025-04-25 23:28:53,905 - CtxMemMgr_User1 - INFO - Successfully initialized LLM API client for memory extraction
2025-04-25 23:28:53,905 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:28:53,907 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:28:53,908 - CtxMemMgr_User1 - INFO - ContextualMemoryManager initialized for user 1.
2025-04-25 23:28:53,908 - managers.conversation_manager - INFO - Initializing Docker LLM API client with URL: http://rai-llm-engine:6101
2025-04-25 23:28:53,908 - conversation_manager_1 - INFO - Using LLM API client: DockerLLMAPI
2025-04-25 23:28:53,908 - conversation_manager_1 - INFO - Successfully initialized database session
2025-04-25 23:28:53,908 - managers.memory.tier_manager - WARNING - Using fallback LLM API client
2025-04-25 23:28:53,909 - managers.memory.tier_manager - INFO - TierManager initialized with LLM API client
2025-04-25 23:28:53,909 - managers.memory.context_builder - INFO - ContextBuilder initialized
2025-04-25 23:28:53,909 - managers.memory.request_parser - INFO - RequestParser initialized
2025-04-25 23:28:53,909 - managers.memory.memory_pruner - INFO - MemoryPruner initialized with 30000 token limit
2025-04-25 23:28:53,909 - managers.memory.memory_importance_scorer - INFO - MemoryImportanceScorer initialized
2025-04-25 23:28:53,909 - conversation_manager_1 - INFO - Initialized memory importance scorer for automatic tier management
2025-04-25 23:28:53,910 - components.prompt_builder - INFO - PromptBuilder initialized for user 1
2025-04-25 23:28:53,910 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:28:53,910 - components.action_handler - INFO - ActionHandler initialized for user 1
2025-04-25 23:28:53,910 - conversation_manager_1 - INFO - Conversation manager for user 1 initialized successfully
2025-04-25 23:28:53,910 - conversation_manager_1 - INFO - Loading session new_chat
2025-04-25 23:28:53,910 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:28:53,911 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:28:53,911 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:28:53,911 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:28:53,911 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:28:53,915 - CtxMemMgr_User1 - INFO - Loading session context for new_chat from /app/data/1/new_chat/context.json
2025-04-25 23:28:53,916 - CtxMemMgr_User1 - INFO - Context file /app/data/1/new_chat/context.json not found. Initializing empty context for new session new_chat.
2025-04-25 23:28:53,916 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-25 23:28:53,917 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:28:53,918 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-25 23:28:53,918 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:28:53,918 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:28:53,918 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:28:53,918 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:28:53,920 - CtxMemMgr_User1 - INFO - No remembered facts found in DB for user 1.
2025-04-25 23:28:55,805 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:29:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me wi...
2025-04-25 23:28:55,806 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:28:55,806 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:28:55,807 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:28:55,807 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:28:55,808 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:28:55,808 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:28:55,808 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:28:55,809 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:28:55,809 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:28:55,809 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:28:55,810 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:28:55,810 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello! It's late, but I'm here if you need anything.  Is there anything I can assist you with?...
2025-04-25 23:28:55,810 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello! It's late, but I'm here if you need anything.  Is there anything I can assist you with?...
2025-04-25 23:28:55,811 - CtxMemMgr_User1 - INFO - Stored turn b02b5b4c-8d89-4538-b539-6d5291d06333 for active session new_chat
2025-04-25 23:28:55,812 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:28:56,277 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~0 / 30000
2025-04-25 23:28:56,278 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:28:56,282 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:28:56,283 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello! It's late, but I'm here if you need anything.  Is there anything I can assist you with?", "session_id": "new_chat", "timestamp": "2025-04-25T23:28:56.282995"}
2025-04-25 23:29:04,013 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:29:04,013 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:29:04,013 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:29:04,014 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:29:04,014 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:29:04,020 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: my name is jordan...
2025-04-25 23:29:04,023 - conversation_manager_1 - INFO - Pattern match extracted: User's name is jordan.
2025-04-25 23:29:04,023 - conversation_manager_1 - INFO - Added 1 new facts to contextual memory
2025-04-25 23:29:04,026 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (1 facts). Pending commit.
2025-04-25 23:29:04,029 - conversation_manager_1 - INFO - Saved 1 new facts to database
2025-04-25 23:29:04,030 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:29:04,030 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'my name is jordan'
2025-04-25 23:29:04,030 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:29:04,030 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:29:04,030 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:29:04,030 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:29:04,032 - CtxMemMgr_User1 - INFO - Loaded 1 facts from DB for user 1
2025-04-25 23:29:06,163 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is stating th...
2025-04-25 23:29:06,163 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:29:06,163 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:29:06,163 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:29:06,164 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:29:06,164 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:29:06,164 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:29:06,164 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:29:06,164 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:29:06,164 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:29:06,165 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:29:06,165 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:29:06,165 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello Jordan! I've updated my memory to include your name. I will address you as Jordan in our futur...
2025-04-25 23:29:06,165 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello Jordan! I've updated my memory to include your name. I will address you as Jordan in our futur...
2025-04-25 23:29:06,165 - CtxMemMgr_User1 - INFO - Stored turn e7554eed-85f3-43b7-b3b9-6a427bd6a507 for active session new_chat
2025-04-25 23:29:06,166 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:29:06,166 - CtxMemMgr_User1 - INFO - Rule-based extraction found name: jordan
2025-04-25 23:29:06,686 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-25 23:29:06,686 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-25 23:29:06,689 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (2 facts). Pending commit.
2025-04-25 23:29:06,695 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-25 23:29:06,695 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~4 / 30000
2025-04-25 23:29:06,696 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:29:06,697 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:29:06,697 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello Jordan! I've updated my memory to include your name. I will address you as Jordan in our future interactions.  Please let me know if there's anything I can assist you with tonight.", "session_id": "new_chat", "timestamp": "2025-04-25T23:29:06.697505"}
2025-04-25 23:29:09,798 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:29:09,798 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:29:09,798 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:29:09,798 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:29:09,799 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:29:09,801 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What is my name?...
2025-04-25 23:29:09,802 - conversation_manager_1 - INFO - Pattern match extracted: User's project uses What for the name.
2025-04-25 23:29:09,802 - conversation_manager_1 - INFO - Added 1 new facts to contextual memory
2025-04-25 23:29:09,803 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (3 facts). Pending commit.
2025-04-25 23:29:09,805 - conversation_manager_1 - INFO - Saved 1 new facts to database
2025-04-25 23:29:09,805 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:29:09,806 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What is my name?'
2025-04-25 23:29:09,806 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:29:09,806 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:29:09,806 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:29:09,806 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:29:09,807 - CtxMemMgr_User1 - INFO - Loaded 3 facts from DB for user 1
2025-04-25 23:29:11,675 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:32:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking for...
2025-04-25 23:29:11,676 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:29:11,676 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:29:11,677 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:29:11,677 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:29:11,677 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:29:11,678 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:29:11,678 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:29:11,678 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:29:11,678 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:29:11,679 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:29:11,679 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:29:11,679 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Your name is Jordan.  I have this information stored in my memory from our earlier interaction....
2025-04-25 23:29:11,680 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Your name is Jordan.  I have this information stored in my memory from our earlier interaction....
2025-04-25 23:29:11,680 - CtxMemMgr_User1 - INFO - Stored turn 3b65fe40-a6db-4740-b68b-b1ab67597188 for active session new_chat
2025-04-25 23:29:11,680 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:29:12,245 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-25 23:29:12,246 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~8 / 30000
2025-04-25 23:29:12,246 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:29:12,247 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:29:12,247 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Your name is Jordan.  I have this information stored in my memory from our earlier interaction.", "session_id": "new_chat", "timestamp": "2025-04-25T23:29:12.247536"}
2025-04-25 23:29:18,900 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:29:18,900 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:29:18,901 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:29:18,901 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:29:18,901 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:29:18,907 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Who is dan martell?...
2025-04-25 23:29:18,914 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:29:18,915 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Who is dan martell?'
2025-04-25 23:29:18,915 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:29:18,915 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:29:18,916 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:29:18,916 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:29:18,918 - CtxMemMgr_User1 - INFO - Loaded 3 facts from DB for user 1
2025-04-25 23:29:20,868 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:31:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking for...
2025-04-25 23:29:20,868 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:29:20,869 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:29:20,869 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:29:20,870 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:29:20,870 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:29:20,870 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:29:20,870 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:29:20,870 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:29:20,871 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:29:20,871 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:29:20,871 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:29:20,871 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: [SEARCH: Dan Martel biography]...
2025-04-25 23:29:20,871 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): [SEARCH: Dan Martel biography]...
2025-04-25 23:29:20,872 - CtxMemMgr_User1 - INFO - Stored turn 90930fef-5544-428e-8c99-f36a72ed6f27 for active session new_chat
2025-04-25 23:29:20,872 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:29:21,474 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~12 / 30000
2025-04-25 23:29:21,475 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:29:21,477 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:29:21,477 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "[SEARCH: Dan Martel biography]", "session_id": "new_chat", "timestamp": "2025-04-25T23:29:21.477461"}
2025-04-25 23:30:08,295 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:08,295 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:30:08,296 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:30:08,296 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:08,296 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:30:08,304 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What is my name?...
2025-04-25 23:30:08,307 - conversation_manager_1 - INFO - Pattern match extracted: User's project uses What for the name.
2025-04-25 23:30:08,307 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:30:08,308 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What is my name?'
2025-04-25 23:30:08,308 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:30:08,308 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:30:08,308 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:30:08,308 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:30:08,309 - CtxMemMgr_User1 - INFO - Loaded 3 facts from DB for user 1
2025-04-25 23:30:10,546 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking for...
2025-04-25 23:30:10,547 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:10,547 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:10,547 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:10,548 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:10,548 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:30:10,548 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:30:10,548 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:30:10,548 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:30:10,548 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:30:10,548 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:30:10,549 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:30:10,549 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Based on our previous conversation, your name is Jordan. You stated this yourself earlier....
2025-04-25 23:30:10,549 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Based on our previous conversation, your name is Jordan. You stated this yourself earlier....
2025-04-25 23:30:10,549 - CtxMemMgr_User1 - INFO - Stored turn 3e8f13a6-af81-440f-9201-dca0c392b248 for active session new_chat
2025-04-25 23:30:10,549 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:30:11,175 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-25 23:30:11,175 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~16 / 30000
2025-04-25 23:30:11,176 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:30:11,178 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:30:11,179 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Based on our previous conversation, your name is Jordan. You stated this yourself earlier.", "session_id": "new_chat", "timestamp": "2025-04-25T23:30:11.179360"}
2025-04-25 23:30:16,717 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:16,718 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:30:16,718 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:30:16,718 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:16,719 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:30:16,722 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What did I ask you to search before?...
2025-04-25 23:30:16,725 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:30:16,726 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What did I ask you to search before?'
2025-04-25 23:30:16,726 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:30:16,726 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:30:16,726 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:30:16,726 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:30:16,728 - CtxMemMgr_User1 - INFO - Loaded 3 facts from DB for user 1
2025-04-25 23:30:19,446 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking wha...
2025-04-25 23:30:19,447 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:19,447 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:19,448 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:19,448 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:19,448 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:30:19,448 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:30:19,449 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:30:19,449 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:30:19,449 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:30:19,449 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:30:19,450 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:30:19,450 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: To answer your question properly, I would need access to your search history, which is beyond my cur...
2025-04-25 23:30:19,450 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): To answer your question properly, I would need access to your search history, which is beyond my cur...
2025-04-25 23:30:19,450 - CtxMemMgr_User1 - INFO - Stored turn d4fe8230-cd15-4bf3-bf9b-a85064641dbc for active session new_chat
2025-04-25 23:30:19,450 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:30:20,053 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~25 / 30000
2025-04-25 23:30:20,054 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:30:20,056 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:30:20,056 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "To answer your question properly, I would need access to your search history, which is beyond my current capabilities.  I'm sorry I can't provide that information right now.", "session_id": "new_chat", "timestamp": "2025-04-25T23:30:20.056328"}
2025-04-25 23:30:40,022 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:40,022 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:30:40,022 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:30:40,022 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:40,023 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:30:40,028 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: I asked you who someone was. Who ws that?...
2025-04-25 23:30:40,032 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:30:40,032 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'I asked you who someone was. Who ws that?'
2025-04-25 23:30:40,033 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:30:40,040 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:30:40,040 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:30:40,040 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:30:40,043 - CtxMemMgr_User1 - INFO - Loaded 3 facts from DB for user 1
2025-04-25 23:30:42,185 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking who...
2025-04-25 23:30:42,186 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:42,186 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:42,186 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:42,187 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:42,187 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:30:42,187 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:30:42,187 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:30:42,187 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:30:42,189 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:30:42,190 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:30:42,190 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:30:42,190 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: [SEARCH: Dan Martel]...
2025-04-25 23:30:42,190 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): [SEARCH: Dan Martel]...
2025-04-25 23:30:42,190 - CtxMemMgr_User1 - INFO - Stored turn 8977649d-7607-4049-99fb-a5512af6a12c for active session new_chat
2025-04-25 23:30:42,191 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:30:42,726 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~35 / 30000
2025-04-25 23:30:42,727 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:30:42,729 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:30:42,729 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "[SEARCH: Dan Martel]", "session_id": "new_chat", "timestamp": "2025-04-25T23:30:42.729632"}
2025-04-25 23:30:50,169 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:50,169 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:30:50,169 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:30:50,171 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:30:50,173 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:30:50,178 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Thats right....
2025-04-25 23:30:50,181 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:30:50,181 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Thats right.'
2025-04-25 23:30:50,181 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:30:50,181 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:30:50,181 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:30:50,181 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:30:50,196 - CtxMemMgr_User1 - INFO - Loaded 3 facts from DB for user 1
2025-04-25 23:30:52,402 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user affirms a pre...
2025-04-25 23:30:52,403 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:52,403 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:52,403 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:30:52,404 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:30:52,404 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:30:52,404 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:30:52,404 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:30:52,405 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:30:52,405 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:30:52,405 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:30:52,405 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:30:52,406 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Understood.  I'm ready for your next request, Jordan....
2025-04-25 23:30:52,406 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Understood.  I'm ready for your next request, Jordan....
2025-04-25 23:30:52,406 - CtxMemMgr_User1 - INFO - Stored turn 55353d95-5729-40dd-8ed9-b9aa12fac5e7 for active session new_chat
2025-04-25 23:30:52,406 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:30:53,337 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-25 23:30:53,338 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~38 / 30000
2025-04-25 23:30:53,338 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:30:53,341 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:30:53,341 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Understood.  I'm ready for your next request, Jordan.", "session_id": "new_chat", "timestamp": "2025-04-25T23:30:53.341752"}
2025-04-25 23:31:08,594 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:31:08,594 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:31:08,594 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:31:08,595 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:31:08,595 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:31:08,598 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Write a dry lease agreement for a cE525...
2025-04-25 23:31:08,600 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:31:08,600 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Write a dry lease agreement for a cE525'
2025-04-25 23:31:08,600 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:31:08,600 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:31:08,601 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:31:08,601 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:31:08,602 - CtxMemMgr_User1 - INFO - Loaded 3 facts from DB for user 1
2025-04-25 23:31:15,169 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:33:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user requests a dr...
2025-04-25 23:31:15,170 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:31:15,171 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:31:15,172 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:31:15,172 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:31:15,172 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:31:15,173 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:31:15,173 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:31:15,173 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:31:15,174 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:31:15,174 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:31:15,175 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:31:15,175 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: This is a sample template only and should not be used as a legally binding document.  It is essentia...
2025-04-25 23:31:15,176 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): This is a sample template only and should not be used as a legally binding document.  It is essentia...
2025-04-25 23:31:15,176 - CtxMemMgr_User1 - INFO - Stored turn 7136b073-2592-4bdb-8396-b22d741374ca for active session new_chat
2025-04-25 23:31:15,176 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:31:16,069 - CtxMemMgr_User1 - INFO - Suggested memory items: ['User needs a dry lease agreement for a Cessna Citation Sovereign+ (CE525).']
2025-04-25 23:31:16,070 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-25 23:31:16,075 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (4 facts). Pending commit.
2025-04-25 23:31:16,079 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-25 23:31:16,080 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~47 / 30000
2025-04-25 23:31:16,080 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:31:16,081 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:31:16,081 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "This is a sample template only and should not be used as a legally binding document.  It is essential to consult with legal counsel to create a legally sound and comprehensive dry lease agreement.  This template is for informational purposes only.\n\n**Dry Lease Agreement**\n\nThis Dry Lease Agreement (the \"Agreement\") is made and entered into this [Date] by and between [Lessor Name], a [State] [Entity Type] with its principal place of business at [Lessor Address] (\"Lessor\"), and [Lessee Name], a [State] [Entity Type] with its principal place of business at [Lessee Address] (\"Lessee\").\n\n**1. Aircraft:**\n\nLessor agrees to lease to Lessee, and Lessee agrees to lease from Lessor, the aircraft described as follows:\n\n*   Make and Model: Cessna Citation Sovereign+ (CE525)\n*   Serial Number: [Serial Number]\n*   Registration Number: [Registration Number]\n\n**2. Lease Term:**\n\nThe lease term shall commence on [Start Date] and shall continue until [End Date], unless terminated earlier in accordance with the terms of this Agreement.\n\n**3. Lease Payment:**\n\nLessee shall pay Lessor a lease payment of [Amount] [Currency] per [Month/Year], payable in advance on the [Day] of each [Month].\n\n**4. Insurance:**\n\nLessee shall maintain hull and liability insurance on the Aircraft in an amount not less than [Amount] [Currency], with coverage acceptable to Lessor.\n\n**5. Maintenance:**\n\nLessee shall be responsible for all maintenance and repairs of the Aircraft, except for [Specify exceptions, if any].\n\n**6. Taxes:**\n\nLessee shall be responsible for all taxes, fees, and other charges associated with the operation of the Aircraft.\n\n**7. Return of Aircraft:**\n\nUpon termination of this Agreement, Lessee shall return the Aircraft to Lessor in the same condition as it was received, reasonable wear and tear excepted.\n\n**8. Default:**\n\n[Specify conditions of default and remedies]\n\n**9. Governing Law:**\n\nThis Agreement shall be governed by and construed in accordance with the laws of the State of [State].\n\n**10. Entire Agreement:**\n\nThis Agreement constitutes the entire agreement between the parties with respect to the subject matter hereof and supersedes all prior or contemporaneous communications and proposals, whether oral or written.\n\n**IN WITNESS WHEREOF**, the parties have executed this Agreement as of the date first written above.\n\n_____________________________\nLessor\n\n_____________________________\nLessee\n\n[Include spaces for signatures and dates]\n\n[SEARCH: Cessna Citation Sovereign+ dry lease agreement template]", "session_id": "new_chat", "timestamp": "2025-04-25T23:31:16.081638"}
2025-04-25 23:31:25,480 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:31:25,480 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:31:25,480 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:31:25,480 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:31:25,481 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:31:25,484 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Summarize the agreement for me....
2025-04-25 23:31:25,487 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:31:25,487 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Summarize the agreement for me.'
2025-04-25 23:31:25,488 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:31:25,488 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:31:25,488 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:31:25,488 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:31:25,489 - CtxMemMgr_User1 - INFO - Loaded 4 facts from DB for user 1
2025-04-25 23:31:28,266 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:33:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user requests a su...
2025-04-25 23:31:28,267 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:31:28,267 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:31:28,267 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:31:28,268 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:31:28,268 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:31:28,268 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:31:28,268 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:31:28,269 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:31:28,269 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:31:28,269 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:31:28,270 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:31:28,270 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: I need the full text of the dry lease agreement to generate a summary. Please provide the document. ...
2025-04-25 23:31:28,270 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): I need the full text of the dry lease agreement to generate a summary. Please provide the document. ...
2025-04-25 23:31:28,270 - ActionHandler_User1 - INFO - Detected tier request in: I need the full text of the dry lease agreement to generate a summary. Please provide the document. ...
2025-04-25 23:31:28,271 - CtxMemMgr_User1 - INFO - Stored turn 0d245aad-1788-4836-b75c-d831a2c478c9 for active session new_chat
2025-04-25 23:31:28,271 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:31:28,826 - CtxMemMgr_User1 - INFO - Suggested memory items: ['User prefers summaries of documents.']
2025-04-25 23:31:28,826 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-25 23:31:28,827 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (5 facts). Pending commit.
2025-04-25 23:31:28,830 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-25 23:31:28,830 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~54 / 30000
2025-04-25 23:31:28,830 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:31:28,831 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:31:28,831 - conversation_manager_1 - INFO - Detected special command in LLM response, processing with RequestParser
2025-04-25 23:31:28,831 - managers.memory.request_parser - INFO - Found tier upgrade request: message msg_12 to tier 3
2025-04-25 23:31:28,831 - managers.memory.request_parser - INFO - Found tier upgrade request: message msg_12 to tier 3
2025-04-25 23:31:28,831 - managers.memory.request_parser - INFO - Found 2 tier requests
2025-04-25 23:31:28,832 - managers.memory.request_parser - INFO - Processing 2 tier upgrade requests
2025-04-25 23:31:28,832 - managers.memory.request_parser - INFO - Upgrading message msg_12 to tier 3
2025-04-25 23:31:28,833 - managers.memory.request_parser - WARNING - Message msg_12 not found in session new_chat
2025-04-25 23:31:28,833 - managers.memory.request_parser - INFO - Upgrading message msg_12 to tier 3
2025-04-25 23:31:28,833 - managers.memory.request_parser - WARNING - Message msg_12 not found in session new_chat
2025-04-25 23:31:28,834 - conversation_manager_1 - INFO - Rebuilding context with updated tier levels
2025-04-25 23:31:28,835 - managers.memory.context_builder - INFO - Building context with max tokens: 4000
2025-04-25 23:31:28,835 - conversation_manager_1 - ERROR - Error building token-aware context: 'NoneType' object has no attribute 'startswith'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 915, in build_context
    context = self.context_builder.build_context(messages, max_tokens)
  File "/app/managers/memory/context_builder.py", line 184, in build_context
    formatted_msg = self.format_message(message_dict)
  File "/app/managers/memory/context_builder.py", line 255, in format_message
    if not message_id.startswith("msg_") and not message_id.startswith("message_"):
AttributeError: 'NoneType' object has no attribute 'startswith'
2025-04-25 23:31:28,836 - conversation_manager_1 - INFO - Constructing enriched system prompt with updated context
2025-04-25 23:31:28,836 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:31:28,836 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Summarize the agreement for me.'
2025-04-25 23:31:28,836 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:31:28,836 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:31:28,836 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:31:28,836 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:31:28,837 - CtxMemMgr_User1 - INFO - Loaded 5 facts from DB for user 1
2025-04-25 23:31:28,837 - conversation_manager_1 - INFO - Regenerating with context size: 0 tokens
2025-04-25 23:31:28,837 - conversation_manager_1 - INFO - Regenerating LLM response with upgraded context
2025-04-25 23:31:31,430 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:33:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user requests a su...
2025-04-25 23:31:31,430 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:31:31,430 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:31:31,431 - conversation_manager_1 - ERROR - Error regenerating response: unhashable type: 'slice'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 570, in process_message
    self.logger.info(f"Successfully regenerated response: {updated_response[:100]}...")
TypeError: unhashable type: 'slice'
2025-04-25 23:31:31,431 - conversation_manager_1 - INFO - Storing regenerated assistant response in contextual memory
2025-04-25 23:31:31,432 - CtxMemMgr_User1 - INFO - Stored turn 2470e25d-35e2-4436-8888-af500be0f061 for active session new_chat
2025-04-25 23:31:31,432 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:31:32,026 - CtxMemMgr_User1 - INFO - Suggested memory items: ['User prefers summaries of documents.']
2025-04-25 23:31:32,027 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~61 / 30000
2025-04-25 23:31:32,027 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:31:32,029 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:31:32,029 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "I apologize, but I encountered an error retrieving the information you requested. Please try asking again.", "session_id": "new_chat", "timestamp": "2025-04-25T23:31:32.029561"}
2025-04-25 23:32:12,500 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:12,500 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:32:12,500 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:32:12,501 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:12,501 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:32:12,505 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: I asked you to write an agreement. What was it about?...
2025-04-25 23:32:12,508 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:32:12,508 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'I asked you to write an agreement. What was it about?'
2025-04-25 23:32:12,508 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:32:12,508 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:32:12,508 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:32:12,508 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:32:12,510 - CtxMemMgr_User1 - INFO - Loaded 5 facts from DB for user 1
2025-04-25 23:32:14,846 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:34:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking abo...
2025-04-25 23:32:14,847 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:32:14,847 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:32:14,847 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:32:14,847 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:32:14,848 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:32:14,848 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:32:14,848 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:32:14,848 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:32:14,848 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:32:14,849 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:32:14,849 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:32:14,849 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: You requested a dry lease agreement for a Cessna Citation Sovereign+ (CE525).  [REQUEST_TIER:2:msg_1...
2025-04-25 23:32:14,850 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): You requested a dry lease agreement for a Cessna Citation Sovereign+ (CE525).  [REQUEST_TIER:2:msg_1...
2025-04-25 23:32:14,850 - ActionHandler_User1 - INFO - Detected tier request in: You requested a dry lease agreement for a Cessna Citation Sovereign+ (CE525).  [REQUEST_TIER:2:msg_1...
2025-04-25 23:32:14,850 - CtxMemMgr_User1 - INFO - Stored turn d66b26fa-b59e-42b2-b19b-835bebac1b37 for active session new_chat
2025-04-25 23:32:14,850 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:32:15,557 - CtxMemMgr_User1 - INFO - Suggested memory items: ['User needs a dry lease agreement for a Cessna Citation Sovereign+ (CE525).']
2025-04-25 23:32:15,557 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~74 / 30000
2025-04-25 23:32:15,557 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:32:15,559 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:32:15,559 - conversation_manager_1 - INFO - Detected special command in LLM response, processing with RequestParser
2025-04-25 23:32:15,560 - managers.memory.request_parser - INFO - Found tier upgrade request: message msg_1234 to tier 2
2025-04-25 23:32:15,560 - managers.memory.request_parser - INFO - Found tier upgrade request: message msg_1234 to tier 2
2025-04-25 23:32:15,560 - managers.memory.request_parser - INFO - Found 2 tier requests
2025-04-25 23:32:15,560 - managers.memory.request_parser - INFO - Processing 2 tier upgrade requests
2025-04-25 23:32:15,560 - managers.memory.request_parser - INFO - Upgrading message msg_1234 to tier 2
2025-04-25 23:32:15,562 - managers.memory.request_parser - WARNING - Message msg_1234 not found in session new_chat
2025-04-25 23:32:15,563 - managers.memory.request_parser - INFO - Upgrading message msg_1234 to tier 2
2025-04-25 23:32:15,564 - managers.memory.request_parser - WARNING - Message msg_1234 not found in session new_chat
2025-04-25 23:32:15,564 - conversation_manager_1 - INFO - Rebuilding context with updated tier levels
2025-04-25 23:32:15,566 - managers.memory.context_builder - INFO - Building context with max tokens: 4000
2025-04-25 23:32:15,567 - conversation_manager_1 - ERROR - Error building token-aware context: 'NoneType' object has no attribute 'startswith'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 915, in build_context
    context = self.context_builder.build_context(messages, max_tokens)
  File "/app/managers/memory/context_builder.py", line 184, in build_context
    formatted_msg = self.format_message(message_dict)
  File "/app/managers/memory/context_builder.py", line 255, in format_message
    if not message_id.startswith("msg_") and not message_id.startswith("message_"):
AttributeError: 'NoneType' object has no attribute 'startswith'
2025-04-25 23:32:15,567 - conversation_manager_1 - INFO - Constructing enriched system prompt with updated context
2025-04-25 23:32:15,567 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:32:15,567 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'I asked you to write an agreement. What was it about?'
2025-04-25 23:32:15,568 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:32:15,568 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:32:15,568 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:32:15,568 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:32:15,570 - CtxMemMgr_User1 - INFO - Loaded 5 facts from DB for user 1
2025-04-25 23:32:15,570 - conversation_manager_1 - INFO - Regenerating with context size: 0 tokens
2025-04-25 23:32:15,571 - conversation_manager_1 - INFO - Regenerating LLM response with upgraded context
2025-04-25 23:32:18,115 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:34:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user wants to know...
2025-04-25 23:32:18,116 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:32:18,116 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:32:18,117 - conversation_manager_1 - ERROR - Error regenerating response: unhashable type: 'slice'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 570, in process_message
    self.logger.info(f"Successfully regenerated response: {updated_response[:100]}...")
TypeError: unhashable type: 'slice'
2025-04-25 23:32:18,117 - conversation_manager_1 - INFO - Storing regenerated assistant response in contextual memory
2025-04-25 23:32:18,118 - CtxMemMgr_User1 - INFO - Stored turn 96486598-5c7e-4a5a-bec4-b8d2a797d1a3 for active session new_chat
2025-04-25 23:32:18,119 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:32:18,857 - CtxMemMgr_User1 - INFO - Suggested memory items: ['User needs a dry lease agreement for a Cessna Citation Sovereign+ (CE525).']
2025-04-25 23:32:18,858 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~87 / 30000
2025-04-25 23:32:18,858 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:32:18,860 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:32:18,861 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "I apologize, but I encountered an error retrieving the information you requested. Please try asking again.", "session_id": "new_chat", "timestamp": "2025-04-25T23:32:18.861016"}
2025-04-25 23:32:27,320 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:27,320 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:32:27,320 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:32:27,321 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:27,321 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:32:27,327 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: My favorite color is blue....
2025-04-25 23:32:27,330 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:32:27,330 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'My favorite color is blue.'
2025-04-25 23:32:27,330 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:32:27,330 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:32:27,330 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:32:27,330 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:32:27,331 - CtxMemMgr_User1 - INFO - Loaded 5 facts from DB for user 1
2025-04-25 23:32:29,475 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:34:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "Jordan stated their fa...
2025-04-25 23:32:29,476 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:32:29,476 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:32:29,477 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:32:29,477 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:32:29,477 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:32:29,477 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:32:29,478 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:32:29,478 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:32:29,478 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:32:29,478 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:32:29,478 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:32:29,479 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Got it, Jordan.  Your preference for the color blue has been noted and will be stored in your user p...
2025-04-25 23:32:29,479 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Got it, Jordan.  Your preference for the color blue has been noted and will be stored in your user p...
2025-04-25 23:32:29,479 - CtxMemMgr_User1 - INFO - Stored turn fe169cb7-22a3-4b07-acda-116b04ed0c4e for active session new_chat
2025-04-25 23:32:29,480 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:32:30,307 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan.", "User's favorite color is blue."]
2025-04-25 23:32:30,308 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-25 23:32:30,312 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (6 facts). Pending commit.
2025-04-25 23:32:30,314 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-25 23:32:30,314 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~93 / 30000
2025-04-25 23:32:30,314 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:32:30,315 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:32:30,315 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Got it, Jordan.  Your preference for the color blue has been noted and will be stored in your user profile for future reference.  This information could be useful for tasks such as personalized recommendations or generating content tailored to your preferences.", "session_id": "new_chat", "timestamp": "2025-04-25T23:32:30.315631"}
2025-04-25 23:32:34,930 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:34,930 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:32:34,930 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:32:34,931 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:34,931 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:32:34,934 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What is my name?...
2025-04-25 23:32:34,935 - conversation_manager_1 - INFO - Pattern match extracted: User's project uses What for the name.
2025-04-25 23:32:34,936 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:32:34,936 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What is my name?'
2025-04-25 23:32:34,936 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:32:34,936 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:32:34,936 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:32:34,936 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:32:34,938 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-25 23:32:37,079 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:33:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking for...
2025-04-25 23:32:37,080 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:32:37,080 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:32:37,081 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:32:37,081 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:32:37,082 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:32:37,082 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:32:37,082 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:32:37,082 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:32:37,083 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:32:37,083 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:32:37,084 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:32:37,084 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Based on our previous conversation, your name is Jordan. You stated this yourself earlier....
2025-04-25 23:32:37,085 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Based on our previous conversation, your name is Jordan. You stated this yourself earlier....
2025-04-25 23:32:37,086 - CtxMemMgr_User1 - INFO - Stored turn 8f7ccffd-4d54-4fb3-9aae-4a7b3da93ae1 for active session new_chat
2025-04-25 23:32:37,086 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:32:37,980 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I need more context to continue.  What is the next user message and assistant response?  I can't continue a conversation without knowing what happened after the assistant noted the user's favorite color.
2025-04-25 23:32:37,981 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~97 / 30000
2025-04-25 23:32:37,981 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:32:37,983 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:32:37,984 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Based on our previous conversation, your name is Jordan. You stated this yourself earlier.", "session_id": "new_chat", "timestamp": "2025-04-25T23:32:37.984162"}
2025-04-25 23:32:47,020 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:47,020 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:32:47,020 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:32:47,020 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:32:47,020 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:32:47,023 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What is my favorite color?...
2025-04-25 23:32:47,027 - conversation_manager_1 - INFO - Pattern match extracted: User's project uses What for the favorite.
2025-04-25 23:32:47,027 - conversation_manager_1 - INFO - Added 1 new facts to contextual memory
2025-04-25 23:33:17,029 - CtxMemMgr_User1 - ERROR - Error saving user facts to DB for user 1: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 295, in save_user_remembered_facts
    user = db.query(User).filter(User.user_id == self.user_id).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-25 23:33:17,043 - conversation_manager_1 - INFO - Saved 1 new facts to database
2025-04-25 23:33:17,043 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:33:17,043 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What is my favorite color?'
2025-04-25 23:33:17,043 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:33:17,043 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:33:17,043 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:33:17,044 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:33:35,658 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-25 23:33:35,663 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-25 23:33:37,786 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:33:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking for...
2025-04-25 23:33:37,787 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:33:37,787 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:33:37,788 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:33:37,788 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:33:37,788 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:33:37,788 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:33:37,788 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:33:37,789 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:33:37,789 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:33:37,789 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:33:37,789 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:33:37,790 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Your favorite color is blue.  You stated this preference earlier in our conversation....
2025-04-25 23:33:37,790 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Your favorite color is blue.  You stated this preference earlier in our conversation....
2025-04-25 23:33:37,790 - CtxMemMgr_User1 - INFO - Stored turn eea3292a-e88b-444f-a08b-96a7b851cd87 for active session new_chat
2025-04-25 23:33:37,790 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:33:38,387 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's favorite color is blue."]
2025-04-25 23:33:38,388 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~103 / 30000
2025-04-25 23:33:38,388 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:33:38,390 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:33:38,391 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Your favorite color is blue.  You stated this preference earlier in our conversation.", "session_id": "new_chat", "timestamp": "2025-04-25T23:33:38.390954"}
2025-04-25 23:33:55,759 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:33:55,760 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:33:55,760 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:33:55,761 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:33:55,761 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:33:55,765 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: are you using your 3 tier memory system?...
2025-04-25 23:33:55,767 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:33:55,767 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'are you using your 3 tier memory system?'
2025-04-25 23:33:55,767 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:33:55,767 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:33:55,767 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:33:55,767 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:33:55,768 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-25 23:33:58,466 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:38:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user asks if the A...
2025-04-25 23:33:58,466 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:33:58,467 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:33:58,467 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:33:58,467 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:33:58,468 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:33:58,468 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:33:58,468 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:33:58,468 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:33:58,469 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:33:58,469 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:33:58,469 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:33:58,470 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Yes, I am actively using my three-tiered memory system.  This system allows me to access and process...
2025-04-25 23:33:58,470 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Yes, I am actively using my three-tiered memory system.  This system allows me to access and process...
2025-04-25 23:33:58,470 - CtxMemMgr_User1 - INFO - Stored turn 1d4c0b96-c6d3-4295-9d5d-26b9bee0ea3f for active session new_chat
2025-04-25 23:33:58,470 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:33:59,318 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~113 / 30000
2025-04-25 23:33:59,318 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:33:59,322 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:33:59,322 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Yes, I am actively using my three-tiered memory system.  This system allows me to access and process information from our previous interactions in a structured manner.  Tier 1 provides access to the most recent messages, Tier 2 expands the context to include some older messages, and Tier 3 provides the complete conversation history.  I'm currently using this system to ensure I can answer your questions accurately and comprehensively, referencing your preferences and previous requests.", "session_id": "new_chat", "timestamp": "2025-04-25T23:33:59.322880"}
2025-04-25 23:34:12,109 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:34:12,110 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:34:12,110 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:34:12,110 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:34:12,111 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:34:12,114 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Have you had to ask for tier 3 yet?...
2025-04-25 23:34:12,117 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:34:12,117 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Have you had to ask for tier 3 yet?'
2025-04-25 23:34:12,117 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:34:12,117 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:34:12,117 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:34:12,117 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:34:12,118 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-25 23:34:14,756 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:36:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "Jordan asks if I\'ve n...
2025-04-25 23:34:14,757 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:34:14,757 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:34:14,758 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:34:14,758 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:34:14,759 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:34:14,759 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:34:14,759 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:34:14,760 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:34:14,760 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:34:14,760 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:34:14,761 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:34:14,761 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: No, I have not yet needed to request Tier 3 information.  Your questions have all been easily answer...
2025-04-25 23:34:14,761 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): No, I have not yet needed to request Tier 3 information.  Your questions have all been easily answer...
2025-04-25 23:34:14,761 - CtxMemMgr_User1 - INFO - Stored turn 02ced145-db71-4942-9b17-7267e96b178b for active session new_chat
2025-04-25 23:34:14,762 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:34:15,428 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~121 / 30000
2025-04-25 23:34:15,428 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:34:15,431 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:34:15,432 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "No, I have not yet needed to request Tier 3 information.  Your questions have all been easily answered from the information I have readily accessible. I am successfully utilizing the Tier 1 and Tier 2 memory systems as instructed and am remembering your preferences and previous requests.", "session_id": "new_chat", "timestamp": "2025-04-25T23:34:15.432120"}
2025-04-25 23:34:29,577 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:34:29,578 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-25 23:34:29,578 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-25 23:34:29,579 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-25 23:34:29,579 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-25 23:34:29,585 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Have you had to ask for tier 2 yet?...
2025-04-25 23:34:29,588 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-25 23:34:29,588 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Have you had to ask for tier 2 yet?'
2025-04-25 23:34:29,588 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-25 23:34:29,588 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-25 23:34:29,588 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-25 23:34:29,589 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-25 23:34:29,589 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-25 23:34:32,054 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-25T23:34:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user asks if I\'ve...
2025-04-25 23:34:32,054 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:34:32,054 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:34:32,054 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-25 23:34:32,055 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-25 23:34:32,055 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-25 23:34:32,055 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-25 23:34:32,055 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-25 23:34:32,055 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-25 23:34:32,056 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-25 23:34:32,056 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-25 23:34:32,056 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-25 23:34:32,056 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: To be completely transparent, I'm carefully managing my context and memory usage to provide the most...
2025-04-25 23:34:32,057 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): To be completely transparent, I'm carefully managing my context and memory usage to provide the most...
2025-04-25 23:34:32,057 - CtxMemMgr_User1 - INFO - Stored turn b3a3f312-6cb5-4a1c-ae8c-d2f573b8d745 for active session new_chat
2025-04-25 23:34:32,057 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-25 23:34:32,611 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~129 / 30000
2025-04-25 23:34:32,611 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-25 23:34:32,613 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-25 23:34:32,613 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "To be completely transparent, I'm carefully managing my context and memory usage to provide the most efficient responses.  While I haven't yet needed to explicitly request Tier 2 information, I will do so immediately if the context of our conversation requires it to ensure accuracy and completeness.", "session_id": "new_chat", "timestamp": "2025-04-25T23:34:32.613342"}
2025-04-26 01:22:47,805 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:22:47,806 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:22:47,806 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:22:47,806 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:22:47,806 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:22:47,815 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:22:47,817 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:22:47,817 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:22:47,817 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:22:47,817 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:22:47,817 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:22:47,817 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:22:47,818 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-26 01:22:49,957 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:23:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted the a...
2025-04-26 01:22:49,957 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:22:49,958 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:22:49,958 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:22:49,959 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:22:49,959 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:22:49,960 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:22:49,960 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:22:49,960 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:22:49,960 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:22:49,961 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:22:49,961 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:22:49,962 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hello Jordan!  It's nice to chat with you.  Is there anything specific I can assist you with this mo...
2025-04-26 01:22:49,962 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hello Jordan!  It's nice to chat with you.  Is there anything specific I can assist you with this mo...
2025-04-26 01:22:49,962 - CtxMemMgr_User1 - INFO - Stored turn 6d069c73-47ab-4078-8343-bf76a3823ec5 for active session new_chat
2025-04-26 01:22:49,963 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:22:50,546 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-26 01:22:50,547 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~129 / 30000
2025-04-26 01:22:50,547 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:22:50,551 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:22:50,552 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hello Jordan!  It's nice to chat with you.  Is there anything specific I can assist you with this morning?", "session_id": "new_chat", "timestamp": "2025-04-26T01:22:50.551894"}
2025-04-26 01:22:56,028 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:22:56,029 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:22:56,029 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:22:56,029 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:22:56,029 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:22:56,034 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What time is it?...
2025-04-26 01:22:56,037 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:22:56,038 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What time is it?'
2025-04-26 01:22:56,038 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:22:56,038 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:22:56,039 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:22:56,039 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:22:56,040 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-26 01:22:58,004 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:23:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user asks for the ...
2025-04-26 01:22:58,004 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:22:58,004 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:22:58,004 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:22:58,004 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:22:58,005 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:22:58,005 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:22:58,005 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:22:58,005 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:22:58,005 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:22:58,005 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:22:58,005 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:22:58,005 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: The current time is 1:23 AM....
2025-04-26 01:22:58,005 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): The current time is 1:23 AM....
2025-04-26 01:22:58,005 - CtxMemMgr_User1 - INFO - Stored turn 98b1e3e2-465a-49a3-8c61-c265274da950 for active session new_chat
2025-04-26 01:22:58,006 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:22:58,467 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~133 / 30000
2025-04-26 01:22:58,467 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:22:58,469 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:22:58,469 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "The current time is 1:23 AM.", "session_id": "new_chat", "timestamp": "2025-04-26T01:22:58.469789"}
2025-04-26 01:23:12,256 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:23:12,256 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:23:12,256 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:23:12,257 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:23:12,257 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:23:12,260 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Its not actually....
2025-04-26 01:23:12,262 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:23:12,263 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Its not actually.'
2025-04-26 01:23:12,263 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:23:12,263 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:23:12,263 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:23:12,263 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:23:12,265 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-26 01:23:14,418 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:26:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "User states that the p...
2025-04-26 01:23:14,418 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:23:14,418 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:23:14,418 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:23:14,419 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:23:14,419 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:23:14,419 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:23:14,419 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:23:14,419 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:23:14,419 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:23:14,419 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:23:14,419 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:23:14,419 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: I need more information to understand what you're referring to. Please clarify which statement you f...
2025-04-26 01:23:14,420 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): I need more information to understand what you're referring to. Please clarify which statement you f...
2025-04-26 01:23:14,420 - ActionHandler_User1 - INFO - Detected tier request in: I need more information to understand what you're referring to. Please clarify which statement you f...
2025-04-26 01:23:14,420 - CtxMemMgr_User1 - INFO - Stored turn cb67ab49-ea89-4ecb-840d-42347e949862 for active session new_chat
2025-04-26 01:23:14,420 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:23:14,857 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~137 / 30000
2025-04-26 01:23:14,857 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:23:14,858 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:23:14,858 - conversation_manager_1 - INFO - Detected special command in LLM response, processing with RequestParser
2025-04-26 01:23:14,858 - managers.memory.request_parser - INFO - Found tier upgrade request: message msg_1234 to tier 2
2025-04-26 01:23:14,858 - managers.memory.request_parser - INFO - Found tier upgrade request: message msg_1234 to tier 2
2025-04-26 01:23:14,858 - managers.memory.request_parser - INFO - Found 2 tier requests
2025-04-26 01:23:14,858 - managers.memory.request_parser - INFO - Processing 2 tier upgrade requests
2025-04-26 01:23:14,858 - managers.memory.request_parser - INFO - Upgrading message msg_1234 to tier 2
2025-04-26 01:23:14,859 - managers.memory.request_parser - WARNING - Message msg_1234 not found in session new_chat
2025-04-26 01:23:14,859 - managers.memory.request_parser - INFO - Upgrading message msg_1234 to tier 2
2025-04-26 01:23:14,860 - managers.memory.request_parser - WARNING - Message msg_1234 not found in session new_chat
2025-04-26 01:23:14,860 - conversation_manager_1 - INFO - Rebuilding context with updated tier levels
2025-04-26 01:23:14,861 - managers.memory.context_builder - INFO - Building context with max tokens: 4000
2025-04-26 01:23:14,861 - conversation_manager_1 - ERROR - Error building token-aware context: 'NoneType' object has no attribute 'startswith'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 915, in build_context
    context = self.context_builder.build_context(messages, max_tokens)
  File "/app/managers/memory/context_builder.py", line 184, in build_context
    formatted_msg = self.format_message(message_dict)
  File "/app/managers/memory/context_builder.py", line 255, in format_message
    if not message_id.startswith("msg_") and not message_id.startswith("message_"):
AttributeError: 'NoneType' object has no attribute 'startswith'
2025-04-26 01:23:14,862 - conversation_manager_1 - INFO - Constructing enriched system prompt with updated context
2025-04-26 01:23:14,862 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:23:14,862 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Its not actually.'
2025-04-26 01:23:14,862 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:23:14,862 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:23:14,862 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:23:14,862 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:23:14,863 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-26 01:23:14,864 - conversation_manager_1 - INFO - Regenerating with context size: 0 tokens
2025-04-26 01:23:14,864 - conversation_manager_1 - INFO - Regenerating LLM response with upgraded context
2025-04-26 01:23:16,975 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:24:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user disagrees wit...
2025-04-26 01:23:16,976 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:23:16,976 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:23:16,977 - conversation_manager_1 - ERROR - Error regenerating response: unhashable type: 'slice'
Traceback (most recent call last):
  File "/app/managers/conversation_manager.py", line 570, in process_message
    self.logger.info(f"Successfully regenerated response: {updated_response[:100]}...")
TypeError: unhashable type: 'slice'
2025-04-26 01:23:16,977 - conversation_manager_1 - INFO - Storing regenerated assistant response in contextual memory
2025-04-26 01:23:16,977 - CtxMemMgr_User1 - INFO - Stored turn ca3a86fc-239c-4c3c-ace2-8b0494086909 for active session new_chat
2025-04-26 01:23:16,978 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:23:17,509 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~141 / 30000
2025-04-26 01:23:17,510 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:23:17,512 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:23:17,512 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "I apologize, but I encountered an error retrieving the information you requested. Please try asking again.", "session_id": "new_chat", "timestamp": "2025-04-26T01:23:17.512546"}
2025-04-26 01:23:18,476 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:23:18,477 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:23:18,477 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:23:18,477 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:23:18,478 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:23:18,484 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:23:18,486 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:23:18,486 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:23:18,487 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:23:18,487 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:23:18,487 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:23:18,487 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:23:18,487 - CtxMemMgr_User1 - INFO - Loaded 6 facts from DB for user 1
2025-04-26 01:23:20,406 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:24:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted me.",...
2025-04-26 01:23:20,407 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:23:20,407 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:23:20,407 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:23:20,408 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:23:20,408 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:23:20,408 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:23:20,409 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:23:20,409 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:23:20,409 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:23:20,409 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:23:20,410 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:23:20,410 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan!  It's good to hear from you. How can I assist you today?  I remember you're working on th...
2025-04-26 01:23:20,410 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan!  It's good to hear from you. How can I assist you today?  I remember you're working on th...
2025-04-26 01:23:20,410 - CtxMemMgr_User1 - INFO - Stored turn 6e38c315-c9c5-4d37-86ae-368053e2f808 for active session new_chat
2025-04-26 01:23:20,411 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:23:21,283 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan.", "User is working on the 'What' project (needs clarification).", 'User needs a dry lease agreement for a Cessna Citation Sovereign+ (CE525).']
2025-04-26 01:23:21,283 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-26 01:23:21,286 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (7 facts). Pending commit.
2025-04-26 01:23:21,291 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-26 01:23:21,292 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~141 / 30000
2025-04-26 01:23:21,292 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:23:21,293 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:23:21,293 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan!  It's good to hear from you. How can I assist you today?  I remember you're working on the What project and need a dry lease agreement for a Cessna Citation Sovereign+ (CE525).  Is there anything I can help you with related to that?", "session_id": "new_chat", "timestamp": "2025-04-26T01:23:21.293494"}
2025-04-26 01:26:13,590 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:13,591 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:26:13,591 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:26:13,591 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:13,591 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:26:13,595 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:26:13,598 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:26:13,598 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:26:13,598 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:26:13,598 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:26:13,598 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:26:13,599 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:26:13,600 - CtxMemMgr_User1 - INFO - Loaded 7 facts from DB for user 1
2025-04-26 01:26:15,385 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:27:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user says hi.",\n ...
2025-04-26 01:26:15,386 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:26:15,386 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:26:15,386 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:26:15,387 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:26:15,387 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:26:15,388 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:26:15,389 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:26:15,389 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:26:15,389 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:26:15,389 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:26:15,390 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:26:15,390 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan!  It's late, but I'm here and ready to assist. How can I help you today?...
2025-04-26 01:26:15,390 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan!  It's late, but I'm here and ready to assist. How can I help you today?...
2025-04-26 01:26:15,390 - CtxMemMgr_User1 - INFO - Stored turn dd2485c9-681e-4b55-ba52-0bc09e626b22 for active session new_chat
2025-04-26 01:26:15,390 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:26:15,931 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-26 01:26:15,933 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~141 / 30000
2025-04-26 01:26:15,933 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:26:15,937 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:26:15,937 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan!  It's late, but I'm here and ready to assist. How can I help you today?", "session_id": "new_chat", "timestamp": "2025-04-26T01:26:15.937646"}
2025-04-26 01:26:20,612 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:20,612 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:26:20,612 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:26:20,612 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:20,613 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:26:20,620 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What time is it?...
2025-04-26 01:26:20,624 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:26:20,624 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What time is it?'
2025-04-26 01:26:20,624 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:26:20,625 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:26:20,625 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:26:20,625 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:26:20,628 - CtxMemMgr_User1 - INFO - Loaded 7 facts from DB for user 1
2025-04-26 01:26:22,429 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:28:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user asks for the ...
2025-04-26 01:26:22,430 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:26:22,430 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:26:22,430 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:26:22,431 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:26:22,431 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:26:22,431 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:26:22,432 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:26:22,432 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:26:22,432 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:26:22,432 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:26:22,433 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:26:22,433 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: It's 1:28 AM....
2025-04-26 01:26:22,433 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): It's 1:28 AM....
2025-04-26 01:26:22,433 - CtxMemMgr_User1 - INFO - Stored turn 1cc8eddb-cb7d-44bd-ab06-0e0379c045de for active session new_chat
2025-04-26 01:26:22,434 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:26:22,944 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~145 / 30000
2025-04-26 01:26:22,945 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:26:22,947 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:26:22,947 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "It's 1:28 AM.", "session_id": "new_chat", "timestamp": "2025-04-26T01:26:22.947158"}
2025-04-26 01:26:29,780 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:29,780 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:26:29,781 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:26:29,781 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:29,781 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:26:29,801 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Who is Dan Martell?...
2025-04-26 01:26:29,804 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:26:29,804 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Who is Dan Martell?'
2025-04-26 01:26:29,804 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:26:29,804 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:26:29,804 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:26:29,805 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:26:50,899 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:50,899 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:26:50,900 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:26:50,900 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:26:50,900 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:26:50,902 - CtxMemMgr_User1 - INFO - Loaded 7 facts from DB for user 1
2025-04-26 01:26:50,907 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:26:50,911 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:26:50,911 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:26:50,911 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:26:50,911 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:26:50,911 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:26:50,911 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:26:53,148 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:28:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user wants to know...
2025-04-26 01:26:53,149 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:26:53,150 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:26:53,150 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:26:53,151 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:26:53,152 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:26:53,152 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:26:53,152 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:26:53,153 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:26:53,153 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:26:53,153 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:26:53,154 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:26:53,154 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: [SEARCH: Dan Martell biography]...
2025-04-26 01:26:53,155 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): [SEARCH: Dan Martell biography]...
2025-04-26 01:26:53,156 - CtxMemMgr_User1 - INFO - Stored turn 8a82b101-f02f-4bf1-87f4-b9c477fea459 for active session new_chat
2025-04-26 01:26:53,156 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:26:53,692 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~149 / 30000
2025-04-26 01:26:53,692 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:26:53,694 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:26:53,694 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "[SEARCH: Dan Martell biography]", "session_id": "new_chat", "timestamp": "2025-04-26T01:26:53.694588"}
2025-04-26 01:27:20,913 - CtxMemMgr_User1 - ERROR - Failed to load user remembered facts during initialization: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 247, in load_user_remembered_facts
    self._load_facts_from_db(db)
  File "/app/managers/memory/contextual_memory.py", line 273, in _load_facts_from_db
    user = session.query(User).filter(User.user_id == self.user_id).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:27:22,706 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:28:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user says hi.",\n ...
2025-04-26 01:27:22,706 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:27:22,707 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:27:22,707 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:27:22,708 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:27:22,708 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:27:22,708 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:27:22,708 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:27:22,709 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:27:22,709 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:27:22,709 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:27:22,709 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:27:22,710 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi! It's nice to chat with you.  Is there anything I can assist you with?...
2025-04-26 01:27:22,710 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi! It's nice to chat with you.  Is there anything I can assist you with?...
2025-04-26 01:27:22,710 - CtxMemMgr_User1 - INFO - Stored turn fd999014-199b-4939-9f15-01b45151f2cd for active session new_chat
2025-04-26 01:27:22,710 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:27:23,104 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:27:23,458 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~149 / 30000
2025-04-26 01:27:23,458 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:27:23,459 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:27:23,460 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi! It's nice to chat with you.  Is there anything I can assist you with?", "session_id": "new_chat", "timestamp": "2025-04-26T01:27:23.460047"}
2025-04-26 01:27:27,942 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:27:38,467 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:27:40,526 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:27:58,482 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:28:08,483 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:28:34,816 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:28:44,756 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:28:54,612 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:28:54,613 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:28:54,613 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:28:54,613 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:28:54,616 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:28:54,622 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:28:54,625 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:28:54,625 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:28:54,625 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:28:54,625 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:28:54,625 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:28:54,625 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:28:54,626 - CtxMemMgr_User1 - INFO - Loaded 7 facts from DB for user 1
2025-04-26 01:28:56,654 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user says hi.",\n ...
2025-04-26 01:28:56,654 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:28:56,654 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:28:56,654 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:28:56,655 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:28:56,655 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:28:56,655 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:28:56,655 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:28:56,655 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:28:56,655 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:28:56,655 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:28:56,655 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:28:56,655 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan! It's good to hear from you. How can I assist you with your What project or the dry lease ...
2025-04-26 01:28:56,656 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan! It's good to hear from you. How can I assist you with your What project or the dry lease ...
2025-04-26 01:28:56,656 - CtxMemMgr_User1 - INFO - Stored turn 64e96061-0e67-4b33-b50d-2df952eb2b65 for active session new_chat
2025-04-26 01:28:56,656 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:28:57,668 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan.", "User is working on a project called 'What' (needs clarification).", 'User needs a dry lease agreement for a Cessna Citation Sovereign+ (CE525).']
2025-04-26 01:28:57,669 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-26 01:28:57,672 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (8 facts). Pending commit.
2025-04-26 01:28:57,676 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-26 01:28:57,676 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~149 / 30000
2025-04-26 01:28:57,677 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:28:57,678 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:28:57,678 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan! It's good to hear from you. How can I assist you with your What project or the dry lease agreement for the Cessna Citation Sovereign+ (CE525)?  Remember, I'm here to help in any way I can.", "session_id": "new_chat", "timestamp": "2025-04-26T01:28:57.678292"}
2025-04-26 01:29:05,557 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:05,558 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:29:05,558 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:29:05,558 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:05,558 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:29:05,562 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:29:05,564 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:29:05,565 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:29:05,565 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:29:05,565 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:29:05,565 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:29:05,565 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:29:05,566 - CtxMemMgr_User1 - INFO - Loaded 8 facts from DB for user 1
2025-04-26 01:29:07,317 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user says hi.",\n ...
2025-04-26 01:29:07,317 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:07,318 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:07,318 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:07,318 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:07,319 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:29:07,319 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:29:07,319 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:29:07,320 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:29:07,320 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:29:07,320 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:29:07,320 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:29:07,321 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan! How can I help you this morning?  Is there anything I can assist you with regarding your ...
2025-04-26 01:29:07,321 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan! How can I help you this morning?  Is there anything I can assist you with regarding your ...
2025-04-26 01:29:07,321 - CtxMemMgr_User1 - INFO - Stored turn bd47f2e7-2302-466b-92a2-e9926829ff11 for active session new_chat
2025-04-26 01:29:07,322 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:29:08,219 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan.", "User is working on a project called 'What' (needs clarification).", 'User needs a dry lease agreement for a Cessna Citation Sovereign+.']
2025-04-26 01:29:08,220 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-26 01:29:08,224 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (9 facts). Pending commit.
2025-04-26 01:29:08,228 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-26 01:29:08,228 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~149 / 30000
2025-04-26 01:29:08,228 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:29:08,230 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:29:08,230 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan! How can I help you this morning?  Is there anything I can assist you with regarding your What project or the dry lease agreement for the Cessna Citation Sovereign+?", "session_id": "new_chat", "timestamp": "2025-04-26T01:29:08.230664"}
2025-04-26 01:29:14,931 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:14,932 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:29:14,932 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:29:14,932 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:14,933 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:29:14,939 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: What is my name?...
2025-04-26 01:29:14,941 - conversation_manager_1 - INFO - Pattern match extracted: User's project uses What for the name.
2025-04-26 01:29:14,941 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:29:14,941 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'What is my name?'
2025-04-26 01:29:14,942 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:29:14,942 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:29:14,942 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:29:14,942 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:29:14,943 - CtxMemMgr_User1 - INFO - Loaded 9 facts from DB for user 1
2025-04-26 01:29:16,721 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking for...
2025-04-26 01:29:16,722 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:16,722 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:16,723 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:16,723 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:16,723 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:29:16,724 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:29:16,724 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:29:16,724 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:29:16,724 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:29:16,724 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:29:16,724 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:29:16,725 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Your name is Jordan. This information was provided earlier in our conversation and is stored in my m...
2025-04-26 01:29:16,725 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Your name is Jordan. This information was provided earlier in our conversation and is stored in my m...
2025-04-26 01:29:16,725 - CtxMemMgr_User1 - INFO - Stored turn fce86701-0015-4f51-b628-2b2a9146a946 for active session new_chat
2025-04-26 01:29:16,725 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:29:17,329 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-26 01:29:17,329 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~153 / 30000
2025-04-26 01:29:17,329 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:29:17,332 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:29:17,332 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Your name is Jordan. This information was provided earlier in our conversation and is stored in my memory.", "session_id": "new_chat", "timestamp": "2025-04-26T01:29:17.332745"}
2025-04-26 01:29:25,497 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:25,497 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:29:25,497 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:29:25,498 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:25,498 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:29:25,501 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: Who is Dan Martell?...
2025-04-26 01:29:25,503 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:29:25,503 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'Who is Dan Martell?'
2025-04-26 01:29:25,503 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:29:25,503 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:29:25,503 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:29:25,503 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:29:25,504 - CtxMemMgr_User1 - INFO - Loaded 9 facts from DB for user 1
2025-04-26 01:29:27,467 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user is asking for...
2025-04-26 01:29:27,468 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:27,469 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:27,469 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:27,470 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:27,470 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:29:27,470 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:29:27,471 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:29:27,471 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:29:27,472 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:29:27,472 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:29:27,473 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:29:27,473 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: [SEARCH: Dan Martell biography]...
2025-04-26 01:29:27,473 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): [SEARCH: Dan Martell biography]...
2025-04-26 01:29:27,474 - CtxMemMgr_User1 - INFO - Stored turn db6a9d97-fcec-46b1-ade6-9f40dfe18491 for active session new_chat
2025-04-26 01:29:27,474 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:29:28,293 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: I need more context to continue.  Please provide the next user message and the assistant's response.  I have no further information to work with.
2025-04-26 01:29:28,294 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:29:28,295 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:29:28,297 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:29:28,297 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "[SEARCH: Dan Martell biography]", "session_id": "new_chat", "timestamp": "2025-04-26T01:29:28.297613"}
2025-04-26 01:29:43,243 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:43,243 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:29:43,243 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:29:43,243 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:29:43,243 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:29:43,247 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:29:43,250 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:29:43,250 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:29:43,250 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:29:43,250 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:29:43,250 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:29:43,250 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:29:43,251 - CtxMemMgr_User1 - INFO - Loaded 9 facts from DB for user 1
2025-04-26 01:29:44,915 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted the a...
2025-04-26 01:29:44,915 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:44,916 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:44,916 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:29:44,916 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:29:44,916 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:29:44,917 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:29:44,917 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:29:44,917 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:29:44,917 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:29:44,917 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:29:44,918 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:29:44,918 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan! It's nice to chat with you. How can I assist you today?...
2025-04-26 01:29:44,918 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan! It's nice to chat with you. How can I assist you today?...
2025-04-26 01:29:44,918 - CtxMemMgr_User1 - INFO - Stored turn 20ff14f2-9b88-4568-b17d-46b9407251bd for active session new_chat
2025-04-26 01:29:44,918 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:29:45,545 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-26 01:29:45,545 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:29:45,546 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:29:45,549 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:29:45,549 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan! It's nice to chat with you. How can I assist you today?", "session_id": "new_chat", "timestamp": "2025-04-26T01:29:45.549830"}
2025-04-26 01:30:01,557 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:30:01,558 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:30:01,558 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:30:01,559 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:30:01,559 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:30:01,565 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:30:01,568 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:30:01,568 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:30:01,568 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:30:01,568 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:30:01,568 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:30:01,568 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:30:01,570 - CtxMemMgr_User1 - INFO - Loaded 9 facts from DB for user 1
2025-04-26 01:30:03,388 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:31:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user says \'hi\'."...
2025-04-26 01:30:03,388 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:30:03,389 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:30:03,389 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:30:03,389 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:30:03,390 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:30:03,390 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:30:03,390 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:30:03,390 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:30:03,390 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:30:03,390 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:30:03,391 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:30:03,391 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan! It's good to hear from you. How can I assist you today?...
2025-04-26 01:30:03,391 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan! It's good to hear from you. How can I assist you today?...
2025-04-26 01:30:03,391 - CtxMemMgr_User1 - INFO - Stored turn 4926855f-9a89-4044-a823-05518bb88aa9 for active session new_chat
2025-04-26 01:30:03,391 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:30:03,970 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-26 01:30:03,970 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:30:03,971 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:30:03,973 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:30:03,973 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan! It's good to hear from you. How can I assist you today?", "session_id": "new_chat", "timestamp": "2025-04-26T01:30:03.973686"}
2025-04-26 01:30:27,909 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:30:27,910 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:30:27,910 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:30:27,910 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:30:27,911 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:30:27,916 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:30:27,918 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:30:27,918 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:30:27,919 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:30:27,919 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:30:27,919 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:30:27,919 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:30:27,920 - CtxMemMgr_User1 - INFO - Loaded 9 facts from DB for user 1
2025-04-26 01:30:29,815 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user says hi.",\n ...
2025-04-26 01:30:29,816 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:30:29,816 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:30:29,817 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:30:29,817 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:30:29,817 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:30:29,818 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:30:29,818 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:30:29,818 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:30:29,818 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:30:29,819 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:30:29,819 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:30:29,819 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan! It's good to hear from you.  How can I assist you today?...
2025-04-26 01:30:29,819 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan! It's good to hear from you.  How can I assist you today?...
2025-04-26 01:30:29,820 - CtxMemMgr_User1 - INFO - Stored turn 10c37255-49c7-47ca-b134-59e210dbdbcc for active session new_chat
2025-04-26 01:30:29,820 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:30:30,420 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan."]
2025-04-26 01:30:30,421 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:30:30,421 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:30:30,425 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:30:30,426 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan! It's good to hear from you.  How can I assist you today?", "session_id": "new_chat", "timestamp": "2025-04-26T01:30:30.426095"}
2025-04-26 01:30:51,395 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:30:51,395 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:30:51,395 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:30:51,395 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:30:51,396 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:30:51,400 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:30:51,402 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:30:51,402 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:30:51,403 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:30:51,403 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:30:51,403 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:30:51,403 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:30:51,403 - CtxMemMgr_User1 - INFO - Loaded 9 facts from DB for user 1
2025-04-26 01:30:53,190 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:30:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted the a...
2025-04-26 01:30:53,191 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:30:53,191 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:30:53,192 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:30:53,192 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:30:53,192 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:30:53,192 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:30:53,193 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:30:53,193 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:30:53,193 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:30:53,193 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:30:53,193 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:30:53,194 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan! How can I help you this morning?  I'm ready to assist with your What project and finding ...
2025-04-26 01:30:53,194 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan! How can I help you this morning?  I'm ready to assist with your What project and finding ...
2025-04-26 01:30:53,194 - CtxMemMgr_User1 - INFO - Stored turn 52c5c881-0b30-4528-867b-e50442fd793a for active session new_chat
2025-04-26 01:30:53,194 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:30:54,064 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan.", "User is working on a project called 'What' (needs clarification).", 'User needs a dry lease agreement for a Cessna Citation Sovereign+.']
2025-04-26 01:30:54,064 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:30:54,064 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:30:54,066 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:30:54,067 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan! How can I help you this morning?  I'm ready to assist with your What project and finding that dry lease agreement for the Cessna Citation Sovereign+.", "session_id": "new_chat", "timestamp": "2025-04-26T01:30:54.067072"}
2025-04-26 01:37:03,934 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:37:03,934 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:37:03,935 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:37:03,935 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:37:03,936 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:37:03,940 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:37:03,942 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:37:03,943 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:37:03,943 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:37:03,943 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:37:03,943 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:37:03,943 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:37:03,944 - CtxMemMgr_User1 - INFO - Loaded 9 facts from DB for user 1
2025-04-26 01:37:05,917 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:38:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted the a...
2025-04-26 01:37:05,917 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:37:05,918 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:37:05,918 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:37:05,919 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:37:05,919 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:37:05,919 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:37:05,920 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:37:05,920 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:37:05,921 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:37:05,921 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:37:05,921 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:37:05,922 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan!  It's good to hear from you.  How can I assist you with your project, or anything else yo...
2025-04-26 01:37:05,922 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan!  It's good to hear from you.  How can I assist you with your project, or anything else yo...
2025-04-26 01:37:05,922 - CtxMemMgr_User1 - INFO - Stored turn 72a49812-bf9b-40cc-b987-2fed2ac006b3 for active session new_chat
2025-04-26 01:37:05,922 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:37:06,678 - CtxMemMgr_User1 - INFO - Suggested memory items: ["User's name is Jordan.", 'User has an ongoing project (details unknown).']
2025-04-26 01:37:06,678 - CtxMemMgr_User1 - INFO - Added 1 new facts to user memory.
2025-04-26 01:37:06,682 - CtxMemMgr_User1 - INFO - Updated remembered_facts in DB for user 1 (10 facts). Pending commit.
2025-04-26 01:37:06,686 - CtxMemMgr_User1 - INFO - Successfully saved 1 new facts to database.
2025-04-26 01:37:06,686 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:37:06,687 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:37:06,688 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:37:06,688 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan!  It's good to hear from you.  How can I assist you with your project, or anything else you need help with today?", "session_id": "new_chat", "timestamp": "2025-04-26T01:37:06.688568"}
2025-04-26 01:38:20,449 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:38:20,450 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:38:20,451 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:38:20,451 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:38:20,452 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:38:20,456 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:38:20,459 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:38:20,459 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:38:20,459 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:38:20,459 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:38:20,459 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:38:20,460 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:38:20,461 - CtxMemMgr_User1 - INFO - Loaded 10 facts from DB for user 1
2025-04-26 01:38:22,311 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:40:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user says \'hi\'."...
2025-04-26 01:38:22,312 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:38:22,312 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:38:22,313 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:38:22,313 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:38:22,313 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:38:22,313 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:38:22,314 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:38:22,314 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:38:22,314 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:38:22,314 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:38:22,315 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:38:22,315 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi Jordan! It's good to hear from you.  How can I assist you today?...
2025-04-26 01:38:22,315 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi Jordan! It's good to hear from you.  How can I assist you today?...
2025-04-26 01:38:22,315 - CtxMemMgr_User1 - INFO - Stored turn 7a9886ae-b5dd-48ea-b0ff-557d32f9d98b for active session new_chat
2025-04-26 01:38:22,316 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:38:22,962 - CtxMemMgr_User1 - WARNING - Memory extraction response was not valid JSON: Please provide me with the previous messages in the conversation. I need that context to continue.
2025-04-26 01:38:22,962 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:38:22,962 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:38:22,963 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:38:22,963 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi Jordan! It's good to hear from you.  How can I assist you today?", "session_id": "new_chat", "timestamp": "2025-04-26T01:38:22.963704"}
2025-04-26 01:40:29,455 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:40:29,455 - conversation_manager_1 - WARNING - Initializing unhealthy components...
2025-04-26 01:40:29,456 - conversation_manager_1 - INFO - Reinitialized database session
2025-04-26 01:40:29,456 - conversation_manager_1 - WARNING - System health check detected degraded components
2025-04-26 01:40:29,456 - conversation_manager_1 - WARNING - System still in degraded state after recovery attempts
2025-04-26 01:40:29,461 - CtxMemMgr_User1 - INFO - Processing user input for active session new_chat: hi...
2025-04-26 01:40:29,464 - components.prompt_builder - INFO - Constructing prompt for session new_chat, user 1, depth 0
2025-04-26 01:40:29,465 - EpisodicMemMgr_User1 - INFO - Searching episodic memories for user 1, query: 'hi'
2025-04-26 01:40:29,465 - EpisodicMemMgr_User1 - INFO - No relevant summaries found for user 1.
2025-04-26 01:40:29,465 - components.prompt_builder - INFO - No current context summary (Tier 2) found.
2025-04-26 01:40:29,465 - components.prompt_builder - INFO - No episodic summaries found.
2025-04-26 01:40:29,465 - CtxMemMgr_User1 - INFO - Loading remembered facts for user 1
2025-04-26 01:40:59,466 - CtxMemMgr_User1 - ERROR - Failed to load user remembered facts during initialization: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
Traceback (most recent call last):
  File "/app/managers/memory/contextual_memory.py", line 247, in load_user_remembered_facts
    self._load_facts_from_db(db)
  File "/app/managers/memory/contextual_memory.py", line 273, in _load_facts_from_db
    user = session.query(User).filter(User.user_id == self.user_id).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:41:01,321 - managers.conversation_manager - INFO - LLM API raw response: {'status': 'success', 'text': '```json\n{\n  "user_message_analysis": {\n    "timestamp": "2025-04-26T01:42:00Z",\n    "speaker": "User",\n    "prompt_tiers": {\n      "tier1": "The user greeted with ...
2025-04-26 01:41:01,321 - managers.conversation_manager - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:41:01,322 - managers.conversation_manager - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:41:01,323 - conversation_manager_1 - INFO - LLM API response type: <class 'dict'>
2025-04-26 01:41:01,323 - conversation_manager_1 - INFO - LLM API response keys: ['status', 'text']
2025-04-26 01:41:01,324 - conversation_manager_1 - INFO - LLM response[status] type: <class 'str'>
2025-04-26 01:41:01,324 - conversation_manager_1 - INFO - LLM response[text] type: <class 'str'>
2025-04-26 01:41:01,324 - ActionHandler_User1 - INFO - Processing LLM response for session new_chat, user 1
2025-04-26 01:41:01,324 - ActionHandler_User1 - INFO - Response data type: <class 'dict'>
2025-04-26 01:41:01,324 - ActionHandler_User1 - INFO - Response data keys: ['status', 'text']
2025-04-26 01:41:01,325 - ActionHandler_User1 - INFO - Found markdown JSON block in response, attempting to extract tier3 content
2025-04-26 01:41:01,325 - ActionHandler_User1 - INFO - Successfully parsed JSON from markdown block, keys: ['user_message_analysis', 'llm_response']
2025-04-26 01:41:01,325 - ActionHandler_User1 - INFO - Successfully extracted tier3 content: Hi! It's nice to chat with you.  Is there anything specific I can assist you with?...
2025-04-26 01:41:01,326 - ActionHandler_User1 - INFO - Extracted content (first 100 chars): Hi! It's nice to chat with you.  Is there anything specific I can assist you with?...
2025-04-26 01:41:01,326 - CtxMemMgr_User1 - INFO - Stored turn 4d29be16-af43-4be4-a6d7-2511e6a3c0a6 for active session new_chat
2025-04-26 01:41:01,326 - CtxMemMgr_User1 - INFO - Updated current_context_summary for session new_chat: '...'
2025-04-26 01:41:01,878 - CtxMemMgr_User1 - INFO - Session new_chat: Active history token count ~157 / 30000
2025-04-26 01:41:01,878 - CtxMemMgr_User1 - INFO - Saving active session context for new_chat to /app/data/1/new_chat/context.json
2025-04-26 01:41:01,881 - CtxMemMgr_User1 - INFO - Successfully saved context for session new_chat
2025-04-26 01:41:01,882 - routes.handlers.chat - INFO - Final response being sent to frontend: {"type": "final", "content": "Hi! It's nice to chat with you.  Is there anything specific I can assist you with?", "session_id": "new_chat", "timestamp": "2025-04-26T01:41:01.882201"}
2025-04-26 01:41:09,389 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:41:39,400 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:41:53,795 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:42:03,955 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:42:06,671 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:42:23,969 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:42:27,758 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:42:30,515 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:42:47,767 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:42:57,770 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:43:17,025 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:43:19,318 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:43:37,030 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:43:44,152 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:43:49,440 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:04,158 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:14,181 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:19,838 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:27,150 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:29,580 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:47,153 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:52,631 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:44:54,567 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:45:03,775 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:45:09,723 - app - ERROR - Exception on /api/chat [POST]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:45:23,779 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:45:33,788 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:46:03,780 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
2025-04-26 01:46:03,804 - app - ERROR - Exception on /api/sessions [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 2528, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python3.10/site-packages/flask_cors/extension.py", line 165, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python3.10/site-packages/flask/app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/app/middleware/auth.py", line 74, in decorated
    user = db.query(User).filter(User.user_id == payload['user_id']).first()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2743, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2842, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2262, in execute
    return self._execute_internal(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2134, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2001, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1126, in _connection_for_bind
    conn = bind.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3264, in connect
    return self._connection_cls(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3288, in raw_connection
    return self.pool.connect()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 452, in connect
    return _ConnectionFairy._checkout(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1267, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 716, in checkout
    rec = pool._do_get()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 158, in _do_get
    raise exc.TimeoutError(
sqlalchemy.exc.TimeoutError: QueuePool limit of size 5 overflow 10 reached, connection timed out, timeout 30.00 (Background on this error at: https://sqlalche.me/e/20/3o7r)
